webpackJsonp([37],{1012:function(e,t,n){"use strict";function r(){return r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},r.apply(this,arguments)}function o(e){return a.createElement("svg",r({width:16,height:16,viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},e),c)}Object.defineProperty(t,"__esModule",{value:!0});var i,a=n(137),c=(n.n(a),(function(e,t,n,r){i||(i="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,a=arguments.length-3;if(t||0===a||(t={children:void 0}),1===a)t.children=r;else if(a>1){for(var c=new Array(a),s=0;s<a;s++)c[s]=arguments[s+3];t.children=c}if(t&&o)for(var u in o)void 0===t[u]&&(t[u]=o[u]);else t||(t=o||{});return{$$typeof:i,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}})("path",{fill:"currentColor",d:"M5.942 11.938l-3.699-4.11A1 1 0 10.757 9.166l4.5 5a1 1 0 001.534-.057l8.5-11a1 1 0 10-1.582-1.223L5.942 11.938z"}));t.default=o},1013:function(e,t,n){"use strict";function r(){return r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},r.apply(this,arguments)}function o(e,t,n,r){a||(a="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=r;else if(i>1){for(var c=new Array(i),s=0;s<i;s++)c[s]=arguments[s+3];t.children=c}if(t&&o)for(var u in o)void 0===t[u]&&(t[u]=o[u]);else t||(t=o||{});return{$$typeof:a,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function i(e){return c.createElement("svg",r({viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},e),s,u)}Object.defineProperty(t,"__esModule",{value:!0});var a,c=n(137),s=(n.n(c),o("path",{fill:"currentColor",fillRule:"evenodd",clipRule:"evenodd",d:"M7.298 12.483a4.648 4.648 0 002.184.054 4.663 4.663 0 003.137-2.396 4.662 4.662 0 00.422-3.108 4.663 4.663 0 00-2.406-3.155 4.66 4.66 0 00-3.123-.414 4.663 4.663 0 00-3.148 2.425A4.66 4.66 0 003.964 7h.909c.499 0 .797.544.522.952l-1.873 2.773a.633.633 0 01-1.044 0L.605 7.952C.33 7.544.628 7 1.127 7h.95a6.47 6.47 0 012.477-4.164 6.494 6.494 0 016.932-.61 6.47 6.47 0 012.158 1.802 6.492 6.492 0 01.627 6.963 6.471 6.471 0 01-1.805 2.157 6.49 6.49 0 01-5.649 1.129.928.928 0 11.48-1.793z"})),u=o("path",{fill:"currentColor",d:"M11.01 8.39a1 1 0 11-1.02 1.72L7.985 9.107A1 1 0 017.5 8.25V5.5a1 1 0 112 0v2.184l1.51.706z"});t.default=i},1226:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LINK=t.LOCAL=void 0,t.LOCAL="local",t.LINK="link"},1227:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.INLINE_IMAGE=t.SIGNATURES=t.ADD_LINK=void 0,t.ADD_LINK="addLink",t.SIGNATURES="signatures",t.INLINE_IMAGE="inline-image"},1228:function(e,t,n){"use strict";function r(e){"@babel/helpers - typeof";return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}function c(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?s(e):t}function s(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}n.d(t,"a",(function(){return y}));var f=n(1229),d=n.n(f),y=(function(e){function t(){return o(this,t),c(this,u(t).apply(this,arguments))}return l(t,e),a(t,[{key:"getConfig",value:function(){}},{key:"getContainer",value:function(){}},{key:"getData",value:function(){}},{key:"setData",value:function(){}},{key:"getContents",value:function(){}},{key:"beforeUpdateElement",value:function(){}},{key:"getCurrentRange",value:function(){return window.getSelection().getRangeAt(0)}}]),t})(d.a)},1230:function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e}n.d(t,"a",(function(){return h}));var a=n(138),c=n.n(a),s=n(1231),u=n(666),l=n(395),p=n.n(l),f=n(1232),d=(n.n(f),n(1233)),y=(n.n(d),n(397)),b=n.n(y),m=-101,h=(function(){function e(t){var n=this;r(this,e),this.editor=null,this._signatureMatches=[],this.disposer=new p.a,this.replacer=document.createElement("div"),this.bootstrap=function(){var e=n.editor.getContainer(),t=n.editor.getConfig(),r=t.isMobile;r||(e.addEventListener("mouseover",n._onMouseOver),e.addEventListener("click",n._onClick),e.addEventListener("keydown",n._onHoverOff,{capture:!0})),n._initMenuAnchor(e,r)},this._initMenuAnchor=function(e,t){n._menuAnchor=n._createMenuAnchor(),e.appendChild(n._menuAnchor),n._updateMenuAnchorPosition(),n._setMenuAnchorVisibility(t),n._setSignaturesPopupVisibility(!1)},this._onBackspace=function(){var e=n._getContainer(),t=n._getContent();if(e&&!t&&n._cursorIsInContainer())return void e.remove();if(n._cursorIsInStartPosition()){var r=n.editor.getCurrentRange(),o=r.startContainer,i=r.startOffset,a=r.endContainer,c=r.endOffset;e.parentNode.insertBefore(e.firstChild,e),n.restoreCursorPosition({startContainer:o,startOffset:i,endContainer:a,endOffset:c})}},this._onResize=function(){n._updateMenuAnchorPosition()},this._onScroll=function(){n._setSignaturesPopupVisibility(!1)},this._onChange=function(){n._menuAnchor&&n._updateMenuAnchorPosition()},this._onDestroy=function(){n.disposer.dispose(n)},this._onGetData=function(e){var t=e.data,r=t.dataValue;void 0!==r&&(t.dataValue=n._insertSignatureBackIntoMessage(r))},this._onSetData=function(e){var t=e.data;t.dataValue&&(t.dataValue=n._wrapSignature(t.dataValue))},this._onClick=function(e){n._isSignatureEvent(e)||(n._setMenuAnchorVisibility(!1),n._isSignaturesPopupShown=!1)},this._onHoverOff=function(e){e.keyCode===b.a.ESC&&(n._setMenuAnchorVisibility(!1),n._isSignaturesPopupShown=!1)},this._onMouseOver=function(e){n._updateMenuAnchorPosition();var t=n._isSignaturesPopupShown||n._isSignatureEvent(e);n._isHovered!==t&&n._setMenuAnchorVisibility(t)},this.applySignature=function(e){var t=n._getContainer();t||(t=document.createElement("div"),n.editor.getContents().appendChild(t)),e.html?(t.innerHTML=e.html,Object(u.c)(t)):t.remove();var r=e.match,o=e.leadingLineBreaks;n._signatureMatches=[{match:r,leadingLineBreaks:o}],n.editor.setData(n.editor.getData());var i=n.editor.getConfig(),a=i.isMobile;n._setMenuAnchorVisibility(a)},this.editor=t,t.signatureManager=this;var o=t.getConfig();this._consts=Object(s.e)(o.isMobile),o.signatures.popup&&t.beforeUpdateElement(this.bootstrap),this._signatureMatches=o.signatures.matches||[],this._addSubscription("getData",this._onGetData,void 0,void 0,m),this._addSubscription("setData",this._onSetData,void 0,void 0,m),o.isMobile&&this._addSubscription("change",this._onChange),this._addSubscription("destroy",this._onDestroy),this._addSubscription("backspace",this._onBackspace),this._addSubscription("resize",(function(){return n._onResize()})),this.disposer.addEventListener(this,{element:window,eventName:"resize",listener:this._onResize});var i=o.composeContainer?o.composeContainer.getScrollableRef():null;if(i){var a=c.a.throttle(this._onScroll,50,{leading:!0});this.disposer.addEventListener(this,{element:i,eventName:"scroll",listener:a})}}return i(e,[{key:"_addSubscription",value:function(e){for(var t,n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];this.disposer.add(this,[(t=this.editor).on.apply(t,[e].concat(r))])}},{key:"restoreCursorPosition",value:function(e){var t=e.startContainer,n=e.startOffset,r=e.endContainer,o=e.endOffset,i=window.getSelection();i.removeAllRanges();var a=document.createRange();a.setStart(t,n),a.setEnd(r,o),i.addRange(a)}},{key:"_getContent",value:function(){var e=this._getContainer();return e?e.innerText.trim():""}},{key:"_cursorIsInStartPosition",value:function(){var e=this._getContainer(),t=this.editor.getCurrentRange(),n=e&&t&&e.contains(t.startContainer);if(!e||!t.collapsed||!n)return!1;var r=t.cloneRange();return r.selectNodeContents(e),r.setEnd(t.endContainer,t.endOffset),0===r.toString().length}},{key:"_cursorIsInContainer",value:function(){var e=this.editor.getCurrentRange(),t=this._getContainer();return t.contains(e.startContainer)||t.contains(e.endContainer)}},{key:"_initReplacerAndFindWrapper",value:function(e){return this.replacer.innerHTML=e,this.replacer.querySelector(this._consts.CONTAINER_SELECTOR)}},{key:"_insertSignatureBackIntoMessage",value:function(e){var t=this._initReplacerAndFindWrapper(e);if(!t)return e;var n=t.querySelector(".".concat(this._consts.MENU_ANCHOR_CLASS));for(n&&t.removeChild(n);t.parentNode!==this.replacer;){var r=t.parentNode;r.parentNode.insertBefore(t,r.nextSibling)}for(;t.childNodes.length;)this.replacer.insertBefore(t.childNodes[0],t);return this.replacer.removeChild(t),this.replacer.innerHTML}},{key:"_createSignatureWrapper",value:function(){var e=document.createElement("div");return e.classList.add(this._consts.CONTAINER_CLASS,s.a),e.setAttribute(s.b,s.c),e}},{key:"_wrapSignature",value:function(e){if(this.replacer.innerHTML=e,this.replacer.querySelector(this._consts.CONTAINER_SELECTOR))return e;var t=Object(u.b)(this.replacer,this._signatureMatches);if(!t)return e;var n=this._createSignatureWrapper(),r=t.start,o=t.finish,i=t.targetMatch,a=o-r+1;i&&(this._signatureMatches=[i]);for(var c=0;c<a;c++)n.appendChild(this.replacer.childNodes[r]);return r<this.replacer.childNodes.length?this.replacer.insertBefore(n,this.replacer.childNodes[r]):this.replacer.appendChild(n),Object(u.c)(n),this.replacer.innerHTML}},{key:"_isSignatureEvent",value:function(e){for(var t=e.target;t;){if(t.classList&&(t.classList.contains(this._consts.CONTAINER_CLASS)||t.classList.contains(this._consts.MENU_ANCHOR_CLASS)))return!0;t=t.parentNode}return!1}},{key:"_createMenuAnchor",value:function(){var e=this,t=document.createElement("div");return t.setAttribute("contenteditable",!1),t.tabIndex=-1,t.classList.add(this._consts.MENU_ANCHOR_CLASS,s.d),t.classList.add(this._consts.MENU_ANCHOR_HIDDEN_CLASS),t.addEventListener("click",(function(){return e._setSignaturesPopupVisibility(!e._isSignaturesPopupShown)})),t}},{key:"_getContainer",value:function(){return this.editor.getContainer().querySelector(this._consts.CONTAINER_SELECTOR)}},{key:"_updateMenuAnchorPosition",value:function(){var e=this,t=this._getContainer();if(!t)return void this._setMenuAnchorVisibility(!1);var n=this.editor.getConfig(),r=n.isMobile;requestAnimationFrame((function(){r?(e._menuAnchor.style.setProperty("top","".concat(t.offsetTop,"px")),e._menuAnchor.style.setProperty("left","".concat(t.offsetLeft+t.offsetWidth,"px"))):(e._menuAnchor.style.setProperty("top","".concat(t.offsetTop-16,"px")),e._menuAnchor.style.setProperty("left","".concat(t.offsetLeft+t.offsetWidth+8,"px")))}))}},{key:"_setMenuAnchorVisibility",value:function(e){var t=this._getContainer();this._isHovered=e,e?(this._menuAnchor.classList.remove(this._consts.MENU_ANCHOR_HIDDEN_CLASS),t&&t.classList.add(this._consts.CONTAINER_HOVERED_CLASS)):(this._menuAnchor.classList.add(this._consts.MENU_ANCHOR_HIDDEN_CLASS),t&&t.classList.remove(this._consts.CONTAINER_HOVERED_CLASS))}},{key:"_setSignaturesPopupVisibility",value:function(e){if(this._isSignaturesPopupShown!==e){this._isSignaturesPopupShown=e;this.editor.getConfig().signatures.popup.stateChange({isOpen:e,anchor:this._menuAnchor,applySignature:this.applySignature})}}}]),e})()},1231:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){return i})),n.d(t,"d",(function(){return a})),n.d(t,"e",(function(){return c}));var r="data-cke-filter",o="off",i="qa-Compose-SignatureContainer",a="qa-Compose-SignatureMenuAnchor",c=function(e){var t=e?"ComposeReact-SignatureContainer":"ComposeReact-SignatureContainer_desktop",n=".".concat(t),r="".concat(t,"_hovered"),o=e?"ComposeReact-SignatureMenuAnchor":"ComposeReact-SignatureMenuAnchorNew";return{CONTAINER_CLASS:t,CONTAINER_SELECTOR:n,CONTAINER_HOVERED_CLASS:r,MENU_ANCHOR_CLASS:o,MENU_ANCHOR_HIDDEN_CLASS:"".concat(o,"_hidden")}}},1232:function(e,t){},1233:function(e,t){},1234:function(e,t,n){"use strict";function r(e){"@babel/helpers - typeof";return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(t,"__esModule",{value:!0});var o=n(152);window.swfobject=(function(){function e(){if(!F){for(var e=L.length,t=0;t<e;t++)L[t]();F=!0}}function t(e){F?e():L[L.length]=e}function n(){N?i():a()}function i(){var e,t=navigator.plugins["Shockwave Flash"]||window.ActiveXObject;try{e=t.description||(function(){return new t("ShockwaveFlash.ShockwaveFlash").GetVariable("$version")})()}catch(t){e="Unavailable"}e=e.split(" ")[2],e?(e=e.split(/\.|,/g),H.pv=[parseInt(e[0],10),parseInt(e[1],10),parseInt(e[2],10)]):H.pv=[0,0,0],a()}function a(){var e=x.length;if(e>0)for(var t=0;t<e;t++){var n=x[t].id,o=x[t].callbackFn,i={success:!1,id:n};if(H.pv[0]>0){var a=m(n);if(a)if(!v(x[t].swfVersion)||H.wk&&H.wk<312)if(x[t].expressInstall&&s()){var p={};p.data=x[t].expressInstall,p.width=a.getAttribute("width")||"0",p.height=a.getAttribute("height")||"0",a.getAttribute("class")&&(p.styleclass=a.getAttribute("class")),a.getAttribute("align")&&(p.align=a.getAttribute("align"));for(var f={},d=a.getElementsByTagName("param"),y=d.length,b=0;b<y;b++)"movie"!=d[b].getAttribute("name").toLowerCase()&&(f[d[b].getAttribute("name")]=d[b].getAttribute("value"));u(p,f,n,o)}else l(a),o&&o(i);else g(n,!0),o&&(i.success=!0,i.ref=c(n),o(i))}else if(g(n,!0),o){var h=c(n);h&&r(h.SetVariable)!=k&&(i.success=!0,i.ref=h),o(i)}}}function c(e){var t=null,n=m(e);if(n&&"OBJECT"==n.nodeName)if(r(n.SetVariable)!=k)t=n;else{var o=n.getElementsByTagName(R)[0];o&&(t=o)}return t}function s(){return!U&&v("6.0.65")&&(H.win||H.mac)&&!(H.wk&&H.wk<312)}function u(e,t,n,o){U=!0,P=o||null,C={success:!1,id:n};var i=m(n);if(i){"OBJECT"==i.nodeName?(S=p(i),E=null):(S=i,E=n),e.id=j,(r(e.width)==k||!/%$/.test(e.width)&&parseInt(e.width,10)<310)&&(e.width="310"),(r(e.height)==k||!/%$/.test(e.height)&&parseInt(e.height,10)<137)&&(e.height="137"),I.title=I.title.slice(0,47)+" - Flash Player Installation";var a=H.ie&&H.win?"ActiveX":"PlugIn",c="MMredirectURL="+M.location.toString().replace(/&/g,"%26")+"&MMplayerType="+a+"&MMdoctitle="+I.title;if(r(t.flashvars)!=k?t.flashvars+="&"+c:t.flashvars=c,H.ie&&H.win&&4!=i.readyState){var s=h("div");n+="SWFObjectNew",s.setAttribute("id",n),i.parentNode.insertBefore(s,i),i.style.display="none",(function(){4==i.readyState?i.parentNode.removeChild(i):setTimeout(arguments.callee,10)})()}f(e,t,n)}}function l(e){if(H.ie&&H.win&&4!=e.readyState){var t=h("div");e.parentNode.insertBefore(t,e),t.parentNode.replaceChild(p(e),t),e.style.display="none",(function(){4==e.readyState?e.parentNode.removeChild(e):setTimeout(arguments.callee,10)})()}else e.parentNode.replaceChild(p(e),e)}function p(e){var t=h("div");if(H.win&&H.ie)t.innerHTML=e.innerHTML;else{var n=e.getElementsByTagName(R)[0];if(n){var r=n.childNodes;if(r)for(var o=r.length,i=0;i<o;i++)1==r[i].nodeType&&"PARAM"==r[i].nodeName||8==r[i].nodeType||t.appendChild(r[i].cloneNode(!0))}}return t}function f(e,t,n){var o,i=m(n);if(H.wk&&H.wk<312)return o;if(i)if(r(e.id)==k&&(e.id=n),H.ie&&H.win){var a="";for(var c in e)e[c]!=Object.prototype[c]&&("data"==c.toLowerCase()?t.movie=e[c]:"styleclass"==c.toLowerCase()?a+=' class="'+e[c]+'"':"classid"!=c.toLowerCase()&&(a+=" "+c+'="'+e[c]+'"'));var s="";for(var u in t)t[u]!=Object.prototype[u]&&(s+='<param name="'+u+'" value="'+t[u]+'" />');i.outerHTML='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"'+a+">"+s+"</object>",z[z.length]=e.id,o=m(e.id)}else{var l=h(R);l.setAttribute("type",A);for(var p in e)e[p]!=Object.prototype[p]&&("styleclass"==p.toLowerCase()?l.setAttribute("class",e[p]):"classid"!=p.toLowerCase()&&l.setAttribute(p,e[p]));for(var f in t)t[f]!=Object.prototype[f]&&"movie"!=f.toLowerCase()&&d(l,f,t[f]);i.parentNode.replaceChild(l,i),o=l}return o}function d(e,t,n){var r=h("param");r.setAttribute("name",t),r.setAttribute("value",n),e.appendChild(r)}function y(e){var t=m(e);t&&"OBJECT"==t.nodeName&&(H.ie&&H.win?(t.style.display="none",(function(){4==t.readyState?b(e):setTimeout(arguments.callee,10)})()):t.parentNode.removeChild(t))}function b(e){var t=m(e);if(t){for(var n in t)"function"==typeof t[n]&&(t[n]=null);t.parentNode.removeChild(t)}}function m(e){var t=null;try{t=I.getElementById(e)}catch(e){}return t}function h(e){return I.createElement(e)}function v(e){var t=H.pv,n=e.split(".");return n[0]=parseInt(n[0],10),n[1]=parseInt(n[1],10)||0,n[2]=parseInt(n[2],10)||0,t[0]>n[0]||t[0]==n[0]&&t[1]>n[1]||t[0]==n[0]&&t[1]==n[1]&&t[2]>=n[2]}function O(e,t,n,o){if(!H.ie||!H.mac){var i=I.getElementsByTagName("head")[0];if(i){var a=n&&"string"==typeof n?n:"screen";if(o&&(w=null,T=null),!w||T!=a){var c=h("style");c.setAttribute("type","text/css"),c.setAttribute("media",a),w=i.appendChild(c),H.ie&&H.win&&r(I.styleSheets)!=k&&I.styleSheets.length>0&&(w=I.styleSheets[I.styleSheets.length-1]),T=a}H.ie&&H.win?w&&r(w.addRule)==R&&w.addRule(e,t):w&&r(I.createTextNode)!=k&&w.appendChild(I.createTextNode(e+" {"+t+"}"))}}}function g(e,t){if(K){var n=t?"visible":"hidden",r=m(e);F&&r&&r.style?r.style.visibility=n:O("#"+e,"visibility:"+n)}}function _(e){return null!=/[\\\"<>\.;]/.exec(e)&&("undefined"==typeof encodeURIComponent?"undefined":r(encodeURIComponent))!=k?encodeURIComponent(e):e}var S,E,P,C,w,T,k="undefined",R="object",A="application/x-shockwave-flash",j="SWFObjectExprInst",M=window,I=document,D=navigator,N=!1,L=[n],x=[],z=[],B=[],F=!1,U=!1,K=!0,H=(function(){var e=r(I.getElementById)!=k&&r(I.getElementsByTagName)!=k&&r(I.createElement)!=k,t=D.userAgent.toLowerCase(),n=D.platform.toLowerCase(),o=/win/.test(n?n:t),i=/mac/.test(n?n:t),a=!!/webkit/.test(t)&&parseFloat(t.replace(/^.*webkit\/(\d+(\.\d+)?).*$/,"$1")),c=!1,s=[0,0,0],u=null;if(r(D.plugins)!=k&&r(D.plugins["Shockwave Flash"])==R)!(u=D.plugins["Shockwave Flash"].description)||r(D.mimeTypes)!=k&&D.mimeTypes[A]&&!D.mimeTypes[A].enabledPlugin||(N=!0,c=!1,u=u.replace(/^.*\s+(\S+\s+\S+$)/,"$1"),s[0]=parseInt(u.replace(/^(.*)\..*$/,"$1"),10),s[1]=parseInt(u.replace(/^.*\.(.*)\s.*$/,"$1"),10),s[2]=/[a-zA-Z]/.test(u)?parseInt(u.replace(/^.*[a-zA-Z]+(.*)$/,"$1"),10):0);else if(r(M.ActiveXObject)!=k)try{var l=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");l&&(u=l.GetVariable("$version"))&&(c=!0,u=u.split(" ")[1].split(","),s=[parseInt(u[0],10),parseInt(u[1],10),parseInt(u[2],10)])}catch(e){}return{w3:e,pv:s,wk:a,ie:c,win:o,mac:i}})();o.a.then(e);!(function(){H.ie&&H.win&&window.attachEvent("onunload",(function(){for(var e=B.length,t=0;t<e;t++)B[t][0].detachEvent(B[t][1],B[t][2]);for(var n=z.length,r=0;r<n;r++)y(z[r]);for(var o in H)H[o]=null;H=null;for(var i in swfobject)swfobject[i]=null;swfobject=null}))})();return{registerObject:function(e,t,n,r){if(H.w3&&e&&t){var o={};o.id=e,o.swfVersion=t,o.expressInstall=n,o.callbackFn=r,x[x.length]=o,g(e,!1)}else r&&r({success:!1,id:e})},getObjectById:function(e){if(H.w3)return c(e)},embedSWF:function(e,n,o,i,a,c,l,p,d,y){var b={success:!1,id:n};H.w3&&!(H.wk&&H.wk<312)&&e&&n&&o&&i&&a?(g(n,!1),t((function(){o+="",i+="";var t={};if(d&&r(d)===R)for(var m in d)t[m]=d[m];t.data=e,t.width=o,t.height=i;var h={};if(p&&r(p)===R)for(var O in p)h[O]=p[O];if(l&&r(l)===R)for(var _ in l)r(h.flashvars)!=k?h.flashvars+="&"+_+"="+l[_]:h.flashvars=_+"="+l[_];if(v(a)){var S=f(t,h,n);t.id==n&&g(n,!0),b.success=!0,b.ref=S}else{if(c&&s())return t.data=c,void u(t,h,n,y);g(n,!0)}y&&y(b)}))):y&&y(b)},switchOffAutoHideShow:function(){K=!1},ua:H,getFlashPlayerVersion:function(){return{major:H.pv[0],minor:H.pv[1],release:H.pv[2]}},hasFlashPlayerVersion:v,createSWF:function(e,t,n){return H.w3?f(e,t,n):void 0},showExpressInstall:function(e,t,n,r){H.w3&&s()&&u(e,t,n,r)},removeSWF:function(e){H.w3&&y(e)},createCSS:function(e,t,n,r){H.w3&&O(e,t,n,r)},addDomLoadEvent:t,getQueryParamValue:function(e){var t=I.location.search||I.location.hash;if(t){if(/\?/.test(t)&&(t=t.split("?")[1]),null==e)return _(t);for(var n=t.split("&"),r=0;r<n.length;r++)if(n[r].substring(0,n[r].indexOf("="))==e)return _(n[r].substring(n[r].indexOf("=")+1))}return""},expressInstallCallback:function(){if(U){var e=m(j);e&&S&&(e.parentNode.replaceChild(S,e),E&&(g(E,!0),H.ie&&H.win&&(S.style.display="block")),P&&P(C)),U=!1}}}})()},1258:function(e,t){e.exports={MAX_MESSAGES_TO_FORWARD:30,MAX_MESSAGES_TO_PIN:15,MAX_MESSAGES_TO_REMOVE_OR_SPAM:20,MAX_MESSAGES_TO_SEND:Daria.IS_CORP?150:50,MAX_TOTAL_SIZE_OF_ATTACHMENTS:Daria.IS_CORP?100:24}},1260:function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e}n.d(t,"a",(function(){return u}));var a=n(351),c=n(138),s=(n.n(c),n(139)),u=(n.n(s),(function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0;r(this,e),this.newMessageId=void 0,this.params=t,this.data=n,this.mSettings=ns.Model.get("settings")}return i(e,[{key:"getParams",value:function(){return this.params}},{key:"getMessageType",value:function(){return Daria.UA.isMobile&&Daria.UA.isTouch?"html":Daria.UA.isMobile?"plain":this.mSettings.isSet("enable_richedit")||Daria.isReactiveCompose()?"html":this.mMessageBody?this.mMessageBody.getSubtype():"plain"}},{key:"getFromName",value:function(){return this.mSettings.getSetting("from_name")}},{key:"getFromEmail",value:function(){return this.mMessage&&this.mMessage.getToEmail()||this.mSettings.getSetting("default_email")}},{key:"getAvailableFromEmails",value:function(){return ns.Model.get("account-information").getFromEmails()}},{key:"_getForwardMarkIds",value:function(){return this.mMessage?this.mMessage.isThread()&&1===this.mMessage.get(".count")?[this.mMessage.get(".last_mid")]:this.mMessage.isThread()?[]:[this.mMessage.get(".mid")]:[]}},{key:"isForward",value:function(){return Boolean("forward"===this.params.oper)}},{key:"isTemplate",value:function(){return!(!this.mMessage||!this.mMessage.isTemplate())||!(!this.data||this.data.save_symbol!==s.WellKnownFolderSymbol.TEMPLATE)}},{key:"isDraft",value:function(){return!this.isTemplate()&&(!(!this.data||"no"!==this.data.ign_overwrite||!this.data.overwrite)||!!(this.mMessage&&this.mMessageBody&&this.mMessage.isDraftLike()))}},{key:"isReplyAll",value:function(){return Boolean(this.mMessageBody&&"reply-all"===this.params.oper)}},{key:"isReply",value:function(){return Boolean(this.mMessageBody&&"reply"===this.params.oper)}},{key:"isReplyAny",value:function(){return this.isReply()||this.isReplyAll()}},{key:"getForwardData",value:function(){var e=this.getMessageType(),t=this.getFromEmail(),n=this.mMessage?this.mMessage.getFolderId():null,r=this.mMessageBody?this.mMessageBody.getForwardBody(e,t):Daria.signs.appendToBody("",e,!0),o=this.mMessageBody?this.mMessageBody.getMessageId():null;return{ttype:e,from_mailbox:t,from_name:this.getFromName(),cc:"",bcc:"",subj:"Fwd: "+this.messageSubject,send:r,inreplyto:o,current_folder:n,overwrite:this.params.ids,ign_overwrite:"yes",references:"",mark_ids:this._getForwardMarkIds(),mark_as:"forwarded",message_id:this.newMessageId}}},{key:"getDraftData",value:function(){var e=this.getMessageType(),t=this.mMessage.isTemplate()?s.WellKnownFolderSymbol.TEMPLATE:s.WellKnownFolderSymbol.DRAFT,n=_.clone(this.mMessage.get(".lid")),r=this.mMessage.getDelayedTime(),o=this.isTemplate()?this.newMessageId:this.mMessage.get(".message_id");if(!r){var i=ns.Model.get("labels").getDelayedMessageLabel();i&&(n=_.pull(n,i.lid))}return{overwrite:this.params.ids,ign_overwrite:"no",save_symbol:t,to:this.mMessageBody.getAddressField("to"),cc:this.mMessageBody.getAddressField("cc"),bcc:this.mMessageBody.getAddressField("bcc"),phone:this.mMessageBody.getAddressField("phone"),lids:n,from_name:this.mMessage.getFromName(),from_mailbox:this.mMessage.getFromEmail(),subj:this.messageSubjectWithPrefix,send:this.mMessageBody.getDraftBody(e),ttype:e,inreplyto:this.mMessageBody.getInReplyTo(),references:this.mMessageBody.getReferences(),current_folder:this.mMessage.getFolderId(),send_time:r,message_id:o}}},{key:"getTemplateData",value:function(){if(this.mMessage&&this.mMessageBody)return this.draftMessageData;var e=this.defaultMessageData;return e.save_symbol=s.WellKnownFolderSymbol.TEMPLATE,e}},{key:"getReplyData",value:function(){var e=this.getMessageType(),t=this.mMessageBody.getRecipients(this.isReplyAll()),n=this.mMessageBody.getMessageId(),r=this.mMessageBody.getReferences(),o=this.mMessageBody.getInReplyTo(),i=this.mMessageBody.getInfo("delivered-to")[0],a=this.fromEmail,c=this.params.isQuickReply?"":this.sendMessageData;return{from:{receiver:i},from_mailbox:a,from_name:this.getFromName(),overwrite:this.params.ids,ign_overwrite:"yes",mark_as:"replied",mark_ids:[this.params.ids],to:t.to,cc:t.cc,bcc:"",subj:"Re: "+this.messageSubject,send:c,ttype:e,inreplyto:n,references:_.trim((r||o||"")+" "+n),message_id:this.newMessageId}}},{key:"getSendMessage",value:function(){return(this.data&&this.data.qrText||"")+this.getReplyBody()}},{key:"getReplyBody",value:function(){var e=this.getMessageType(),t=this.fromEmail;return this.mMessageBody.getReplyBody(e,t)}},{key:"getDefaultData",value:function(){var e=this.getFromEmail()||ns.Model.get("account-information").getFromDefaultEmail(),t=this.getFromName(),n=this.getMessageType(),r=this.data&&this.data.send||"";return Object(c.isEmpty)(r)||"html"!==this.getMessageType()||(r="<div>".concat(r,"</div>")),{from_mailbox:e,from_name:t,ttype:n,send:Daria.signs.appendToBody(r,n,!0),message_id:this.newMessageId}}},{key:"getComposeMessageData",value:function(){return this.isDraft()?this.draftMessageData:this.isTemplate()?this.templateMessageData:this.isReplyAny()?this.replyMessageData:this.isForward()?this.forwardMessageData:this.defaultMessageData}},{key:"isPredefinedDataEmpty",value:function(){var e=Object(a.toJS)(this.data);return!e||0===Object.keys(e).length}},{key:"getRelatedThreadId",value:function(){return this.mMessage?this.mMessage.getThreadId():""}},{key:"isNewMessage",value:function(){return!this.isDraft()&&!this.isReplyAny()&&!this.isForward()}},{key:"isNewTemplate",value:function(){var e=this.data&&this.data.overwrite||this.mMessage&&this.mMessage.isDraftLike();return this.isTemplate()&&!e}},{key:"hasMessage",get:function(){return this.params.ids&&!this.params.tids}},{key:"mMessage",get:function(){return this.hasMessage?ns.Model.getValid("message",{ids:this.params.ids}):null}},{key:"mThread",get:function(){return this.hasMessage?null:ns.Model.getValid("message",{ids:this.params.tids})}},{key:"mMessageBody",get:function(){if(!this.hasMessage)return null;var e=ns.Model.infoLite("message-body").calculateParamsForMessageBody(this.params);return ns.Model.getValid("message-body",e)}},{key:"fromName",get:function(){return this.getFromName()}},{key:"fromEmail",get:function(){return this.getFromEmail()}},{key:"fromEmails",get:function(){return this.getAvailableFromEmails()}},{key:"forwardMessageData",get:function(){return this.getForwardData()}},{key:"messageSubject",get:function(){var e=this.mMessage||this.mThread;return e?e.getSubject(!0):""}},{key:"messageSubjectWithPrefix",get:function(){var e=this.mMessage||this.mThread;return e?e.getSubject():""}},{key:"draftMessageData",get:function(){return this.getDraftData()}},{key:"templateMessageData",get:function(){return this.getTemplateData()}},{key:"replyMessageData",get:function(){return this.getReplyData()}},{key:"sendMessageData",get:function(){return this.getSendMessage()}},{key:"defaultMessageData",get:function(){return this.getDefaultData()}},{key:"messageData",get:function(){return this.getComposeMessageData()}},{key:"relatedThreadId",get:function(){return this.getRelatedThreadId()}}]),e})())},1261:function(e,t,n){"use strict";function r(e){switch(e){case a.e.STATUS_DISK_FULL:return a.e.DISK_FULL;case a.e.DISK_TECHNICAL_WORK:return a.e.DISK_TECHNICAL_WORK;case a.e.DISK_TRAFFIC_LIMIT:return a.e.DISK_TRAFFIC_LIMIT;default:return a.e.UNKNOWN}}function o(e,t){if(e===a.e.DISK_TRAFFIC_LIMIT&&t&&t.error&&t.error.limit)return{limit:t.error.limit}}function i(e,t,n){var r=n.onError,o=n.onSuccess,i=t&&t.upload_url,u=t&&t.oid;if(!i||!u)return r({info:{errorType:"upload.disk.no_url_or_oid"},additionalInfo:t&&JSON.stringify(t),status:a.c.FAILED}),void Object(c.a)(e.file,{handlerName:s,isOk:!1});e.narod={oid:u,url:i},Object(c.a)(e.file,{handlerName:s,isOk:!0}),e.file&&o()}var a=n(369),c=n(789),s="do-attach-file-store";t.a=function(e,t){var n=t.onError,u=t.onSuccess,l={file:e.name,size:e.file&&e.file.size,checkLimit:!0};return ns.forcedRequest(s,l).then((function(t){return i(e,t[0].getData(),{onError:n,onSuccess:u})}),(function(t){var i=t&&t.invalid&&t.invalid[0]||{},u=i.error&&i.error.code,l=r(u);Object(c.a)(e.file,{handlerName:s,isOk:!1,errorCode:u}),n({info:{errorType:"fail-do-attach-file-store"},status:a.c.FAILED,errorCode:l,additionalInfo:o(u,i)})}))}},1262:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n.d(t,"LOCAL",(function(){return r})),n.d(t,"DISK",(function(){return o}));var r="local",o="disk"},1263:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n.d(t,"MB_SIZE",(function(){return r})),n.d(t,"GB_SIZE",(function(){return o})),n.d(t,"HAS_DISK",(function(){return i})),n.d(t,"MAX_TOTAL_ATTACHMENTS_SIZE",(function(){return a})),n.d(t,"MAX_SIZE_FOR_SINGLE_FILE",(function(){return c})),n.d(t,"IS_CORP",(function(){return s}));var r=1048576,o=1024*r,i=!Daria.IS_CORP&&-1!==Daria.SIDS.indexOf("59"),a=Daria.IS_CORP?40*r:24*r,c=i?2*o:a,s=Daria.IS_CORP},1264:function(e,t,n){"use strict";var r=n(369),o=n(789),i=n(790);t.a=function(e,t){var n=e.file,a=e.narod,c=t.onError,s=t.onUploadProgress,u=t.onUploadComplete,l=new FormData;l.append("file",n);var p=new XMLHttpRequest;return p.open("POST",a.url,!0),Object(i.a)(p,s),p.onreadystatechange=function(){4===this.readyState&&(this.status>=200&&this.status<300?u(this):(c({info:{errorType:"upload.disk.xhr_fail",status:this.status},additionalInfo:this.responseText,status:r.c.FAILED,errorCode:this.status===r.e.STATUS_DISK_FULL?r.e.DISK_FULL:r.e.UNKNOWN}),Object(o.a)(n,{handlerName:"diskUploadXhr",isOk:!1,errorCode:this.status})))},p.send(l),p}},1265:function(e,t,n){"use strict";function r(e,t,n){var r=n.onError,c=n.onUploadProgress,s=n.onUploadComplete,u=t[0].getData(),p=u.operation;if(!p)return void r({info:{errorType:"upload.disk.no_operation"},status:l.c.FAILED,errorCode:l.e.YADISK_ERROR});var f=p.status;switch(f){case"EXECUTING":case"WAITING":c(o(p));break;case"FAILED":r(i(p));break;case"DONE":return a(e,p,{onError:r,onUploadComplete:s});default:r({info:{errorType:"unknown_disk_status",status:f},additionalInfo:JSON.stringify(u)})}}function o(e){var t=e&&e.stages&&e.stages.stage||[],n=t.filter((function(e){return e&&"kladun_upload"===e.name}))[0],r=n&&n.progress;return void 0===r||100===Number(r)?100:r}function i(e){var t=Number(e&&e.error&&e.error.code);return t===l.e.VIRUS?{info:{errorType:"upload.disk.virus"},status:l.c.VIRUS,errorCode:l.e.VIRUS}:t===l.e.DISK_FULL?{info:{errorType:"upload.disk.quota_limit"},status:l.c.FAILED,errorCode:l.e.DISK_FULL}:{info:{errorType:"upload.disk.failed"},status:l.c.FAILED,errorCode:l.e.YADISK_ERROR}}function a(e,t,n){var r=n.onError,o=n.onUploadComplete,i=t.file;if(i)return c(e,i,{onError:r,onUploadComplete:o});r({info:{errorType:"upload.disk.no_fileinfo"},status:l.c.FAILED,errorCode:l.e.YADISK_ERROR})}function c(e,t,n){var r=n.onError,o=n.onUploadComplete;return e.narodUrl=t.meta&&t.meta.short_url,e.size=t.size,e.hash=t.meta&&t.meta.public_hash,s(t).then((function(t){e.narodPreview=t,u(e,{onError:r,onUploadComplete:o})}))}function s(e){var t=e&&e.meta||{},n=t.preview,r=t.public_hash;return n&&r?ns.Model.get("disk-resources").getPreview(r).always((function(e){return e})):Promise.resolve(n)}function u(e,t){var n=t.onError,r=t.onUploadComplete;delete e.narod,e.narodUrl&&e.size?r():n({info:{errorType:"upload.disk.no_size_or_nourl",disk_url:e.narodUrl,disk_size:e.size},status:l.c.FAILED,errorCode:l.e.YADISK_ERROR})}var l=n(369);t.a=function(e,t){var n=t.onError,o=t.onUploadProgress,i=t.onUploadComplete;if(e&&e.narod)return ns.forcedRequest("do-attach-file-status",{oid:e.narod.oid}).then((function(t){return r(e,t,{onError:n,onUploadProgress:o,onUploadComplete:i})}),(function(){return n({info:{errorType:"fail-do-attach-file-status"},status:l.c.FAILED})}))}},1266:function(e,t,n){"use strict";function r(e,t){o(e),e.getProgressTimer=setInterval(t,1500)}function o(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};clearInterval(e.getProgressTimer)}t.a=r,t.b=o},1267:function(e,t,n){"use strict";var r=n(790);t.a=function(e,t){var n=e.name,o=e.file,i=t.uploadUrl,a=t.onUploadProgress,c=t.onUploadComplete,s=new FormData;s.append("Filename",n);var u=new XMLHttpRequest;return u.open("POST",i,!0),Object(r.a)(u,a),u.onreadystatechange=function(){4===this.readyState&&c(this)},s.append("attachment",o,n),a(0),u.send(s),u}},1268:function(e,t,n){"use strict";var r=n(369);t.a=function(e,t){var n=e.info,o=e.previewSupported,i=e.xhr,a=t.onError,c=t.onSuccess,s=t.onAuthFail,u=i.responseText,l={};if(u)try{l=JSON.parse(u)}catch(e){return void a({info:{errorType:"simpleUpload.json_parse",xhr_status:i.status,xhr_readystate:i.readyState,xml_length:u?u.length:0},additionalInfo:u,status:r.c.FAILED,errorCode:r.e.UNKNOWN})}var p=l.write_attachment;p||!l.error||"AUTH_NO_AUTH"!==l.error.code&&"AUTH_WRONG_GUARD"!==l.error.code||s();var f=p&&p.id,d=p&&p.downloadUrl;if(!f||!d)return void a({info:{errorType:"simpleUpload",xhr_status:i.status,xhr_readystate:i.readyState,xml_length:u?u.length:0},additionalInfo:u,status:r.c.FAILED,errorCode:r.e.UNKNOWN});n.att_id=f,n.url=d.replace("http://","//");var y=p&&p.previewUrl;o&&y&&(n.previewHref=n.url+"&no_disposition=y",n.previewSrc=y.replace("http://","//")+"&no_disposition=y"),c()}},1269:function(e,t,n){"use strict";function r(e){return Daria.utils.getDiskParams(e)}var o=n(369);t.a=function(e,t){switch(e.type){case o.d.FILE:return{att_id:e.att_id,hid:e.hid,from_template:e.from_template,template_hid:e.template_hid,template_mid:e.template_mid};case o.d.YADISK:return{disk:t===o.c.COMPLETED?r(e):""}}}},1270:function(e,t,n){"use strict";function r(e,t){return e.narodUrl=t.url,e.hash=t.hash,e.narodPreview?ns.Model.get("disk-resources").getPreview(t.hash).always((function(t){return e.narodPreview=t})):Promise.resolve()}function o(e){var t=Object(a.a)(100),n=0;return setInterval((function(){return e(t(n++))}),100)}function i(e){clearInterval(e)}var a=n(901);t.a=function(e,t){var n=t.onFail,a=t.onSuccess,c=t.onUploadProgress,s=o(c);return ns.Model.get("disk-resources").attach(e.diskSrcPath,e.name).then((function(t){return r(e,t)})).then((function(){return a()})).fail((function(){return n()})).always((function(){return i(s)}))}},1271:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return a}));var r=n(367),o=function(e){return e||"(".concat(Object(r.default)("compose-react/Без_темы"),")")},i=function(e){return e?o(e.getSubject(!0)):""},a=function(e){return e?[e.get(".subject_prefix"),o(e.getSubject(!0))].filter(Boolean).join(" "):""}},1272:function(e,t,n){"use strict";var r=n(138),o=(n.n(r),n(369));t.a=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n={stid:t.getSTID(),mid:t.params.ids,bid:e.bid,hid:e.hid,name:Object(r.unescape)(e.name),"browser-supports":e["browser-supports"],from_template:e.from_template,template_hid:e.template_hid,template_mid:e.template_mid};return e.narod?(n.narodUrl=e.unsafeUrl,n.size=e.size,n.type=o.d.YADISK,n.folder=Boolean(e.folder),n.narodPreview=e.preview):(n.size=e.length,n.type=o.d.FILE,n.class=e.class,n.message=Boolean(e.message),n.external_transformer=e.external_transformer,n.external_transformer_filetype=e.external_transformer_filetype),n}},1273:function(e,t,n){"use strict";var r=n(369);t.a=function(e){return e.type===r.d.YADISK?Boolean(e.narodPreview):Boolean(e.extension.preview)||"audio"===e.class&&"mp3"===e.extension.icon}},1275:function(e,t,n){"use strict";function r(e,t,n,r,o,i,a){try{var c=e[i](a),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,o)}function o(e){return function(){var t=this,n=arguments;return new Promise(function(o,i){function a(e){r(s,o,i,a,c,"next",e)}function c(e){r(s,o,i,a,c,"throw",e)}var s=e.apply(t,n);a(void 0)})}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function c(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),e}function s(e,t,n,r){n&&Object.defineProperty(e,t,{enumerable:n.enumerable,configurable:n.configurable,writable:n.writable,value:n.initializer?n.initializer.call(r):void 0})}function u(e,t,n,r,o){var i={};return Object.keys(r).forEach((function(e){i[e]=r[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce((function(n,r){return r(e,t,n)||n}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}n.d(t,"a",(function(){return A}));var l,p,f,d,y,b,m,h,v,O,g=n(138),_=n.n(g),S=n(351),E=n(1276),P=n(3878),C=n(785),w=n(3879),T=n(366),k=(n.n(T),n(905)),R=(n.n(k),n(399)),A=(n.n(R),l=S.observable.ref,p=O=(function(){function e(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=n.params,a=n.predefinedData,c=n.miniData,u=n.services,l=n.controllers,p=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},O=p.size,_=void 0===O?R.ComposeSizes.LARGE:O;i(this,e),s(this,"mode",f,this),s(this,"size",d,this),s(this,"currentPromo",y,this),this._loadingPromise=null,s(this,"waitToClose",b,this),s(this,"waitToCollapse",m,this),s(this,"_params",h,this),s(this,"_predefinedData",v,this),this.onSendSuccess=(function(){var e=o(regeneratorRuntime.mark((function e(n){var r,o,i,a,c,s,u;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=n.responseData,o=n.composeParamsData,i=n.miniData,a=n.withUndo,c=n.sendTime,s=n.preventLeave,t.leaveComposeController.sendMetrika(),t.miniData.update(i).catch((function(){})),t.leaveComposeController.showMessageSentNotification({fromQR:!1,sentMid:r.storedmid,wasSendCancelled:!1,withUndo:a,isDelayed:Boolean(c),sendTime:c}),u=t.composeParamsService,u.data=o.data,u.params=o.params,u.isDraft()&&t.syncRelatedModelsService.updateDraftAfterAction(!1,u.data.overwrite),t.syncRelatedModelsService.updateMessageFlagsAfterSend(u.data.mark_ids,{isForward:u.isForward(),isReply:u.isReplyAny(),replyMessageId:u.data.inreplyto}),t.sendTime=c,s||(t.pageAfterSend=t.leaveComposeController.getPageAfterSent(),t.setWaitToClose(!0),u.isForward()&&t.syncRelatedModelsService.resetCheckedMessages());case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}})(),this.onSaveSuccess=(function(){var e=o(regeneratorRuntime.mark((function e(n){var r,o,i,a,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=n.dataUpdate,o=n.miniData,i=n.composeParamsData,a=n.responseData,t.updateAfterSave(r),c=t.composeParamsService,c.data=i.data,c.params=i.params,t.miniData.update(o),t.isDraft?t.syncRelatedModelsService.updateDraftAfterAction(!0,a.storedmid):t.composeParamsService.isTemplate()&&t.syncRelatedModelsService.updateTemplateAfterAction(a.storedmid);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}})(),this.onClose=(function(){var e=o(regeneratorRuntime.mark((function e(n){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=n.leaveType,e.t0=r,e.next=e.t0===T.LeaveTypes.COLLAPSE?4:e.t0===T.LeaveTypes.CLOSE?6:e.t0===T.LeaveTypes.SENT?8:e.t0===T.LeaveTypes.DELETE?11:14;break;case 4:return t.setWaitToCollapse(!0),e.abrupt("break",14);case 6:return t.setWaitToClose(!0),e.abrupt("break",14);case 8:return t.pageAfterSend=t.leaveComposeController.getPageAfterSent(),t.setWaitToClose(!0),e.abrupt("break",14);case 11:return t.ignoreChanges=!0,t.setWaitToClose(!0),e.abrupt("break",14);case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}})(),this.changeWorkMode=function(e){var n=e.mode;t.composeAdapter.sender.changeWorkMode({mode:n}).then((function(){}),(function(e){"dispose"!==e&&Jane.ErrorLog.sendException(k.CHANGE_WORK_MODE_FAILED,e)}))},this.id=Object(g.uniqueId)("compose_state_"),this._params=r||{},this._predefinedData=a,this.size=_,this.services=u,this.controllers=l,this.composeAdapter=new E.b(this),this.composeParamsService=new C.a(r,a),this.undoSendController=new w.a(r),this.miniData=new P.a(c)}return c(e,[{key:"maximize",value:function(){this.mode="maximized",this.undoSendController.composeLoaded=!0}},{key:"minimize",value:function(){this.mode="minimized",this._loadingPromise=null,this.undoSendController.composeLoaded=!1,this.onClosePromo()}},{key:"setMaximized",value:function(){this.mode="maximized"}},{key:"waitLoad",value:(function(){function e(){return t.apply(this,arguments)}var t=o(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.maximize(),this._loadingPromise||(this._loadingPromise=o(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.composeAdapter.waitLoad();case 2:return e.next=4,t.loadCompose();case 4:case"end":return e.stop()}}),e)})))()),e.abrupt("return",this._loadingPromise);case 3:case"end":return e.stop()}}),e,this)})));return e})()},{key:"setWaitToClose",value:function(e){this.waitToClose=e}},{key:"setWaitToCollapse",value:function(e){this.waitToCollapse=e}},{key:"isEqual",value:function(e){return _.a.isEqual(e.params,this.params)}},{key:"setCurrentScenario",value:function(e){return this.composeAdapter.setCurrentScenario(e)}},{key:"disconnect",value:function(){return"maximized"===this.mode&&this.setWaitToClose(!0),this.composeAdapter.disconnect()}},{key:"loadCompose",value:(function(){function e(){return t.apply(this,arguments)}var t=o(regeneratorRuntime.mark((function e(){var t,n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={params:this._params,predefinedData:this._predefinedData},e.next=3,this.composeAdapter.sender.loadWithParams({initParams:t});case 3:return n=e.sent,r=n.miniData,e.abrupt("return",this.miniData.update(r));case 6:case"end":return e.stop()}}),e,this)})));return e})()},{key:"saveData",value:(function(){function e(){return t.apply(this,arguments)}var t=o(regeneratorRuntime.mark((function e(){var t,n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.composeAdapter.sender.saveData();case 2:return t=e.sent,n=t.saveDataResult,r=t.miniData,e.next=7,this.miniData.update(r);case 7:return e.abrupt("return",n);case 8:case"end":return e.stop()}}),e,this)})));return e})()},{key:"updateAfterSave",value:function(e){e.ids=e.overwriteIds||this._params.ids,delete e.overwriteIds,this._params=e}},{key:"changeSize",value:function(e,t){this.size=e,this.composeAdapter.sender.changeSize(this.size).then(Object(S.action)((function(){})),Object(S.action)((function(e){"dispose"!==e&&"not ready"!==e&&Jane.ErrorLog.sendException(k.CHANGE_SIZE_FAILED,e)}))),t&&(this.controllers.settings.lastUsedComposeSize=e),e===R.ComposeSizes.LARGE&&this.syncRelatedModelsService.resetCheckedMessages()}},{key:"setCurrentPromo",value:function(e,t,n){this.currentPromo=e,this.currentPromoActions=t,this.composeAdapter.sender.setCurrentPromo(e,n)}},{key:"clearPromo",value:function(){this.setCurrentPromo(null,null,null)}},{key:"onClosePromo",value:function(){this.currentPromoActions&&this.currentPromoActions.onClose(),this.currentPromo=null,this.currentPromoActions=null}},{key:"onShowPromo",value:function(){this.currentPromoActions&&this.currentPromoActions.onShow(this)}},{key:"collapseAllComposes",value:function(){this.currentPromoActions&&this.currentPromoActions.collapseAllComposes()}},{key:"showAbookPopup",value:function(e){this.abookPopupController.showAbookPopup(e)}},{key:"leaveComposeController",get:function(){return this.controllers.leaveCompose}},{key:"syncRelatedModelsService",get:function(){return this.services.syncRelatedModels}},{key:"abookPopupController",get:function(){return this.controllers.abookPopup}},{key:"minimized",get:function(){return"minimized"===this.mode}},{key:"maximized",get:function(){return"maximized"===this.mode}},{key:"params",get:function(){return{ids:this._params.ids,tids:this._params.tids,oper:this._params.oper,qrAttaches:this._params.qrAttaches||[]}}},{key:"predefinedData",get:function(){return this._predefinedData}},{key:"hasEmptyParams",get:function(){return!(this.params.ids||this.params.tids||this.params.oper)}},{key:"hasEmptyPredefinedData",get:function(){return!this._predefinedData||_.a.isEqual(this._predefinedData,{})}},{key:"isDraft",get:function(){return this.composeParamsService.isDraft()}},{key:"isTemplate",get:function(){return this.composeParamsService.isTemplate()}},{key:"isNewTemplate",get:function(){return this.composeParamsService.isNewTemplate()}},{key:"isEmpty",get:function(){return this.hasEmptyParams&&this.hasEmptyPredefinedData}}]),e})(),f=u(p.prototype,"mode",[S.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"minimized"}}),d=u(p.prototype,"size",[S.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return R.ComposeSizes.LARGE}}),y=u(p.prototype,"currentPromo",[S.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),u(p.prototype,"leaveComposeController",[S.computed],Object.getOwnPropertyDescriptor(p.prototype,"leaveComposeController"),p.prototype),u(p.prototype,"syncRelatedModelsService",[S.computed],Object.getOwnPropertyDescriptor(p.prototype,"syncRelatedModelsService"),p.prototype),u(p.prototype,"abookPopupController",[S.computed],Object.getOwnPropertyDescriptor(p.prototype,"abookPopupController"),p.prototype),u(p.prototype,"minimized",[S.computed],Object.getOwnPropertyDescriptor(p.prototype,"minimized"),p.prototype),u(p.prototype,"maximized",[S.computed],Object.getOwnPropertyDescriptor(p.prototype,"maximized"),p.prototype),u(p.prototype,"maximize",[S.action],Object.getOwnPropertyDescriptor(p.prototype,"maximize"),p.prototype),u(p.prototype,"minimize",[S.action],Object.getOwnPropertyDescriptor(p.prototype,"minimize"),p.prototype),u(p.prototype,"setMaximized",[S.action],Object.getOwnPropertyDescriptor(p.prototype,"setMaximized"),p.prototype),b=u(p.prototype,"waitToClose",[S.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),u(p.prototype,"setWaitToClose",[S.action],Object.getOwnPropertyDescriptor(p.prototype,"setWaitToClose"),p.prototype),m=u(p.prototype,"waitToCollapse",[S.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),u(p.prototype,"setWaitToCollapse",[S.action],Object.getOwnPropertyDescriptor(p.prototype,"setWaitToCollapse"),p.prototype),h=u(p.prototype,"_params",[l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u(p.prototype,"params",[S.computed],Object.getOwnPropertyDescriptor(p.prototype,"params"),p.prototype),v=u(p.prototype,"_predefinedData",[S.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u(p.prototype,"predefinedData",[S.computed],Object.getOwnPropertyDescriptor(p.prototype,"predefinedData"),p.prototype),u(p.prototype,"hasEmptyParams",[S.computed],Object.getOwnPropertyDescriptor(p.prototype,"hasEmptyParams"),p.prototype),u(p.prototype,"hasEmptyPredefinedData",[S.computed],Object.getOwnPropertyDescriptor(p.prototype,"hasEmptyPredefinedData"),p.prototype),u(p.prototype,"isEmpty",[S.computed],Object.getOwnPropertyDescriptor(p.prototype,"isEmpty"),p.prototype),u(p.prototype,"updateAfterSave",[S.action],Object.getOwnPropertyDescriptor(p.prototype,"updateAfterSave"),p.prototype),u(p.prototype,"changeSize",[S.action],Object.getOwnPropertyDescriptor(p.prototype,"changeSize"),p.prototype),u(p.prototype,"setCurrentPromo",[S.action],Object.getOwnPropertyDescriptor(p.prototype,"setCurrentPromo"),p.prototype),u(p.prototype,"clearPromo",[S.action],Object.getOwnPropertyDescriptor(p.prototype,"clearPromo"),p.prototype),u(p.prototype,"onClosePromo",[S.action],Object.getOwnPropertyDescriptor(p.prototype,"onClosePromo"),p.prototype),p)},1276:function(e,t,n){"use strict";var r=n(3498);n.d(t,"a",(function(){return r.a})),n.d(t,"b",(function(){return r.b}));var o=n(3877);n.d(t,"c",(function(){return o.a}))},1277:function(e,t,n){"use strict";var r=n(3506);n.d(t,"a",(function(){return r.a}));var o=n(3507);n.d(t,"b",(function(){return o.a}));var i=n(3508);n.d(t,"c",(function(){return i.a}));var a=n(3509);n.d(t,"d",(function(){return a.a}));var c=n(3510);n.d(t,"e",(function(){return c.a}));var s=n(3511);n.d(t,"f",(function(){return s.a}));var u=n(3512);n.d(t,"g",(function(){return u.a}));var l=n(3513);n.d(t,"h",(function(){return l.a}));var p=n(3514);n.d(t,"i",(function(){return p.a}));var f=n(3515);n.d(t,"l",(function(){return f.a}));var d=n(3516);n.d(t,"m",(function(){return d.a}));var y=n(3517);n.d(t,"n",(function(){return y.a}));var b=n(3518);n.d(t,"o",(function(){return b.a}));var m=n(3520);n.d(t,"p",(function(){return m.a}));var h=n(3521);n.d(t,"q",(function(){return h.a}));var v=n(3522);n.d(t,"r",(function(){return v.a}));var O=n(3523);n.d(t,"s",(function(){return O.a}));var g=n(3524);n.d(t,"t",(function(){return g.a}));var _=n(3525);n.d(t,"u",(function(){return _.a}));var S=n(3526);n.d(t,"v",(function(){return S.a}));var E=n(3527);n.d(t,"w",(function(){return E.a}));var P=n(3528);n.d(t,"x",(function(){return P.a}));var C=n(3529);n.d(t,"y",(function(){return C.a}));var w=n(3531);n.n(w);n.o(w,"MessageBodyController")&&n.d(t,"j",(function(){return w.MessageBodyController}));var T=n(3532),k=n.n(T);n.d(t,"k",(function(){return k.a}))},1278:function(e,t,n){"use strict";var r=n(369),o=n(500);t.a=function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.meta,i=n&&n.mediatype||"unknown";"image"===i&&(e=n&&n.preview);var a,c=t.type===o.d;return a=c?n&&n.group&&n.group.size:n&&n.size,{name:t.name,type:r.d.YADISK,size:a,narodPreview:e,folder:c,mediaType:i,diskSrcPath:t.id}}},1279:function(e,t,n){"use strict";var r=n(369),o=n(529),i=function(e){return e.map((function(e){return Object(o.a)(e.info)||0})).reduce((function(e,t){return e+t}),0)};t.a=function(e){var t=e.filter((function(e){return e.info.type===r.d.FILE})),n=e.filter((function(e){return e.info.type===r.d.YADISK})),o=e.filter((function(e){return e.info.type===r.d.FORWARDED_MAIL})).map((function(e){return e.info.mid}));return{hasAttachments:e.length>0,fileAttachmentsCount:t.length,fileAttachmentsSize:i(t),diskAttachmentsCount:n.length,diskAttachmentsSize:i(n),forwardedMailsAttachmentsCount:o.length,relatedMailIds:o}}},1280:function(e,t,n){"use strict";var r=n(369),o=n(680);t.a=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0;if(e.type===r.d.YADISK)return!1;var i;return e.att_id?i=t.filter((function(t){return t.att_id===e.att_id}))[0]:e.hid&&(i=t.filter((function(t){return t.old_hid===e.hid}))[0]),!!i&&(e.from_template=void 0,e.template_hid=void 0,e.template_mid=void 0,e.att_id=void 0,e.url=void 0,e.hid=i.hid,e.mid=n,e.id=Object(o.a)(e),t.splice(t.indexOf(i),1),!0)}},1281:function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e}n.d(t,"a",(function(){return a}));var a=(function(){function e(t,n){var o=this;r(this,e),this.isOn=!1,this.wasPageHidden=!1,this.prevTime=null,this.fpsLevels=[],this.counters={},this._onPageVisibilityChanged=function(e,t){o.wasPageHidden=o.wasPageHidden||!t.value},this.area=t,this.fpsLevels=Object.keys(n).map((function(e){return{key:e,value:n[e]}})).sort((function(e,t){return e.value-t.value})),this._resetCounters()}return i(e,[{key:"_hasPerformance",value:function(){return Boolean(window.performance&&window.performance.now)}},{key:"_resetCounters",value:function(){var e=this;this.counters={total:0},this.fpsLevels.forEach((function(t){return e.counters[t.key]=0}))}},{key:"processFrame",value:function(){var e=performance.now();if(this.prevTime&&!this.wasPageHidden){var t=e-this.prevTime,n=Math.round(1e3/t),r="";if(this.fpsLevels.some((function(e){return r=e.key,e.value>=n}))&&this.counters.hasOwnProperty(r)){var o=Math.floor(t/(1e3/30));this.counters[r]+=o}this.counters.total++}this.prevTime=e,this.wasPageHidden=!1}},{key:"start",value:function(){var e=this;this.stop(),this._resetCounters(),this.isOn=this._hasPerformance(),this.prevTime=null;!(function t(){e.isOn&&(e.processFrame(),requestAnimationFrame(t))})(),ns.events.on("pageVisible.change",this._onPageVisibilityChanged)}},{key:"stop",value:function(){this.isOn=!1,ns.events.off("pageVisible.change",this._onPageVisibilityChanged)}},{key:"logCounters",value:function(){this._hasPerformance()&&Daria.monitoring.performance.fps(this.area,this.counters)}},{key:"finish",value:function(){this.stop(),this.logCounters()}}]),e})();a.defaultConfig={slow:30,freeze:5}},1283:function(e,t,n){"use strict";var r=n(348),o=n.n(r),i=n(3549);t.a=o.a.shape({avatar:i.a,name:o.a.string.isRequired,isGroup:o.a.func.isRequired,count:o.a.number.isRequired,email:o.a.string.isRequired})},1300:function(e,t,n){"use strict";function r(){return r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},r.apply(this,arguments)}function o(e){"@babel/helpers - typeof";return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){c(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(e,t){if(null==e)return{};var n,r,o=u(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function u(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function p(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function f(e,t,n){return t&&p(e.prototype,t),n&&p(e,n),e}function d(e,t){return!t||"object"!==o(t)&&"function"!=typeof t?y(e):t}function y(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function b(e){return(b=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function m(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&h(e,t)}function h(e,t){return(h=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function v(e){var t=(function(t){function n(){var e,t;l(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return t=d(this,(e=b(n)).call.apply(e,[this].concat(o))),t.targetRef=g.a.createRef(),t.onMouseDown=function(e){var n=t.targetRef.current;if(n){var r=n.containerRef.current,o=e.clientX,i=e.clientY,a=!1;if(r){var c=r.getBoundingClientRect();a=o>=c.left&&o<=c.right&&i>=c.top&&i<=c.bottom}var s=document.querySelector(".js-context-menu");!t.props.onOutsideClick||a||!r||r.contains(e.target)||e.metaKey||e.ctrlKey||e.altKey||e.shiftKey||e.button||s&&s.contains(e.target)||t.props.onOutsideClick(e)}},t.onKeyDown=function(e){t.props.onOutsideKeyDown&&t.props.onOutsideKeyDown(e)},t}return m(n,t),f(n,[{key:"componentDidMount",value:function(){this.subscribeToEvents()}},{key:"componentWillUnmount",value:function(){this.unsubscribeFromEvents()}},{key:"render",value:function(){var t=this.props,n=(t.onOutsideClick,t.onOutsideKeyDown,s(t,["onOutsideClick","onOutsideKeyDown"]));return g.a.createElement(e,r({ref:this.targetRef,onClose:P.a.noop},n))}},{key:"subscribeToEvents",value:function(){document.addEventListener("mousedown",this.onMouseDown,!0),document.addEventListener("keydown",this.onKeyDown,!0)}},{key:"unsubscribeFromEvents",value:function(){document.removeEventListener("mousedown",this.onMouseDown,!0),document.removeEventListener("keydown",this.onKeyDown,!0)}}]),n})(g.a.PureComponent);return t.propTypes=a({},e.propTypes,{onOutsideClick:S.a.func,onOutsideKeyDown:S.a.func}),t}t.a=v;var O=n(137),g=n.n(O),_=n(348),S=n.n(_),E=n(138),P=n.n(E)},1301:function(e,t,n){"use strict";function r(e,t){var n=t.top,r=t.isSmooth,o=void 0===r||r;e&&(i?e.scrollTo({top:n,behavior:o?"smooth":"auto"}):e.scrollTop=n)}function o(e,t){if(i)e.scrollIntoView(t);else if("boolean"==typeof t||void 0===t)e.scrollIntoView(t);else{var n="end"!==t.block;e.scrollIntoView(n)}}Object.defineProperty(t,"__esModule",{value:!0}),t.scrollIntoView=t.scrollTo=void 0;var i="scrollBehavior"in document.documentElement.style;t.scrollTo=r,t.scrollIntoView=o},1302:function(e,t,n){"use strict";var r=n(3607),o=n(3705);n.d(t,"a",(function(){return o.a})),t.b=r.a},1303:function(e,t,n){"use strict";function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n.d(t,"a",(function(){return f})),n.d(t,"b",(function(){return d}));var a=n(348),c=n.n(a),s=n(372),u=n(365),l=n(380),p={cls:c.a.string},f=o({},p,{services:u.a.isRequired,visual:l.a.isRequired}),d=o({},p,{controllers:s.a.isRequired})},1304:function(e,t,n){"use strict";n.d(t,"a",(function(){return y}));var r=n(3609),o=n(3616),i=n(3622),a=n(532),c=n(622),s=n(3631),u=n(3633),l=n(433),p=n(360),f=(n.n(p),Object(s.a)(r.b,{label:"compose-react/Attachments_LocalFiles"})),d={PopupContent:o.a,cls:r.a.Popup,metrikaArgs:[p.COMPOSE_METRIKA_FOOTER_ATTACHMENTS,p.COMPOSE_METRIKA_FOOTER_ATTACHMENTS_CLICK],directions:["top"],title:"compose-react/AttachmentsPopup_Title"};t.b=Object(l.a)(Object(c.a)("compose-react/Attachments_LocalFiles",Object(u.a)(f,{shouldCheckUploadDisabled:!1})),Object(c.a)("compose-react/ControlPanel_AttachFile_Tooltip",Object(a.a)(d,Object(u.a)(f,{shouldCheckUploadDisabled:!0}))));var y=Object(a.a)(d,i.a)},1305:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(348),o=n.n(r),i=n(138),a=(n.n(i),{LOCAL:"local",DISK:"disk",MAIL:"mail"});t.b=o.a.shape({type:o.a.oneOf(Object(i.values)(a)),icon:o.a.string,loc:o.a.string})},1306:function(e,t,n){"use strict";function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n.d(t,"b",(function(){return b})),n.d(t,"a",(function(){return m}));var a,c=n(355),s=n.n(c),u=n(138),l=n.n(u),p=n(367),f=n(366),d=(n.n(f),n(3640)),y=(a={},i(a,f.TimePresets.TODAY,19),i(a,f.TimePresets.TOMORROW,12),i(a,f.TimePresets.WEEKEND,12),i(a,f.TimePresets.NEXT_WEEK,12),a),b=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Date.now,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t=o({},y,{},t);var n=s()(e()),r=l.a.values(d.a).map((function(e){return e(n,t)})).filter((function(e){return e}));return r=l.a.uniq(r,(function(e){return e.value.getTime()}))},m=function(e){e=s()(e);var t=e.format(Object(p.default)("compose-react/TimeOptions_TimeFormat"));e=e.startOf("day");var n=s()().startOf("day");return 0===n.diff(e)?{date:Object(p.default)("compose-react/Send_Delayed_Today"),time:t}:0===s()().startOf("day").add(1,"day").diff(e)?{date:Object(p.default)("compose-react/Send_Delayed_Tomorrow"),time:t}:n.year()===e.year()?{date:e.format(Object(p.default)("compose-react/TimeOptions_DateFormat_Short")),time:t}:{date:e.format(Object(p.default)("compose-react/TimeOptions_DateFormat")),time:t}}},1307:function(e,t,n){"use strict";function r(e){"@babel/helpers - typeof";return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t,n){return t&&c(e.prototype,t),n&&c(e,n),e}function u(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?p(e):t}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function p(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function f(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&d(e,t)}function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function y(e,t,n,r){C||(C="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=r;else if(i>1){for(var a=new Array(i),c=0;c<i;c++)a[c]=arguments[c+3];t.children=a}if(t&&o)for(var s in o)void 0===t[s]&&(t[s]=o[s]);else t||(t=o||{});return{$$typeof:C,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function b(e,t,n,r){n&&Object.defineProperty(e,t,{enumerable:n.enumerable,configurable:n.configurable,writable:n.writable,value:n.initializer?n.initializer.call(r):void 0})}function m(e,t,n,r,o){var i={};return Object.keys(r).forEach((function(e){i[e]=r[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce((function(n,r){return r(e,t,n)||n}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}n.d(t,"a",(function(){return q}));var h,v,O,g,_,S,E,P,C,w=n(137),T=n.n(w),k=n(350),R=n.n(k),A=n(351),j=n(353),M=n(372),I=n(376),D=n(365),N=n(800),L=n(380),x=n(503),z=n(455),B=n(352),F=n(1306),U=n(360),K=(n.n(U),n(3668)),H=(n.n(K),"ComposeSendButton"),W={Block:H,Text:"".concat(H,"-Text"),Delayed:"".concat(H,"_delayed"),MainText:"".concat(H,"-MainText"),SecondaryText:"".concat(H,"-SecondaryText")},G=["SPACE"],Y=["ENTER"],q=(h=Object(j.inject)("controllers","data","services","validation","visual"))(v=Object(j.observer)((P=E=(function(e){function t(){var e,n;a(this,t);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return n=u(this,(e=l(t)).call.apply(e,[this].concat(o))),b(p(n),"onSendTranslation",g,p(n)),b(p(n),"onSend",_,p(n)),b(p(n),"executeSend",S,p(n)),n.onClickHandler=function(){return n.props.controllers.compose.isPddRestricted?n.props.controllers.compose.showPddRestrictPopup():n.isTranslated?n.onSendTranslation():n.onSend()},n}return f(t,e),s(t,[{key:"_getDelayedSendText",value:function(){var e=Object(F.a)(this.sendTime),t=this.isTranslated?"compose-react/Send_Translated":"compose-react/Send",n=this.isMobile?"compose-react/SendTime_Mobile":"compose-react/Notifications_ReplyTime";return T.a.createElement(T.a.Fragment,null,y(B.default,{loc:t,className:W.MainText}),y(B.default,{loc:n,className:W.SecondaryText,params:e}))}},{key:"_getSendText",value:function(){var e=this.isTranslated?"compose-react/Send_Translated":"compose-react/Send";return y(B.default,{loc:e})}},{key:"render",value:function(){var e=R()(this.props.cls,W.Block,this.isMobile?"".concat(W.Block,"_mobile"):"".concat(W.Block,"_desktop"),i({},W.Delayed,Boolean(this.sendTime))),t=this.sendTime?this._getDelayedSendText():this._getSendText();return y(z.a,{innerRef:this.props.innerRef,className:e,disabled:this.isLocked,view:"action",onClick:this.onClickHandler,pressKeys:Y,prvntKeys:G,isAction:!0},void 0,y("div",{className:W.Text},void 0,t))}},{key:"isLocked",get:function(){return this.props.visual.isLocked}},{key:"sendTime",get:function(){return this.props.data.sendTime}},{key:"isTranslated",get:function(){return this.props.visual.translate.isEnabled}},{key:"metrikaService",get:function(){return this.props.services.metrika}},{key:"isMobile",get:function(){return this.props.services.settings.isMobile}}]),t})(T.a.PureComponent),E.propTypes=(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e})({},x.a,{controllers:M.a.isRequired,data:I.a.isRequired,services:D.a.isRequired,validation:N.a.isRequired,visual:L.a.isRequired}),O=P,m(O.prototype,"isLocked",[A.computed],Object.getOwnPropertyDescriptor(O.prototype,"isLocked"),O.prototype),m(O.prototype,"sendTime",[A.computed],Object.getOwnPropertyDescriptor(O.prototype,"sendTime"),O.prototype),m(O.prototype,"isTranslated",[A.computed],Object.getOwnPropertyDescriptor(O.prototype,"isTranslated"),O.prototype),m(O.prototype,"metrikaService",[A.computed],Object.getOwnPropertyDescriptor(O.prototype,"metrikaService"),O.prototype),m(O.prototype,"isMobile",[A.computed],Object.getOwnPropertyDescriptor(O.prototype,"isMobile"),O.prototype),g=m(O.prototype,"onSendTranslation",[A.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){e.props.controllers.translate.doAfterTranslate(e.props.visual,Object(A.action)((function(t){var n;e.props.controllers.messageBody.replaceText(t),e.executeSend();var r=e.sendTime?[U.COMPOSE_METRIKA_FOOTER_DELAYED_SENDING,U.COMPOSE_METRIKA_TRANSLATION_SEND_BUTTON]:[U.COMPOSE_METRIKA_TRANSLATION_SEND_BUTTON];(n=e.metrikaService).sendFooterMetrika.apply(n,r)})))}}}),_=m(O.prototype,"onSend",[A.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){var t;e.executeSend();var n=e.sendTime?[U.COMPOSE_METRIKA_FOOTER_DELAYED_SENDING,U.COMPOSE_METRIKA_FOOTER_DELAYED_SENDING_SEND]:[U.COMPOSE_METRIKA_FOOTER_SEND];(t=e.metrikaService).sendFooterMetrika.apply(t,n)}}}),S=m(O.prototype,"executeSend",[A.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){e.props.controllers.saveSend.sendMessage({messageBody:t})}}}),v=O))||v)||v},1309:function(e,t,n){"use strict";var r=n(348),o=(n.n(r),n(1789));t.a=r.PropTypes.shape({addressesFrom:r.PropTypes.instanceOf(o.b),contacts:r.PropTypes.instanceOf(o.a)})},1310:function(e,t,n){"use strict";function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n.d(t,"a",(function(){return f}));var i=n(348),a=n.n(i),c=n(376),s=n(380),u=n(365),l=n(372),p={cls:a.a.string,field:a.a.string.isRequired,innerRef:a.a.object,onFocus:a.a.func,onDragStart:a.a.func,title:a.a.string.isRequired,data:c.a.isRequired,visual:s.a.isRequired,services:u.a.isRequired},f=(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e})({},p,{controllers:l.a.isRequired,onYabblesChanged:a.a.func,onSelectSuggestContact:a.a.func});t.b=p},1311:function(e,t,n){"use strict";function r(e){"@babel/helpers - typeof";return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}function c(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?u(e):t}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function u(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function f(e,t,n,r){_||(_="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=r;else if(i>1){for(var a=new Array(i),c=0;c<i;c++)a[c]=arguments[c+3];t.children=a}if(t&&o)for(var s in o)void 0===t[s]&&(t[s]=o[s]);else t||(t=o||{});return{$$typeof:_,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function d(e,t,n,r){n&&Object.defineProperty(e,t,{enumerable:n.enumerable,configurable:n.configurable,writable:n.writable,value:n.initializer?n.initializer.call(r):void 0})}function y(e,t,n,r,o){var i={};return Object.keys(r).forEach((function(e){i[e]=r[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce((function(n,r){return r(e,t,n)||n}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}n.d(t,"a",(function(){return K}));var b,m,h,v,O,g,_,S=n(137),E=n.n(S),P=n(351),C=n(353),w=n(348),T=n.n(w),k=n(623),R=n.n(k),A=n(688),j=n(376),M=n(380),I=n(365),D=n(372),N=n(360),L=(n.n(N),n(366)),x=(n.n(L),n(395)),z=n.n(x),B=n(3791),F=(n.n(B),"ComposeSubject"),U={Block:F,Content:"".concat(F,"-Content"),TextField:"".concat(F,"-TextField"),IFrame:"".concat(F,"-IFrame"),SubmitButton:"".concat(F,"-SubmitButton")},K=(b=Object(C.inject)("data","visual","services","controllers"))(m=Object(C.observer)((g=O=(function(e){function t(){var e,n;o(this,t);for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return n=c(this,(e=s(t)).call.apply(e,[this].concat(i))),n.disposer=new z.a,n.submitRef=E.a.createRef(),n.fieldId=R()("compose-field-subject-"),d(u(n),"updateSubject",v,u(n)),n.focusTextField=function(e){e.preventDefault(),e.stopPropagation(),n.props.inputRef.current.focus()},n.onFocus=function(e){var t=n.props.onFocus;t&&t(e),n.metrikaService.sendHeaderMetrika(N.COMPOSE_METRIKA_HEADER_SUBJECT)},n.onKeyDown=function(){n.selectionLength=document.getSelection().toString().length},n.onSending=function(e){e&&n.subject.length&&n.submitRef.current&&n.submitRef.current.click()},n}return l(t,e),a(t,[{key:"componentDidMount",value:function(){var e=this;this.disposer.add(this,[Object(P.reaction)((function(){return e.props.visual.isSending}),this.onSending),Object(P.reaction)((function(){return e.subject}),(function(t){e.props.inputRef.current.value!==t&&(e.props.inputRef.current.value=t)}))])}},{key:"componentWillUnmount",value:function(){this.disposer.dispose(this)}},{key:"render",value:function(){return f("div",{className:U.Block},void 0,this._renderContent())}},{key:"_renderContent",value:function(){var e=this;return f(A.d,{getRef:this.props.innerRef,title:this.props.title,onTitleClick:this.focusTextField,contentClass:U.Content,fieldId:this.fieldId},void 0,f(A.f,{fieldId:this.fieldId,cls:U.TextField,getRef:function(t){return e.props.inputRef.current=t},value:this.subject,onChange:this.updateSubject,onFocus:this.onFocus,onClick:this.onClick,onKeyDown:this.onKeyDown,name:"subject",autoComplete:this.autocompleteOff?"off":"on"}))}},{key:"subject",get:function(){return this.props.data.subject||""}},{key:"metrikaService",get:function(){return this.props.services.metrika}},{key:"complexityLogger",get:function(){return this.props.controllers.compose.complexityLogger}},{key:"autocompleteOff",get:function(){return this.props.services.settings.hasEmptySubjectPopup}}]),t})(E.a.Component),O.propTypes={innerRef:T.a.object,inputRef:T.a.object,onClick:T.a.func,onFocus:T.a.func,title:T.a.string.isRequired,data:j.a.isRequired,visual:M.a.isRequired,services:I.a.isRequired,controllers:D.a.isRequired},O.defaultProps={innerRef:E.a.createRef(),inputRef:E.a.createRef()},h=g,y(h.prototype,"subject",[P.computed],Object.getOwnPropertyDescriptor(h.prototype,"subject"),h.prototype),y(h.prototype,"metrikaService",[P.computed],Object.getOwnPropertyDescriptor(h.prototype,"metrikaService"),h.prototype),y(h.prototype,"complexityLogger",[P.computed],Object.getOwnPropertyDescriptor(h.prototype,"complexityLogger"),h.prototype),y(h.prototype,"autocompleteOff",[P.computed],Object.getOwnPropertyDescriptor(h.prototype,"autocompleteOff"),h.prototype),v=y(h.prototype,"updateSubject",[P.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t,n){e.props.data.subject=t,e.selectionLength>0||(n===L.InputTypes.INSERT_TEXT?e.complexityLogger.increaseSubjectInsertCount():n===L.InputTypes.DELETE_CONTENT_BACKWARD&&e.complexityLogger.increaseSubjectDeleteCount())}}}),m=h))||m)||m},1312:function(e,t,n){"use strict";function r(e){"@babel/helpers - typeof";return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}function c(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?s(e):t}function s(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function f(e){return (function(t){function n(){var e,t;o(this,n);for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return t=c(this,(e=u(n)).call.apply(e,[this].concat(i))),t.handleError=function(e){if(e.target&&"IMG"===e.target.tagName&&"js-browse-disk-thumbnail"===e.target.dataset.role){e.stopPropagation(),e.preventDefault();var t=e.target.dataset.fallbackSrc;e.target.src.substr(-t.length)!==t&&(e.target.src=e.target.dataset.fallbackSrc,e.target.dataset.clearClass&&e.target.classList.remove(e.target.dataset.clearClass))}},t}return l(n,t),a(n,[{key:"componentDidMount",value:function(){window.addEventListener("error",this.handleError,!0)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("error",this.handleError,!0)}},{key:"render",value:function(){return y.a.createElement(e,this.props)}}]),n})(y.a.PureComponent)}t.a=f;var d=n(137),y=n.n(d)},1313:function(e,t){},1314:function(e,t,n){"use strict";var r=n(1315);n.d(t,"a",(function(){return r.a}))},1315:function(e,t,n){"use strict";function r(){return r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},r.apply(this,arguments)}function o(e){"@babel/helpers - typeof";return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){if(null==e)return{};var n,r,o=a(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function a(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e,t,n){return t&&s(e.prototype,t),n&&s(e,n),e}function l(e,t){return!t||"object"!==o(t)&&"function"!=typeof t?p(e):t}function p(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function d(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&y(e,t)}function y(e,t){return(y=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function b(e,t,n,r){g||(g="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=r;else if(i>1){for(var a=new Array(i),c=0;c<i;c++)a[c]=arguments[c+3];t.children=a}if(t&&o)for(var s in o)void 0===t[s]&&(t[s]=o[s]);else t||(t=o||{});return{$$typeof:g,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}n.d(t,"a",(function(){return B}));var m,h,v,O,g,_=n(137),S=n.n(_),E=n(348),P=n.n(E),C=n(350),w=n.n(C),T=n(351),k=n(353),R=n(801),A=n.n(R),j=n(1316),M=n(659),I=n(487),D=n(1317),N=n(382),L=n(1318),x=(n.n(L),function(){return Jane.Services.runModules(["disk-resources.js","disk-resources.css"]).then((function(){return Daria.React.DiskResourcesContainer}))}),z=b("div",{className:"diskResources-Placeholder"},void 0,b(I.default,{size:"m"})),B=(m=Object(k.inject)("services"))(h=Object(k.observer)((O=v=(function(e){function t(){var e,n;c(this,t);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return n=l(this,(e=f(t)).call.apply(e,[this].concat(o))),n._disposer=new N.a,n._shortcutsConnected=!1,n}return d(t,e),u(t,[{key:"_renderPlaceholder",value:function(){return z}},{key:"componentDidMount",value:function(){var e=this;this._togglePageInteraction(this.props.isVisible),this._disposer.add(this,Object(T.reaction)((function(){return e.props.isVisible}),(function(t){return e._togglePageInteraction(t)})))}},{key:"componentWillUnmount",value:function(){this.props.isVisible&&this._togglePageInteraction(!1),this._disposer.dispose(this)}},{key:"_togglePageInteraction",value:function(e){Object(D.a)(e),this.toggleSelectionOutside(!e),this.toggleShortcuts(e)}},{key:"toggleSelectionOutside",value:function(e){document.body.onselectstart=function(){return e}}},{key:"toggleShortcuts",value:function(e){if(e){$.Shortcuts.modalListPush("disk-resources")&&(this._shortcutsConnected=!0)}else this._shortcutsConnected&&($.Shortcuts.modalListPop("disk-resources"),this._shortcutsConnected=!1)}},{key:"render",value:function(){var e=this.props,t=e.isVisible,n=e.onClose,o=i(e,["isVisible","onClose"]),a=this.props.services.settings.isMobile;o.isMobile=a;var c=w()("diskResources",a?"diskResources_mobile":"diskResources_desktop");return b(A.a,{cls:c,visible:t,fullscreen:!0,onClose:n},void 0,b("div",{className:"diskResources-Content"},void 0,S.a.createElement(M.a,r({},o,{loader:x,renderPlaceholder:this._renderPlaceholder}))))}}]),t})(S.a.Component),v.displayName="DiskResources",v.propTypes={isVisible:P.a.bool,services:j.a.isRequired,scope:P.a.instanceOf(Element),onClose:P.a.func},h=O))||h)||h},1316:function(e,t,n){"use strict";var r=n(348),o=n.n(r);t.a=o.a.shape({settings:o.a.shape({isMobile:o.a.bool})})},1317:function(e,t,n){"use strict";t.a=function(e){Daria.toggleVerticalScrollBar(e),Daria.toggleHorizontalScrollBar(e)}},1318:function(e,t){},1319:function(e,t,n){"use strict";function r(e,t){return Jane.Date.format(t,e)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=r},152:function(e,t,n){"use strict";var r=n(8);t.a=new Promise(function(e){if("complete"===document.readyState)return void e();var t=Object(r.c)((function(){document.removeEventListener("DOMContentLoaded",t,!1),window.removeEventListener("load",t,!1),e()}));document.addEventListener("DOMContentLoaded",t,!1),window.addEventListener("load",t,!1)})},1776:function(e,t,n){"use strict";var r=n(785);n.d(t,"w",(function(){return r.b}));var o=n(3430);n.d(t,"a",(function(){return o.a}));var i=n(728);n.d(t,"b",(function(){return i.a}));var a=n(3435);n.d(t,"c",(function(){return a.a}));var c=n(3436);n.d(t,"d",(function(){return c.a}));var s=n(3437);n.d(t,"e",(function(){return s.a}));var u=n(3438);n.d(t,"f",(function(){return u.a}));var l=n(1781);n.d(t,"g",(function(){return l.a}));var p=n(3444);n.d(t,"h",(function(){return p.a}));var f=n(3446);n.d(t,"i",(function(){return f.a}));var d=n(3447);n.d(t,"j",(function(){return d.a}));var y=n(3448);n.d(t,"k",(function(){return y.a}));var b=n(3470);n.d(t,"l",(function(){return b.a}));var m=n(3471);n.d(t,"m",(function(){return m.a}));var h=n(3473);n.d(t,"n",(function(){return h.a}));var v=n(3474);n.d(t,"o",(function(){return v.a}));var O=n(3475);n.d(t,"p",(function(){return O.a}));var g=n(3476);n.d(t,"q",(function(){return g.a}));var _=n(3477);n.d(t,"r",(function(){return _.a}));var S=n(1784);n.d(t,"s",(function(){return S.a}));var E=n(3478);n.d(t,"t",(function(){return E.a}));var P=n(3479);n.d(t,"u",(function(){return P.a}));var C=n(1785);n.d(t,"v",(function(){return C.a}));var w=n(3480);n.d(t,"x",(function(){return w.a}));var T=n(3481);n.d(t,"y",(function(){return T.a}))},1777:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"c",(function(){return i})),n.d(t,"b",(function(){return a}));var r=n(901),o=function(e,t){var n=Object(r.a)(t),o=0;return setInterval((function(){return e(n(o++))}),100)},i=function(e){clearInterval(e)},a=function(e,t){var n=e.to-e.from,r=t.to-t.from,o=r/n;return function(e){return t.from+e*o}}},1778:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GB_SIZE=t.MB_SIZE=void 0,t.MB_SIZE=1048576,t.GB_SIZE=1024*t.MB_SIZE},1779:function(e,t,n){"use strict";function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n.d(t,"a",(function(){return u}));var a=n(1272),c=n(903),s=n(902),u=function(e,t){var n=Object(a.a)(t,e),r=Object(c.a)(n);return o({},r,{visual:Object(s.a)(r.info,{status:r.status,previewSupported:r.previewSupported})})}},1781:function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e}n.d(t,"a",(function(){return c}));var a=n(3443),c=(function(){function e(){r(this,e),this.contactsParser=Object(a.a)()}return i(e,[{key:"parseContacts",value:function(e){return this.contactsParser(e).map((function(e){return Jane.FormValidation.contact2obj(e)}))}},{key:"contactToString",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.email,n=e.name;return Jane.FormValidation.obj2contact({email:t,name:n})}}]),e})()},1782:function(e,t,n){"use strict";var r=(n(906),n(3467));n.d(t,"a",(function(){return r.a}));var o=n(3468);n.d(t,"b",(function(){return o.a}));var i=n(3469);n.d(t,"c",(function(){return i.a}))},1784:function(e,t,n){"use strict";function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}n.d(t,"a",(function(){return d}));var c=n(138),s=(n.n(c),n(87)),u=(n.n(s),n(606)),l=n(559),p=n(366),f=(n.n(p),n(375)),d=(function(){function e(){o(this,e)}return a(e,[{key:"toggleAutocomplete",value:function(){this.data.toggleSetting(p.Settings.DISABLE_AUTOCOMPLETE_REACT)}},{key:"registerChangeSettingsHandler",value:function(e,t){var n=this,r=t?"ns-model-changed.".concat(t):"ns-model-changed",o=function(t,n,r,o,i){e({eventName:t,jpath:n,fullJpath:r,data:o,previousValue:i})};return this.data.on(r,o),function(){n.data.off(r,e)}}},{key:"data",get:function(){return ns.Model.get("settings")}},{key:"areHotkeysEnabled",get:function(){return this.data.getSetting(p.Settings.ENABLE_HOTKEYS)}},{key:"storedComposeStates",get:function(){var e=decodeURIComponent(this.data.getSetting(p.Settings.STORED_COMPOSE_STATES));return e&&"undefined"!==e?JSON.parse(e):[]},set:function(e){"string"!=typeof e&&(e=JSON.stringify(e)),this.data.setSettings({storedComposeStates:encodeURIComponent(e)})}},{key:"sizeLayout",get:function(){return Number(this.data.getSetting(p.Settings.SIZE_LAYOUT))}},{key:"sizeLayoutLeft",get:function(){return Number(this.data.getSetting(p.Settings.SIZE_LAYOUT_LEFT))}},{key:"timelineEnabled",get:function(){return this.data.checkTimelineEnable()}},{key:"timelineExpanded",get:function(){return""!==this.data.getSetting(p.Settings.TIMELINE_EXPANDED)}},{key:"todoEnabled",get:function(){return Object(f.getSettingsStore)().isTodoEnabled}},{key:"isComposeAutocompleteEnabled",get:function(){return Object(u.a)()===l.a.REACT}},{key:"isNsComposePromoClosed",get:function(){return this.data.getSetting(p.Settings.NS_COMPOSE_PROMO_CLOSED)},set:function(e){this.data.setSettings(r({},p.Settings.NS_COMPOSE_PROMO_CLOSED,e))}},{key:"isRecipientsDiffPromoClosed",get:function(){return this.data.getSetting(p.Settings.RECIPIENTS_DIFF_PROMO_CLOSED)},set:function(e){this.data.setSettings(r({},p.Settings.RECIPIENTS_DIFF_PROMO_CLOSED,e))}},{key:"disableAutocompleteReact",get:function(){return this.data.getSetting(p.Settings.DISABLE_AUTOCOMPLETE_REACT)}},{key:"isBeautifulEmailPromoClosed",get:function(){return this.data.getSetting(p.Settings.BEAUTIFUL_EMAIL_PROMO_CLOSED)},set:function(e){this.data.setSettings(r({},p.Settings.BEAUTIFUL_EMAIL_PROMO_CLOSED,e))}},{key:"hasEmptySubjectPopup",get:function(){return!this.isMobile&&this.isSmartSubjectEnabled}},{key:"isSmartSubjectEnabled",get:function(){return Object(f.getSettingsStore)().isSmartSubjectEnabled},set:function(e){this.data.setSettings(r({},p.Settings.EMPTY_SUBJECT_POPUP_DISABLED,e))}},{key:"topLevelDomain",get:function(){return Daria.Config.TLD}},{key:"autocompleteDelay",get:function(){return 30}},{key:"isMobile",get:function(){return Object(s.hasFeature)(s.Features.WEB_MOBILE_COMPOSE)}},{key:"isTablet",get:function(){return this.isMobile&&Daria.UA.isTablet}},{key:"lang",get:function(){return Daria.locale||"ru"}},{key:"isTopSignature",get:function(){return this.data.getSetting(p.Settings.SIGNATURE_TOP)}},{key:"lastUsedComposeSize",get:function(){return this.data.getSetting(p.Settings.LAST_USED_COMPOSE_SIZE)},set:function(e){this.data.setSettings(r({},p.Settings.LAST_USED_COMPOSE_SIZE,e))}},{key:"numberOfAutosavePromoShow",get:function(){return Number(this.data.getSetting(p.Settings.NUMBER_OF_AUTOSAVE_PROMO_SHOW)||0)},set:function(e){this.data.setSettings(r({},p.Settings.NUMBER_OF_AUTOSAVE_PROMO_SHOW,e))}},{key:"muteAutosavePromoUntil",get:function(){return Number(this.data.getSetting(p.Settings.MUTE_AUTOSAVE_PROMO_UNTIL)||0)},set:function(e){this.data.setSettings(r({},p.Settings.MUTE_AUTOSAVE_PROMO_UNTIL,e))}},{key:"canWriteLetters",get:function(){var e=this.data.getSetting(p.Settings.CAN_WRITE_LETTERS);return void 0===e||e}}]),e})();d.instance=Object(c.memoize)((function(){return new d}))},1785:function(e,t,n){"use strict";function r(e){return a(e)||i(e)||o()}function o(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function i(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function a(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e,t,n){return t&&s(e.prototype,t),n&&s(e,n),e}n.d(t,"a",(function(){return p}));var l=n(444),p=(function(){function e(t){var n=this,o=t.contactsStore;c(this,e),this.parseResponse=function(e,t){var o=e[0],i=o.getData();if(i){var a=i.contacts||[],c=i.groups||[],s=[].concat(r(a),r(c)).map((function(e){return n.contactsStore.findContactByEmail(e.email)||l.b.of(e)}));s.forEach((function(e){return n.contactsStore.writeContact(e)})),t(s)}else t(n.fallback())},this.contactsStore=o}return u(e,[{key:"getPopularContactsSuggest",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return new Promise(function(n){ns.request(["abook-suggest"],{popular:!0,to:t,climit:5,glimit:5}).then((function(t){return e.parseResponse(t,n)})).fail((function(){return n(e.fallback())}))})}},{key:"getQuerySuggest",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return new Promise(function(o){ns.request(["abook-suggest"],{q:e,to:n,climit:5,glimit:5,useAbook:r?"on":null}).then((function(e){return t.parseResponse(e,o)})).fail((function(){return o(t.fallback())}))})}},{key:"fallback",value:function(){return[]}}]),e})()},1786:function(e,t,n){"use strict";n.d(t,"e",(function(){return r})),n.d(t,"f",(function(){return o})),n.d(t,"b",(function(){return i})),n.d(t,"d",(function(){return a})),n.d(t,"c",(function(){return c})),n.d(t,"a",(function(){return s}));var r=31,o=190,i=256,a=4,c=256+a,s=252},1787:function(e,t,n){"use strict";function r(e,t,n,r,o,i,a){try{var c=e[i](a),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,o)}function o(e){return function(){var t=this,n=arguments;return new Promise(function(o,i){function a(e){r(s,o,i,a,c,"next",e)}function c(e){r(s,o,i,a,c,"throw",e)}var s=e.apply(t,n);a(void 0)})}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function c(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),e}function s(e,t,n,r){n&&Object.defineProperty(e,t,{enumerable:n.enumerable,configurable:n.configurable,writable:n.writable,value:n.initializer?n.initializer.call(r):void 0})}function u(e,t,n,r,o){var i={};return Object.keys(r).forEach((function(e){i[e]=r[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce((function(n,r){return r(e,t,n)||n}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}n.d(t,"a",(function(){return I}));var l,p,f,d,y,b,m,h,v=n(351),O=n(1275),g=n(382),_=n(3880),S=n(425),E=n(384),P=n(681),C=n(421),w=n(3881),T=n(366),k=(n.n(T),n(399)),R=(n.n(k),n(87)),A=(n.n(R),n(442)),j=(n.n(A),n(410)),M=(n.n(j),n(139)),I=(n.n(M),l=h=(function(){function e(t){var n=this;i(this,e),s(this,"stack",p,this),s(this,"currentCompose",f,this),s(this,"isShowingDoneScreen",d,this),s(this,"suggestedBeautifulEmail",y,this),this.lastSentTime=null,this.openCompose=(function(){var e=o(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",n._runSafe((function(){return n._doOpenCompose(t)})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}})(),this.expandCompose=function(e){return n._runSafe((function(){return n._doExpandCompose(e)}))},this._doOpenCompose=(function(){var e=o(regeneratorRuntime.mark((function e(t){var r,o,i,a,c,s,u,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=t||new O.a({services:n.services,controllers:n.controllers}),n.fetchBeautifulAddress(),n.currentPromo&&(r=n.currentPromo,o=r.name,i=r.actions,a=r.data,t.setCurrentPromo(o,i,a)),e.next=5,n._doExpandCompose(t);case 5:if(e.sent){e.next=7;break}return e.abrupt("return",!1);case 7:return n.stack.add(t),n.currentPromo&&(c=n.currentPromo,s=c.name,u=c.actions,l=c.data,t.setCurrentPromo(s,u,l)),e.abrupt("return",!0);case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}})(),this.closeCompose=(function(){var e=o(regeneratorRuntime.mark((function e(t){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.collapseCompose(t);case 2:if(r=e.sent){e.next=5;break}return e.abrupt("return",!1);case 5:return n.stack.remove(t),e.abrupt("return",!0);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}})(),this._doExpandCompose=(function(){var e=o(regeneratorRuntime.mark((function e(t){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return",!0);case 2:if(n.currentCompose!==t){e.next=4;break}return e.abrupt("return",!1);case 4:return e.next=6,n.collapseCompose(n.currentCompose);case 6:if(r=e.sent){e.next=9;break}return e.abrupt("return",!1);case 9:return t.size===k.ComposeSizes.LARGE&&t.syncRelatedModelsService&&t.syncRelatedModelsService.resetCheckedMessages(),n._setCurrentCompose(t),e.next=13,t.waitLoad();case 13:return t.changeWorkMode({mode:T.WorkModes.FOREGROUND}),n._logExpand(t),n._disposeOnClose.add(t,Object(v.reaction)((function(){return t.waitToClose}),(function(e){return e&&n._handleClose(t)}))),n._disposeOnCollapse.add(t,Object(v.reaction)((function(){return t.waitToCollapse}),(function(e){return e&&n._handleCollapse(t)}))),n._expandHelper.reportExpand(t.id),e.abrupt("return",!0);case 19:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}})(),this.collapseCompose=(function(){var e=o(regeneratorRuntime.mark((function e(t){var r,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return",!0);case 2:if(t.maximized){e.next=4;break}return e.abrupt("return",!0);case 4:if(t.ignoreChanges){e.next=11;break}return e.next=7,t.saveData();case 7:if(r=e.sent,o=r.canContinue){e.next=11;break}return e.abrupt("return",!1);case 11:return t.minimize(),n.currentCompose===t&&n._setCurrentCompose(null),n._disposeOnClose.dispose(t),n._disposeOnCollapse.dispose(t),n._expandHelper.reportCollapse(t.id),t.changeWorkMode({mode:T.WorkModes.BACKGROUND}),e.abrupt("return",!0);case 18:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}})(),this.collapseAllComposes=o(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Promise.all(n.stack.composeMetaStates.map(n.collapseCompose)));case 1:case"end":return e.stop()}}),e)}))),s(this,"closeDoneScreen",b,this),s(this,"showDoneScreen",m,this),this.showPromo=function(e){var t=e.name,r=e.off,o=e.data,i=void 0===o?{}:o,a={onClose:n.onClosePromo,onShow:n.onShowPromo,collapseAllComposes:n.collapseAllComposes};n.currentPromo={name:t,off:r,actions:a,data:i},n.stack.composeMetaStates.forEach((function(e){return e.setCurrentPromo(t,a,i)}))},this.onClosePromo=function(){n.stack.composeMetaStates.forEach((function(e){return e.clearPromo()})),n.currentPromo=null},this.onShowPromo=function(e){n.currentPromo.off(),n.stack.composeMetaStates.filter((function(t){return t!==e})).forEach((function(e){return e.clearPromo()}))};var r=t.services,a=t.controllers;this.services=r,this.controllers=a,this.stack=new w.a(t),this._disposeOnClose=new g.a,this._disposeOnCollapse=new g.a,this._expandHelper=new _.a,this._running=Promise.resolve()}return c(e,[{key:"connect",value:function(){this.stack.connect()}},{key:"_runSafe",value:function(e){return this._running=this._running.then(e)}},{key:"_handleClose",value:(function(){function e(e){return t.apply(this,arguments)}var t=o(regeneratorRuntime.mark((function e(t){var n,r,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.closeCompose(t);case 2:n=e.sent,n&&("done"===t.pageAfterSend?this.showDoneScreen(t):"sent_list"===t.pageAfterSend&&(r=ns.Model.get("folders").getFidBySymbol(M.WellKnownFolderSymbol.SENT),o=ns.router.generateUrl("messages",{current_folder:r}),ns.page.go(o)));case 4:case"end":return e.stop()}}),e,this)})));return e})()},{key:"_handleCollapse",value:function(e){return e.waitToCollapse=!1,this.collapseCompose(e)}},{key:"_setCurrentCompose",value:function(e){this.currentCompose=e}},{key:"_logExpand",value:function(e){var t=e.size===k.ComposeSizes.SMALL;if(S.a.hasActiveScenario(E.b)){var n=S.a.getActiveScenario(E.b),r=n.getTimeFromStart();n.logStep(P.d,{duration:r,usedSmall:t})}else S.a.startScenario(E.b,C.d,{usedSmall:t});e.setCurrentScenario(S.a.getActiveScenario(E.b))}},{key:"setSuggestedBeautifulEmail",value:function(e){this.suggestedBeautifulEmail=e}},{key:"fetchBeautifulAddress",value:(function(){function e(){return t.apply(this,arguments)}var t=o(regeneratorRuntime.mark((function e(){var t,n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,Object(R.hasFeature)(R.Features.WEB_B2C_DOMAIN_DONE_SCREEN)&&Object(j.canShowPromo)()){e.next=3;break}return e.abrupt("return");case 3:if(t=Object(R.getFeatureParams)(R.Features.WEB_B2C_DOMAIN_DONE_SCREEN)||{},n=t.probability,r=void 0===n?-1:n,!(Math.random()>r)){e.next=6;break}return e.abrupt("return");case 6:return e.t0=this,e.next=9,A.BeautifulEmailStore.instance().getSuggestedEmail();case 9:e.t1=e.sent,e.t0.setSuggestedBeautifulEmail.call(e.t0,e.t1),e.next=15;break;case 13:e.prev=13,e.t2=e.catch(0);case 15:case"end":return e.stop()}}),e,this,[[0,13]])})));return e})()}]),e})(),p=u(l.prototype,"stack",[v.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),f=u(l.prototype,"currentCompose",[v.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),d=u(l.prototype,"isShowingDoneScreen",[v.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),y=u(l.prototype,"suggestedBeautifulEmail",[v.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),u(l.prototype,"_handleCollapse",[v.action],Object.getOwnPropertyDescriptor(l.prototype,"_handleCollapse"),l.prototype),u(l.prototype,"_setCurrentCompose",[v.action],Object.getOwnPropertyDescriptor(l.prototype,"_setCurrentCompose"),l.prototype),b=u(l.prototype,"closeDoneScreen",[v.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){e.isShowingDoneScreen=!1,e._expandHelper.reportDoneScreenClose()}}}),m=u(l.prototype,"showDoneScreen",[v.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){e.isShowingDoneScreen=!0,e.lastSentTime=t.sendTime,e._expandHelper.reportDoneScreenShow()}}}),u(l.prototype,"setSuggestedBeautifulEmail",[v.action],Object.getOwnPropertyDescriptor(l.prototype,"setSuggestedBeautifulEmail"),l.prototype),l)},1788:function(e,t,n){"use strict";var r=n(3500);n.d(t,"a",(function(){return r.a}))},1789:function(e,t,n){"use strict";var r=n(3505);n.d(t,"b",(function(){return r.a}));var o=n(1499);n.d(t,"a",(function(){return o.a}))},1790:function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return c}));var o=n(1776),i=new o.g,a={avatars:new o.b,captcha:new o.c,composeRequest:new o.f,contactsFormatter:i,date:new o.i,errors:new o.j,logContactValidation:new o.n,logSuggest:new o.o,metrika:new o.p,pageReload:new o.q,removeDraft:new o.r,settings:o.s.instance(),signatures:new o.t,syncRelatedModels:new o.w,templates:new o.x({contactsFormatter:i}),labels:new o.m},c=function e(t,n){r(this,e),this.abookPopup=a.abookPopup,this.avatars=a.avatars,this.captcha=a.captcha,this.composeRequest=a.composeRequest,this.contactsFormatter=a.contactsFormatter,this.date=a.date,this.dateFormat=a.dateFormat,this.errors=a.errors,this.loadData=a.loadData,this.logContactValidation=a.logContactValidation,this.logSuggest=a.logSuggest,this.pageReload=a.pageReload,this.removeDraft=a.removeDraft,this.settings=a.settings,this.signatures=a.signatures,this.syncRelatedModels=a.syncRelatedModels,this.templates=a.templates,this.labels=a.labels,this.htmlProcessor=new o.l,this.composeParams=new o.e(n.params,n.predefinedData),this.metrika=new o.p(n.params),this.checkEmptyDraft=new o.d(this.composeParams.defaultMessageData.send,this),this.contacts=new o.h(t.contacts,a.errors),this.smartSubject=new o.u,this.suggest=new o.v({contactsStore:t.contacts}),this.hotkeys=new o.k,this.attachments=new o.a(this.composeParams),this.translate=new o.y(this)}},1791:function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return c}));var o=n(1277),i=n(1790),a={avatars:new o.c(i.b.avatars),settings:new o.r(i.b.settings)},c=function e(t){var n=t.services,i=t.stores,c=t.environmentAdapter,s=t.visualState,u=t.data,l=t.validation;r(this,e);var p={services:n,stores:i,controllers:this,environmentAdapter:c,visualState:s,data:u,validation:l};this.avatars=a.avatars,this.settings=a.settings,this.messageBody=new o.j(p),this.contacts=new o.f(p),this.contactsSuggest=new o.u(p),this.hotkeys=new o.h(p),this.recipientsDiff=new o.m(p),this.attachments=new o.a(p),this.autoSave=new o.b(p),this.validation=new o.x(p),this.compose=new o.e(p),this.quickReply=new o.l(p),this.checkUnsavedChanges=new o.d(p),this.saveOnClose=new o.n(p),this.selfRecipient=new o.p(p),this.smartSubject=new o.t(p),this.signatures=new o.s(p),this.translate=new o.w(p),this.templates=new o.v(p),this.labels=new o.i(p),this.deleteDraft=new o.g(p),this.serialization=new o.q(p),this.saveSend=new o.o(p),this.visual=new o.y(p),this.notification=new o.k(p)}},1792:function(e,t,n){"use strict";function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return u})),n.d(t,"a",(function(){return l}));var o,i,a,c=n(369),s=(o={},r(o,c.e.UNKNOWN,{key:"compose-react/ErrorCode_Attachments_Unknown"}),r(o,c.e.FILE_LIMIT,{key:"compose-react/ErrorCode_Attachments_FileLimit"}),r(o,c.e.TOTAL_LIMIT,{key:"compose-react/ErrorCode_Attachments_TotalLimit"}),r(o,c.e.VIRUS,{key:"compose-react/ErrorCode_Attachments_Virus"}),r(o,c.e.DISK_FULL,{key:"compose-react/ErrorCode_Attachments_DiskFull"}),r(o,c.e.DISK_TECHNICAL_WORK,{key:"compose-react/ErrorCode_Attachments_DiskTrafficLimitError_Title"}),r(o,c.e.DISK_TRAFFIC_LIMIT,{key:"compose-react/ErrorCode_Attachments_DiskTrafficLimitError_Title"}),o),u=(i={},r(i,c.e.UNKNOWN,"unknown"),r(i,c.e.FILE_LIMIT,"file limit"),r(i,c.e.TOTAL_LIMIT,"total limit"),r(i,c.e.VIRUS,"virus"),r(i,c.e.DISK_FULL,"disk full"),i),l=(a={},r(a,c.e.UNKNOWN,{key:"compose-react/ErrorCode_Attachments_Unknown_Description"}),r(a,c.e.FILE_LIMIT,{key:"compose-react/ErrorCode_Attachments_FileLimit_Description",extraKeyCorp:"compose-react/ErrorCode_Attachments_FileLimit_Description_NoDisk",extraKeyProd:"compose-react/ErrorCode_Attachments_FileLimit_Description_NoDisk_Prod"}),r(a,c.e.TOTAL_LIMIT,{key:"compose-react/ErrorCode_Attachments_TotalLimit_Description",extraKeyCorp:"compose-react/ErrorCode_Attachments_TotalLimit_Description_Corp",extraKeyProd:"compose-react/ErrorCode_Attachments_TotalLimit_Description_NoDisk_Prod"}),r(a,c.e.VIRUS,{key:"compose-react/ErrorCode_Attachments_Virus_Description"}),r(a,c.e.DISK_FULL,{key:"compose-react/ErrorCode_Attachments_DiskFull_Description"}),r(a,c.e.DISK_TECHNICAL_WORK,{key:"compose-react/ErrorCode_Attachments_DiskTrafficLimitTechnicalError_Description"}),r(a,c.e.DISK_TRAFFIC_LIMIT,{key:"compose-react/ErrorCode_Attachments_DiskTrafficLimitError_Description"}),a)},1793:function(e,t,n){"use strict";function r(e){return a(e)||i(e)||o()}function o(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function i(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function a(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e,t,n){return t&&s(e.prototype,t),n&&s(e,n),e}n.d(t,"a",(function(){return p}));var l=n(606),p=(function(){function e(){c(this,e),this.smartComposeShows=0,this.smartComposeUses=0,this.smartComposeLettersTotal=0,this.subjectInsertCount=0,this.subjectDeleteCount=0,this.bodyInsertCount=0,this.bodyDeleteCount=0,this.smartSubjectMode="line|popup",this.smartSubjectsUses=0,this.smartSubjectLastUsedText="",this.smartSubjectLastUsedItems=[],this.signatureWasChanged=!1}return u(e,[{key:"addSmartComposeMeasure",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.length;t&&(this.smartComposeUses+=1,this.smartComposeLettersTotal+=t)}},{key:"getSummary",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.subject,n=void 0===t?"":t,r=n.length;return{autocomplete:Object(l.c)(),smartComposeShows:this.smartComposeShows,smartComposeUses:this.smartComposeUses,smartComposeLettersTotal:this.smartComposeLettersTotal,subjectInsertCount:this.subjectInsertCount,subjectDeleteCount:this.subjectDeleteCount,bodyInsertCount:this.bodyInsertCount,bodyDeleteCount:this.bodyDeleteCount,wasSSUsed:Boolean(this.smartSubjectsUses),smartSubjectMode:this.smartSubjectMode,subjectLength:r,sSSuccessRate:this._calculateSharedPrefix(n,this.smartSubjectLastUsedText),sSAbstractSuccessRate:this._calculateItemsSharedPrefix(n,this.smartSubjectLastUsedItems),signatureWasChanged:this.signatureWasChanged}}},{key:"_calculateItemsSharedPrefix",value:function(e,t){var n=this;return e.length?Math.max.apply(Math,r(t.map((function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{text:""},r=t.text;return n._calculateSharedPrefix(e,r)})))):0}},{key:"_calculateSharedPrefix",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=Math.min(e.length,t.length),r=0;r<n;r++)if(e[r]!==t[r])return r/e.length;return n/e.length}},{key:"increaseSubjectInsertCount",value:function(){this.subjectInsertCount+=1}},{key:"increaseSubjectDeleteCount",value:function(){this.subjectDeleteCount+=1}},{key:"increaseBodyInsertCount",value:function(){this.bodyInsertCount+=1}},{key:"increaseBodyDeleteCount",value:function(){this.bodyDeleteCount+=1}},{key:"increaseSmartComposeShows",value:function(){this.smartComposeShows+=1}},{key:"addSmartSubjectUsage",value:function(e){var t=e.text,n=void 0===t?"":t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];this.smartSubjectsUses++,this.smartSubjectLastUsedText=n,this.smartSubjectLastUsedItems=r}},{key:"setSignatureWasChanged",value:function(e){this.signatureWasChanged=e}}]),e})()},1794:function(e,t,n){"use strict";function r(e,t,n,r,o,i,a){try{var c=e[i](a),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,o)}function o(e){return function(){var t=this,n=arguments;return new Promise(function(o,i){function a(e){r(s,o,i,a,c,"next",e)}function c(e){r(s,o,i,a,c,"throw",e)}var s=e.apply(t,n);a(void 0)})}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function c(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),e}n.d(t,"a",(function(){return u}));var s=n(1795),u=(function(){function e(){i(this,e)}return c(e,[{key:"onNeedRemoveDraft",value:(function(){function e(){return t.apply(this,arguments)}var t=o(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return e})()},{key:"onSaveSuccess",value:(function(){function e(){return t.apply(this,arguments)}var t=o(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return e})()},{key:"onSaveFailed",value:(function(){function e(){return t.apply(this,arguments)}var t=o(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return e})()},{key:"onSending",value:(function(){function e(){return t.apply(this,arguments)}var t=o(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return e})()},{key:"onSendSuccess",value:(function(){function e(){return t.apply(this,arguments)}var t=o(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return e})()},{key:"onSendFailed",value:(function(){function e(){return t.apply(this,arguments)}var t=o(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return e})()},{key:"onFieldChanged",value:(function(){function e(e){return t.apply(this,arguments)}var t=o(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.fieldName;case 1:case"end":return e.stop()}}),e)})));return e})()},{key:"onShowNotification",value:(function(){function e(e){return t.apply(this,arguments)}var t=o(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return e})()},{key:"onClose",value:(function(){function e(e){return t.apply(this,arguments)}var t=o(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.leaveType;case 1:case"end":return e.stop()}}),e)})));return e})()},{key:"openTemplate",value:(function(){function e(e){return t.apply(this,arguments)}var t=o(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.params;case 1:case"end":return e.stop()}}),e)})));return e})()},{key:"openTemplatesManager",value:(function(){function e(){return t.apply(this,arguments)}var t=o(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return e})()},{key:"openSignaturesSettings",value:(function(){function e(){return t.apply(this,arguments)}var t=o(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return e})()},{key:"manageLabels",value:(function(){function e(){return t.apply(this,arguments)}var t=o(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return e})()},{key:"changeSize",value:(function(){function e(e,n){return t.apply(this,arguments)}var t=o(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return e})()},{key:"onShowPromo",value:(function(){function e(){return t.apply(this,arguments)}var t=o(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return e})()},{key:"onClosePromo",value:(function(){function e(){return t.apply(this,arguments)}var t=o(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return e})()},{key:"showAbookPopup",value:(function(){function e(){return t.apply(this,arguments)}var t=o(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return e})()},{key:"showPddRestrictPopup",value:(function(){function e(){return t.apply(this,arguments)}var t=o(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return e})()}]),e})();Object(s.a)(u)},1795:function(e,t,n){"use strict";function r(e){var t=Object.getOwnPropertyNames(e.prototype),n=t.filter((function(t){return"function"==typeof e.prototype[t]&&"constructor"!==t}));return Object.freeze(n)}t.a=r},1796:function(e,t,n){"use strict";function r(e){"@babel/helpers - typeof";return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t,n,r,o,i,a){try{var c=e[i](a),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,o)}function i(e){return function(){var t=this,n=arguments;return new Promise(function(r,i){function a(e){o(s,r,i,a,c,"next",e)}function c(e){o(s,r,i,a,c,"throw",e)}var s=e.apply(t,n);a(void 0)})}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t,n){return t&&c(e.prototype,t),n&&c(e,n),e}function u(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?l(e):t}function l(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function f(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&d(e,t)}function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}n.d(t,"a",(function(){return b}));var y=n(3538),b=(function(e){function t(e){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return a(this,t),n=u(this,p(t).call(this)),n._options={},n.composeState=e,n._options=r,n}return f(t,e),s(t,[{key:"loadWithParams",value:(function(){function e(e){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark((function e(t){var n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.initParams,e.next=3,this.composeState.setInitParams(n);case 3:return e.next=5,this.composeState.fill();case 5:return this._options.onDataLoaded&&this._options.onDataLoaded(),r=this.composeState.getMiniData(),e.abrupt("return",{miniData:r});case 8:case"end":return e.stop()}}),e,this)})));return e})()},{key:"saveData",value:(function(){function e(){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.composeState.saveData();case 2:return t=e.sent,n=this.composeState.getMiniData(),e.abrupt("return",{saveDataResult:t,miniData:n});case 5:case"end":return e.stop()}}),e,this)})));return e})()},{key:"changeWorkMode",value:(function(){function e(e){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.mode,this.composeState.changeWorkMode({mode:n});case 2:case"end":return e.stop()}}),e,this)})));return e})()},{key:"changeSize",value:(function(){function e(e){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.composeState.changeSize(t);case 1:case"end":return e.stop()}}),e,this)})));return e})()},{key:"setCurrentPromo",value:(function(){function e(e,n){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.composeState.setCurrentPromo(t,n);case 1:case"end":return e.stop()}}),e,this)})));return e})()}]),t})(y.a)},1797:function(e,t,n){"use strict";var r=(n(3540),n(1798),n(3584));n.d(t,"a",(function(){return r.a}));var o=n(3841);n.d(t,"c",(function(){return o.a}));var i=(n(618),n(917),n(921),n(1852));n.d(t,"b",(function(){return i.a}));n(1853),n(1311)},1798:function(e,t,n){"use strict";function r(e){"@babel/helpers - typeof";return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function c(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),e}function s(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?l(e):t}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function l(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function p(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function d(e,t,n,r){M||(M="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=r;else if(i>1){for(var a=new Array(i),c=0;c<i;c++)a[c]=arguments[c+3];t.children=a}if(t&&o)for(var s in o)void 0===t[s]&&(t[s]=o[s]);else t||(t=o||{});return{$$typeof:M,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function y(e,t,n,r){n&&Object.defineProperty(e,t,{enumerable:n.enumerable,configurable:n.configurable,writable:n.writable,value:n.initializer?n.initializer.call(r):void 0})}function b(e,t,n,r,o){var i={};return Object.keys(r).forEach((function(e){i[e]=r[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce((function(n,r){return r(e,t,n)||n}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}n.d(t,"a",(function(){return de}));var m,h,v,O,g,_,S,E,P,C,w,T,k,R,A,j,M,I=n(137),D=n.n(I),N=n(348),L=n.n(N),x=n(350),z=n.n(x),B=n(351),F=n(353),U=n(397),K=n.n(U),H=n(395),W=n.n(H),G=n(636),Y=(n.n(G),n(376)),q=n(372),V=n(365),$=n(380),Q=n(794),J=n.n(Q),X=n(1800),Z=n(795),ee=n(618),te=n(3554),ne=n(444),re=n(1801),oe=n(1802),ie=n(399),ae=(n.n(ie),n(3579)),ce=n(3581),se=n(466),ue=(n.n(se),n(360)),le=(n.n(ue),n(3583)),pe=(n.n(le),"ComposeAddressFrom"),fe={Block:pe,Popup:"".concat(pe,"-Popup"),Popup_small:"".concat(pe,"-Popup_small"),Field:"".concat(pe,"-Field"),Content:"".concat(pe,"-Content")},de=(m=Object(F.inject)("data","controllers","services","visual"))(h=Object(F.observer)((j=A=(function(e){function t(){var e,n;i(this,t);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return n=s(this,(e=u(t)).call.apply(e,[this].concat(o))),n.disposer=new W.a,y(l(n),"isEditing",O,l(n)),y(l(n),"isShowingPopup",g,l(n)),y(l(n),"textFieldRef",_,l(n)),n.yabbleRef=D.a.createRef(),n.labelRef=D.a.createRef(),n.fieldRef=D.a.createRef(),n.contentRef=D.a.createRef(),n.beautifulEmailPromoRef=D.a.createRef(),n.suggestBeautifulEmailPromoRef=D.a.createRef(),n.onShowPromo=function(){n.props.controllers.visual.onShowPromo()},n.onClosePromo=function(){n.props.controllers.visual.onClosePromo()},n.onGoToBeautifulAddressSettings=function(){n.props.controllers.visual.collapseAllComposes()},y(l(n),"onTopContentInFixedModeChanged",S,l(n)),n.focusTextField=function(){n.isEditing&&n.textFieldRef&&(n.textFieldRef.focus(),n.textFieldRef.setSelectionRange(0,n.address.name?n.address.name.length:0))},n.onNameChanged=function(e){n.updateAddressFrom({email:n.address.email,name:e})},n.onSelectAddress=function(e){n.updateAddressFrom({email:e,name:n.address.name}),n.closePopup()},y(l(n),"onStartEditing",E,l(n)),n.onTitleClick=function(){n.isShowingPopup?n.closePopup():n.showPopup()},n.onOutsideClick=function(e){var t=n.props.innerRef&&n.props.innerRef.current;t&&t.contains(e.target)||n.closePopup()},y(l(n),"setTextFieldRef",P,l(n)),y(l(n),"onWriteOnly",C,l(n)),y(l(n),"showPopup",w,l(n)),y(l(n),"closePopup",T,l(n)),n.onEditingKeyDown=function(e){e.keyCode===K.a.ENTER&&n.onStopEditing()},y(l(n),"onStopEditing",k,l(n)),y(l(n),"updateAddressFrom",R,l(n)),n}return p(t,e),c(t,[{key:"componentDidMount",value:function(){var e=this;this.disposer.add(this,[Object(B.reaction)((function(){return{isEditing:e.isEditing,textFieldRef:e.textFieldRef}}),this.focusTextField,{equals:B.comparer.structural}),Object(B.reaction)((function(){return e.props.visual.topContentInFixedMode}),this.onTopContentInFixedModeChanged),Object(B.reaction)((function(){return e.props.visual.contactsSuggest.field||["to","cc","bcc"].indexOf(e.props.visual.yabbleMenuPopup.field)>-1}),this.onClosePromo),Object(B.reaction)((function(){return e.isShowingPopup}),(function(t){e.props.visual.yabbleMenuPopup.field=t?"from":""}))])}},{key:"componentDidUpdate",value:function(){this.beautifulEmailPromoRef.current&&this.beautifulEmailPromoRef.current.forceUpdate(),this.suggestBeautifulEmailPromoRef.current&&this.suggestBeautifulEmailPromoRef.current.forceUpdate()}},{key:"componentWillUnmount",value:function(){this.disposer.dispose(this)}},{key:"maybeRenderAliasPromo",value:function(){return this.contentRef.current&&this.isBeautifulEmailPromoOn&&Object(G.areEmailsEqual)(this.address.email,this.props.visual.promoData)?d(ae.a,{promoRef:this.beautifulEmailPromoRef,scopeRef:this.labelRef,anchorRef:this.contentRef,canBeShowed:!0,onShow:this.onShowPromo,onClose:this.onClosePromo}):null}},{key:"maybeRenderBeautifulAddressPromo",value:function(){return this.contentRef.current&&this.isSuggestBeautifulEmailPromoOn&&!Object(G.areEmailsEqual)(this.address.email,this.props.visual.promoData)?d(ce.a,{promoRef:this.suggestBeautifulEmailPromoRef,scopeRef:this.props.visual.composeContainerRef,anchorRef:this.contentRef,onShow:this.onShowPromo,onClose:this.onClosePromo,onAction:this.onGoToBeautifulAddressSettings,suggestedEmail:this.props.visual.promoData,toBottom:this.isSmall}):null}},{key:"render",value:function(){return D.a.createElement("div",{ref:this.props.innerRef,className:fe.Block},d(J.a,{title:this.props.title,onClickCapture:this.onTitleClick,getRef:this.labelRef},void 0,D.a.createElement("div",{ref:this.fieldRef,className:fe.Field,tabIndex:"0"},d("div",{className:fe.Content,tabIndex:"-1"},void 0,D.a.createElement("span",{ref:this.contentRef},this.renderContent())))),this.renderPopup(),this.maybeRenderAliasPromo(),this.maybeRenderBeautifulAddressPromo())}},{key:"renderContent",value:function(){return this.isEditing?d(X.a,{getRef:this.setTextFieldRef,value:this.address.name,onChange:this.onNameChanged,onKeyDown:this.onEditingKeyDown,onBlur:this.onStopEditing}):this.renderYabble()}},{key:"renderYabble",value:function(){var e=this;return d("span",{className:"js-yabble yabble-compose"},void 0,d(Z.a,{nodeRef:this.yabbleRef,AvatarComponent:ee.a,ContentComponent:te.a,isEditable:!1,getContact:function(){return ne.b.of(e.address)}}))}},{key:"renderPopup",value:function(){if(!this.isShowingPopup)return null;var e=this.props.services.settings.isMobile,t=e?this.props.innerRef:this.yabbleRef;return d(oe.a,{anchor:t,cls:z()(fe.Popup,o({},fe.Popup_small,this.isSmall)),scope:this.props.visual.refs.topContent,onOutsideClick:this.onOutsideClick,onClose:this.closePopup,bounds:this.fieldRef},void 0,d(re.a,{contact:this.address,onSelectAddress:this.onSelectAddress,availableAddresses:this.availableAddresses,onCopy:this.closePopup,onEdit:this.onStartEditing,onWriteOnly:this.onWriteOnly}))}},{key:"address",get:function(){return this.props.data.addresses.from}},{key:"availableAddresses",get:function(){return this.props.controllers.selfRecipient.availableAddresses}},{key:"metrikaService",get:function(){return this.props.services.metrika}},{key:"composeContainerRef",get:function(){return this.props.visual&&this.props.visual.refs.composeContainer}},{key:"isSmall",get:function(){return this.props.visual.size===ie.ComposeSizes.SMALL}},{key:"isBeautifulEmailPromoOn",get:function(){return this.props.visual.currentPromo===se.PROMO_COMPOSE_BEAUTIFUL_EMAIL}},{key:"isSuggestBeautifulEmailPromoOn",get:function(){return this.props.visual.currentPromo===se.PROMO_COMPOSE_SUGGEST_BEAUTIFUL_EMAIL}}]),t})(D.a.Component),A.propTypes={innerRef:L.a.object,onShow:L.a.func,title:L.a.string.isRequired,data:Y.a.isRequired,controllers:q.a.isRequired,services:V.a.isRequired,visual:$.a.isRequired},A.defaultProps={innerRef:D.a.createRef()},v=j,O=b(v.prototype,"isEditing",[B.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),g=b(v.prototype,"isShowingPopup",[B.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),_=b(v.prototype,"textFieldRef",[B.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),b(v.prototype,"address",[B.computed],Object.getOwnPropertyDescriptor(v.prototype,"address"),v.prototype),b(v.prototype,"availableAddresses",[B.computed],Object.getOwnPropertyDescriptor(v.prototype,"availableAddresses"),v.prototype),b(v.prototype,"metrikaService",[B.computed],Object.getOwnPropertyDescriptor(v.prototype,"metrikaService"),v.prototype),b(v.prototype,"composeContainerRef",[B.computed],Object.getOwnPropertyDescriptor(v.prototype,"composeContainerRef"),v.prototype),b(v.prototype,"isSmall",[B.computed],Object.getOwnPropertyDescriptor(v.prototype,"isSmall"),v.prototype),b(v.prototype,"isBeautifulEmailPromoOn",[B.computed],Object.getOwnPropertyDescriptor(v.prototype,"isBeautifulEmailPromoOn"),v.prototype),b(v.prototype,"isSuggestBeautifulEmailPromoOn",[B.computed],Object.getOwnPropertyDescriptor(v.prototype,"isSuggestBeautifulEmailPromoOn"),v.prototype),S=b(v.prototype,"onTopContentInFixedModeChanged",[B.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){t&&(e.isShowingPopup=!1)}}}),E=b(v.prototype,"onStartEditing",[B.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){e.isEditing=!0,e.closePopup()}}}),P=b(v.prototype,"setTextFieldRef",[B.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){e.textFieldRef=t}}}),C=b(v.prototype,"onWriteOnly",[B.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){e.props.controllers.contacts.setSingleRecipient(e.address),e.closePopup()}}}),w=b(v.prototype,"showPopup",[B.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){var t=e.props.onShow;e.isShowingPopup=!0,t&&t(),e.metrikaService.sendHeaderMetrika(ue.COMPOSE_METRIKA_HEADER_FROM_SHOW)}}}),T=b(v.prototype,"closePopup",[B.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){e.isShowingPopup=!1,e.composeContainerRef.contains(document.activeElement)||e.composeContainerRef.focus()}}}),k=b(v.prototype,"onStopEditing",[B.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){e.isEditing=!1}}}),R=b(v.prototype,"updateAddressFrom",[B.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){e.props.controllers.selfRecipient.setFrom(t),e.metrikaService.sendHeaderMetrika(ue.COMPOSE_METRIKA_HEADER_FROM_CLICK)}}}),h=v))||h)||h},1799:function(e,t,n){"use strict";function r(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function o(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function i(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}n.d(t,"a",(function(){return f}));var a=n(348),c=n.n(a),s=n(138),u=n.n(s),l=n(530),p=n(366),f=(n.n(p),c.a.shape({text:c.a.string.isRequired}));t.b=c.a.shape({requestId:c.a.string,suggestItems:l.a.arrayOf(f),suggestType:c.a.oneOf([""].concat(function(e){return i(e)||o(e)||r()}(u.a.values(p.SmartSubjectType))))})},1800:function(e,t,n){"use strict";function r(e){"@babel/helpers - typeof";return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}function c(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?s(e):t}function s(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}n.d(t,"a",(function(){return S}));var f=n(137),d=n.n(f),y=n(348),b=n.n(y),m=n(350),h=n.n(m),v=n(366),O=(n.n(v),n(397)),g=n.n(O),_=n(3552),S=(n.n(_),(function(e){function t(){var e,n;o(this,t);for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return n=c(this,(e=u(t)).call.apply(e,[this].concat(i))),n.inputRef=null,n.onChange=function(e){var t=e.target.value,r=n.guessInputType(t);n.clearInputTypeHints(),n.props.onChange(t,r)},n.onFocus=function(e){var t=e.target;setTimeout((function(){return t.selectionStart=t.selectionEnd}));var r=n.props.onFocus;r&&r()},n.onBlur=function(e){n.props.onBlur&&n.props.onBlur(e)},n.onCut=function(){n.isCut=!0},n.onPaste=function(){n.isPaste=!0},n.onKeyDown=function(e){n.lastKey=e.keyCode;var t=n.props.onKeyDown;t&&t(e)},n.setInputRef=function(e){n.inputRef=e,n.inputRef&&(n.inputRef.value=n.props.value),n.props.getRef&&n.props.getRef(e)},n}return l(t,e),a(t,[{key:"guessInputType",value:function(e){return this.isPaste?v.InputTypes.INSERT_FROM_PASTE:this.isCut?v.InputTypes.DELETE_BY_CUT:Math.abs(e.length-this.props.value.length)>1?v.InputTypes.INSERT_MULTIPLE:this.lastKey===g.a.BACKSPACE?v.InputTypes.DELETE_CONTENT_BACKWARD:v.InputTypes.INSERT_TEXT}},{key:"clearInputTypeHints",value:function(){this.isPaste=!1,this.isCut=!1,this.lastKey=null}},{key:"render",value:function(){var e=this.props,t=e.cls,n=e.name,r=e.fieldId,o=h()("composeTextField",t);return d.a.createElement("input",{id:r,name:n,className:o,ref:this.setInputRef,onChange:this.onChange,onClick:this.props.onClick,onFocus:this.onFocus,onBlur:this.onBlur,onKeyDown:this.onKeyDown,onCut:this.onCut,onPaste:this.onPaste,autoComplete:this.props.autoComplete})}}]),t})(d.a.PureComponent));S.propTypes={cls:b.a.string,fieldId:b.a.string,value:b.a.string.isRequired,getRef:b.a.func,name:b.a.string,onChange:b.a.func.isRequired,onClick:b.a.func,onFocus:b.a.func,onBlur:b.a.func,onKeyDown:b.a.func,autoComplete:b.a.string}},1801:function(e,t,n){"use strict";var r=n(3555);n.d(t,"a",(function(){return r.a}))},1802:function(e,t,n){"use strict";var r=n(433),o=n(3572),i=n.n(o),a=n(3576);t.a=Object(r.a)(i.a,a.a)},1803:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},r.apply(this,arguments)},o=this&&this.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var o=0,r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]]);return n},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Popup=void 0;var a=i(n(137)),c=i(n(350)),s=n(3573),u=n(147),l=n(381),p=n(440),f=n(87),d=i(n(3574)),y=function(e){var t=e.position,n=o(e,["position"]),i=s.useVirtualElementRef({rect:t});return t&&(n.anchor=i),a.default.createElement(u.Popup,r({role:"dialog",view:"default",target:"anchor",enableFocusTrap:!0},n,{className:c.default(d.default.root,n.className,f.hasFeature(f.Features.WEB_DARK_COMPOSE)?"":l.cnTheme(p.PS_LIGHT))}))};t.Popup=y},1804:function(e,t,n){"use strict";var r=this&&this.__extends||(function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}})(),o=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&o(t,e,n);return i(t,e),t},c=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Progress=void 0;var s=a(n(137)),u=c(n(350)),l=c(n(3593)),p=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.render=function(){return s.default.createElement("div",{className:u.default(l.default.progress,this.props.className)},s.default.createElement("div",{className:l.default.progress_inner,style:{width:(this.props.progress||0)+"%"}}))},t})(s.PureComponent);t.Progress=p},1806:function(e,t,n){"use strict";function r(){return r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},r.apply(this,arguments)}function o(e){return a.createElement("svg",r({width:16,height:16,fill:"none",xmlns:"http://www.w3.org/2000/svg"},e),c)}Object.defineProperty(t,"__esModule",{value:!0});var i,a=n(137),c=(n.n(a),(function(e,t,n,r){i||(i="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,a=arguments.length-3;if(t||0===a||(t={children:void 0}),1===a)t.children=r;else if(a>1){for(var c=new Array(a),s=0;s<a;s++)c[s]=arguments[s+3];t.children=c}if(t&&o)for(var u in o)void 0===t[u]&&(t[u]=o[u]);else t||(t=o||{});return{$$typeof:i,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}})("path",{d:"M13.4 3.9l-1.31-1.31a2.11 2.11 0 00-2.93 0l-1.3 1.3c-.76.77-.8 1.97-.13 2.78L8.8 5.59a.57.57 0 01.12-.63l1.3-1.31a.56.56 0 01.8 0l1.32 1.31c.22.22.22.58 0 .8l-1.31 1.31a.58.58 0 01-.63.11L9.32 8.26a2.04 2.04 0 002.77-.12l1.3-1.32c.81-.8.81-2.12 0-2.92zm-3.23 2.98a.75.75 0 00-1.06-1.06l-.07.07-1.06 1.06-1.02 1.02L5.9 9.03l-.07.07a.75.75 0 001.06 1.06l.07-.07 1.06-1.06 1.02-1.02 1.06-1.06.07-.07zm-3.09 4.14c.18-.17.21-.42.12-.63L8.27 9.3c.67.81.63 2.01-.13 2.77l-1.3 1.31a2.05 2.05 0 01-2.93 0l-1.3-1.3a2.07 2.07 0 010-2.93l1.3-1.32a2.11 2.11 0 012.77-.12L5.61 8.79a.56.56 0 00-.64.12l-1.3 1.3a.57.57 0 000 .81l1.3 1.31c.22.21.6.21.8 0l1.31-1.3z",fill:"currentColor"}));t.default=o},1807:function(e,t,n){"use strict";function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var o,i=n(501),a=n(915),c=n(1304),s=n(1810),u=n(3651),l=n(1818);t.a=(o={},r(o,i.a.ATTACHMENTS,{buttonCls:a.a.AttachFileButton,Button:c.b,MenuItem:c.a}),r(o,i.a.DELAYED_SENDING,{buttonCls:a.a.DelayedSendingButton,Button:s.b,MenuItem:s.a}),r(o,i.a.LABELS,{buttonCls:a.a.LabelButton,Button:u.b,MenuItem:u.a}),r(o,i.a.NOTIFICATIONS,{buttonCls:a.a.NotificationsButton,Button:l.b,MenuItem:l.a}),o)},1808:function(e,t,n){"use strict";function r(e){"@babel/helpers - typeof";return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function c(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),e}function s(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?l(e):t}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function l(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function p(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function d(e,t,n,r){P||(P="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=r;else if(i>1){for(var a=new Array(i),c=0;c<i;c++)a[c]=arguments[c+3];t.children=a}if(t&&o)for(var s in o)void 0===t[s]&&(t[s]=o[s]);else t||(t=o||{});return{$$typeof:P,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function y(e,t,n,r){n&&Object.defineProperty(e,t,{enumerable:n.enumerable,configurable:n.configurable,writable:n.writable,value:n.initializer?n.initializer.call(r):void 0})}function b(e,t,n,r,o){var i={};return Object.keys(r).forEach((function(e){i[e]=r[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce((function(n,r){return r(e,t,n)||n}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}n.d(t,"a",(function(){return Y}));var m,h,v,O,g,_,S,E,P,C=n(137),w=n.n(C),T=n(350),k=n.n(T),R=n(348),A=n.n(R),j=n(353),M=n(351),I=n(352),D=n(368),N=n(1305),L=n(372),x=n(376),z=n(365),B=n(380),F=n(531),U=n(366),K=(n.n(U),n(360)),H=(n.n(K),n(3618)),W=(n.n(H),"ComposeAttachmentSourcesMenu"),G={Block:W,Item:"".concat(W,"-Item"),Icon:"".concat(W,"-Icon"),Text:"".concat(W,"-Text"),FileInput:"".concat(W,"-FileInput")},Y=(m=Object(j.inject)("controllers","data","services","visual"))(h=Object(j.observer)((E=S=(function(e){function t(){var e,n,r;i(this,t);for(var a=arguments.length,c=new Array(a),p=0;p<a;p++)c[p]=arguments[p];return r=s(this,(e=u(t)).call.apply(e,[this].concat(c))),y(l(r),"onChangeFile",O,l(r)),y(l(r),"onAttachMail",g,l(r)),y(l(r),"onAttachDisk",_,l(r)),r.onAttachLocal=function(){r.props.onSelectSource&&r.props.onSelectSource(N.a.LOCAL),r.metrikaService.sendFooterMetrika(K.COMPOSE_METRIKA_FOOTER_ATTACH_LOCAL)},r.sourceHandlers=(n={},o(n,N.a.LOCAL,r.onAttachLocal),o(n,N.a.DISK,r.onAttachDisk),o(n,N.a.MAIL,r.onAttachMail),n),r}return p(t,e),c(t,[{key:"render",value:function(){var e=this,t=this.props.sources,n=t.find((function(e){return e.type===N.a.LOCAL})),r=t.filter((function(e){return e!==n}));return d("div",{className:k()(this.props.cls,G.Block)},void 0,this.renderAttachLocal(n),r.map((function(t){return e.renderItem(t)})))}},{key:"renderAttachLocal",value:function(e){var t=e.type,n=e.icon,r=e.loc;return d("label",{className:G.Item,onClick:this.sourceHandlers[t]},t,d("div",{className:G.Icon},void 0,d(D.default,{id:n})),d("div",{className:G.Text},void 0,d(I.default,{loc:r})),d("input",{className:G.FileInput,type:"file",multiple:!0,onChange:this.onChangeFile}))}},{key:"renderItem",value:function(e){var t=e.type,n=e.icon,r=e.loc;return d("div",{className:G.Item,onClick:this.sourceHandlers[t]},t,d("div",{className:G.Icon},void 0,d(D.default,{id:n})),d("div",{className:G.Text},void 0,d(I.default,{loc:r})))}},{key:"attachmentsController",get:function(){return this.props.controllers.attachments}},{key:"metrikaService",get:function(){return this.props.services.metrika}}]),t})(w.a.PureComponent),S.propTypes={cls:A.a.string,controllers:L.a.isRequired,data:x.a.isRequired,onSelectSource:A.a.func,services:z.a.isRequired,sources:A.a.arrayOf(N.b),visual:B.a.isRequired},v=E,b(v.prototype,"attachmentsController",[M.computed],Object.getOwnPropertyDescriptor(v.prototype,"attachmentsController"),v.prototype),b(v.prototype,"metrikaService",[M.computed],Object.getOwnPropertyDescriptor(v.prototype,"metrikaService"),v.prototype),O=b(v.prototype,"onChangeFile",[M.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){t.stopPropagation(),t.preventDefault();var n=Array.from(t.target.files);e.props.controllers.attachments.attachFilesFromLocal(n),t.target.value=null}}}),g=b(v.prototype,"onAttachMail",[M.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){e.props.onSelectSource&&e.props.onSelectSource(N.a.MAIL),e.props.visual.diskResourcesPath=F.b,e.props.visual.currentPopup=U.Popups.DISK_RESOURCES,e.metrikaService.sendFooterMetrika(K.COMPOSE_METRIKA_FOOTER_ATTACH_MAIL)}}}),_=b(v.prototype,"onAttachDisk",[M.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){e.props.onSelectSource&&e.props.onSelectSource(N.a.DISK),e.props.visual.diskResourcesPath=F.a,e.props.visual.currentPopup=U.Popups.DISK_RESOURCES,e.metrikaService.sendFooterMetrika(K.COMPOSE_METRIKA_FOOTER_ATTACH_DISK)}}}),h=v))||h)||h},1809:function(e,t,n){"use strict";var r=n(348),o=n.n(r);t.a={onChange:o.a.func,onAction:o.a.func}},1810:function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var r=n(622),o=n(532),i=n(1811),a=n(3635),c=n(3650),s=n(360),u=(n.n(s),{PopupContent:a.a,cls:i.a.Popup,metrikaArgs:[s.COMPOSE_METRIKA_FOOTER_DELAYED_SENDING,s.COMPOSE_METRIKA_FOOTER_DELAYED_SENDING_CLICK],directions:["top"],title:"compose-react/DelayedSending_Title"}),l=Object(o.a)(u,i.b);t.b=Object(r.a)("compose-react/ControlPanel_DelayedSending_Tooltip",l);var p=Object(o.a)(u,c.a)},1811:function(e,t,n){"use strict";function r(e){"@babel/helpers - typeof";return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t,n){return t&&c(e.prototype,t),n&&c(e,n),e}function u(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?l(e):t}function l(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function f(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&d(e,t)}function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function y(e,t,n,r){g||(g="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=r;else if(i>1){for(var a=new Array(i),c=0;c<i;c++)a[c]=arguments[c+3];t.children=a}if(t&&o)for(var s in o)void 0===t[s]&&(t[s]=o[s]);else t||(t=o||{});return{$$typeof:g,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}n.d(t,"a",(function(){return N})),n.d(t,"b",(function(){return L}));var b,m,h,v,O,g,_=n(137),S=n.n(_),E=n(350),P=n.n(E),C=n(351),w=n(353),T=n(376),k=n(503),R=n(563),A=n(501),j=n(367),M=n(455),I=n(427),D=n(3634),N=(n.n(D),{Block:"ComposeDelayedSendingButton",Popup:"".concat("ComposeDelayedSendingButton","-Popup")}),L=(b=Object(w.inject)("data","services","visual"))(m=Object(w.observer)((O=v=(function(e){function t(){return a(this,t),u(this,p(t).apply(this,arguments))}return f(t,e),s(t,[{key:"render",value:function(){var e=this.props.isMobile?"mail--Compose-DelayedSending":"mail--Compose-DelayedSending_new";return y(M.a,{innerRef:this.props.innerRef,onMouseEnter:this.props.onMouseEnter,onMouseLeave:this.props.onMouseLeave,onClick:this.props.onClick,className:P()(N.Block,this.props.cls),hasNotification:this.hasNotification,iconComponent:y(I.a,{id:e}),"aria-label":Object(j.default)("compose-react/ControlPanel_DelayedSending_Tooltip")})}},{key:"hasNotification",get:function(){return R.a[A.a.DELAYED_SENDING]({data:this.props.data})}}]),t})(S.a.Component),v.propTypes=(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e})({},k.a,{data:T.a.isRequired}),h=O,(function(e,t,n,r,o){var i={};return Object.keys(r).forEach((function(e){i[e]=r[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce((function(n,r){return r(e,t,n)||n}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i})(h.prototype,"hasNotification",[C.computed],Object.getOwnPropertyDescriptor(h.prototype,"hasNotification"),h.prototype),m=h))||m)||m},1812:function(e,t,n){"use strict";var r=n(3637);n.d(t,"a",(function(){return r.a}))},1814:function(e,t,n){"use strict";var r=n(348),o=n.n(r);t.a={anchor:o.a.object,visible:o.a.bool,onSelectDate:o.a.func.isRequired,onCancelSelectDate:o.a.func,getInitialDate:o.a.func.isRequired,getMaxDate:o.a.func.isRequired,getMinDate:o.a.func.isRequired}},1815:function(e,t,n){"use strict";function r(e){"@babel/helpers - typeof";return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}function c(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?s(e):t}function s(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function f(e,t,n,r){O||(O="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=r;else if(i>1){for(var a=new Array(i),c=0;c<i;c++)a[c]=arguments[c+3];t.children=a}if(t&&o)for(var s in o)void 0===t[s]&&(t[s]=o[s]);else t||(t=o||{});return{$$typeof:O,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function d(e,t,n,r,o){var i={};return Object.keys(r).forEach((function(e){i[e]=r[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce((function(n,r){return r(e,t,n)||n}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}n.d(t,"a",(function(){return B}));var y,b,m,h,v,O,g=n(137),_=n.n(g),S=n(348),E=n.n(S),P=n(350),C=n.n(P),w=n(353),T=n(351),k=n(372),R=n(376),A=n(365),j=n(1816),M=n(352),I=n(140),D=(n.n(I),n(360)),N=(n.n(D),n(3655)),L=n.n(N),x="ComposeLabelOptions",z={Block:x,Wrapper:"".concat(x,"-Wrapper"),List:"".concat(x,"-List"),Actions:"".concat(x,"-Actions"),Item:"".concat(x,"-Item"),Label:"".concat(x,"-Label"),Separator:"".concat(x,"-Separator")},B=(y=Object(w.inject)("controllers","data","services"))(b=Object(w.observer)((v=h=(function(e){function t(){var e,n;o(this,t);for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return n=c(this,(e=u(t)).call.apply(e,[this].concat(i))),n.onManageAction=function(){n.props.onAction&&n.props.onAction(),n.labelsController.manageLabels(),n.metrikaService.sendFooterMetrika(D.COMPOSE_METRIKA_FOOTER_LABELS,D.COMPOSE_METRIKA_FOOTER_LABELS_MANAGE)},n}return l(t,e),a(t,[{key:"addLabel",value:function(e){this.labelsController.addLabel(e),this.props.onAction&&this.props.onAction();var t=this.labelsService.isImportantLabel(e);this.metrikaService.sendFooterMetrika(D.COMPOSE_METRIKA_FOOTER_LABELS,t?D.COMPOSE_METRIKA_FOOTER_LABELS_ADD_IMPORTANT:D.COMPOSE_METRIKA_FOOTER_LABELS_ADD_USER)}},{key:"componentDidUpdate",value:function(){this.props.onChange&&this.props.onChange()}},{key:"render",value:function(){var e=this.isMobile?"".concat(z.Block,"_mobile ").concat(L.a.mobile):"".concat(z.Block,"_desktop ").concat(L.a.desktop);return f("div",{className:z.Wrapper},void 0,f("div",{className:C()(z.Block,e,L.a.root)},void 0,this.renderList(),f("div",{className:C()(z.Actions,L.a.actions)},void 0,this.renderAction())))}},{key:"renderList",value:function(){var e=this;return this.unusedLabels.length?_.a.createElement(_.a.Fragment,null,f("div",{className:C()(z.List,L.a.list)},void 0,this.unusedLabels.map((function(t){return e.renderLabel(t)}))),f("div",{className:C()(z.Separator,L.a.separator)})):null}},{key:"renderLabel",value:function(e){var t=this;return f("div",{className:C()(z.Item,L.a.item),onClick:function(){return t.addLabel(e)}},e.lid,f(j.a,{label:e,cls:z.Label}))}},{key:"renderAction",value:function(){var e=this.hasCreatedByUserLabels?"compose-react/Labels_Edit":"compose-react/Labels_Create";return f(I.Text,{typography:"body-long-m",className:C()(z.Item,L.a.item),onClick:this.onManageAction},void 0,f(M.default,{loc:e}))}},{key:"labelsController",get:function(){return this.props.controllers.labels}},{key:"labelsService",get:function(){return this.props.services.labels}},{key:"composeController",get:function(){return this.props.controllers.compose}},{key:"metrikaService",get:function(){return this.props.services.metrika}},{key:"unusedLabels",get:function(){return this.labelsController.getUnusedLabels()}},{key:"hasCreatedByUserLabels",get:function(){return this.labelsService.getCreatedByUserLabels().length>0}},{key:"isMobile",get:function(){return this.props.services.settings.isMobile}}]),t})(_.a.Component),h.propTypes={onChange:E.a.func,onAction:E.a.func,controllers:k.a.isRequired,data:R.a.isRequired,services:A.a.isRequired},m=v,d(m.prototype,"labelsController",[T.computed],Object.getOwnPropertyDescriptor(m.prototype,"labelsController"),m.prototype),d(m.prototype,"labelsService",[T.computed],Object.getOwnPropertyDescriptor(m.prototype,"labelsService"),m.prototype),d(m.prototype,"composeController",[T.computed],Object.getOwnPropertyDescriptor(m.prototype,"composeController"),m.prototype),d(m.prototype,"metrikaService",[T.computed],Object.getOwnPropertyDescriptor(m.prototype,"metrikaService"),m.prototype),d(m.prototype,"unusedLabels",[T.computed],Object.getOwnPropertyDescriptor(m.prototype,"unusedLabels"),m.prototype),d(m.prototype,"hasCreatedByUserLabels",[T.computed],Object.getOwnPropertyDescriptor(m.prototype,"hasCreatedByUserLabels"),m.prototype),d(m.prototype,"isMobile",[T.computed],Object.getOwnPropertyDescriptor(m.prototype,"isMobile"),m.prototype),b=m))||b)||b},1816:function(e,t,n){"use strict";function r(e){"@babel/helpers - typeof";return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}function c(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?s(e):t}function s(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function f(e,t,n,r){v||(v="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=r;else if(i>1){for(var a=new Array(i),c=0;c<i;c++)a[c]=arguments[c+3];t.children=a}if(t&&o)for(var s in o)void 0===t[s]&&(t[s]=o[s]);else t||(t=o||{});return{$$typeof:v,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}n.d(t,"a",(function(){return R}));var d,y,b,m,h,v,O=n(137),g=n.n(O),_=n(348),S=n.n(_),E=n(351),P=n(353),C=n(3652),w=n(365),T=n(1817),k=n.n(T),R=(d=Object(P.inject)("services"))(y=Object(P.observer)((h=m=(function(e){function t(){return o(this,t),c(this,u(t).apply(this,arguments))}return l(t,e),a(t,[{key:"render",value:function(){var e=this.labelsService.labelColors(this.props.label),t=e.background,n=e.color,r=this.labelsService.isImportantLabel(this.props.label);return f(k.a,{background:t,className:this.props.cls,color:n,id:"mail--ComposeReact-ImportantLabel",isImportant:r,name:this.props.label.name,onRemove:this.props.onRemove})}},{key:"labelsService",get:function(){return this.props.services.labels}}]),t})(g.a.Component),m.propTypes={cls:S.a.string,label:C.a.isRequired,onRemove:S.a.func,services:w.a.isRequired},b=h,(function(e,t,n,r,o){var i={};return Object.keys(r).forEach((function(e){i[e]=r[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce((function(n,r){return r(e,t,n)||n}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i})(b.prototype,"labelsService",[E.computed],Object.getOwnPropertyDescriptor(b.prototype,"labelsService"),b.prototype),y=b))||y)||y},1818:function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var r=n(622),o=n(532),i=n(3659),a=n(3663),c=n(360),s=(n.n(c),n(3664)),u={PopupContent:i.a,cls:s.a.Popup,metrikaArgs:[c.COMPOSE_METRIKA_FOOTER_NOTIFICATIONS,c.COMPOSE_METRIKA_FOOTER_NOTIFICATIONS_CLICK],directions:["top"],title:"compose-react/Notifications_Title"},l=Object(o.a)(u,s.b);t.b=Object(r.a)("compose-react/ControlPanel_Notifications_Tooltip",l);var p=Object(o.a)(u,a.a)},1819:function(e,t,n){"use strict";var r=n(3676);n.d(t,"a",(function(){return r.a}))},1820:function(e,t,n){"use strict";function r(e){"@babel/helpers - typeof";return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}function c(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?u(e):t}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function u(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function f(e,t,n,r){S||(S="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=r;else if(i>1){for(var a=new Array(i),c=0;c<i;c++)a[c]=arguments[c+3];t.children=a}if(t&&o)for(var s in o)void 0===t[s]&&(t[s]=o[s]);else t||(t=o||{});return{$$typeof:S,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function d(e,t,n,r){n&&Object.defineProperty(e,t,{enumerable:n.enumerable,configurable:n.configurable,writable:n.writable,value:n.initializer?n.initializer.call(r):void 0})}function y(e,t,n,r,o){var i={};return Object.keys(r).forEach((function(e){i[e]=r[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce((function(n,r){return r(e,t,n)||n}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}n.d(t,"a",(function(){return $}));var b,m,h,v,O,g,_,S,E=n(137),P=n.n(E),C=n(348),w=n.n(C),T=n(350),k=n.n(T),R=n(353),A=n(351),j=n(372),M=n(376),I=n(365),D=n(380),N=n(3680),L=n(352),x=n(140),z=(n.n(x),n(366)),B=(n.n(z),n(360)),F=(n.n(B),n(3682)),U=n.n(F),K="ComposeTemplatesOptions",H={Block:K,List:"".concat(K,"-List"),Separator:"".concat(K,"-Separator"),Action:"".concat(K,"-Action"),ActionSave:"".concat(K,"-Action_save"),ActionUpdate:"".concat(K,"-Action_update"),ActionSaveAs:"".concat(K,"-Action_save_as"),ActionManage:"".concat(K,"-Action_manage")},W=f(L.default,{loc:"compose-react/Templates_Manage"}),G=f(L.default,{loc:"compose-react/Templates_Save"}),Y=f(L.default,{loc:"compose-react/Templates_Update"}),q=f(L.default,{loc:"compose-react/Templates_Save_As_New"}),V=f(L.default,{loc:"compose-react/Templates_Save"}),$=(b=Object(R.inject)("controllers","data","services","visual"))(m=Object(R.observer)((_=g=(function(e){function t(){var e,n;o(this,t);for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return n=c(this,(e=s(t)).call.apply(e,[this].concat(i))),d(u(n),"hasTemplates",v,u(n)),d(u(n),"processTemplates",O,u(n)),n.onSelectTemplate=function(e){n.templatesController.openTemplate(e),n.onAction(B.COMPOSE_METRIKA_FOOTER_TEMPLATES_SELECT)},n.onCreateTemplate=function(){n.templatesController.createTemplate(),n.onAction(B.COMPOSE_METRIKA_FOOTER_TEMPLATES_SAVE)},n.onSaveAsNewTemplate=function(){n.templatesController.saveAsNewTemplate(),n.onAction(B.COMPOSE_METRIKA_FOOTER_TEMPLATES_SAVE_AS_NEW)},n.onUpdateTemplate=function(){n.templatesController.updateTemplate(),n.onAction(B.COMPOSE_METRIKA_FOOTER_TEMPLATES_UPDATE)},n.onManageTemplates=function(){n.composeController.closeCompose({leaveType:z.LeaveTypes.COLLAPSE}),n.templatesController.manageTemplates(),n.metrika.sendFooterMetrika(B.COMPOSE_METRIKA_FOOTER_TEMPLATES,B.COMPOSE_METRIKA_FOOTER_TEMPLATES_MANAGE)},n}return l(t,e),a(t,[{key:"onAction",value:function(e){this.metrika.sendFooterMetrika(B.COMPOSE_METRIKA_FOOTER_TEMPLATES,e),this.props.onAction&&this.props.onAction()}},{key:"componentDidMount",value:function(){this.props.services.templates.loadTemplates().then(this.processTemplates)}},{key:"componentDidUpdate",value:function(){this.props.onChange&&this.props.onChange()}},{key:"render",value:function(){return f("div",{className:k()(U.a.root,H.Block,this.props.cls)},void 0,this.renderContent())}},{key:"renderContent",value:function(){return this.hasTemplates?P.a.createElement(P.a.Fragment,null,f(N.a,{cls:k()(H.List,U.a.list),onChange:this.props.onChange,onSelectTemplate:this.onSelectTemplate}),f("div",{className:k()(H.Separator,U.a.separator)}),f(x.Text,{typography:"body-long-m",onClick:this.onManageTemplates,className:k()(H.Action,H.ActionManage,U.a.action)},void 0,W),this.isTemplate?this.renderTemplateActions():this.renderDraftActions()):this.renderDraftActions()}},{key:"renderTemplateActions",value:function(){return this.props.services.composeParams.isNewTemplate()?this.renderNewTemplateActions():this.renderExistingTemplateActions()}},{key:"renderNewTemplateActions",value:function(){return f(x.Text,{typography:"body-long-m",className:k()(H.Action,H.ActionSave,U.a.action),onClick:this.onCreateTemplate},void 0,G)}},{key:"renderExistingTemplateActions",value:function(){return P.a.createElement(P.a.Fragment,null,this.hasChanges&&f(x.Text,{typography:"body-long-m",className:k()(H.Action,H.ActionUpdate,U.a.action),onClick:this.onUpdateTemplate},void 0,Y),f(x.Text,{typography:"body-long-m",className:k()(H.Action,H.ActionSaveAs,U.a.action),onClick:this.onSaveAsNewTemplate},void 0,q))}},{key:"renderDraftActions",value:function(){return f(x.Text,{typography:"body-long-m",className:k()(H.Action,H.ActionSave,U.a.action),onClick:this.onCreateTemplate},void 0,V)}},{key:"isTemplate",get:function(){return this.props.data.isTemplate}},{key:"hasChanges",get:function(){return this.props.visual.hasChanges}},{key:"templatesController",get:function(){return this.props.controllers.templates}},{key:"composeController",get:function(){return this.props.controllers.compose}},{key:"metrika",get:function(){return this.props.services.metrika}}]),t})(P.a.PureComponent),g.propTypes={cls:w.a.string,onChange:w.a.func,onAction:w.a.func,controllers:j.a.isRequired,data:M.a.isRequired,services:I.a.isRequired,visual:D.a.isRequired},h=_,v=y(h.prototype,"hasTemplates",[A.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),y(h.prototype,"isTemplate",[A.computed],Object.getOwnPropertyDescriptor(h.prototype,"isTemplate"),h.prototype),y(h.prototype,"hasChanges",[A.computed],Object.getOwnPropertyDescriptor(h.prototype,"hasChanges"),h.prototype),y(h.prototype,"templatesController",[A.computed],Object.getOwnPropertyDescriptor(h.prototype,"templatesController"),h.prototype),y(h.prototype,"composeController",[A.computed],Object.getOwnPropertyDescriptor(h.prototype,"composeController"),h.prototype),y(h.prototype,"metrika",[A.computed],Object.getOwnPropertyDescriptor(h.prototype,"metrika"),h.prototype),O=y(h.prototype,"processTemplates",[A.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){var n=t.items;e.hasTemplates=Boolean(n.length)}}}),m=h))||m)||m},1821:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=r(n(3688));t.default=o.default},1822:function(e,t,n){"use strict";var r="ComposeMoreOptions";t.a={Block:r,Item:"".concat(r,"-Item"),ItemLabel:"".concat(r,"-ItemLabel"),ItemToggle:"".concat(r,"-ItemToggle"),TemplatesPopup:"".concat(r,"-TemplatesPopup"),TemplatesButton:"".concat(r,"-TemplatesButton")}},1823:function(e,t,n){"use strict";var r=n(433),o=n(3695),i=n(3701);t.a=Object(r.a)(i.a,o.a)},1824:function(e,t,n){"use strict";var r=n(433),o=n(3696),i=n.n(o),a=n(3698);t.a=Object(r.a)(a.a,i.a)},1825:function(e,t){},1826:function(e,t,n){"use strict";function r(e){"@babel/helpers - typeof";return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}function c(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?u(e):t}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function u(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function f(e,t,n,r){C||(C="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=r;else if(i>1){for(var a=new Array(i),c=0;c<i;c++)a[c]=arguments[c+3];t.children=a}if(t&&o)for(var s in o)void 0===t[s]&&(t[s]=o[s]);else t||(t=o||{});return{$$typeof:C,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function d(e,t,n,r){n&&Object.defineProperty(e,t,{enumerable:n.enumerable,configurable:n.configurable,writable:n.writable,value:n.initializer?n.initializer.call(r):void 0})}function y(e,t,n,r,o){var i={};return Object.keys(r).forEach((function(e){i[e]=r[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce((function(n,r){return r(e,t,n)||n}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}n.d(t,"a",(function(){return te}));var b,m,h,v,O,g,_,S,E,P,C,w=n(137),T=n.n(w),k=n(348),R=n.n(k),A=n(350),j=n.n(A),M=n(138),I=n.n(M),D=n(351),N=n(353),L=n(794),x=n.n(L),z=n(1816),B=n(352),F=n(427),U=n(140),K=(n.n(U),n(372)),H=n(376),W=n(365),G=n(502),Y=n(395),q=n.n(Y),V=n(366),$=(n.n(V),n(1827)),Q=n(360),J=(n.n(Q),n(3706)),X=(n.n(J),"ComposeLabels"),Z={Block:X,Content:"".concat(X,"-Content"),Item:{Container:"".concat(X,"-Item"),hidden:"".concat(X,"-Item_hidden")},Toggle:{Container:"".concat(X,"-Toggle"),Text:"".concat(X,"-ToggleText")}},ee=f(F.a,{id:"mail--ComposeReact-Expand"}),te=(b=Object(N.inject)("controllers","data","services","visual"))(m=Object(N.observer)((P=E=(function(e){function t(){var e,n;o(this,t);for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return n=c(this,(e=s(t)).call.apply(e,[this].concat(i))),n.disposer=new q.a,n.containerRef=T.a.createRef(),n.toggleControlRef=null,d(u(n),"hiddenLabelsCount",v,u(n)),d(u(n),"isExpanded",O,u(n)),d(u(n),"onExpand",g,u(n)),d(u(n),"updateExpanded",_,u(n)),d(u(n),"toggleLabels",S,u(n)),n.refreshLabels=function(){n.props.controllers.labels.refreshUserLabels()},n.setToggleControlRef=function(e){n.toggleControlRef=e},n}return l(t,e),a(t,[{key:"removeLabel",value:function(e){this.props.controllers.labels.removeUserLabel(e),this.metrikaService.sendHeaderMetrika(Q.COMPOSE_METRIKA_HEADER_LABELS,Q.COMPOSE_METRIKA_HEADER_LABELS_REMOVE)}},{key:"expandLabels",value:function(){Array.from(this.containerRef.current.children).forEach((function(e){return e.classList.remove(Z.Item.hidden)}))}},{key:"collapseLabels",value:function(){var e=this,t=Array.from(this.containerRef.current.children).filter((function(t){return t!==e.toggleControlRef}));if(t.length){var n=Object($.a)({elements:t,hiddenClass:Z.Item.hidden,summary:this.toggleControlRef});-1!==n.indexOf(t[0])&&n.splice(0,1),n.forEach((function(e){return e.classList.add(Z.Item.hidden)})),n.length&&this.collapseLabels()}}},{key:"componentDidMount",value:function(){var e=this;this.toggleLabels(),this.disposer.addEventListener(this,{element:window,eventName:"resize",listener:this.toggleLabels}),this.previousLabelsLength=this.props.data.userLabels.length,this.disposer.add(this,[Object(D.reaction)((function(){return e.props.visual.topContentInFixedMode}),(function(t){return e.updateExpanded(t)})),Object(D.reaction)((function(){return e.props.visual.additionalAddressesAreExpanded}),(function(t){return e.updateExpanded(!t)})),Object(D.reaction)((function(){return e.props.data.userLabels.length}),(function(t){t>e.previousLabelsLength&&e.onExpand(),e.previousLabelsLength=t})),this.labelsService.subscribeLabelsChanged(this.refreshLabels)])}},{key:"componentDidUpdate",value:function(){this.toggleLabels()}},{key:"componentWillUnmount",value:function(){this.disposer.dispose(this)}},{key:"render",value:function(){var e=this;return this.userLabels.length?f(x.a,{cls:Z.Block,title:"compose-react/Header_Labels",contentClass:Z.Content,contentRef:this.containerRef},void 0,this.userLabels.map((function(t){return e.renderLabel(t)})),this.renderToggleControl()):null}},{key:"renderLabel",value:function(e){var t=this;return f(z.a,{cls:Z.Item.Container,label:e,onRemove:function(){return t.removeLabel(e)}},e.lid)}},{key:"renderToggleControl",value:function(){var e=this.hiddenLabelsCount;return this.isExpanded||!e?null:T.a.createElement("div",{ref:this.setToggleControlRef,className:j()(Z.Item.Container,Z.Toggle.Container),onClick:this.onExpand},f(U.Text,{typography:"body-long-m"},void 0,f(B.default,{className:Z.Toggle.Text,loc:"compose-react/More_N",params:{count:e}}),ee))}},{key:"labelsService",get:function(){return this.props.services.labels}},{key:"userLabels",get:function(){var e=this;return I.a.sortBy(this.props.data.userLabels,(function(t){return!e.labelsService.isImportantLabel(t)}))}},{key:"metrikaService",get:function(){return this.props.services.metrika}},{key:"isBackground",get:function(){return this.props.visual.workMode===V.WorkModes.BACKGROUND}},{key:"hiddenItems",get:function(){return Array.from(this.containerRef.current.children).filter((function(e){return e.classList.contains(Z.Item.hidden)}))}}]),t})(T.a.Component),E.propTypes={controllers:K.a.isRequired,data:H.a.isRequired,services:W.a.isRequired,visual:G.a.isRequired,onExpand:R.a.func},h=P,v=y(h.prototype,"hiddenLabelsCount",[D.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),O=y(h.prototype,"isExpanded",[D.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),y(h.prototype,"labelsService",[D.computed],Object.getOwnPropertyDescriptor(h.prototype,"labelsService"),h.prototype),y(h.prototype,"userLabels",[D.computed],Object.getOwnPropertyDescriptor(h.prototype,"userLabels"),h.prototype),y(h.prototype,"metrikaService",[D.computed],Object.getOwnPropertyDescriptor(h.prototype,"metrikaService"),h.prototype),y(h.prototype,"isBackground",[D.computed],Object.getOwnPropertyDescriptor(h.prototype,"isBackground"),h.prototype),g=y(h.prototype,"onExpand",[D.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){e.isExpanded=!0,e.hiddenLabelsCount=0,e.props.onExpand&&e.props.onExpand()}}}),_=y(h.prototype,"updateExpanded",[D.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){e.isExpanded&&t&&(e.isExpanded=!1)}}}),S=y(h.prototype,"toggleLabels",[D.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){if(e.containerRef.current&&!e.isBackground&&(e.expandLabels(),!e.isExpanded)){e.collapseLabels();var t=e.hiddenItems.length;t!==e.hiddenLabelsCount&&(e.hiddenLabelsCount=t)}}}}),m=h))||m)||m},1827:function(e,t,n){"use strict";function r(e){return a(e)||i(e)||o()}function o(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function i(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function a(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}n.d(t,"a",(function(){return u}));var c=n(138),s=n.n(c),u=function(e){var t=e.elements,n=e.hiddenClass,o=e.summary;if(s.a.isEmpty(t))return[];var i=t[0];if(i.classList.contains(n))return[];var a=i.offsetTop,c=i.offsetTop+i.offsetHeight,u=t.filter((function(e){return e.offsetTop>c}));if(!(o&&o.offsetTop>c))return u;var l=s.a.findLast(t,(function(e){return!e.classList.contains(n)&&e.offsetTop===a}));return[].concat(r(l?[l]:[]),r(u))}},1834:function(e,t,n){"use strict";function r(e){"@babel/helpers - typeof";return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}function c(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?s(e):t}function s(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function f(e,t,n,r){d||(d="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=r;else if(i>1){for(var a=new Array(i),c=0;c<i;c++)a[c]=arguments[c+3];t.children=a}if(t&&o)for(var s in o)void 0===t[s]&&(t[s]=o[s]);else t||(t=o||{});return{$$typeof:d,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}n.d(t,"a",(function(){return O}));var d,y=n(137),b=n.n(y),m=n(530),h=n(682),v=n(688),O=(function(e){function t(){return o(this,t),c(this,u(t).apply(this,arguments))}return l(t,e),a(t,[{key:"render",value:function(){return f("div",{className:"compose-AttachmentsList"},void 0,this.props.attachments.map(this.renderItem))}},{key:"renderItem",value:function(e){return f(v.a,{attachment:e},e.info.id)}}]),t})(b.a.PureComponent);O.propTypes={attachments:m.a.arrayOf(h.a).isRequired}},1835:function(e,t,n){"use strict";function r(){return r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},r.apply(this,arguments)}function o(e){"@babel/helpers - typeof";return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){if(null==e)return{};var n,r,o=a(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function a(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e,t,n){return t&&s(e.prototype,t),n&&s(e,n),e}function l(e,t){return!t||"object"!==o(t)&&"function"!=typeof t?p(e):t}function p(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function d(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&y(e,t)}function y(e,t){return(y=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}n.d(t,"a",(function(){return E}));var b=n(137),m=n.n(b),h=n(348),v=n.n(h),O=n(350),g=n.n(O),_=n(370),S=n(3746),E=(n.n(S),(function(e){function t(){var e,n;c(this,t);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return n=l(this,(e=f(t)).call.apply(e,[this].concat(o))),n.state={timeToShow:!1},n.timeout=null,n}return d(t,e),u(t,[{key:"componentDidUpdate",value:function(e){var t=this,n=this.props,r=n.visible,o=n.delayToShow;e.visible!==r&&(clearTimeout(this.timeout),this.state.timeToShow&&this.setState({timeToShow:!1}),r&&(this.timeout=setTimeout((function(){return t.setState({timeToShow:!0})}),o)))}},{key:"componentWillUnmount",value:function(){clearTimeout(this.timeout)}},{key:"render",value:function(){var e=this.props,t=e.cls,n=e.visible,o=i(e,["cls","visible"]),a=this.state.timeToShow,c=n&&a,s=g()("ComposeTooltip",t);return m.a.createElement(_.default,r({cls:s,view:"default",tone:"default",to:"top-left",size:"xs",theme:"normal",visible:c},o))}}]),t})(m.a.PureComponent));E.propTypes={cls:v.a.string,visible:v.a.bool,delayToShow:v.a.number},E.defaultProps={visible:!1,delayToShow:300}},1836:function(e,t,n){"use strict";n.d(t,"b",(function(){return u})),n.d(t,"a",(function(){return l}));var r=n(138),o=(n.n(r),n(348)),i=n.n(o),a=n(1793),c=n(1277),s=n(399),u=(n.n(s),{cls:i.a.string,complexityLogger:i.a.instanceOf(a.a),messageBodyController:i.a.instanceOf(c.j),getComposeContainerRef:i.a.func.isRequired,getInlineDropZone:i.a.func,getScrollableRef:i.a.func.isRequired,isCorp:i.a.bool,isMobile:i.a.bool,isQuickReply:i.a.bool,mailAutocomplete:i.a.object,onChange:i.a.func,onChildPopupStateChanged:i.a.func,onEditorInit:i.a.func,onEditorDestroy:i.a.func,onFocus:i.a.func,onInput:i.a.func,onKeyboardMove:i.a.func,onPasteFiles:i.a.func,onToolbarCommandClick:i.a.func,placeholder:i.a.string.isRequired,signatureMatches:i.a.arrayOf(i.a.shape({match:i.a.string,leadingLineBreaks:i.a.number})),size:i.a.oneOf(Object(r.values)(s.ComposeSizes))}),l={onChange:r.noop,onChildPopupStateChanged:r.noop,onEditorInit:r.noop,onEditorDestroy:r.noop,onFocus:r.noop,onInput:r.noop,onPasteFiles:r.noop,onToolbarCommandClick:r.noop}},1837:function(e,t,n){"use strict";var r=n(3756);n.d(t,"a",(function(){return r.a}))},1838:function(e,t,n){"use strict";var r=n(3757);n.d(t,"a",(function(){return r.a}))},1839:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},r.apply(this,arguments)},o=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&o(t,e,n);return i(t,e),t},c=this&&this.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var o=0,r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]]);return n},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var u=a(n(137)),l=s(n(350)),p=s(n(368)),f=n(142),d=s(n(3758)),y=function(e){var t=e.cls,n=e.isExpanded,o=c(e,["cls","isExpanded"]),i=u.useCallback((function(e){e.preventDefault()}),[]),a=u.useCallback((function(e){var t;return u.default.createElement("span",{className:l.default(e,d.default.icon)},u.default.createElement(p.default,{id:"mail--ComposeReact-Expand",cls:l.default((t={},t[d.default.expanded]=n,t)),focusable:!1}))}),[n]);return u.default.createElement(f.Button,r({className:l.default(t,d.default.root,"ComposeExpanderButton"),view:"clear",size:"m"},o,{onKeyPress:i,iconRight:a,"aria-expanded":n}))};t.default=y},1840:function(e,t,n){"use strict";var r=n(433),o=n(3762),i=n(3771);t.a=Object(r.a)(o.a,i.a)},1843:function(e,t,n){"use strict";var r=n(348),o=n.n(r),i=n(372),a=n(380);t.a={field:o.a.string,scope:o.a.object,position:o.a.object,anchor:o.a.object,onClose:o.a.func,onSelectContact:o.a.func,onShowAllContacts:o.a.func,controllers:i.a.isRequired,visual:a.a.isRequired}},1844:function(e,t,n){"use strict";function r(e){"@babel/helpers - typeof";return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}function c(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?u(e):t}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function u(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function f(e,t,n,r){_||(_="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=r;else if(i>1){for(var a=new Array(i),c=0;c<i;c++)a[c]=arguments[c+3];t.children=a}if(t&&o)for(var s in o)void 0===t[s]&&(t[s]=o[s]);else t||(t=o||{});return{$$typeof:_,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function d(e,t,n,r){n&&Object.defineProperty(e,t,{enumerable:n.enumerable,configurable:n.configurable,writable:n.writable,value:n.initializer?n.initializer.call(r):void 0})}function y(e,t,n,r,o){var i={};return Object.keys(r).forEach((function(e){i[e]=r[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce((function(n,r){return r(e,t,n)||n}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}n.d(t,"a",(function(){return q}));var b,m,h,v,O,g,_,S=n(137),E=n.n(S),P=n(348),C=n.n(P),w=n(138),T=n.n(w),k=n(350),R=n.n(k),A=n(353),j=n(351),M=n(530),I=n(382),D=n(372),N=n(365),L=n(352),x=n(3764),z=n(444),B=n(793),F=n(688),U=n(433),K=n(360),H=(n.n(K),n(3769)),W=(n.n(H),Object(U.a)(F.c,"div")),G={Block:"ComposeContactsList",Item:"".concat("ComposeContactsList","-Item"),HighlightedText:"".concat("ComposeContactsList","-HighlightedText")},Y=f(L.default,{loc:"compose-react/Send_it_to_me"}),q=(b=Object(A.inject)("controllers","services"))(m=Object(A.observer)((g=O=(function(e){function t(){var e,n;o(this,t);for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return n=c(this,(e=s(t)).call.apply(e,[this].concat(i))),n._disposer=new I.a,n.getContactEmailList=function(e){return!e||e.isLocal()?Promise.resolve():n.contactsController.getEmailList(e).then((function(t){return e.emailList=t}))},d(u(n),"selectContact",v,u(n)),n.formatContact=function(e){return{name:e.isSelf?Y:n._applyHighlight(e.name),email:z.b.isGroupContact(e)?f(L.default,{loc:"compose-react/GroupYabble_N_Recipients",params:{count:e.group.length}}):n._applyHighlight(e.email)}},n}return l(t,e),a(t,[{key:"componentDidUpdate",value:function(){this.props.onChange&&this.props.onChange()}},{key:"render",value:function(){var e=this;return f(W,{className:R()(G.Block,this.props.cls),cls:R()(G.Block,this.props.cls),selectedIndex:this.props.selectedContactIndex,itemHeight:40},void 0,this.props.contacts.map((function(t,n){return e.renderItem(t,n)})))}},{key:"renderItem",value:function(e,t){var n=this,r=this.props,o=r.onHoverContact,i=r.selectedContactIndex,a=t===i,c={cls:G.Item,contact:e,formatContact:this.formatContact,isActive:a,key:e.email+e.cid,onClick:function(){return n.selectContact(e)},onMouseEnter:function(){return o&&o(e)}};return E.a.createElement(x.a,c)}},{key:"_applyHighlight",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=this.props.query;if(!t)return e;var n=new RegExp(T.a.escapeRegExp(t),"gi"),r=e.split(n),o=[];e.replace(n,(function(e){return o.push(e)}));var i=[r[0]];return r.slice(1).forEach((function(e,t){var n=o[t];i.push(f("span",{className:G.HighlightedText},t,n)),i.push(e)})),E.a.createElement(E.a.Fragment,null,i)}},{key:"contactsController",get:function(){return this.props.controllers.contacts}},{key:"metrikaService",get:function(){return this.props.services.metrika}}]),t})(E.a.Component),O.propTypes={cls:C.a.string,query:C.a.string,selectedContactIndex:C.a.number,contacts:M.a.arrayOf(B.a),onSelectContact:C.a.func,onHoverContact:C.a.func,onChange:C.a.func,controllers:D.a.isRequired,services:N.a.isRequired},h=g,y(h.prototype,"contactsController",[j.computed],Object.getOwnPropertyDescriptor(h.prototype,"contactsController"),h.prototype),y(h.prototype,"metrikaService",[j.computed],Object.getOwnPropertyDescriptor(h.prototype,"metrikaService"),h.prototype),v=y(h.prototype,"selectContact",[j.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){e.getContactEmailList(t),e.props.onSelectContact&&e.props.onSelectContact(t);var n=t.isSelf?K.COMPOSE_METRIKA_HEADER_SUGGEST_SELF:K.COMPOSE_METRIKA_HEADER_SUGGEST_OTHER;e.metrikaService.sendHeaderMetrika(K.COMPOSE_METRIKA_HEADER_SUGGEST,n)}}}),m=h))||m)||m},1845:function(e,t,n){"use strict";var r=n(348),o=n.n(r);t.a={cls:o.a.string,contact:o.a.object,formatContact:o.a.func.isRequired,isActive:o.a.bool,onClick:o.a.func}},1846:function(e,t,n){"use strict";function r(){return r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},r.apply(this,arguments)}function o(e){"@babel/helpers - typeof";return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function c(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),e}function s(e,t){return!t||"object"!==o(t)&&"function"!=typeof t?l(e):t}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function l(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function p(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function d(e,t,n,r){P||(P="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=r;else if(i>1){for(var a=new Array(i),c=0;c<i;c++)a[c]=arguments[c+3];t.children=a}if(t&&o)for(var s in o)void 0===t[s]&&(t[s]=o[s]);else t||(t=o||{});return{$$typeof:P,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function y(e,t,n,r){n&&Object.defineProperty(e,t,{enumerable:n.enumerable,configurable:n.configurable,writable:n.writable,value:n.initializer?n.initializer.call(r):void 0})}function b(e,t,n,r,o){var i={};return Object.keys(r).forEach((function(e){i[e]=r[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce((function(n,r){return r(e,t,n)||n}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}n.d(t,"a",(function(){return H}));var m,h,v,O,g,_,S,E,P,C=n(137),w=n.n(C),T=n(348),k=n.n(T),R=n(350),A=n.n(R),j=n(351),M=n(353),I=n(372),D=n(376),N=n(365),L=n(1309),x=n(380),z=n(3773),B=n(3775),F=n(3776),U=n(382),K=n(3778),H=(n.n(K),(m=Object(M.inject)("controllers","data","services","stores","visual"))(h=Object(M.observer)((E=S=(function(e){function t(){var e,n;i(this,t);for(var o=arguments.length,a=new Array(o),c=0;c<o;c++)a[c]=arguments[c];return n=s(this,(e=u(t)).call.apply(e,[this].concat(a))),n._disposer=new U.a,n.addYabble=function(e){var t=e.field,r=e.contact;n.props.field===t&&n.composeYabbles.addYabble(r)},n.editBubble=function(e){var t=e.field,r=e.event,o=e.yabble;n.props.field===t&&n.composeYabbles.onYabbleEdit(r,o)},y(l(n),"focusAddresses",O,l(n)),n.collapseField=function(e){e||n.composeYabbles.hideYabbles()},y(l(n),"onBubblesExpanded",g,l(n)),n.onBubblesChanged=function(e){n.props.onYabblesChanged&&n.props.onYabblesChanged(e);var t=n.contacts.map((function(e){return e.email})).sort(),r=e.map((function(e){return e.email})).sort();t.join("")!==r.join("")&&n.updateAddresses(e)},n.onClick=function(){if(!n.composeYabbles.isEditing){var e=n.props.onClick;e&&e(n.getLastYabblePosition())}},n.onInput=function(e){if(!n.composeYabbles.isEditing){var t=n.props.onInput;t&&t(e,n.getLastYabblePosition())}},n.onYabbleRemove=function(e){n.composeYabbles.onYabbleRemove(e);var t=n.props.onYabbleRemove;t&&t(e)},n.onInternalYabbleRemove=function(){var e=n.props.onYabbleRemove;e&&e()},n.renderYabble=function(e){var t=e.contact,r=w.a.createRef();return d(B.a,{avatars:n.props.controllers.avatars,contact:t,innerRef:r,lang:n.props.services.settings.lang,onClick:function(e){return n.props.onYabbleClick(e,r,t)},onRemove:n.onYabbleRemove})},n.renderShowMoreYabble=function(e){return w.a.createElement(F.a,r({lang:n.props.services.settings.lang},e))},y(l(n),"updateAddresses",_,l(n)),n}return p(t,e),c(t,[{key:"focus",value:function(){var e=this;setTimeout((function(){e.composeYabbles.element.focus(),e.composeYabbles.canHideYabbles=!0}))}},{key:"getLastYabblePosition",value:function(){var e=this.composeYabbles.element,t=0;return e.childElementCount&&(t=e.lastElementChild.getBoundingClientRect().right-e.getBoundingClientRect().left),{left:t}}},{key:"componentDidMount",value:function(){var e=this;this.composeYabbles=new z.a({canHideYabbles:!0,contactsStore:this.contactsStore,convertContactToText:this.props.convertContactToText,formatterService:this.contactsFormatterService,isYabblesExpanded:this.props.visual.expandedFields[this.props.field],name:this.props.field,id:this.props.fieldId,node:this.props.innerRef.current,onBubblesChanged:this.onBubblesChanged,onInternalYabbleRemove:this.onInternalYabbleRemove,onFocus:this.props.onFocus,onClick:this.onClick,onInput:this.onInput,renderShowMoreYabble:this.renderShowMoreYabble,renderYabble:this.renderYabble,draggable:this.props.isDraggable,onDragStart:this.props.onDragStart,onBubblesExpanded:this.onBubblesExpanded,title:this.props.title}),this._disposer.add(this,[Object(j.reaction)((function(){return e.contacts}),(function(){return e.syncYabbles()}),{fireImmediately:!0,equals:j.comparer.structural}),Object(j.reaction)((function(){return e.props.visual.expandedFields[e.props.field]}),this.collapseField),Object(j.reaction)((function(){return e.props.visual.focusedField}),this.focusAddresses),function(){return e.composeYabbles.destroyBubbles()}])}},{key:"componentWillUnmount",value:function(){this._disposer.dispose(this)}},{key:"render",value:function(){return w.a.createElement("div",{ref:this.props.innerRef,className:A()(this.props.cls,"ComposeYabblesField")},this.props.children)}},{key:"syncYabbles",value:function(){this.composeYabbles.syncYabbles(this.contacts)}},{key:"contactsFormatterService",get:function(){return this.props.services.contactsFormatter}},{key:"contactsController",get:function(){return this.props.controllers.contacts}},{key:"contactsStore",get:function(){return this.props.stores.contacts}},{key:"addresses",get:function(){var e=this.props,t=e.data,n=e.field;return t.addresses[n]}},{key:"contacts",get:function(){var e=this;return this.addresses.map((function(t){return e.contactsController.replaceLoadedContact(t)}))}}]),t})(w.a.Component),S.propTypes={cls:k.a.string,convertContactToText:k.a.func,field:k.a.string,fieldId:k.a.string,innerRef:k.a.object,onClick:k.a.func,onFocus:k.a.func,onInput:k.a.func,onYabbleClick:k.a.func,onYabbleRemove:k.a.func,onYabblesChanged:k.a.func,onDragStart:k.a.func,isDraggable:k.a.bool,title:k.a.string,controllers:I.a.isRequired,data:D.a.isRequired,services:N.a.isRequired,stores:L.a.isRequired,visual:x.a.isRequired},S.defaultProps={innerRef:w.a.createRef()},v=E,b(v.prototype,"contactsFormatterService",[j.computed],Object.getOwnPropertyDescriptor(v.prototype,"contactsFormatterService"),v.prototype),b(v.prototype,"contactsController",[j.computed],Object.getOwnPropertyDescriptor(v.prototype,"contactsController"),v.prototype),b(v.prototype,"contactsStore",[j.computed],Object.getOwnPropertyDescriptor(v.prototype,"contactsStore"),v.prototype),b(v.prototype,"addresses",[j.computed],Object.getOwnPropertyDescriptor(v.prototype,"addresses"),v.prototype),b(v.prototype,"contacts",[j.computed],Object.getOwnPropertyDescriptor(v.prototype,"contacts"),v.prototype),O=b(v.prototype,"focusAddresses",[j.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){t===e.props.field&&(e.focus(),e.props.visual.focusedField="")}}}),g=b(v.prototype,"onBubblesExpanded",[j.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){e.props.visual.expandedFields[e.props.field]=!0}}}),_=b(v.prototype,"updateAddresses",[j.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){var n=e.props,r=n.data,o=n.field;r.addresses[o]=t}}}),h=v))||h)||h)},1847:function(e,t,n){"use strict";function r(e,t,n,r){o||(o="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,a=arguments.length-3;if(t||0===a||(t={children:void 0}),1===a)t.children=r;else if(a>1){for(var c=new Array(a),s=0;s<a;s++)c[s]=arguments[s+3];t.children=c}if(t&&i)for(var u in i)void 0===t[u]&&(t[u]=i[u]);else t||(t=i||{});return{$$typeof:o,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}var o,i=n(137),a=(n.n(i),n(352)),c=n(1283),s=function(e){var t=e.contact,n=t.name;return t.isGroup()?r(a.default,{loc:"compose-react/SearchSuggest_Group",params:{name:n}}):n};t.a=s,s.propTypes={contact:c.a}},1848:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ButtonWithIcon=void 0;var r=n(3814);Object.defineProperty(t,"ButtonWithIcon",{enumerable:!0,get:function(){return r.ButtonWithIcon}})},1849:function(e,t,n){"use strict";function r(){return r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},r.apply(this,arguments)}function o(e){return a.createElement("svg",r({width:16,height:16,viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},e),c)}Object.defineProperty(t,"__esModule",{value:!0});var i,a=n(137),c=(n.n(a),(function(e,t,n,r){i||(i="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,a=arguments.length-3;if(t||0===a||(t={children:void 0}),1===a)t.children=r;else if(a>1){for(var c=new Array(a),s=0;s<a;s++)c[s]=arguments[s+3];t.children=c}if(t&&o)for(var u in o)void 0===t[u]&&(t[u]=o[u]);else t||(t=o||{});return{$$typeof:i,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}})("rect",{x:2,y:12,width:12,height:2,rx:1,fill:"currentColor"}));t.default=o},1850:function(e,t,n){"use strict";function r(){return r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},r.apply(this,arguments)}function o(e){return a.createElement("svg",r({width:16,height:16,viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},e),c)}Object.defineProperty(t,"__esModule",{value:!0});var i,a=n(137),c=(n.n(a),(function(e,t,n,r){i||(i="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,a=arguments.length-3;if(t||0===a||(t={children:void 0}),1===a)t.children=r;else if(a>1){for(var c=new Array(a),s=0;s<a;s++)c[s]=arguments[s+3];t.children=c}if(t&&o)for(var u in o)void 0===t[u]&&(t[u]=o[u]);else t||(t=o||{});return{$$typeof:i,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}})("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M0 4a3 3 0 013-3h10a3 3 0 013 3v8a3 3 0 01-3 3H3a3 3 0 01-3-3V4zm3-1a1 1 0 00-1 1v8a1 1 0 001 1h10a1 1 0 001-1V4a1 1 0 00-1-1H3z",fill:"currentColor"}));t.default=o},1851:function(e,t,n){"use strict";function r(){return r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},r.apply(this,arguments)}function o(e){return a.createElement("svg",r({width:16,height:16,viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},e),c)}Object.defineProperty(t,"__esModule",{value:!0});var i,a=n(137),c=(n.n(a),(function(e,t,n,r){i||(i="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,a=arguments.length-3;if(t||0===a||(t={children:void 0}),1===a)t.children=r;else if(a>1){for(var c=new Array(a),s=0;s<a;s++)c[s]=arguments[s+3];t.children=c}if(t&&o)for(var u in o)void 0===t[u]&&(t[u]=o[u]);else t||(t=o||{});return{$$typeof:i,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}})("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M4 7.3A2.3 2.3 0 016.3 5h3.4A2.3 2.3 0 0112 7.3v3.4A2.3 2.3 0 019.7 13H6.3A2.3 2.3 0 014 10.7V7.3zM6.3 7a.3.3 0 00-.3.3v3.4a.3.3 0 00.3.3h3.4a.3.3 0 00.3-.3V7.3a.3.3 0 00-.3-.3H6.3z",fill:"currentColor"}));t.default=o},1852:function(e,t,n){"use strict";function r(e,t,n,r){o||(o="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,a=arguments.length-3;if(t||0===a||(t={children:void 0}),1===a)t.children=r;else if(a>1){for(var c=new Array(a),s=0;s<a;s++)c[s]=arguments[s+3];t.children=c}if(t&&i)for(var u in i)void 0===t[u]&&(t[u]=i[u]);else t||(t=i||{});return{$$typeof:o,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}var o,i=n(137),a=(n.n(i),n(87)),c=(n.n(a),n(3856)),s=Object(a.hasFeature)(a.Features.WEB_CAPTCHA_CHECKBOX),u=r(c.a,{}),l=r(c.b,{}),p=r(c.b,{}),f=r(c.c,{}),d=r(c.d,{}),y=r(c.e,{}),b=r(c.f,{}),m=r(c.g,{}),h=r(c.h,{}),v=r(c.i,{}),O=function(){return r("div",{},void 0,u,s?l:p,f,d,y,b,m,h,v)};t.a=O},1853:function(e,t,n){"use strict";function r(e,t,n,r){o||(o="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,a=arguments.length-3;if(t||0===a||(t={children:void 0}),1===a)t.children=r;else if(a>1){for(var c=new Array(a),s=0;s<a;s++)c[s]=arguments[s+3];t.children=c}if(t&&i)for(var u in i)void 0===t[u]&&(t[u]=i[u]);else t||(t=i||{});return{$$typeof:o,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}var o,i=n(137),a=(n.n(i),n(348)),c=n.n(a),s=n(352),u=n(1319),l=function(e){var t=e.timestamp,n={savedTime:Object(u.default)(t,"%R")};return r(s.default,{loc:"compose-react/Saved_at",params:n})};t.a=l,l.propTypes={timestamp:c.a.oneOfType([c.a.number,c.a.instanceOf(Date)])}},1854:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n(3886);Object.defineProperty(t,"default",{enumerable:!0,get:function(){return r.ComposePopup}})},207:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3429),o=n(3913);Jane.module("compose-manager.js",(function(){var e=new r.a,t=new o.a;Daria.React.Compose={create:function(t,n,r){Daria.React.Compose.shouldRenderStack=!0,e.createCompose(t,n,r),e.render(document.querySelector(".js-ComposeManagerContainer"))},restore:function(t){e.render(t)},showPromo:function(t){e.showPromo(t)},destroy:function(){return e.unmount()},isVisible:function(){return Boolean(e.manager.currentCompose)}},Daria.React.QuickReply={open:t.render,saveDraft:t.saveDraft,saveDraftAndDestroy:t.saveDraftAndUnmount,destroy:t.unmount}}))},3429:function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e}n.d(t,"a",(function(){return b}));var a=n(1776),c=n(3482),s=n(3483),u=n(1787),l=n(3910),p=n(3911),f=n(3912),d=n(899),y=n(786),b=(function(){function e(){r(this,e),this._createPromise=Promise.resolve();var t=new a.s,n=new a.p,o=new c.a;this.services={abookPopup:o,metrika:n,settings:t,syncRelatedModels:new d.a},this.controllers={abookPopup:new l.a(o),settings:new p.a(t),dimensions:new f.a(t),leaveCompose:new y.a},this._init(),Daria.maybeSaveReactComposeFirstUsedDate()}return i(e,[{key:"_init",value:function(){this.inited||(this.inited=!0,this.manager=new u.a({services:this.services,controllers:this.controllers}),this.manager.connect())}},{key:"render",value:function(e){if(this._init(),!this.rendered&&e){this.rendered=!0;var t=this.manager,n=this.services,r=this.controllers;this._destroyer=Object(s.a)({manager:t,services:n,controllers:r,node:e})}}},{key:"unmount",value:function(){this.rendered=!1,this._destroyer&&this._destroyer(),this.manager=null,this.inited=!1}},{key:"createCompose",value:function(e,t,n){var r=this;return this._init(),this._createPromise=this._createPromise.then((function(){var o=r.manager.stack.get(e,t,n);return r.manager.openCompose(o)})),this._createPromise}},{key:"showPromo",value:function(e){this._init(),this.manager.showPromo(e)}}]),e})()},3430:function(e,t,n){"use strict";function r(e){return a(e)||i(e)||o()}function o(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function i(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function a(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}function c(e,t,n,r,o,i,a){try{var c=e[i](a),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,o)}function s(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){function i(e){c(s,r,o,i,a,"next",e)}function a(e){c(s,r,o,i,a,"throw",e)}var s=e.apply(t,n);i(void 0)})}}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function p(e,t,n){return t&&l(e.prototype,t),n&&l(e,n),e}n.d(t,"a",(function(){return P}));var f=n(138),d=n.n(f),y=n(3431),b=n(3432),m=n(3433),h=n(1269),v=n(902),O=n(1270),g=n(369),_=n(3434),S=n(1271),E=n(1779),P=(function(){function e(t){u(this,e),this.composeParamsService=t,this.limits=new m.a({hasDisk:this.hasDisk,isCorp:Daria.IS_CORP})}return p(e,[{key:"loadInitialAttachments",value:function(){var e=this.composeParamsService.mMessageBody;return!e||this.composeParamsService.isReplyAny()?[]:e.getAttachments().filter((function(e){return!e.inline})).map(E.a.bind(this,e))}},{key:"getDataForSend",value:function(e){return e.info.type===g.d.FORWARDED_MAIL?{ids:e.info.id}:Object(h.a)(e.info,e.status)}},{key:"getRenderData",value:function(e){return Object(v.a)(e.info,{status:e.status,previewSupported:e.previewSupported})}},{key:"showImagePreview",value:function(e,t,n,r){ns.action.run(e,t,n,r)}},{key:"fileUploadWithDisk",value:(function(){function e(e){return t.apply(this,arguments)}var t=s(regeneratorRuntime.mark((function e(t){var n,r,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.attachment,r=t.onUploadProgress,o=new y.a({attachment:n,onUploadProgress:r}),e.abrupt("return",o.upload());case 3:case"end":return e.stop()}}),e)})));return e})()},{key:"fileUploadDirect",value:(function(){function e(e){return t.apply(this,arguments)}var t=s(regeneratorRuntime.mark((function e(t){var n,r,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.attachment,r=t.onUploadProgress,o=new b.a({attachment:n,onUploadProgress:r}),e.abrupt("return",o.upload());case 3:case"end":return e.stop()}}),e)})));return e})()},{key:"attachFromDisk",value:(function(){function e(e){return t.apply(this,arguments)}var t=s(regeneratorRuntime.mark((function e(t){var n,r,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.attachment,r=t.onUploadProgress,o=d.a.cloneDeep(n.info),e.abrupt("return",new Promise(function(e,t){Object(O.a)(o,{onUploadProgress:r,onSuccess:function(){return e({info:o})},onFail:function(){t({status:g.c.FAILED})}})}));case 3:case"end":return e.stop()}}),e)})));return e})()},{key:"cleanUpYaDiskUrl",value:function(){return Daria.url.cleanUpYaDisk()}},{key:"increaseYaDiskSizeUrl",value:function(){return Daria.url.increaseYaDiskSize()}},{key:"signUpDiskUrl",value:function(){return Daria.url.signUpDisk()}},{key:"diskHelpUrl",value:function(){return"".concat(Daria.url.diskHelp(),"/enlarge/disk-space.html#limit")}},{key:"getForwardedMessagesAttachData",value:(function(){function e(){return t.apply(this,arguments)}var t=s(regeneratorRuntime.mark((function e(){var t,n,o,i,a,c,s,u;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.composeParamsService.params,"forward"===n.oper){e.next=3;break}return e.abrupt("return",[]);case 3:return o=Object(_.a)(n.tids),i=Object(_.a)(n.ids),a=[].concat(r(o.map((function(e){return{id:"messages",params:{thread_id:e,first:0,count:Math.min(ns.Model.get("message",{ids:e}).getThreadCount(),500)}}}))),r(i.map((function(e){return{id:"message",params:{ids:e}}})))),e.next=8,ns.request(a);case 8:return c=e.sent,s=c.map((function(e){return"messages"===e.id?e.models:[e]})),u=(t=[]).concat.apply(t,r(s)),e.abrupt("return",u.map((function(e){return{mid:e.get(".mid"),subject:Object(S.a)(e)}})));case 12:case"end":return e.stop()}}),e,this)})));return e})()},{key:"isCorp",get:function(){return Daria.IS_CORP}},{key:"hasDisk",get:function(){return!Daria.IS_CORP}}]),e})()},3431:function(e,t,n){"use strict";function r(e,t,n,r,o,i,a){try{var c=e[i](a),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,o)}function o(e){return function(){var t=this,n=arguments;return new Promise(function(o,i){function a(e){r(s,o,i,a,c,"next",e)}function c(e){r(s,o,i,a,c,"throw",e)}var s=e.apply(t,n);a(void 0)})}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function c(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),e}n.d(t,"a",(function(){return m}));var s=n(138),u=n.n(s),l=n(1261),p=n(1264),f=n(1265),d=n(1266),y=n(369),b=n(1777),m=(function(){function e(t){var n=t.attachment,r=t.onUploadProgress;i(this,e),this.attachment=n,this.onUploadProgress=r,this.patchedUploadProgress=this._patchUploadProgress()}return c(e,[{key:"_patchUploadProgress",value:function(){var e=this,t=Object(b.b)({from:0,to:100},{from:0,to:90});return function(n){return e.onUploadProgress(t(n))}}},{key:"upload",value:(function(){function e(){return t.apply(this,arguments)}var t=o(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.onUploadProgress(0),e.next=3,this._prepareUpload();case 3:return e.next=5,this._uploadFileXHR();case 5:return e.next=7,this._checkUploadProgress();case 7:return e.abrupt("return",e.sent);case 8:case"end":return e.stop()}}),e,this)})));return e})()},{key:"_prepareUpload",value:function(){var e=this;return new Promise(function(t,n){Object(l.a)(e.attachment.info,{onError:function(t){var r=t.info,o=t.additionalInfo,i=t.status,a=t.errorCode;e.attachment.status!==y.c.ABORTED&&Jane.ErrorLog.send(r,o),n({status:i,errorCode:a,additionalInfo:o})},onSuccess:t})})}},{key:"_uploadFileXHR",value:function(){var e=this;return new Promise(function(t,n){Object(p.a)(e.attachment.info,{onUploadProgress:e.patchedUploadProgress,onUploadComplete:t,onError:function(t){var r=t.info,o=t.additionalInfo,i=t.status,a=t.errorCode;e.attachment.status!==y.c.ABORTED&&Jane.ErrorLog.send(r,o),n({status:i,errorCode:a})}})})}},{key:"_checkUploadProgress",value:(function(){function e(){return t.apply(this,arguments)}var t=o(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.attachment.info.narod){e.next=2;break}return e.abrupt("return");case 2:return t=this._launchCheckStatusAnimation(),e.prev=3,e.next=6,this._getDiskProgress();case 6:return e.abrupt("return",e.sent);case 7:return e.prev=7,Object(b.c)(t),e.finish(7);case 10:case"end":return e.stop()}}),e,this,[[3,,7,10]])})));return e})()},{key:"_launchCheckStatusAnimation",value:function(){var e=this;return Object(b.a)((function(t){e.onUploadProgress(90+t)}),10)}},{key:"_getDiskProgress",value:function(){var e=this;return new Promise(function(t,n){var r=u.a.cloneDeep(e.attachment.info);Object(d.a)(r.narod,(function(){Object(f.a)(r,{onError:function(e){var t=e.info,o=e.status,i=e.errorCode,a=e.additionalInfo;Object(d.b)(r.narod||{}),Jane.ErrorLog.send(t,a),n({status:o,errorCode:i})},onUploadProgress:function(){},onUploadComplete:function(){Object(d.b)(r.narod||{}),t({info:r})}})}))})}}]),e})()},3432:function(e,t,n){"use strict";function r(e,t,n,r,o,i,a){try{var c=e[i](a),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,o)}function o(e){return function(){var t=this,n=arguments;return new Promise(function(o,i){function a(e){r(s,o,i,a,c,"next",e)}function c(e){r(s,o,i,a,c,"throw",e)}var s=e.apply(t,n);a(void 0)})}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function c(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),e}n.d(t,"a",(function(){return d}));var s=n(138),u=n.n(s),l=n(1267),p=n(1268),f=n(369),d=(function(){function e(t){var n=t.attachment,r=t.onUploadProgress;i(this,e),this.attachment=n,this.onUploadProgress=r}return c(e,[{key:"upload",value:(function(){function e(){return t.apply(this,arguments)}var t=o(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._uploadFileXHR();case 2:return e.next=4,this._processDirectUploadResponse();case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e,this)})));return e})()},{key:"_uploadFileXHR",value:function(){var e=this;return new Promise(function(t){e.xhr=Object(l.a)(e.attachment.info,{uploadUrl:e._getUploadUrl(),onUploadProgress:e.onUploadProgress,onUploadComplete:function(){return t()}})})}},{key:"_getUploadUrl",value:function(){return Daria.url.upload()}},{key:"_processDirectUploadResponse",value:function(){var e=this;return new Promise(function(t,n){var r=u.a.cloneDeep(e.attachment.info);Object(p.a)({info:r,previewSupported:e.attachment.previewSupported,xhr:e.xhr},{onAuthFail:function(){return Jane.doLogin("upload_attachment")},onError:function(t){var r=t.info,o=t.additionalInfo,i=t.status,a=t.errorCode;e.attachment.status!==f.c.ABORTED&&Jane.ErrorLog.send(r,o),n({status:i,errorCode:a})},onSuccess:function(){return t({info:r})}})})}}]),e})()},3433:function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}n.d(t,"a",(function(){return i}));var o=n(1778),i=(n.n(o),function e(t){var n=t.hasDisk,i=t.isCorp;r(this,e),this.maxTotalAttachmentsSize=i?40*o.MB_SIZE:24*o.MB_SIZE,this.maxSizeForSingleFile=n?2*o.GB_SIZE:this.maxTotalAttachmentsSize})},3434:function(e,t,n){"use strict";var r=n(138),o=n.n(r);t.a=function(e){return e?o.a.isArray(e)?e:[e]:[]}},3435:function(e,t,n){"use strict";function r(e,t,n,r,o,i,a){try{var c=e[i](a),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,o)}function o(e){return function(){var t=this,n=arguments;return new Promise(function(o,i){function a(e){r(s,o,i,a,c,"next",e)}function c(e){r(s,o,i,a,c,"throw",e)}var s=e.apply(t,n);a(void 0)})}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function c(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),e}n.d(t,"a",(function(){return s}));var s=(function(){function e(){i(this,e)}return c(e,[{key:"refreshCaptcha",value:(function(){function e(){return t.apply(this,arguments)}var t=o(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ns.forcedRequest("captcha").then((function(e){return e[0].data}));case 2:return t=e.sent,e.abrupt("return",{captchaKey:t.key,captchaUrl:t.url});case 4:case"end":return e.stop()}}),e)})));return e})()}]),e})()},3436:function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e}n.d(t,"a",(function(){return s}));var a=n(138),c=(n.n(a),n(367)),s=(function(){function e(t,n){var o=n.htmlProcessor;r(this,e),this.emptySend=t,this.processorService=o}return i(e,[{key:"isEmpty",value:function(e){return!e.to&&!e.cc&&!e.bcc&&this.isSubjectEmpty(e.subj)&&this._isSendEmpty(e.send)&&Object(a.isEmpty)(e.att_ids)&&Object(a.isEmpty)(e.parts)&&!e.disk_att&&Object(a.isEmpty)(e.lids)}},{key:"isSubjectEmpty",value:function(e){return!e||e==="(".concat(Object(c.default)("compose-react/Без_темы"),")")}},{key:"_isSendEmpty",value:function(e){return!e||this.processorService.processHtml(e)===this.processorService.processHtml(this.emptySend)}}]),e})()},3437:function(e,t,n){"use strict";function r(e){"@babel/helpers - typeof";return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}function c(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?s(e):t}function s(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}n.d(t,"a",(function(){return y}));var f=n(785),d=n(1271),y=(function(e){function t(){return o(this,t),c(this,u(t).apply(this,arguments))}return l(t,e),a(t,[{key:"messageSubject",get:function(){return Object(d.a)(this.mMessage||this.mThread)}},{key:"messageSubjectWithPrefix",get:function(){return Object(d.b)(this.mMessage||this.mThread)}}]),t})(f.a)},3438:function(e,t,n){"use strict";function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t,n,r,o,i,a){try{var c=e[i](a),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,o)}function c(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){function i(e){a(s,r,o,i,c,"next",e)}function c(e){a(s,r,o,i,c,"throw",e)}var s=e.apply(t,n);i(void 0)})}}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function l(e,t,n){return t&&u(e.prototype,t),n&&u(e,n),e}function p(e){return f.apply(this,arguments)}function f(){return f=c(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.ok){e.next=2;break}throw{status:t.status,statusText:t.statusText,text:t.statusText};case 2:return n={},e.prev=3,e.next=6,t.json();case 6:n=e.sent,e.next=12;break;case 9:throw e.prev=9,e.t0=e.catch(3),{status:t.status,statusText:"parsererror",text:e.t0&&e.t0.message||e.t0};case 12:if(Daria.parseLoginInfo(n)){e.next=14;break}throw{status:t.status,statusText:"no_auth"};case 14:if("ok"===n.status||n.limited){e.next=16;break}throw{status:n.status,statusText:n.message,limited:n.limited,response:n};case 16:if(!n.error){e.next=18;break}throw{status:t.status,statusText:n.error,response:n};case 18:return e.abrupt("return",n);case 19:case"end":return e.stop()}}),e,null,[[3,9]])}))),f.apply(this,arguments)}n.d(t,"a",(function(){return h}));var d=n(3439),y=n(3442),b=n(139),m=(n.n(b),{att_ids:null,bcc:"",captcha_entered:null,captcha_key:null,cc:"",charset:null,confirm_limit:null,current_folder:null,doit:null,fid:null,from_mailbox:null,from_name:null,get_abook:null,html:null,idcs:null,ids:[],ign_overwrite:null,initial_cc:"",initial_to:"",inreplyto:null,lids:[],mark_as:null,mark_ids:[],disk_att:null,nosave:null,nosend:null,notify_on_send:null,overwrite:null,parts:null,phone:null,references:null,remind_period:null,retpath:null,returl:null,saveDraft:null,save_symbol:b.WellKnownFolderSymbol.DRAFT,send:"",send_time:null,store_fid:null,store_name:null,strict_charset:null,style:null,subj:null,to:"",ttype:null,withUpdatedUndoAndDelayedErrorHandling:"yes"}),h=(function(){function e(){s(this,e)}return l(e,[{key:"makeRequest",value:(function(){function e(e){return t.apply(this,arguments)}var t=c(regeneratorRuntime.mark((function e(t){var n,r,i,a,c,s,u,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.data,r=t.send,i={_connection_id:Daria.Config.connection_id,_ckey:Daria.ckey,_uid:Daria.uid,_eexp:Daria.Config["eexp-boxes"]},a=o({},m,{},i,{},n),c=r?"send":"save",s="".concat(Daria.api["do-send"],"?_").concat(c,"=true"),u=Object(d.a)(a),e.prev=6,e.next=9,fetch(s,u);case 9:l=e.sent,e.next=15;break;case 12:e.prev=12,e.t0=e.catch(6),Object(y.a)({status:0,statusText:"",text:""},c);case 15:return e.prev=15,e.next=18,p(l);case 18:return e.abrupt("return",e.sent);case 21:e.prev=21,e.t1=e.catch(15),Object(y.a)(e.t1,c);case 24:case"end":return e.stop()}}),e,null,[[6,12],[15,21]])})));return e})()},{key:"removeMidFromFailedMessages",value:function(e){ns.Model.get("message-failed").removeMid(e)}}]),e})()},3439:function(e,t,n){"use strict";function r(e){return{method:"POST",mode:"no-cors",cache:"no-cache",credentials:"same-origin",redirect:"follow",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:i.a.stringify(e)}}t.a=r;var o=n(1780),i=n.n(o)},3442:function(e,t,n){"use strict";function r(e){"@babel/helpers - typeof";return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?a(e):t}function a(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function c(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}function s(e){var t="function"==typeof Map?new Map:void 0;return(s=function(e){function n(){return l(e,arguments,d(this).constructor)}if(null===e||!p(e))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,n)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),f(n,e)})(e)}function u(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function l(e,t,n){return l=u()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var o=Function.bind.apply(e,r),i=new o;return n&&f(i,n.prototype),i},l.apply(null,arguments)}function p(e){return-1!==Function.toString.call(e).indexOf("[native code]")}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function d(e){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function y(e,t){var n=e.status,r=e.statusText,o=e.text,i=e.response,a=b.SendError.INTERNAL_ERROR,c=a;throw"parsererror"===r?(c="bad_json",a=b.SendError.NO_DATA):"no_auth"===r||403===n?(c="NoAuth",a=b.SendError.ACCESS_DENIED):a=b.SendError.RETRYABLE_ERRORS.includes(r)?r:413===n?b.SendError.TOO_BIG_ATTACHMENTS:n>0?b.SendError.NO_DATA:n||b.SendError.NO_NETWORK,Jane.ErrorLog.send({errorType:"compose.http",status:c,statusText:r,ckey:ns.Model.get("account-information").get(".ckey")},o),"NoAuth"!==c?Jane.ErrorLog.send({errorType:"compose."+t+".failed",status:a,ckey:ns.Model.get("account-information").get(".ckey")}):Jane.doLogin("composeHandleRequestError"),new m(a,i)}t.a=y;var b=n(366),m=(n.n(b),(function(e){function t(e){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return o(this,t),n=i(this,d(t).call(this)),n.code=e,n.data=r,n}return c(t,e),t})(s(Error)))},3443:function(e,t,n){"use strict";var r=n(904),o=n.n(r);n.d(t,"a",(function(){return o.a}))},3444:function(e,t,n){"use strict";function r(e){return a(e)||i(e)||o()}function o(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function i(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function a(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}function c(e,t){return l(e)||u(e,t)||s()}function s(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function u(e,t){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)){var n=[],r=!0,o=!1,i=void 0;try{for(var a,c=e[Symbol.iterator]();!(r=(a=c.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==c.return||c.return()}finally{if(o)throw i}}return n}}function l(e){if(Array.isArray(e))return e}function p(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?p(Object(n),!0).forEach((function(t){d(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function d(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function y(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function b(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function m(e,t,n){return t&&b(e.prototype,t),n&&b(e,n),e}n.d(t,"a",(function(){return S}));var h=n(444),v=n(905),O=(n.n(v),n(138)),g=n.n(O),_={onlyFirstEmail:!0,joinName:!0,withContactEmailList:!0},S=(function(){function e(t,n){y(this,e),this.contactsStore=t,this.errorsService=n}return m(e,[{key:"loadContacts",value:function(e){var t=this;if(!e||!e.length)return Promise.resolve();var n=e.map((function(e){return e.email})).filter((function(e){return Jane.FormValidation.checkEmail(e||"")})),r=this._splitToChunks(n),o=r.map((function(e){var n=[t._createContactListRequest(e)];return Daria.Config.workspace&&n.push(t._createContactListRequest(e,{shared:1})),ns.request(n).then((function(n){return t._processContactListResponse(n,e)})).fail((function(e){return t._processContactLoadFailure(e)}))}));return Promise.all(o)}},{key:"_processContactLoadFailure",value:function(e){e&&e.invalid&&(e=new Error(JSON.stringify(ns.Model.collectErrorData(e.invalid)))),this.errorsService.sendException(v.CONTACT_LOAD_FAILED,e)}},{key:"loadContact",value:function(e){var t=this;if(!e)return Promise.resolve();var n=[this._createContactRequest(e.email)];return Daria.Config.workspace&&n.push(this._createContactRequest(e.email,{shared:1})),ns.request(n).then((function(n){return t._processContactResponse(n,e)}))}},{key:"_splitToChunks",value:function(e){var t=[],n=[],r=0;return e.forEach((function(e){e.length>=256||(r+=e.length+1,r>256&&(t.push(n),n=[],r=0),n.push(e))})),n.length&&t.push(n),t}},{key:"_createContactListRequest",value:function(e){return{id:"abook-contacts",params:f({},arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{emails:e.join(",")})}}},{key:"_createContactRequest",value:function(e){return{id:"abook-contact",params:f({},arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{email:e})}}},{key:"_processContactListResponse",value:function(e,t){var n=this,o=c(e,2),i=o[0],a=o[1],s=i.getContactsInfoByEmails(t,_);[].concat(r(a?a.getContactsInfoByEmails(t,f({},_,{shared:!0})):[]),r(s)).forEach((function(e){return n._processContact(e)}))}},{key:"_processContactResponse",value:function(e,t){var n=c(e,2),r=n[0],o=n[1],i=!g.a.isEmpty(r.getData()),a=i&&r.getContactInfo(_,{email:t.email}),s=o?o.getContactInfo(f({},_,{shared:!0}),{email:t.email}):null,u=s||a;return u?this._processContact(u):t}},{key:"_processContact",value:function(e){var t;t=e.emailList?e.emailList.map((function(t){return h.b.of(f({},e,{email:t}))})):[h.b.of(e)];var n=!0,r=!1,o=void 0;try{for(var i,a=t[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var c=i.value;this.contactsStore.writeContact(c)}}catch(e){r=!0,o=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw o}}return e}}]),e})()},3445:function(e,t,n){"use strict";var r=/[^a-zа-яё0-9]/i,o=/['"()<>]/g,i=/^[a-zа-яё0-9]/i,a=/[A-ZА-ЯЁ]/g;t.a=function(e,t){if(e&&(e=String(e),e=e.replace(o,""))){var n=e.split(r),c=n[0].match(a)||[];return c.length&&e.charAt(0).match(a)&&(c=c.slice(1)),e=t?e.charAt(0):-1!==e.indexOf("@")&&i.test(e)?e.charAt(0):2===n[0].length?n[0]:c.length?n[0].charAt(0)+c[0]:n.length>1?n[0].charAt(0)+n[1].charAt(0):n[0].charAt(0),e.toUpperCase()}}},3446:function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e}n.d(t,"a",(function(){return a}));var a=(function(){function e(){r(this,e)}return i(e,[{key:"getPassportDate",value:function(e){return Daria.getPassportDate(e)}},{key:"convertPassportDateToTimestamp",value:function(e){return Daria.convertPassportDateToTimestamp(e)}},{key:"now",get:function(){return new Date(Daria.now())}},{key:"passportNow",get:function(){return new Date(Daria.passportNow())}}]),e})()},3447:function(e,t,n){"use strict";function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t,n){return t&&c(e.prototype,t),n&&c(e,n),e}n.d(t,"a",(function(){return u}));var u=(function(){function e(){a(this,e)}return s(e,[{key:"sendException",value:function(e,t,n){Jane.ErrorLog.sendException(e,t,n)}},{key:"sendError",value:function(e,t){Jane.ErrorLog.send(o({errorType:e},t))}}]),e})()},3448:function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e}n.d(t,"a",(function(){return f}));var a=n(138),c=(n.n(a),n(1782)),s=n(397),u=n.n(s),l=400,p={leading:!0,trailing:!1},f=(function(){function e(){var t=this;r(this,e),this.events={save:new c.a,send:new c.a,exit:new c.a},this.setHandlerNode=function(e){t.handlerNode=e},this._onKeyDown=function(e){var n=Modernizr.mac?e.metaKey:e.ctrlKey;if(e.keyCode===u.a.ESC&&t._emitEventDebounced(t.events.exit,e),n)switch(e.keyCode){case u.a.S:t._emitEventDebounced(t.events.save,e);break;case u.a.ENTER:t._emitEventDebounced(t.events.send,e)}},this._emitEvent=function(e,n){t._stopEvent(n),e.emit()},this._stopEvent=function(e){e.preventDefault(),e.stopPropagation()},this.handlerNode=null,this._emitEventDebounced=Object(a.debounce)(this._emitEvent,l,p)}return i(e,[{key:"subscribe",value:function(){this.handlerNode&&this.handlerNode.addEventListener("keydown",this._onKeyDown,!0)}},{key:"unsubscribe",value:function(){this.handlerNode&&this.handlerNode.removeEventListener("keydown",this._onKeyDown,!0)}}]),e})()},3467:function(e,t,n){"use strict";function r(e){"@babel/helpers - typeof";return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}function c(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?s(e):t}function s(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}n.d(t,"a",(function(){return d}));var f=n(906),d=(function(e){function t(){return o(this,t),c(this,u(t).apply(this,arguments))}return l(t,e),a(t,[{key:"emit",value:function(){this._emit()}}]),t})(f.a)},3468:function(e,t,n){"use strict";function r(e){"@babel/helpers - typeof";return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}function c(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?s(e):t}function s(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}n.d(t,"a",(function(){return d}));var f=n(906),d=(function(e){function t(){return o(this,t),c(this,u(t).apply(this,arguments))}return l(t,e),a(t,[{key:"emit",value:function(){this._emit()}}]),t})(f.a)},3469:function(e,t,n){"use strict";function r(e){"@babel/helpers - typeof";return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}function c(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?s(e):t}function s(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}n.d(t,"a",(function(){return d}));var f=n(906),d=(function(e){function t(){return o(this,t),c(this,u(t).apply(this,arguments))}return l(t,e),a(t,[{key:"emit",value:function(){this._emit()}}]),t})(f.a)},3470:function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e}n.d(t,"a",(function(){return a}));var a=(function(){function e(){r(this,e),this._replacer=document.createElement("div")}return i(e,[{key:"initDataProcessor",value:function(e){this.dataProcessor=e}},{key:"resetDataProcessor",value:function(){this.dataProcessor=null}},{key:"processHtml",value:function(e){if(!e)return e;var t=this.dataProcessor?this.dataProcessor.toHtml(e):this._stripWhitespaces(e);return this._processHtml(t)}},{key:"_processHtml",value:function(e){this._replacer.innerHTML=e||"";var t=this._replacer.innerHTML;return this._replacer.innerHTML="",t}},{key:"_stripWhitespaces",value:function(e){return e&&e.replace(/\r|\n/gi,"").replace(/(<br\/>)|(&nbsp;)|\s/gi," ")}}]),e})()},3471:function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e}function a(e){return Boolean(e)}n.d(t,"a",(function(){return p}));var c=n(138),s=n.n(c),u=n(968),l=n(3472),p=(function(){function e(){r(this,e)}return i(e,[{key:"splitLabels",value:function(e){var t=this,n=e.map((function(e){return t.mLabels.getLabelById(e)})).filter(a),r=n.filter((function(e){return t.isUserLabel(e)}));return{userLabels:r,otherLabels:s.a.difference(n,r)}}},{key:"isUserLabel",value:function(e){return e&&(e.user||this.isImportantLabel(e))&&!this.isSystemLabel(e)}},{key:"isImportantLabel",value:function(e){var t=this.mLabels.getImportantLID();return e.lid===t}},{key:"isSystemLabel",value:function(e){return!!e&&(!e.user&&-1!==[this.waitingForReplyLabel,this.delayedMessageLabel].indexOf(e))}},{key:"labelColors",value:function(e){return Object(u.a)(e)}},{key:"getCreatedByUserLabels",value:function(){var e=this;return this.mLabels.models.map((function(e){return e.getData()})).filter((function(t){return e.isUserLabel(t)&&!e.isImportantLabel(t)}))}},{key:"subscribeLabelsChanged",value:function(e){return Object(l.a)(this.mLabels,e)}},{key:"refreshUserLabels",value:function(e){var t=this,n=this.mLabels.getLabelsHash();return e.map((function(e){return s.a.has(n,e.lid)&&t.mLabels.getLabelById(e.lid)})).filter(a)}},{key:"mLabels",get:function(){return ns.Model.get("labels")}},{key:"waitingForReplyLabel",get:function(){return this.mLabels.getWaitingForReplyLabel()}},{key:"delayedMessageLabel",get:function(){return this.mLabels.getDelayedMessageLabel()}},{key:"importantLabel",get:function(){var e=this;return this.mLabels.models.map((function(e){return e.getData()})).find((function(t){return e.isImportantLabel(t)}))}}]),e})()},3472:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(138),o=(n.n(r),function(e,t){var n=Object(r.debounce)(t,0);return e.on("ns-model-changed",n),function(){e.off("ns-model-changed",n)}})},3473:function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e}n.d(t,"a",(function(){return a}));var a=(function(){function e(){r(this,e)}return i(e,[{key:"_extractSection",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n={};return Object.keys(e).filter((function(e){return String(e).indexOf(t)>=0})).forEach((function(t){n[t]=e[t]})),n}},{key:"logValidationFail",value:function(e,t){var n=Daria&&Daria.Recipients&&Daria.Recipients._validityCache,r=Daria&&Daria.Recipients&&Daria.Recipients._cache,o=this._extractSection(n,e),i=this._extractSection(r,e),a={email:e,contact:t,validity:o,cache:i};Daria&&Daria.monitoring&&Daria.monitoring.contactValidation&&Daria.monitoring.contactValidation(a)}}]),e})()},3474:function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e}n.d(t,"a",(function(){return l}));var a=n(138),c=n.n(a),s=n(639),u=n(444),l=(function(){function e(){r(this,e),this.preventSuggest={to:!1,cc:!1,bcc:!1},this._suggestShownField=""}return i(e,[{key:"markSuggestShown",value:function(e){this._suggestShownField=e}},{key:"logSuggestUsage",value:function(e,t){var n=e.field,r=e.usedPosition,o=void 0===r?"":r,i=e.usedText,a=void 0===i?"":i;if(this.preventSuggest[n])return void(this.preventSuggest[n]=!1);var u=o>0;u&&(this.preventSuggest[n]=!0);var l={project:"search_mail",action:"suggest-compose",product:s.b,uid:Daria.uid,filed:n,field:n,suggest_used:u?"yes":"no",suggest_show:this._suggestShownField===n?"yes":"no",pos:o,count:t.contacts&&t.contacts.length||"",user_text:t.query,search_text:a};l.user_text=l.user_text?encodeURIComponent(l.user_text):"",l.search_text=l.search_text?encodeURIComponent(l.search_text):"",Daria.searchClickCounter(c.a.pairs(l).map((function(e){return e.join("=")}))),u&&this._reportAbookSuggest(t.contacts[o-1],t),this._suggestShownField=""}},{key:"_reportAbookSuggest",value:function(e,t){if(!c.a.startsWith(e.id,u.a)){var n={q:t.query||"",section:u.b.isGroupContact(e)?"group":"email",id:e.id.replace(/^(cid|mcid|tid|id)/,""),title:e.email};ns.forcedRequest("abook-suggest-report",n)}}}]),e})()},3475:function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e}n.d(t,"a",(function(){return c}));var a=n(360),c=(n.n(a),(function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r(this,e),this.params=t,this.base=this.params.isQuickReply?a.QUICK_REPLY:a.COMPOSE_METRIKA}return i(e,[{key:"sendMetrika",value:function(){var e;(e=Jane).c.apply(e,arguments)}},{key:"sendHeaderMetrika",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.sendMetrika.apply(this,[this.base,a.COMPOSE_METRIKA_HEADER].concat(t))}},{key:"sendRecipientsDiffMetrika",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.sendMetrika.apply(this,[this.base,a.COMPOSE_METRIKA_RECIPIENTS_DIFF].concat(t))}},{key:"sendWysiwigMetrika",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.sendMetrika.apply(this,[this.base,a.COMPOSE_METRIKA_WYSIWIG].concat(t))}},{key:"sendFooterMetrika",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.sendMetrika.apply(this,[this.base,a.COMPOSE_METRIKA_FOOTER].concat(t))}},{key:"sendAttachmentsMetrika",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.sendMetrika.apply(this,[a.COMPOSE_METRIKA_ATTACHMENTS].concat(t,[a.COMPOSE_METRIKA_ATTACHMENTS_PLACE]))}},{key:"sendPopupsMetrika",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.sendMetrika.apply(this,[this.base,a.COMPOSE_METRIKA_POPUPS].concat(t))}}]),e})())},3476:function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e}n.d(t,"a",(function(){return c}));var a=n(1782),c=(function(){function e(){var t=this;r(this,e),this.events={leaveBrowser:new a.b,leavePage:new a.c},this._onBrowserLeave=function(){return t.events.leaveBrowser.emit(),t.hasChanges?"Cannot leave: unsaved changes":void 0},this._onPageLeave=function(){return t.events.leavePage.emit(),!t.hasChanges},this._onNsBrowserLeave=function(){t.events.leaveBrowser.emit(),t.hasChanges&&Daria.addUnloadText("Cannot leave: unsaved changes")},this.hasChanges=!1}return i(e,[{key:"subscribe",value:function(){var e=this;return window.addEventListener("beforeunload",this._onBrowserLeave),ns.events.on("beforeunload",this._onNsBrowserLeave),ns.page.blockReload.add(this._onPageLeave),function(){return e.unsubscribe()}}},{key:"unsubscribe",value:function(){window.removeEventListener("beforeunload",this._onBrowserLeave),ns.events.off("beforeunload",this._onNsBrowserLeave),ns.page.blockReload.remove(this._onPageLeave)}}]),e})()},3477:function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e}n.d(t,"a",(function(){return a}));var a=(function(){function e(){r(this,e)}return i(e,[{key:"_getMessage",value:function(e){return ns.Model.get("message",{ids:e})}},{key:"removeDraft",value:function(e){Daria.MOPS["remove.draft"](this._getMessage(e).getMessagesCheckedModel())}}]),e})()},3478:function(e,t,n){"use strict";function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t,n){return t&&c(e.prototype,t),n&&c(e,n),e}function u(e){return e=Daria.Html2Text.text2html(e),e=f.a.unescape(e),Daria.Html2Text.html2text(e)}function l(e){for(var t=u(e),n=0;"\n"===t[n];)n++;return n}n.d(t,"a",(function(){return d}));var p=n(138),f=n.n(p),d=(function(){function e(){a(this,e),this._signs=null}return s(e,[{key:"_getRawSignatures",value:function(){return this._signs||(this._signs=Daria.signs.getHtml().map((function(e){return o({},e,{idx:e._idx,name:e.name||e.preview,html:e.convert,match:Daria.signs.getSignatureMatch(e.convert),leadingLineBreaks:l(e.convert)})}))),this._signs}},{key:"reset",value:function(){this._signs=null}},{key:"getSignatures",value:function(e,t){var n=Daria.signs.sort(e,t);return this._getRawSignatures().sort(n)}},{key:"getMatches",value:function(){return f.a.unique(this._getRawSignatures().map((function(e){return{match:e.match,leadingLineBreaks:e.leadingLineBreaks}})))}}]),e})()},3479:function(e,t,n){"use strict";function r(e,t,n,r,o,i,a){try{var c=e[i](a),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,o)}function o(e){return function(){var t=this,n=arguments;return new Promise(function(o,i){function a(e){r(s,o,i,a,c,"next",e)}function c(e){r(s,o,i,a,c,"throw",e)}var s=e.apply(t,n);a(void 0)})}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function c(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),e}n.d(t,"a",(function(){return s}));var s=(function(){function e(){i(this,e)}return c(e,[{key:"getSmartSubjects",value:(function(){function e(e){return t.apply(this,arguments)}var t=o(regeneratorRuntime.mark((function e(t){var n,r,o,i,a,c,s,u,l,p;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.position,r=t.messageId,o=t.threadId,i=t.text,a=t.addresses,c=t.attaches,s=Daria.Html2Text.html2text(i),e.next=4,ns.Model.get("compose-smartsubject",{position:n,message_id:r,thread_id:o}).getItemsData({text:s,addresses:a,attaches:c});case 4:return u=e.sent,l=u.items,p=u.requestId,e.abrupt("return",{items:l,requestId:p});case 8:case"end":return e.stop()}}),e)})));return e})()}]),e})()},3480:function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e}n.d(t,"a",(function(){return u}));var a=n(1271),c=n(139),s=(n.n(c),n(1779)),u=(function(){function e(t){var n=t.contactsFormatter;r(this,e),this.contactsFormatter=n}return i(e,[{key:"loadTemplates",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{count:20},n=t.first,r=t.count,o=void 0===r?20:r;return this._getTemplatesModel({first:n,count:o}).then((function(t){var n=t.models.map(e._mapModel);return{canLoadMore:t.canLoadMore(),items:n}}),(function(){return{canLoadMore:!1,items:[]}}))}},{key:"_getTemplatesModel",value:function(e){var t=e.count,n=e.first,r=this._getTemplatesFolderFid();return r?ns.request([{id:"messages",params:{current_folder:r,sort_type:"date",first:n,count:t}}]).then((function(e){return e[0]})):Promise.reject("No templates folder")}},{key:"_getTemplatesFolderFid",value:function(){return ns.Model.get("folders").getFidBySymbol(c.WellKnownFolderSymbol.TEMPLATE)}},{key:"_mapModel",value:function(e){return{key:e.key,subject:Object(a.a)(e),mid:e.get(".mid")}}},{key:"loadTemplateData",value:function(e,t){var n=this;return ns.request(["message","message-body"],{ids:e,draft:!0}).then((function(r){var o=r[0],i=r[1];return{mid:e,subject:Object(a.b)(o),messageBody:i.getDraftBody(t),addresses:{to:n.contactsFormatter.parseContacts(i.getAddressField("to")),cc:n.contactsFormatter.parseContacts(i.getAddressField("cc")),bcc:n.contactsFormatter.parseContacts(i.getAddressField("bcc"))},attachments:i.getAttachments().filter((function(e){return!e.inline})).map((function(t){return t=_.extend({},t,{from_template:!0,template_mid:e,template_hid:t.hid}),delete t.hid,Object(s.a)(i,t)}))}}))}},{key:"ensureTemplatesFolder",value:function(){var e=ns.Model.get("folders"),t=e.getFidBySymbol(c.WellKnownFolderSymbol.TEMPLATE);return t?Promise.resolve(t):e.createTemplateFolder().then((function(e){return e.fid}))}}]),e})()},3481:function(e,t,n){"use strict";function r(e,t,n,r,o,i,a){try{var c=e[i](a),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,o)}function o(e){return function(){var t=this,n=arguments;return new Promise(function(o,i){function a(e){r(s,o,i,a,c,"next",e)}function c(e){r(s,o,i,a,c,"throw",e)}var s=e.apply(t,n);a(void 0)})}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function c(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),e}n.d(t,"a",(function(){return u}));var s="translate-langs",u=(function(){function e(t){var n=t.composeParams;i(this,e),this.currentTranslationPromise=null,this.composeParamsService=n,this.languages=ns.Model.get(s)}return c(e,[{key:"init",value:(function(){function e(){return t.apply(this,arguments)}var t=o(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ns.request(s);case 2:case"end":return e.stop()}}),e)})));return e})()},{key:"translate",value:(function(){function e(e,n,r){return t.apply(this,arguments)}var t=o(regeneratorRuntime.mark((function e(t,n,r){var o,i,a,c,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return",{translation:"",langFrom:n,langTo:r});case 2:return o={text:t,lang:r,format:"html"},n&&r&&(o.lang="".concat(n,"-").concat(r)),this.currentTranslationPromise=ns.request("do-translate",o),e.next=7,this.currentTranslationPromise;case 7:return i=e.sent,this.currentTranslationPromise=null,a=i.filter((function(e){return"do-translate"===e.id}))[0],c=(a.get(".text")||[]).join(""),s=a.get(".detected.lang"),e.abrupt("return",{translation:c,langFrom:n||s,langTo:r});case 13:case"end":return e.stop()}}),e,this)})));return e})()},{key:"getLanguageName",value:function(e){return this.languages&&this.languages.getName(e)}},{key:"getRecents",value:function(){return this.languages&&this.languages.getRecent()}},{key:"getLangs",value:function(){return this.languages&&this.languages.getLangs()}},{key:"setRecent",value:function(e){this.languages&&this.languages.setRecent(e)}},{key:"getDefaultLanguageFrom",value:function(e){var t;return this.composeParamsService.isReplyAny&&(t=Daria.Translate.getLangByMid(this.composeParamsService.params.ids)),!t&&e.length&&(t=Daria.Translate.defineLanguage(e)),t||(t=Daria.Config.locale),t}},{key:"getDefaultLanguageTo",value:function(e){var t=Daria.Translate.getDefaultLangTo(e);return t||(e!==Daria.Config.locale?Daria.Config.locale:"ru"!==e?"ru":"en")}},{key:"getHelpUrl",value:function(){return Daria.Config["help-url"]+"/web/letter/translation.html#translation-outgoing"}}]),e})()},3482:function(e,t,n){"use strict";function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}n.d(t,"a",(function(){return c}));var c=(function(){function e(){o(this,e),this.isAbookPopupReady=!1}return a(e,[{key:"initAbookPopup",value:function(){var e=this;return this.isAbookPopupReady?Promise.resolve():Jane.Services.runModules(["abook.css","abook.js","abook.yate"]).then((function(){return e.isAbookPopupReady=!0}))}},{key:"showAbookPopup",value:function(e){var t=e.field,n=e.contacts;return this.initAbookPopup().then((function(){var e=r({},t,n.map((function(e){return{email:e.email,name:e.name}}))),o=new vow.Deferred;return ns.action.run("mail-common.abook-popup",{popupType:"select",emails:e,resultDeferred:o}),o.promise()}))}}]),e})()},3483:function(e,t,n){"use strict";function r(e,t,n,r){i||(i="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,a=arguments.length-3;if(t||0===a||(t={children:void 0}),1===a)t.children=r;else if(a>1){for(var c=new Array(a),s=0;s<a;s++)c[s]=arguments[s+3];t.children=c}if(t&&o)for(var u in o)void 0===t[u]&&(t[u]=o[u]);else t||(t=o||{});return{$$typeof:i,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function o(e){var t=e.manager,n=e.services,o=e.controllers,i=e.node,a=Daria.locale||"ru";return s.a.render(r(u.Provider,{state:t,services:n,controllers:o},void 0,r(l.default,{lang:a},void 0,f)),i),function(){s.a.unmountComponentAtNode(i),i.remove()}}t.a=o;var i,a=n(137),c=(n.n(a),n(141)),s=n.n(c),u=n(353),l=n(386),p=n(3484),f=r(p.a,{})},3484:function(e,t,n){"use strict";function r(){return r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},r.apply(this,arguments)}function o(e){"@babel/helpers - typeof";return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){return u(e)||s(e,t)||c()}function c(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function s(e,t){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)){var n=[],r=!0,o=!1,i=void 0;try{for(var a,c=e[Symbol.iterator]();!(r=(a=c.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==c.return||c.return()}finally{if(o)throw i}}return n}}function u(e){if(Array.isArray(e))return e}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function p(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function f(e,t,n){return t&&p(e.prototype,t),n&&p(e,n),e}function d(e,t){return!t||"object"!==o(t)&&"function"!=typeof t?b(e):t}function y(e){return(y=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function b(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function m(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&h(e,t)}function h(e,t){return(h=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function v(e,t,n,r){A||(A="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=r;else if(i>1){for(var a=new Array(i),c=0;c<i;c++)a[c]=arguments[c+3];t.children=a}if(t&&o)for(var s in o)void 0===t[s]&&(t[s]=o[s]);else t||(t=o||{});return{$$typeof:A,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function O(e,t,n,r){n&&Object.defineProperty(e,t,{enumerable:n.enumerable,configurable:n.configurable,writable:n.writable,value:n.initializer?n.initializer.call(r):void 0})}function g(e,t,n,r,o){var i={};return Object.keys(r).forEach((function(e){i[e]=r[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce((function(n,r){return r(e,t,n)||n}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}n.d(t,"a",(function(){return ie}));var _,S,E,P,C,w,T,k,R,A,j=n(137),M=n.n(j),I=n(348),D=n.n(I),N=n(138),L=n.n(N),x=n(350),z=n.n(x),B=n(28),F=n(363),U=n(351),K=n(353),H=n(356),W=n(382),G=n(3485),Y=n(399),q=(n.n(Y),n(1787)),V=n(3882),Q=n(1854),J=n.n(Q),X=n(1276),Z=n(3894),ee=n(397),te=n.n(ee),ne=n(3909),re=(n.n(ne),"ComposeManager"),oe={Block:re,hidden:"".concat(re,"_hidden"),visible:"".concat(re,"_visible"),PopupCompose:"".concat(re,"-PopupCompose"),PopupCompose_hidden:"".concat(re,"-PopupCompose_hidden")},ie=(_=Object(K.inject)("state"),S=Object(K.inject)("controllers"),E=U.observable.ref,_(P=S(P=Object(K.observer)((R=k=(function(e){function t(){var e,n;l(this,t);for(var o=arguments.length,i=new Array(o),c=0;c<o;c++)i[c]=arguments[c];return n=d(this,(e=y(t)).call.apply(e,[this].concat(i))),n._disposer=new W.a,O(b(n),"containerRef",w,b(n)),n._currentOpenComposes=[],O(b(n),"setContainerRef",T,b(n)),n._renderComposeMeta=function(e,t){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=o.className,c=o.actions,s=void 0===c?{}:c,u=s.onClose,l=s.onExpand,p=s.onCollapse,f=[["expandCompose",l],["collapseCompose",p],["closeCompose",u]].reduce((function(e,r){var o=a(r,2),i=o[0],c=o[1],s=n.props.state[i];return e[i]=function(){return s(t)&&c&&c()},e}),{});return M.a.createElement(V.a,r({mode:e,metaState:t,className:i},f))},n.renderCompose=function(e){var t,r,o=!e.maximized;return e.size===Y.ComposeSizes.LARGE&&(t=n.props.controllers.dimensions.composeWidth,r=n.props.controllers.dimensions.composeRight),v(J.a,{scope:n.containerRef,size:e.size,cls:o?oe.PopupCompose_hidden:"",visible:!o,onClose:function(t){return n.onClose(t,e)},Body:function(){return v(X.a,{cls:oe.PopupCompose,metaState:e})},width:t,right:r,enableFocusTrap:!n.isAbookPopupOpened},e.id)},n.onClose=function(e,t){n.isAbookPopupOpened||e.keyCode!==te.a.ESC&&(!n.containerRef||n.containerRef.contains(e.target))||n.props.state.collapseCompose(t)},n.renderCollapsedComposeAsThumb=function(e){return n._renderComposeMeta(Y.ComposeMode.COLLAPSED,e)},n.renderCollapsedComposeAsMenuItem=function(e,t,r){var o={className:t,actions:{onExpand:r}};return n._renderComposeMeta(Y.ComposeMode.COLLAPSED,e,o)},n.renderDoneScreen=function(){var e=n.props.state,t=e.isShowingDoneScreen,r=e.lastSentTime,o=e.closeDoneScreen,i=e.suggestedBeautifulEmail;return t?v(Z.a,{beautifulEmail:i,visible:t,onClose:o,sendTime:r}):null},n}return m(t,e),f(t,[{key:"componentDidMount",value:function(){var e=this;B.default.log("promo: ComposeManager mounted"),this._disposer.add(this,[Object(U.reaction)((function(){return e.hasMinimizedComposes}),(function(t){return e._updatePageClasses(t)})),Object(U.reaction)((function(){return e.hasExpandedCompose}),(function(t){return e._onComposeExpandedStateChanged(t)}),{fireImmediately:!0})]),this._updatePageClasses(this.hasMinimizedComposes)}},{key:"runPromoManager",value:function(e){e&&(Object(F.getPromozavrBridge)()&&Object(F.getPromozavrBridge)().show("compose"),this._disposer.dispose("promo"))}},{key:"componentWillUnmount",value:function(){this._disposer.dispose(this),this.hasExpandedCompose&&this._onComposeExpandedStateChanged(!1)}},{key:"_updatePageClasses",value:function(e){Object(H.updatePageClasses)(i({},"mail-Page_with_Collapsed_Composes",e))}},{key:"_onComposeExpandedStateChanged",value:function(e){e?$.Shortcuts.modalListPush("compose-react"):$.Shortcuts.modalListPop("compose-react"),Object(F.getPromozavrBridge)()&&Object(F.getPromozavrBridge)().reportComposeState(e)}},{key:"render",value:function(){var e=this.props.state.stack,t=e.composeMetaStates.some((function(e){return e.minimized})),n=this.openComposes.find((function(e){return e.maximized})),r=n&&n.size||Y.ComposeSizes.LARGE,o=z()(oe.Block,t?oe.visible:oe.hidden,"".concat(oe.Block,"_size_").concat(r));return M.a.createElement("div",{className:o,ref:this.setContainerRef},this.renderDoneScreen(),this.openComposes.map(this.renderCompose),e&&v(G.a,{composeMetaStates:e.composeMetaStates,thumbItemView:this.renderCollapsedComposeAsThumb,menuItemView:this.renderCollapsedComposeAsMenuItem}))}},{key:"hasMinimizedComposes",get:function(){var e=this.props.state;return e.stack&&e.stack.composeMetaStates.some((function(e){return e.minimized}))}},{key:"hasExpandedCompose",get:function(){return Boolean(this.props.state.currentCompose)}},{key:"isAbookPopupOpened",get:function(){return this.props.controllers.abookPopup.isAbookPopupOpened}},{key:"openComposes",get:function(){var e=this.props.state,t=e.currentCompose,n=e.stack;return this._currentOpenComposes=L.a.intersection(this._currentOpenComposes,n.composeMetaStates),t&&-1===this._currentOpenComposes.indexOf(t)&&this._currentOpenComposes.push(t),this._currentOpenComposes}}]),t})(M.a.Component),k.propTypes={state:D.a.instanceOf(q.a),services:D.a.object,controllers:D.a.object},C=R,w=g(C.prototype,"containerRef",[E],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),g(C.prototype,"hasMinimizedComposes",[U.computed],Object.getOwnPropertyDescriptor(C.prototype,"hasMinimizedComposes"),C.prototype),g(C.prototype,"hasExpandedCompose",[U.computed],Object.getOwnPropertyDescriptor(C.prototype,"hasExpandedCompose"),C.prototype),g(C.prototype,"isAbookPopupOpened",[U.computed],Object.getOwnPropertyDescriptor(C.prototype,"isAbookPopupOpened"),C.prototype),g(C.prototype,"openComposes",[U.computed],Object.getOwnPropertyDescriptor(C.prototype,"openComposes"),C.prototype),T=g(C.prototype,"setContainerRef",[U.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){e.containerRef=t}}}),P=C))||P)||P)||P)},3485:function(e,t,n){"use strict";function r(e){"@babel/helpers - typeof";return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}function c(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?s(e):t}function s(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function f(e,t,n,r){O||(O="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=r;else if(i>1){for(var a=new Array(i),c=0;c<i;c++)a[c]=arguments[c+3];t.children=a}if(t&&o)for(var s in o)void 0===t[s]&&(t[s]=o[s]);else t||(t=o||{});return{$$typeof:O,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}n.d(t,"a",(function(){return M}));var d,y,b,m,h,v,O,g=n(137),_=n.n(g),S=n(348),E=n.n(S),P=n(353),C=n(351),w=n(3486),T=n(3493),k=(n.n(T),n(3494)),R=n(1786),A=n(360),j=(n.n(A),{Container:"ComposeStack",Item:"ComposeStack-Item"}),M=(d=Object(P.inject)("services"),y=Object(P.inject)("controllers"),d(b=y(b=Object(P.observer)((v=h=(function(e){function t(){var e,n;o(this,t);for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return n=c(this,(e=u(t)).call.apply(e,[this].concat(i))),n._renderThumbs=function(e,t){var r=n.props.thumbItemView;return e.map((function(e){return f(w.b,{title:e.miniData.subject,minimized:e.minimized,inmenu:t.indexOf(e)>-1,className:j.Item},e.id,r(e))}))},n._renderMenu=function(e){var t=n.props.menuItemView,r=n.props.controllers.dimensions.windowHeight;return f(w.a,{composeMetaStates:e,className:j.Item,maxHeight:Math.min(r,R.a),onToggle:n.onMenuToggle,onDraftsLinkClick:n.onMenuDraftsLinkClick},void 0,t)},n.onMenuToggle=function(){n.metrikaService.sendHeaderMetrika(A.COMPOSE_METRIKA_HEADER_TOGGLE_STACK)},n.onMenuDraftsLinkClick=function(){n.metrikaService.sendHeaderMetrika(A.COMPOSE_METRIKA_HEADER_STACK_DRAFTS_LINK)},n}return l(t,e),a(t,[{key:"componentDidMount",value:function(){var e=this.props.controllers,t=e.dimensions,n=e.settings;t.subscribe(),n.subscribe()}},{key:"componentWillUnmount",value:function(){var e=this.props.controllers,t=e.dimensions,n=e.settings;t.unsubscribe(),n.unsubscribe()}},{key:"render",value:function(){var e=this.props.composeMetaStates;if(!e.length)return null;var t={},n=this.props.controllers.dimensions.rightSpace,r=this.props.controllers.settings,o=r.timelineEnabled,i=r.timelineExpanded,a=r.todoEnabled,c=n;t.maxWidth="".concat(n,"px"),o&&i&&(t.bottom="".concat(R.e,"px")),!a||o&&i||(c=n-R.f-R.d,t.right="".concat(R.f+R.d,"px"),t.maxWidth="".concat(c,"px"));var s=Object(k.a)(e,c),u=s.toShow,l=s.toMenu;return f("div",{className:j.Container,style:t},void 0,l.length?this._renderMenu(l):null,u.length?this._renderThumbs(u.reverse(),l):null)}},{key:"metrikaService",get:function(){return this.props.services.metrika}}]),t})(_.a.Component),h.propTypes={thumbItemView:E.a.func.isRequired,menuItemView:E.a.func.isRequired,composeMetaStates:P.PropTypes.observableArray.isRequired,services:E.a.object.isRequired,controllers:E.a.object.isRequired},m=v,(function(e,t,n,r,o){var i={};return Object.keys(r).forEach((function(e){i[e]=r[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce((function(n,r){return r(e,t,n)||n}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i})(m.prototype,"metrikaService",[C.computed],Object.getOwnPropertyDescriptor(m.prototype,"metrikaService"),m.prototype),b=m))||b)||b)||b)},3486:function(e,t,n){"use strict";var r=n(3487);n.d(t,"b",(function(){return r.a}));var o=n(3489);n.d(t,"a",(function(){return o.a}));n(3491)},3487:function(e,t,n){"use strict";function r(e){"@babel/helpers - typeof";return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function c(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),e}function s(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?u(e):t}function u(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function p(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function d(e,t,n,r){y||(y="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=r;else if(i>1){for(var a=new Array(i),c=0;c<i;c++)a[c]=arguments[c+3];t.children=a}if(t&&o)for(var s in o)void 0===t[s]&&(t[s]=o[s]);else t||(t=o||{});return{$$typeof:y,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}n.d(t,"a",(function(){return E}));var y,b=n(137),m=n.n(b),h=n(348),v=n.n(h),O=n(350),g=n.n(O),_=n(3488),S=(n.n(_),{Block:"ComposeStackThumb",Block_collapsed:"ComposeStackThumb_collapsed",Content:"ComposeStackThumb-Content"}),E=(function(e){function t(){return i(this,t),s(this,l(t).apply(this,arguments))}return p(t,e),c(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.minimized,r=t.inmenu,i=t.className,a=g()(i,S.Block,o({},S.Block_collapsed,!n||r));return m.a.createElement("div",{className:a,ref:function(t){return e.thumb=t}},d("div",{className:S.Content},void 0,this.props.children))}}]),t})(m.a.Component);E.propTypes={minimized:v.a.bool.isRequired,inmenu:v.a.bool.isRequired,className:v.a.string}},3488:function(e,t){},3489:function(e,t,n){"use strict";function r(e){"@babel/helpers - typeof";return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function c(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),e}function s(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?u(e):t}function u(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function p(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function d(e,t,n,r){y||(y="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=r;else if(i>1){for(var a=new Array(i),c=0;c<i;c++)a[c]=arguments[c+3];t.children=a}if(t&&o)for(var s in o)void 0===t[s]&&(t[s]=o[s]);else t||(t=o||{});return{$$typeof:y,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}n.d(t,"a",(function(){return C}));var y,b=n(137),m=n.n(b),h=n(348),v=n.n(h),O=n(350),g=n.n(O),_=n(3490),S=(n.n(_),n(427)),E=n(352),P={Block:"ComposeStackMenu",Block_active:"ComposeStackMenu_active",Content:"ComposeStackMenu-Content",Title:"ComposeStackMenu-Title",TitleText:"ComposeStackMenu-TitleText",TitleIcon:"ComposeStackMenu-TitleIcon",Marker:"ComposeStackMenu-Marker",Items:"ComposeStackMenu-Items",Item:"ComposeStackMenu-Item",ItemContent:"ComposeStackMenu-ItemContent",ItemContent_active:"ComposeStackMenu-ItemContent_active",DraftLink:"ComposeStackMenu-DraftLink",DraftIcon:"ComposeStackMenu-DraftIcon",DraftTitle:"ComposeStackMenu-DraftTitle"},C=(function(e){function t(){var e,n;i(this,t);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return n=s(this,(e=l(t)).call.apply(e,[this].concat(o))),n.state={isOpened:!1},n.close=function(){n.setState({isOpened:!1})},n.onToggle=function(e){e.stopPropagation(),n.setState((function(e){return{isOpened:!e.isOpened}}));var t=n.props.onToggle;t&&t()},n.handleClickOutside=function(e){n.blockRef&&!n.blockRef.contains(e.target)&&n.close()},n}return p(t,e),c(t,[{key:"componentDidMount",value:function(){document.addEventListener("click",this.handleClickOutside,!0)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("click",this.handleClickOutside,!0)}},{key:"_renderItem",value:function(e){var t=g()(P.ItemContent,o({},P.ItemContent_active,!e.minimized));return d("div",{className:P.Item},e.id,this.props.children(e,t,this.close))}},{key:"_renderItems",value:function(e){var t=this;return this.state.isOpened?d("div",{className:P.Items},void 0,e.map((function(e){return t._renderItem(e)}))):null}},{key:"render",value:function(){var e=this,t=this.props,n=t.composeMetaStates,r=t.maxHeight,i=this.state.isOpened,a=Math.min(r,this.thumbHeight+5.5*this.itemHeight),c=g()(P.Block,o({},P.Block_active,i)),s={};if(i){var u=Math.min(a,this.thumbHeight+this.itemHeight*n.length);s.height=u,s.bottom=u-this.thumbHeight}return m.a.createElement("div",{className:c,style:s,ref:function(t){return e.blockRef=t}},d("div",{className:P.Content},void 0,this._renderItems(n)),d("div",{className:g()(P.Title),onClick:this.onToggle},void 0,d("span",{className:P.TitleText},void 0,this.renderTitle()),d(S.a,{cls:P.TitleIcon,id:"mail--ComposeManager-Arrow"})))}},{key:"renderTitle",value:function(){var e=this.props.composeMetaStates;return d(E.default,{loc:"compose-react/ComposesMenu_DraftsMoreN",params:{count:e.length}})}},{key:"itemHeight",get:function(){return 36}},{key:"thumbHeight",get:function(){return 36}}]),t})(m.a.PureComponent);C.propTypes={composeMetaStates:v.a.array.isRequired,maxHeight:v.a.number.isRequired,onToggle:v.a.func,onDraftsLinkClick:v.a.func}},3490:function(e,t){},3491:function(e,t,n){"use strict";function r(){return r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},r.apply(this,arguments)}var o=n(137),i=n.n(o),a=n(348),c=n.n(a),s=n(138),u=(n.n(s),n(657)),l=n(3492),p=(n.n(l),function(e){var t=e.isShown,n=e.title,o=e.anchorNode,a={target:"anchor",directions:["top-left","top-right"],size:"m",autoclosable:!0,theme:"normal",onClose:s.noop};return o&&i.a.createElement(u.a,r({cls:"composeTooltip"},a,{anchor:o,visible:t}),n)});p.propTypes={anchorNode:c.a.instanceOf(Element),isShown:c.a.bool.isRequired,title:c.a.string.isRequired}},3492:function(e,t){},3493:function(e,t){},3494:function(e,t,n){"use strict";function r(e,t){if(e.reduce((function(e,t){return e+i(t)}),0)<=t)return{toShow:e,toMenu:[]};var n=t-o.b-o.d,r=e.reduce((function(e,t){var r=e.toShow,o=e.toMenu,a=e.space;return a+=i(t),r.push(t),a>n&&o.push(t),{toShow:r,toMenu:o,space:a}}),{toShow:[],toMenu:[],space:0});return{toShow:r.toShow,toMenu:r.toMenu}}t.a=r;var o=n(1786),i=function(e){return e.minimized?o.c:0}},3495:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EXPANDED=t.COLLAPSED=void 0,t.COLLAPSED="collapsed",t.EXPANDED="expanded"},3496:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LARGE=t.SMALL=void 0,t.SMALL="small",t.LARGE="large"},3497:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MINIMIZE=t.MAXIMIZE_SMALL=t.MAXIMIZE=t.CLOSE=void 0,t.CLOSE="close",t.MAXIMIZE="maximize",t.MAXIMIZE_SMALL="maximize_small",t.MINIMIZE="collapse"},3498:function(e,t,n){"use strict";var r=n(3499),o=n(3539);n.d(t,"b",(function(){return r.a})),n.d(t,"a",(function(){return o.a}))},3499:function(e,t,n){"use strict";function r(e){"@babel/helpers - typeof";return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t,n,r,o,i,a){try{var c=e[i](a),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,o)}function i(e){return function(){var t=this,n=arguments;return new Promise(function(r,i){function a(e){o(s,r,i,a,c,"next",e)}function c(e){o(s,r,i,a,c,"throw",e)}var s=e.apply(t,n);a(void 0)})}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t,n){return t&&c(e.prototype,t),n&&c(e,n),e}function u(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?l(e):t}function l(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function f(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&d(e,t)}function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}n.d(t,"a",(function(){return v}));var y=n(1788),b=n(3535),m=n(3536),h=n(1796),v=(function(e){function t(e){var n;return a(this,t),n=u(this,p(t).call(this,e)),n.receiver=new m.a(e),n.composeState=new y.a(n.receiver,e.size),n.sender=new h.a(n.composeState),n}return f(t,e),s(t,[{key:"disconnect",value:function(){this.composeState.disconnect()}},{key:"setCurrentScenario",value:(function(){function e(e){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.composeState.data.currentScenario=t;case 1:case"end":return e.stop()}}),e,this)})));return e})()},{key:"getMiniData",value:(function(){function e(){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.composeState.getMiniData());case 1:case"end":return e.stop()}}),e,this)})));return e})()}]),t})(b.a)},3500:function(e,t,n){"use strict";function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t,n,r,o,i,a){try{var c=e[i](a),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,o)}function c(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){function i(e){a(s,r,o,i,c,"next",e)}function c(e){a(s,r,o,i,c,"throw",e)}var s=e.apply(t,n);i(void 0)})}}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function l(e,t,n){return t&&u(e.prototype,t),n&&u(e,n),e}function p(e,t,n,r){n&&Object.defineProperty(e,t,{enumerable:n.enumerable,configurable:n.configurable,writable:n.writable,value:n.initializer?n.initializer.call(r):void 0})}function f(e,t,n,r,o){var i={};return Object.keys(r).forEach((function(e){i[e]=r[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce((function(n,r){return r(e,t,n)||n}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}n.d(t,"a",(function(){return W}));var d,y,b,m,h,v,O,g,_,S=n(138),E=(n.n(S),n(351)),P=n(3501),C=n(3503),w=n(3504),T=n(1790),k=n(1791),R=n(3533),A=n(382),j=n(1282),M=n(3534),I=n(900),D=n(355),N=n.n(D),L=n(1187),x=n.n(L),z=n(399),B=(n.n(z),n(425)),F=n(384),U=n(466),K=(n.n(U),n(681)),H=n(636),W=(n.n(H),d=E.observable.ref,_=g=(function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:z.ComposeSizes.LARGE;s(this,e),p(this,"data",b,this),p(this,"_params",m,this),p(this,"_predefinedData",h,this),p(this,"changeWorkMode",v,this),p(this,"changeSize",O,this),this.id=Object(S.uniqueId)("compose_state_"),this._dataLoaded=!1,this._disposer=new A.a,this.environmentAdapter=t,this.stores=null,this.services=null,this.controllers=null,this.visual=new P.a(n),this.validation=null,this.setData(null)}return l(e,[{key:"setData",value:function(e){if(!this.data)return void(this.data=e);Object.assign(this.data,e)}},{key:"connect",value:function(){var e=!0,t=!1,n=void 0;try{for(var r,o=Object.getOwnPropertyNames(this.controllers)[Symbol.iterator]();!(e=(r=o.next()).done);e=!0){var i=r.value;this.controllers[i].init&&this.controllers[i].init()}}catch(e){t=!0,n=e}finally{try{e||null==o.return||o.return()}finally{if(t)throw n}}}},{key:"disconnect",value:function(){if(this.controllers){var e=!0,t=!1,n=void 0;try{for(var r,o=Object.getOwnPropertyNames(this.controllers)[Symbol.iterator]();!(e=(r=o.next()).done);e=!0){var i=r.value;this.controllers[i].destroy()}}catch(e){t=!0,n=e}finally{try{e||null==o.return||o.return()}finally{if(t)throw n}}}}},{key:"setInitParams",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.params,n=e.predefinedData;this._params=t,this._predefinedData=n}},{key:"fill",value:(function(){function e(){return t.apply(this,arguments)}var t=c(regeneratorRuntime.mark((function e(){var t,n,r,o,i,a,c,s,u,l,p,f,d,y,b;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Object(S.isEmpty)(this.data)){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,this.loadData();case 4:t=e.sent,this._dataLoaded||console.warn("Не смогли загрузить данные для письма"),n=this.visual,r=new C.a,o=new w.a,i=new T.a(o,this),i.composeParams.newMessageId=Object(j.a)(t),a=i.settings.lang,N.a.locale(x.a[a]),c=i.composeParams,s=c.fromName,u=c.fromEmails,l=this.createInputComposeData(i),p=function(e){return{email:e,name:l.from_name||s}},f=p(l.from_mailbox),d=i.signatures.getSignatures(f,a)[0],y=new R.a(f,l,d||null),b=new k.a({services:i,stores:o,environmentAdapter:this.environmentAdapter,visualState:n,data:y,validation:r}),o.addressesFrom.addresses=u.map(p),Object.assign(this,{stores:o,services:i,controllers:b,validation:r}),this.connect(),this.fillData(y);case 24:case"end":return e.stop()}}),e,this)})));return e})()},{key:"createInputComposeData",value:function(e){var t=e.composeParams.messageData,n=o({},t,{},Object(S.omit)(this.predefinedData,"send"),{},Object(I.a)(t));return e.checkEmptyDraft.isSubjectEmpty(n.subj)&&(n.subj=""),["to","cc","bcc","initial_to","initial_cc"].forEach((function(t){n[t]=e.contactsFormatter.parseContacts(n[t])})),n}},{key:"getMiniData",value:function(){var e=this.data||{addresses:{to:[],cc:[],bcc:[]}},t={subject:e.subject,addresses:e.addresses,lastSaved:e.lastSaved};return Object(E.toJS)(t,{recurseEverything:!0})}},{key:"fillData",value:function(e){this.setData(e),this.checkIfAdditionalAddressIsExpanded(),this.isDraft=this.services.composeParams.isDraft(),this.visual.expandedFields={to:!this.services.composeParams.isReplyAny(),cc:!1,bcc:!1}}},{key:"checkIfAdditionalAddressIsExpanded",value:function(){var e=Boolean(Object(S.get)(this,"data.addresses.cc.length")),t=Boolean(Object(S.get)(this,"data.addresses.bcc.length")),n=Object(S.get)(this,"data.addresses.from.email"),r=this.visual,o=r.currentPromo,i=r.promoData,a=o===U.PROMO_COMPOSE_SUGGEST_BEAUTIFUL_EMAIL||Boolean(o===U.PROMO_COMPOSE_BEAUTIFUL_EMAIL&&n&&Object(H.areEmailsEqual)(n,i));this.visual.additionalAddressesAreExpanded=e||t||a}},{key:"loadData",value:(function(){function e(){return t.apply(this,arguments)}var t=c(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._dataLoaded){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,e.next=5,Object(M.a)(this.params);case 5:return t=e.sent,this._dataLoaded=!0,e.abrupt("return",t);case 10:e.prev=10,e.t0=e.catch(2),this._dataLoaded=!1;case 13:case"end":return e.stop()}}),e,this,[[2,10]])})));return e})()},{key:"saveData",value:(function(){function e(){return t.apply(this,arguments)}var t=c(regeneratorRuntime.mark((function e(){var t,n=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.controllers&&this.data){e.next=2;break}return e.abrupt("return",{canContinue:!0});case 2:return this.data.currentScenario&&(this.data.currentScenario.qualityMetrics=function(){return n.controllers.compose.getQualityMetrics(n.data)}),e.next=5,this.controllers.checkUnsavedChanges.checkUnsavedChanges();case 5:return t=e.sent,e.abrupt("return",Object(S.omit)(t,"savePromise"));case 7:case"end":return e.stop()}}),e,this)})));return e})()},{key:"_getChangeSizeParams",value:function(e){return this.controllers&&this.controllers.compose?this.controllers.compose.getParamsForQualityMetrics():{usedSmall:e===z.ComposeSizes.SMALL}}},{key:"setCurrentPromo",value:function(e,t){this.visual.setCurrentPromo(e,t),e&&this.checkIfAdditionalAddressIsExpanded()}},{key:"params",get:function(){return{ids:this.isDraft&&this.data&&this.data.overwriteIds||this._params.ids,tids:this._params.tids,oper:this._params.oper,isQuickReply:this._params.isQuickReply,qrAttaches:this._params.qrAttaches||[]}}},{key:"predefinedData",get:function(){return this._predefinedData}},{key:"providedState",get:function(){return Object(S.pick)(this,this.constructor.PROVIDED_PROPS)}}]),e})(),g.PROVIDED_PROPS=["data","visual","controllers","services","stores","validation"],y=_,b=f(y.prototype,"data",[E.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),f(y.prototype,"setData",[E.action],Object.getOwnPropertyDescriptor(y.prototype,"setData"),y.prototype),m=f(y.prototype,"_params",[d],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),f(y.prototype,"params",[E.computed],Object.getOwnPropertyDescriptor(y.prototype,"params"),y.prototype),h=f(y.prototype,"_predefinedData",[E.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),f(y.prototype,"predefinedData",[E.computed],Object.getOwnPropertyDescriptor(y.prototype,"predefinedData"),y.prototype),f(y.prototype,"fillData",[E.action],Object.getOwnPropertyDescriptor(y.prototype,"fillData"),y.prototype),f(y.prototype,"checkIfAdditionalAddressIsExpanded",[E.action],Object.getOwnPropertyDescriptor(y.prototype,"checkIfAdditionalAddressIsExpanded"),y.prototype),f(y.prototype,"providedState",[E.computed],Object.getOwnPropertyDescriptor(y.prototype,"providedState"),y.prototype),v=f(y.prototype,"changeWorkMode",[E.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){var n=t.mode;e.visual.workMode=n}}}),O=f(y.prototype,"changeSize",[E.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){if(e.visual.size!==t){var n=B.a.getActiveScenario(F.b);n&&n.logStep(t===z.ComposeSizes.SMALL?K.b:K.c,e._getChangeSizeParams(t)),e.visual.size=t,t===z.ComposeSizes.SMALL&&(e.visual.translate.isEnabled=!1)}}}}),y)},3501:function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e}function a(e,t,n,r){n&&Object.defineProperty(e,t,{enumerable:n.enumerable,configurable:n.configurable,writable:n.writable,value:n.initializer?n.initializer.call(r):void 0})}function c(e,t,n,r,o){var i={};return Object.keys(r).forEach((function(e){i[e]=r[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce((function(n,r){return r(e,t,n)||n}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}n.d(t,"a",(function(){return j}));var s,u,l,p,f,d,y,b,m,h,v,O,g,_,S,E,P,C,w,T=n(351),k=n(366),R=(n.n(k),n(3502)),A=n(399),j=(n.n(A),s=w=(function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:A.ComposeSizes.LARGE;r(this,e),a(this,"isLocked",u,this),a(this,"isSending",l,this),a(this,"additionalAddressesAreExpanded",p,this),a(this,"topContentInFixedMode",f,this),a(this,"currentPopup",d,this),a(this,"refs",y,this),a(this,"yabbleMenuPopup",b,this),a(this,"contactsSuggest",m,this),a(this,"subjectsSuggest",h,this),a(this,"translate",v,this),a(this,"workMode",O,this),this.isInIframe=Object(R.a)(),a(this,"size",g,this),a(this,"hasChanges",_,this),a(this,"currentPromo",S,this),a(this,"promoData",E,this),a(this,"focusedField",P,this),a(this,"expandedFields",C,this),this.size=t}return i(e,[{key:"setCurrentPromo",value:function(e,t){this.currentPromo=e,this.promoData=t}},{key:"composeContainerRef",get:function(){return{current:this.refs.composeContainer}}}]),e})(),u=c(s.prototype,"isLocked",[T.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),l=c(s.prototype,"isSending",[T.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),p=c(s.prototype,"additionalAddressesAreExpanded",[T.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),f=c(s.prototype,"topContentInFixedMode",[T.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),d=c(s.prototype,"currentPopup",[T.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),y=c(s.prototype,"refs",[T.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e,t,n,r,o,i,a;return e=T.observable.ref,t=T.observable.ref,n=T.observable.ref,r={composeContainer:null,composeScrollableContainer:null,topContent:null},c(r,"composeContainer",[e],(o=Object.getOwnPropertyDescriptor(r,"composeContainer"),o=o?o.value:void 0,{enumerable:!0,configurable:!0,writable:!0,initializer:function(){return o}}),r),c(r,"composeScrollableContainer",[t],(i=Object.getOwnPropertyDescriptor(r,"composeScrollableContainer"),i=i?i.value:void 0,{enumerable:!0,configurable:!0,writable:!0,initializer:function(){return i}}),r),c(r,"topContent",[n],(a=Object.getOwnPropertyDescriptor(r,"topContent"),a=a?a.value:void 0,{enumerable:!0,configurable:!0,writable:!0,initializer:function(){return a}}),r),r}}),b=c(s.prototype,"yabbleMenuPopup",[T.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{field:""}}}),m=c(s.prototype,"contactsSuggest",[T.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{contacts:[],canShowSuggest:!0,type:"",query:"",field:""}}}),h=c(s.prototype,"subjectsSuggest",[T.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{requestId:"",suggestItems:[],suggestType:""}}}),v=c(s.prototype,"translate",[T.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{isEnabled:!1,translateFrom:"",translateTo:"",translation:"",translationsInProgress:0}}}),O=c(s.prototype,"workMode",[T.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return k.WorkModes.FOREGROUND}}),g=c(s.prototype,"size",[T.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return A.ComposeSizes.LARGE}}),_=c(s.prototype,"hasChanges",[T.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),S=c(s.prototype,"currentPromo",[T.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),E=c(s.prototype,"promoData",[T.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),P=c(s.prototype,"focusedField",[T.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),C=c(s.prototype,"expandedFields",[T.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),c(s.prototype,"setCurrentPromo",[T.action],Object.getOwnPropertyDescriptor(s.prototype,"setCurrentPromo"),s.prototype),c(s.prototype,"composeContainerRef",[T.computed],Object.getOwnPropertyDescriptor(s.prototype,"composeContainerRef"),s.prototype),s)},3502:function(e,t,n){"use strict";function r(){try{return window.self!==window.top}catch(e){return!0}}t.a=r},3503:function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e}function a(e,t,n,r){n&&Object.defineProperty(e,t,{enumerable:n.enumerable,configurable:n.configurable,writable:n.writable,value:n.initializer?n.initializer.call(r):void 0})}function c(e,t,n,r,o){var i={};return Object.keys(r).forEach((function(e){i[e]=r[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce((function(n,r){return r(e,t,n)||n}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}n.d(t,"a",(function(){return m}));var s,u,l,p,f,d,y=n(351),b=n(138),m=(n.n(b),s=y.observable.ref,u=d=(function(){function e(){r(this,e),a(this,"errors",l,this),a(this,"sendError",p,this),a(this,"limitedRecipients",f,this)}return i(e,[{key:"getAddressError",value:function(){var e=Object(b.head)(Object(b.filter)(this.errors,{fieldName:"addresses"}));if(e)return"incorrect_".concat(e.additionalFieldNames[0])}}]),e})(),l=c(u.prototype,"errors",[s],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),p=c(u.prototype,"sendError",[y.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),f=c(u.prototype,"limitedRecipients",[y.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),u)},3504:function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}n.d(t,"a",(function(){return i}));var o=n(1789),i=function e(){r(this,e),this.addressesFrom=new o.b,this.contacts=new o.a}},3505:function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e}n.d(t,"a",(function(){return a}));var a=(function(){function e(){r(this,e),this._addresses=null}return i(e,[{key:"addresses",get:function(){if(!this._addresses)throw new TypeError("FromAddressStore `addresses` field should be inited before call.");return this._addresses},set:function(e){this._addresses=e}}]),e})()},3506:function(e,t,n){"use strict";function r(e){"@babel/helpers - typeof";return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function c(e,t,n,r,o,i,a){try{var c=e[i](a),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,o)}function s(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){function i(e){c(s,r,o,i,a,"next",e)}function a(e){c(s,r,o,i,a,"throw",e)}var s=e.apply(t,n);i(void 0)})}}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function p(e,t,n){return t&&l(e.prototype,t),n&&l(e,n),e}function f(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?y(e):t}function d(e){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function y(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function b(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&m(e,t)}function m(e,t){return(m=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function h(e,t,n,r){n&&Object.defineProperty(e,t,{enumerable:n.enumerable,configurable:n.configurable,writable:n.writable,value:n.initializer?n.initializer.call(r):void 0})}function v(e,t,n,r,o){var i={};return Object.keys(r).forEach((function(e){i[e]=r[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce((function(n,r){return r(e,t,n)||n}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}n.d(t,"a",(function(){return G}));var O,g,_,S,E,P,C,w=n(351),T=n(903),k=n(529),R=n(1278),A=n(1279),j=n(369),M=n(1280),I=n(791),D=n(1777),N=n(393),L=n.n(N),x=n(679),z=n(1792),B=n(905),F=(n.n(B),n(496)),U=(n.n(F),n(360)),K=(n.n(U),5),H=95,W=[j.c.FAILED,j.c.VIRUS,j.c.RESTRICTED],G=(O=C=(function(e){function t(e){var n;return u(this,t),n=f(this,d(t).call(this,e)),h(y(n),"forwardedMessages",g,y(n)),n.adjustProgress=Object(D.b)({from:0,to:100},{from:K,to:H}),h(y(n),"_maybeShowErrorsPopup",_,y(n)),h(y(n),"onUploadProgress",S,y(n)),h(y(n),"onUploadSuccess",E,y(n)),h(y(n),"onUploadFailure",P,y(n)),n._mapForwardedMessage=function(e){var t={status:j.c.COMPLETED,previewSupported:!1,info:{id:e.mid,mid:e.mid,type:j.d.FORWARDED_MAIL,name:e.subject}};return t.visual=n.services.attachments.getRenderData(t),t},n.initPromise=n.initAttachments().catch((function(e){n.services.errors.sendException(B.ATTACHMENTS_INITIALIZATION_FAILED,e)})).then((function(){return n.subscribeToFieldsChanged()})),n}return b(t,e),p(t,[{key:"subscribeToFieldsChanged",value:function(){var e=this;this._disposer.add(this,[Object(w.reaction)((function(){return e.validAttachments.length}),(function(){return e.environmentAdapter.onFieldChanged({fieldName:"attachments"})}))])}},{key:"isValidAttachment",value:function(e){return!W.includes(e.status)}},{key:"createSendData",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=t.map((function(t){return e.services.attachments.getDataForSend(t)})),r=this._extractDataByField(n,(function(e){return e.disk})),o=n.filter((function(e){return e.from_template})).map((function(e){return{mid:e.template_mid,hid:e.template_hid}})),i={att_ids:this._extractDataByField(n,(function(e){return e.att_id})),parts:this._extractDataByField(n,(function(e){return e.hid})),parts_json:o.length?JSON.stringify(o):"",disk_att:r.length?JSON.stringify(r):"",ids:this._extractDataByField(n,(function(e){return e.ids}))},a=this._extractDataByField(n,(function(e){return e.ids}));return a.length&&(i.mark_ids=a),i}},{key:"_extractDataByField",value:function(e,t){return e.map(t).filter((function(e){return Boolean(e)}))}},{key:"attachFilesMixed",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=e.filter((function(e){return e.source===j.b.LOCAL})).map((function(e){return e.data})),n=e.filter((function(e){return e.source===j.b.DISK})).map((function(e){return e.data}));this.attachFilesFromDisk(n),this.attachFilesFromLocal(t)}},{key:"attachFilesFromLocal",value:function(e){var t=this;if(this.services.composeParams.params.isQuickReply){var n=Array.from(e).map(Object(w.action)((function(e){return{source:j.b.LOCAL,data:e}})));return this.controllers.quickReply.goToFullCompose({qrAttaches:n})}e.forEach(Object(w.action)((function(e){var n=Object(T.a)({file:e});n.source=j.b.LOCAL,n.info.type=j.d.FILE,n.visual=t.services.attachments.getRenderData(n),t.attachments.push(n)}))),this._processNextFileInQueue()}},{key:"attachFilesFromDisk",value:function(e){var t=this;if(this.services.composeParams.params.isQuickReply){var n=Array.from(e).map(Object(w.action)((function(e){return{source:j.b.DISK,data:e}})));return this.controllers.quickReply.goToFullCompose({qrAttaches:n})}e.forEach(Object(w.action)((function(e){var n=Object(R.a)(e),r=Object(T.a)(n);r.source=j.b.DISK,r.status=j.c.NEW,r.visual=t.services.attachments.getRenderData(r),t.attachments.push(r)}))),this._processNextFileInQueue()}},{key:"_getTotalAttachmentsSize",value:function(){return this.attachments.reduce((function(e,t){return t.status===j.c.COMPLETED&&t.info.type!==j.d.YADISK?e+Object(k.a)(t.info):e}),0)}},{key:"_processAttachmentSize",value:function(e,t){var n=Object(k.a)(e.info);if(n>this.services.attachments.limits.maxSizeForSingleFile)throw{status:j.c.FAILED,errorCode:j.e.FILE_LIMIT};if(t+n>this.services.attachments.limits.maxTotalAttachmentsSize){if(this.services.attachments.hasDisk)return j.d.YADISK;throw{status:j.c.FAILED,errorCode:j.e.TOTAL_LIMIT}}return j.d.FILE}},{key:"_processNextFileInQueue",value:(function(){function e(){return t.apply(this,arguments)}var t=s(regeneratorRuntime.mark((function e(){var t,n,r,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=this._findNextFileInQueue())){e.next=17;break}return e.prev=2,e.next=5,this._processAttachment(t);case 5:n=e.sent,this.onUploadSuccess(i({attachment:t},n)),e.next=14;break;case 9:e.prev=9,e.t0=e.catch(2),r=e.t0.status||j.c.FAILED,o=e.t0.errorCode||j.e.UNKNOWN,this.onUploadFailure({attachment:t,status:r,errorCode:o});case 14:this._processNextFileInQueue(),e.next=18;break;case 17:this._maybeShowErrorsPopup();case 18:case"end":return e.stop()}}),e,this,[[2,9]])})));return e})()},{key:"_findNextFileInQueue",value:function(){var e=!0,t=!1,n=void 0;try{for(var r,o=this.attachments[Symbol.iterator]();!(e=(r=o.next()).done);e=!0){var i=r.value;if(i.status===j.c.UPLOADING)return!1;if(i.status===j.c.NEW)return i}}catch(e){t=!0,n=e}finally{try{e||null==o.return||o.return()}finally{if(t)throw n}}return null}},{key:"_processAttachment",value:(function(){function e(e){return t.apply(this,arguments)}var t=s(regeneratorRuntime.mark((function e(t){var n,r,o,i=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=function(e){return i.onUploadProgress({attachment:t,progress:e})},t.source!==j.b.DISK){e.next=6;break}return this.onUploadStarted({attachment:t}),e.next=5,this.services.attachments.attachFromDisk({attachment:t,onUploadProgress:n});case 5:return e.abrupt("return",e.sent);case 6:if(r=this._getTotalAttachmentsSize(),(o=this._processAttachmentSize(t,r))!==j.d.YADISK||!this.controllers.compose.isPddRestricted){e.next=10;break}throw{status:j.c.RESTRICTED};case 10:if(this.onUploadStarted({attachment:t,type:o}),t.info.type!==j.d.YADISK){e.next=15;break}return e.next=14,this.services.attachments.fileUploadWithDisk({attachment:t,onUploadProgress:n});case 14:return e.abrupt("return",e.sent);case 15:return e.next=17,this.services.attachments.fileUploadDirect({attachment:t,onUploadProgress:n});case 17:return e.abrupt("return",e.sent);case 18:case"end":return e.stop()}}),e,this)})));return e})()},{key:"onUploadStarted",value:function(e){var t=e.attachment,n=e.type;n&&(t.info.type=n),t.progress=0,t.status=j.c.UPLOADING}},{key:"removeNotValidAttachments",value:function(){this.attachments=this.validAttachments}},{key:"initAttachments",value:(function(){function e(){return t.apply(this,arguments)}var t=s(regeneratorRuntime.mark((function e(){var t,n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.attachments=this.services.attachments.loadInitialAttachments(),t=this.services.composeParams.params||{},n=t.qrAttaches,n&&n.length&&this.attachFilesMixed(n),e.next=5,this.services.attachments.getForwardedMessagesAttachData();case 5:r=e.sent,this.setForwardedMessages(r),r.length>1&&this.updateAttachments(r.map(this._mapForwardedMessage));case 8:case"end":return e.stop()}}),e,this)})));return e})()},{key:"setForwardedMessages",value:function(e){this.forwardedMessages=e}},{key:"updateAttachments",value:function(e){var t=this;e.reverse().forEach(Object(w.action)((function(e){t.attachments.unshift(e)})))}},{key:"updateAfterSave",value:function(e,t,n){e.forEach(Object(w.action)((function(e){Object(M.a)(e.info,t,n)})))}},{key:"getSummaryForLog",value:function(e){return Object(A.a)(e)}},{key:"addForwardAsAttachment",value:(function(){function e(){return t.apply(this,arguments)}var t=s(regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.services.attachments.getForwardedMessagesAttachData();case 2:t=e.sent,n=t.map(this._mapForwardedMessage),this.addAttachments(n);case 5:case"end":return e.stop()}}),e,this)})));return e})()},{key:"addAttachments",value:function(e){var t=this;e.forEach(Object(w.action)((function(e){t.data.attachments.push(e)})))}},{key:"attachments",get:function(){return this.data.attachments},set:function(e){this.data.attachments=e}},{key:"isUploadedAll",get:function(){return!this.attachments.some((function(e){return e.status===j.c.NEW||e.status===j.c.UPLOADING}))}},{key:"hasPendingAttachments",get:function(){return this.attachments.some((function(e){return e.status!==j.c.COMPLETED}))}},{key:"hasRestrictedAttachments",get:function(){return this.attachments.some((function(e){return e.status===j.c.RESTRICTED}))}},{key:"validAttachments",get:function(){return this.attachments.filter(this.isValidAttachment)}},{key:"notValidAttachments",get:function(){var e=this;return this.attachments.filter((function(t){return!e.isValidAttachment(t)}))}},{key:"forwardMailAttachments",get:function(){return this.attachments.filter((function(e){return e.info.type===j.d.FORWARDED_MAIL}))}},{key:"uploadedCount",get:function(){return this.validAttachments.filter((function(e){return e.status===j.c.COMPLETED})).length}},{key:"yaDiskCount",get:function(){return this.validAttachments.filter((function(e){return e.info.type===j.d.YADISK})).length}}]),t})(L.a),g=v(O.prototype,"forwardedMessages",[w.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),v(O.prototype,"attachments",[w.computed],Object.getOwnPropertyDescriptor(O.prototype,"attachments"),O.prototype),v(O.prototype,"isUploadedAll",[w.computed],Object.getOwnPropertyDescriptor(O.prototype,"isUploadedAll"),O.prototype),v(O.prototype,"hasPendingAttachments",[w.computed],Object.getOwnPropertyDescriptor(O.prototype,"hasPendingAttachments"),O.prototype),v(O.prototype,"hasRestrictedAttachments",[w.computed],Object.getOwnPropertyDescriptor(O.prototype,"hasRestrictedAttachments"),O.prototype),v(O.prototype,"validAttachments",[w.computed],Object.getOwnPropertyDescriptor(O.prototype,"validAttachments"),O.prototype),v(O.prototype,"notValidAttachments",[w.computed],Object.getOwnPropertyDescriptor(O.prototype,"notValidAttachments"),O.prototype),v(O.prototype,"forwardMailAttachments",[w.computed],Object.getOwnPropertyDescriptor(O.prototype,"forwardMailAttachments"),O.prototype),v(O.prototype,"uploadedCount",[w.computed],Object.getOwnPropertyDescriptor(O.prototype,"uploadedCount"),O.prototype),v(O.prototype,"yaDiskCount",[w.computed],Object.getOwnPropertyDescriptor(O.prototype,"yaDiskCount"),O.prototype),v(O.prototype,"attachFilesFromLocal",[w.action],Object.getOwnPropertyDescriptor(O.prototype,"attachFilesFromLocal"),O.prototype),v(O.prototype,"attachFilesFromDisk",[w.action],Object.getOwnPropertyDescriptor(O.prototype,"attachFilesFromDisk"),O.prototype),_=v(O.prototype,"_maybeShowErrorsPopup",[w.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){if(e.notValidAttachments.length){if(e.hasRestrictedAttachments)return e.controllers.compose.showPddRestrictPopup();e.visualState.currentPopup=F.ATTACHMENTS_ERROR,e.notValidAttachments.forEach(Object(w.action)((function(t){e.services.metrika.sendPopupsMetrika(U.COMPOSE_METRIKA_POPUPS_ATTACHMENTS_ERRORS,U.COMPOSE_METRIKA_POPUPS_ATTACHMENTS_ERRORS_SHOW,z.c[t.errorCode||x.UNKNOWN])})))}}}}),v(O.prototype,"onUploadStarted",[w.action],Object.getOwnPropertyDescriptor(O.prototype,"onUploadStarted"),O.prototype),S=v(O.prototype,"onUploadProgress",[w.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){var n=t.attachment,r=t.progress;r=e.adjustProgress(r),n.status===j.c.UPLOADING&&(n.progress=r)}}}),E=v(O.prototype,"onUploadSuccess",[w.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){var n=t.attachment,r=t.info;n.status=j.c.COMPLETED,r&&(r.size=Object(k.a)(r),n.info=r,n.visual=e.services.attachments.getRenderData(n)),n.previewSupported&&Object(I.a)(n.info)}}}),P=v(O.prototype,"onUploadFailure",[w.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return function(e){var t=e.attachment,n=e.status,r=e.errorCode;t.status=n||j.c.FAILED,t.errorCode=r}}}),v(O.prototype,"setForwardedMessages",[w.action],Object.getOwnPropertyDescriptor(O.prototype,"setForwardedMessages"),O.prototype),v(O.prototype,"updateAttachments",[w.action],Object.getOwnPropertyDescriptor(O.prototype,"updateAttachments"),O.prototype),v(O.prototype,"updateAfterSave",[w.action],Object.getOwnPropertyDescriptor(O.prototype,"updateAfterSave"),O.prototype),v(O.prototype,"addAttachments",[w.action],Object.getOwnPropertyDescriptor(O.prototype,"addAttachments"),O.prototype),O)},3507:function(e,t,n){"use strict";function r(e){"@babel/helpers - typeof";return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}function c(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?s(e):t}function s(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}n.d(t,"a",(function(){return b}));var f=n(393),d=n.n(f),y=1e4,b=(function(e){function t(e){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:y;return o(this,t),n=c(this,u(t).call(this,e)),n._autosave=function(){n.controllers.saveSend.saveMessage()},n.periodMs=r,n}return l(t,e),a(t,[{key:"init",value:function(){this.startAutosave()}},{key:"startAutosave",value:function(){this._isAutoSaveEnabled&&!this.interval&&(this.interval=setInterval(this._autosave,this.periodMs))}},{key:"autosave",value:function(){this._isAutoSaveEnabled&&this._autosave()}},{key:"stopAutosave",value:function(){this.interval&&(clearInterval(this.interval),delete this.interval)}},{key:"destroy",value:function(){this.stopAutosave()}},{key:"_isAutoSaveEnabled",get:function(){return!this.services.composeParams.isTemplate()}}]),t})(d.a)},3508:function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e}n.d(t,"a",(function(){return u}));var a=n(138),c=(n.n(a),n(444)),s=100,u=(function(){function e(t){var n=this;r(this,e),this._cache={},this._queue=[],this._requestAvatars=function(){var e=n._queue.splice(0);n.avatarsService.loadAvatars(e).then(n._processAvatarsResults)},this._processAvatarsResults=function(e){e.forEach(n._processAvatarResult)},this._processAvatarResult=function(e){var t=e.contact,r=e.avatar;if(t){var o=n._getCacheId(t),i=n._cache[o];i.result=r,i.resolve(r),delete i.resolve,delete i.reject,delete i.promise}},this.avatarsService=t,this._requestAvatars=Object(a.debounce)(this._requestAvatars,s)}return i(e,[{key:"getAvatarForContact",value:function(e){if(c.b.isGroupContact(e))return Promise.resolve(e.avatar);var t=this._getCacheId(e),n=this._cache[t]||{};return n.result?Promise.resolve(n.result):n.promise?n.promise:(this._cache[t]=n,n.promise=new Promise(function(e,t){n.resolve=e,n.reject=t}),this._queue.push(e),this._requestAvatars(),n.promise)}},{key:"_getCacheId",value:function(e){var t=e.email,n=e.name;return"".concat(t," <").concat(n,">")}},{key:"destroy",value:function(){this._queue=[]}}]),e})()},3509:function(e,t,n){"use strict";function r(e){"@babel/helpers - typeof";return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t,n,r,o,i,a){try{var c=e[i](a),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,o)}function i(e){return function(){var t=this,n=arguments;return new Promise(function(r,i){function a(e){o(s,r,i,a,c,"next",e)}function c(e){o(s,r,i,a,c,"throw",e)}var s=e.apply(t,n);a(void 0)})}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t,n){return t&&c(e.prototype,t),n&&c(e,n),e}function u(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?l(e):t}function l(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function f(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&d(e,t)}function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function y(e,t,n,r,o){var i={};return Object.keys(r).forEach((function(e){i[e]=r[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce((function(n,r){return r(e,t,n)||n}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}n.d(t,"a",(function(){return C}));var b,m=n(351),h=n(425),v=n(384),O=n(792),g=n(366),_=(n.n(g),n(366)),S=(n.n(_),n(393)),E=n.n(S),P=n(360),C=(n.n(P),b=(function(e){function t(){return a(this,t),u(this,p(t).apply(this,arguments))}return f(t,e),s(t,[{key:"checkUnsavedChanges",value:(function(){function e(){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.sendData=this.serializationController.createSendData(),!this.saveSendController.isSaving){e.next=3;break}return e.abrupt("return",this._saveAndContinue());case 3:if(!this._hasChanges()){e.next=7;break}return e.abrupt("return",this._continueUnSavedChanges());case 7:return e.abrupt("return",this._continueSavedChanges());case 8:case"end":return e.stop()}}),e,this)})));return e})()},{key:"_continueSavedChanges",value:function(){return this._isEmpty()?this._removeAndContinue():this._continueNoChanges()}},{key:"_removeAndContinue",value:function(){return this.controllers.deleteDraft.deleteDraft(),this._finishScenarioIfCurrent(O.e),{canContinue:!0,resolution:_.ResolutionTypes.DRAFT_REMOVED}}},{key:"_continueNoChanges",value:function(){return this._finishScenarioIfCurrent(O.c),{canContinue:!0,resolution:_.ResolutionTypes.NO_CHANGES}}},{key:"_continueUnSavedChanges",value:(function(){function e(){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,this._isEmpty()&&!this.attachmentsController.hasPendingAttachments){e.next=3;break}return e.abrupt("return",this._saveAndContinue());case 3:if(!this.saveSendController.isSaved){e.next=8;break}return e.next=6,this._promptRemoveDraft();case 6:return t=e.sent,e.abrupt("return",t?this._removeAndContinue():this._continueWithoutSaving());case 8:return e.abrupt("return",this._removeAndContinue());case 11:return e.prev=11,e.t0=e.catch(0),e.abrupt("return",{canContinue:!1});case 14:case"end":return e.stop()}}),e,this,[[0,11]])})));return e})()},{key:"_continueWithoutSaving",value:function(){return this._finishScenarioIfCurrent(O.b),{canContinue:!0,resolution:_.ResolutionTypes.DRAFT_NOT_SAVED}}},{key:"_saveAndContinue",value:function(){var e=this,t=this.saveSendController.saveMessage().then((function(){return O.f}),(function(){return O.d})).then((function(t){return e._finishScenarioIfCurrent(t)}));return{canContinue:!0,resolution:_.ResolutionTypes.DRAFT_SAVED,savePromise:t}}},{key:"_promptRemoveDraft",value:function(){return this.promptRemoveDraftPromise||(this.promptRemoveDraftPromise=this._makePromptRemoveDraftPromise()),this.promptRemoveDraftPromise}},{key:"_makePromptRemoveDraftPromise",value:function(){var e=this;return this._showConfirmRemovePopup(),new Promise(function(t,n){e.resolveRemoveDraftPromise=t,e.rejectRemoveDraftPromise=n})}},{key:"_showConfirmRemovePopup",value:function(){this.visualState.currentPopup=g.Popups.CONFIRM_REMOVE,this.autoSaveController.stopAutosave(),this.metrikaService.sendPopupsMetrika(P.COMPOSE_METRIKA_POPUPS_CONFIRM_REMOVE,P.COMPOSE_METRIKA_POPUPS_CONFIRM_REMOVE_SHOW)}},{key:"_closeConfirmRemovePopup",value:function(){this.visualState.currentPopup="",this.autoSaveController.startAutosave(),this.promptRemoveDraftPromise=null,this.resolveRemoveDraftPromise=null,this.rejectRemoveDraftPromise=null}},{key:"confirmRemoveDraft",value:function(){this.resolveRemoveDraftPromise(!0),this._closeConfirmRemovePopup(),this.metrikaService.sendPopupsMetrika(P.COMPOSE_METRIKA_POPUPS_CONFIRM_REMOVE,P.COMPOSE_METRIKA_POPUPS_CONFIRM_REMOVE_ACTION)}},{key:"rejectRemoveDraft",value:function(){this.resolveRemoveDraftPromise(!1),this._closeConfirmRemovePopup(),this.metrikaService.sendPopupsMetrika(P.COMPOSE_METRIKA_POPUPS_CONFIRM_REMOVE,P.COMPOSE_METRIKA_POPUPS_CONFIRM_REMOVE_CANCEL)}},{key:"cancelRemoveDraft",value:function(){this.rejectRemoveDraftPromise(),this._closeConfirmRemovePopup(),this.composeController.focusCompose(),this.metrikaService.sendPopupsMetrika(P.COMPOSE_METRIKA_POPUPS_CONFIRM_REMOVE,P.COMPOSE_METRIKA_POPUPS_CONFIRM_REMOVE_CLOSE)}},{key:"_finishScenarioIfCurrent",value:function(e){this.composeParamsService.params.isQuickReply||h.a.getActiveScenario(v.b)===this.data.currentScenario&&h.a.finishScenario(v.b,e,this.composeController.getQualityMetrics(this.data))}},{key:"_hasChanges",value:function(){return this.attachmentsController.hasPendingAttachments||this.visualState.hasChanges}},{key:"_isEmpty",value:function(){return!this.sendData||this.checkEmptyDraftService.isEmpty(this.sendData)}},{key:"composeController",get:function(){return this.controllers.compose}},{key:"attachmentsController",get:function(){return this.controllers.attachments}},{key:"checkEmptyDraftService",get:function(){return this.services.checkEmptyDraft}},{key:"autoSaveController",get:function(){return this.controllers.autoSave}},{key:"serializationController",get:function(){return this.controllers.serialization}},{key:"metrikaService",get:function(){return this.services.metrika}},{key:"saveSendController",get:function(){return this.controllers.saveSend}},{key:"composeParamsService",get:function(){return this.services.composeParams}}]),t})(E.a),y(b.prototype,"_showConfirmRemovePopup",[m.action],Object.getOwnPropertyDescriptor(b.prototype,"_showConfirmRemovePopup"),b.prototype),y(b.prototype,"_closeConfirmRemovePopup",[m.action],Object.getOwnPropertyDescriptor(b.prototype,"_closeConfirmRemovePopup"),b.prototype),b)},3510:function(e,t,n){"use strict";function r(e){"@babel/helpers - typeof";return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?u(e):t}function u(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function l(e,t,n){return(l="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=p(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function p(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=f(e)););return e}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function d(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function y(e,t,n){return t&&d(e.prototype,t),n&&d(e,n),e}function b(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&m(e,t)}function m(e,t){return(m=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function h(e,t,n,r,o){var i={};return Object.keys(r).forEach((function(e){i[e]=r[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce((function(n,r){return r(e,t,n)||n}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}n.d(t,"a",(function(){return j}));var v,O=n(138),g=n.n(O),_=n(351),S=n(908),E=n(1793),P=n(366),C=(n.n(P),n(399)),w=(n.n(C),n(393)),T=n.n(w),k=n(1281),R=n(356),A=n(87),j=(n.n(A),v=(function(e){function t(e){var n;return c(this,t),n=s(this,f(t).call(this,e)),n.complexityLogger=new E.a,n.fpsCounter=new k.a("compose-react",k.a.defaultConfig),n}return b(t,e),y(t,[{key:"attachmentsController",get:function(){return this.controllers.attachments}},{key:"composeParamsService",get:function(){return this.services.composeParams}},{key:"settingsService",get:function(){return this.services.settings}}]),y(t,[{key:"init",value:function(){this._initialBodyLength=Object(S.a)(this.controllers.messageBody.text),this.fpsCounter.start()}},{key:"destroy",value:function(){l(f(t.prototype),"destroy",this).call(this),this.fpsCounter.finish()}},{key:"closeCompose",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{leaveType:P.LeaveTypes.CLOSE},t=e.leaveType;this.visualState.isLocked=!1,this.environmentAdapter.onClose({leaveType:t})}},{key:"focusCompose",value:function(){this.visualState.focusedField="compose"}},{key:"focusComposeField",value:function(e){g.a.startsWith(e,"addresses.")&&(e=e.substring("addresses.".length)),this.visualState.focusedField=e}},{key:"focusAttachments",value:function(){this.visualState.focusedField="attachments"}},{key:"getParamsForQualityMetrics",value:function(){return{usedSmall:this.visualState.size===C.ComposeSizes.SMALL}}},{key:"getQualityMetrics",value:function(){var e=this.attachmentsController.getSummaryForLog(this.data.attachments),t=e.relatedMailIds;!t.length&&this.data.markIds.length&&(t=this.data.markIds);var n=this.complexityLogger.getSummary(this.data);return i({bodyLength:Object(S.a)(this.controllers.messageBody.text),initialBodyLength:this._initialBodyLength,hasDelayedSending:Boolean(this.data.sendTime),hasReplyNotification:this.data.notifications.reply,hasDeliveryNotification:this.data.notifications.delivery,hasLabels:this.data.userLabels.length>0},e,{},n,{relatedMailIds:t},this.getParamsForQualityMetrics())}},{key:"getComposeParamsData",value:function(){var e=this.composeParamsService;return{params:e.params,data:e.data}}},{key:"getMiniData",value:function(){var e=this.data||{addresses:{to:[],cc:[],bcc:[]}},t={subject:e.subject,addresses:e.addresses,lastSaved:e.lastSaved};return Object(_.toJS)(t,{recurseEverything:!0})}},{key:"changeSize",value:function(e,t){this.environmentAdapter.changeSize(e,t)}},{key:"checkAuthConfirmed",value:function(e){return this.environmentAdapter.checkAuthConfirmed(e)}},{key:"showAbookPopup",value:function(e){this.environmentAdapter.showAbookPopup(e)}},{key:"showPddRestrictPopup",value:function(){Object(A.hasFeature)(A.Features.PDD_RESTRICT)&&this.environmentAdapter.showPddRestrictPopup()}},{key:"isPddRestricted",get:function(){return!!Object(A.hasFeature)(A.Features.PDD_RESTRICT)&&(Object(R.isPDD)()&&!this.settingsService.canWriteLetters)}}]),t})(T.a),h(v.prototype,"closeCompose",[_.action],Object.getOwnPropertyDescriptor(v.prototype,"closeCompose"),v.prototype),h(v.prototype,"focusCompose",[_.action],Object.getOwnPropertyDescriptor(v.prototype,"focusCompose"),v.prototype),h(v.prototype,"focusComposeField",[_.action],Object.getOwnPropertyDescriptor(v.prototype,"focusComposeField"),v.prototype),h(v.prototype,"focusAttachments",[_.action],Object.getOwnPropertyDescriptor(v.prototype,"focusAttachments"),v.prototype),v)},3511:function(e,t,n){"use strict";function r(e){"@babel/helpers - typeof";return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e){return c(e)||a(e)||i()}function i(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function a(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function c(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function l(e,t,n){return t&&u(e.prototype,t),n&&u(e,n),e}function p(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?f(e):t}function f(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function d(e){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function y(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&b(e,t)}function b(e,t){return(b=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function m(e,t,n,r,o){var i={};return Object.keys(r).forEach((function(e){i[e]=r[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce((function(n,r){return r(e,t,n)||n}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}n.d(t,"a",(function(){return S}));var h,v=n(351),O=n(444),g=n(393),_=n.n(g),S=(h=(function(e){function t(){return s(this,t),p(this,d(t).apply(this,arguments))}return y(t,e),l(t,[{key:"init",value:function(){var e=this,t=[].concat(o(this.data.addresses.to),o(this.data.addresses.cc),o(this.data.addresses.bcc));return this.contactsService.loadContacts(t).then((function(){e.initAddresses()})).catch((function(){})).then((function(){return e.subscribeToFieldsChanged()}))}},{key:"initAddresses",value:function(){var e=this.data.addresses,t=e.to,n=e.cc,r=e.bcc;Object.assign(this.data.addresses,{to:this.replaceLoadedContacts(t),cc:this.replaceLoadedContacts(n),bcc:this.replaceLoadedContacts(r)})}},{key:"subscribeToFieldsChanged",value:function(){var e=this;this._disposer.add(this,[Object(v.reaction)((function(){return e.data.subject}),(function(){return e.environmentAdapter.onFieldChanged({fieldName:"subject"})})),Object(v.reaction)((function(){return e.controllers.messageBody.text}),(function(){return e.environmentAdapter.onFieldChanged({fieldName:"body"})})),Object(v.reaction)((function(){return e.data.addresses.to}),(function(){return e.environmentAdapter.onFieldChanged({fieldName:"to"})})),Object(v.reaction)((function(){return e.data.addresses.cc}),(function(){return e.environmentAdapter.onFieldChanged({fieldName:"cc"})})),Object(v.reaction)((function(){return e.data.addresses.bcc}),(function(){return e.environmentAdapter.onFieldChanged({fieldName:"bcc"})}))])}},{key:"getEmailList",value:function(e){return e.emailList||e.isGroup()?Promise.resolve(e.emailList):this.contactsService.loadContact(e).then((function(e){return e&&e.emailList||null}),(function(){return null}))}},{key:"replaceLoadedContacts",value:function(e){var t=this;return e.map((function(e){return t.replaceLoadedContact(e)}))}},{key:"replaceLoadedContact",value:function(e){if(e instanceof O.b&&!e.isLocal())return e;var t=this.contactsStore.findContactByEmail(e.email),n=t?t.toJSON():e;return n.name!==e.name&&(n.name=e.name),O.b.of(n)}},{key:"setSingleRecipient",value:function(e){var t=e.email,n=e.name;this.data.addresses.to=[this.contactsStore.findContactByEmail(t)||O.b.of({email:t,name:n})],this.data.addresses.cc=[],this.data.addresses.bcc=[]}},{key:"contactsStore",get:function(){return this.stores.contacts}},{key:"contactsService",get:function(){return this.services.contacts}}]),t})(_.a),m(h.prototype,"initAddresses",[v.action],Object.getOwnPropertyDescriptor(h.prototype,"initAddresses"),h.prototype),m(h.prototype,"setSingleRecipient",[v.action],Object.getOwnPropertyDescriptor(h.prototype,"setSingleRecipient"),h.prototype),h)},3512:function(e,t,n){"use strict";function r(e){"@babel/helpers - typeof";return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}function c(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?s(e):t}function s(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function f(e,t,n,r,o){var i={};return Object.keys(r).forEach((function(e){i[e]=r[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce((function(n,r){return r(e,t,n)||n}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}n.d(t,"a",(function(){return g}));var d,y=n(351),b=n(360),m=(n.n(b),n(496)),h=(n.n(m),n(393)),v=n.n(h),O=n(366),g=(n.n(O),d=(function(e){function t(){return o(this,t),c(this,u(t).apply(this,arguments))}return l(t,e),a(t,[{key:"doDelete",value:function(){this.services.composeParams.isDraft()?this._promptDeleteDraft():this._removeUnsaved()}},{key:"_promptDeleteDraft",value:function(){this.visualState.currentPopup=m.REMOVE_DRAFT,this.autoSaveController.stopAutosave(),this.services.metrika.sendPopupsMetrika(b.COMPOSE_METRIKA_POPUPS_REMOVE_DRAFT,b.COMPOSE_METRIKA_POPUPS_REMOVE_DRAFT_SHOW)}},{key:"_removeUnsaved",value:function(){this.controllers.compose.closeCompose({leaveType:O.LeaveTypes.DELETE}),this.services.metrika.sendPopupsMetrika(b.COMPOSE_METRIKA_POPUPS_REMOVE_DRAFT,b.COMPOSE_METRIKA_POPUPS_REMOVE_DRAFT_ACTION)}},{key:"_closeRemoveDraftPopup",value:function(){this.visualState.currentPopup=""}},{key:"cancelRemoveDraft",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{isClose:!1},t=e.isClose;this._closeRemoveDraftPopup(),this.autoSaveController.startAutosave(),this.controllers.compose.focusCompose(),this.services.metrika.sendPopupsMetrika(b.COMPOSE_METRIKA_POPUPS_REMOVE_DRAFT,t?b.COMPOSE_METRIKA_POPUPS_REMOVE_DRAFT_CLOSE:b.COMPOSE_METRIKA_POPUPS_REMOVE_DRAFT_CANCEL)}},{key:"removeDraftAndClose",value:function(){this._closeRemoveDraftPopup(),this.deleteDraft(),this.controllers.compose.closeCompose({leaveType:O.LeaveTypes.DELETE}),this.services.metrika.sendPopupsMetrika(b.COMPOSE_METRIKA_POPUPS_REMOVE_DRAFT,b.COMPOSE_METRIKA_POPUPS_REMOVE_DRAFT_ACTION)}},{key:"deleteDraft",value:function(){var e=this.controllers.serialization.createSendData(),t=e.overwrite;t&&this.environmentAdapter.onNeedRemoveDraft(t).catch((function(){}))}},{key:"autoSaveController",get:function(){return this.controllers.autoSave}}]),t})(v.a),f(d.prototype,"doDelete",[y.action],Object.getOwnPropertyDescriptor(d.prototype,"doDelete"),d.prototype),f(d.prototype,"_closeRemoveDraftPopup",[y.action],Object.getOwnPropertyDescriptor(d.prototype,"_closeRemoveDraftPopup"),d.prototype),d)},3513:function(e,t,n){"use strict";function r(e){"@babel/helpers - typeof";return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}function c(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?s(e):t}function s(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function u(e,t,n){return(u="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=l(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function l(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=p(e)););return e}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function f(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&d(e,t)}function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}n.d(t,"a",(function(){return h}));var y=n(393),b=n.n(y),m=n(351),h=(function(e){function t(){var e,n;o(this,t);for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return n=c(this,(e=p(t)).call.apply(e,[this].concat(i))),n.save=function(){n.areHotkeysEnabled&&n.controllers.saveSend.saveMessage({isForce:!0})},n.send=function(){if(n.areHotkeysEnabled)return n.controllers.compose.isPddRestricted?n.controllers.compose.showPddRestrictPopup():void n.controllers.saveSend.sendMessage()},n}return f(t,e),a(t,[{key:"attachNode",value:function(e){var t=this;this.services.hotkeys.setHandlerNode(e),this.services.hotkeys.subscribe(),this._disposer.add(this,[this.services.hotkeys.events.save.on(this.save),this.services.hotkeys.events.send.on(this.send),Object(m.reaction)((function(){return t.visualState.currentPopup}),(function(e){return t.onCurrentPopupChanged(e)}))])}},{key:"destroy",value:function(){u(p(t.prototype),"destroy",this).call(this),this.services.hotkeys.unsubscribe()}},{key:"suspend",value:function(){this.services.hotkeys.unsubscribe()}},{key:"resume",value:function(){this.services.hotkeys.subscribe()}},{key:"onCurrentPopupChanged",value:function(e){e?this.suspend():this.resume()}},{key:"areHotkeysEnabled",get:function(){return this.services.settings.areHotkeysEnabled}}]),t})(b.a)},3514:function(e,t,n){"use strict";function r(e){"@babel/helpers - typeof";return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t,n,r,o,i,a){try{var c=e[i](a),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,o)}function i(e){return function(){var t=this,n=arguments;return new Promise(function(r,i){function a(e){o(s,r,i,a,c,"next",e)}function c(e){o(s,r,i,a,c,"throw",e)}var s=e.apply(t,n);a(void 0)})}}function a(e){return u(e)||s(e)||c()}function c(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function s(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function u(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function p(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function f(e,t,n){return t&&p(e.prototype,t),n&&p(e,n),e}function d(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?y(e):t}function y(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function b(e){return(b=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function m(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&h(e,t)}function h(e,t){return(h=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function v(e,t,n,r,o){var i={};return Object.keys(r).forEach((function(e){i[e]=r[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce((function(n,r){return r(e,t,n)||n}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}n.d(t,"a",(function(){return E}));var O,g=n(351),_=n(393),S=n.n(_),E=(O=(function(e){function t(){return l(this,t),d(this,b(t).apply(this,arguments))}return m(t,e),f(t,[{key:"init",value:function(){var e=this.services.labels,t=this.data,n=e.splitLabels(t.labelIds),r=n.userLabels,o=n.otherLabels;t.userLabels=r,t.otherLabels=o}},{key:"removeUserLabel",value:function(e){var t=this.data.userLabels.indexOf(e);-1!==t&&this.data.userLabels.splice(t,1)}},{key:"getUnusedLabels",value:function(){var e=this;return[this.services.labels.importantLabel].concat(a(this.services.labels.getCreatedByUserLabels())).filter((function(t){return!e.data.userLabels.find((function(e){return e.lid===t.lid}))}))}},{key:"addLabel",value:function(e){this.data.userLabels.push(e)}},{key:"refreshUserLabels",value:function(){this.data.userLabels=this.services.labels.refreshUserLabels(this.data.userLabels)}},{key:"manageLabels",value:(function(){function e(){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.environmentAdapter.manageLabels();case 2:case"end":return e.stop()}}),e,this)})));return e})()}]),t})(S.a),v(O.prototype,"init",[g.action],Object.getOwnPropertyDescriptor(O.prototype,"init"),O.prototype),v(O.prototype,"removeUserLabel",[g.action],Object.getOwnPropertyDescriptor(O.prototype,"removeUserLabel"),O.prototype),v(O.prototype,"addLabel",[g.action],Object.getOwnPropertyDescriptor(O.prototype,"addLabel"),O.prototype),v(O.prototype,"refreshUserLabels",[g.action],Object.getOwnPropertyDescriptor(O.prototype,"refreshUserLabels"),O.prototype),O)},3515:function(e,t,n){"use strict";function r(e){"@babel/helpers - typeof";return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e,t,n){return t&&s(e.prototype,t),n&&s(e,n),e}function l(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?p(e):t}function p(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function d(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&y(e,t)}function y(e,t){return(y=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}n.d(t,"a",(function(){return h}));var b=n(393),m=n.n(b),h=(function(e){function t(){return c(this,t),l(this,f(t).apply(this,arguments))}return d(t,e),u(t,[{key:"goToFullCompose",value:function(e){var t=i({},this.paramsService.getParams(),{isQuickReply:!1,qrText:this.controllers.messageBody.text},e);return this.paramsService.isDraft()&&this.paramsService.data&&this.paramsService.data.overwrite&&(t.ids=[this.paramsService.data.overwrite]),this.controllers.autoSave.stopAutosave(),this.environmentAdapter.goToFullCompose(t)}},{key:"paramsService",get:function(){return this.services.composeParams}}]),t})(m.a)},3516:function(e,t,n){"use strict";function r(e){"@babel/helpers - typeof";return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e){return c(e)||a(e)||i()}function i(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function a(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function c(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function l(e,t,n){return t&&u(e.prototype,t),n&&u(e,n),e}function p(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?d(e):t}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function d(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function y(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&b(e,t)}function b(e,t){return(b=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function m(e,t,n,r){n&&Object.defineProperty(e,t,{enumerable:n.enumerable,configurable:n.configurable,writable:n.writable,value:n.initializer?n.initializer.call(r):void 0})}function h(e,t,n,r,o){var i={};return Object.keys(r).forEach((function(e){i[e]=r[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce((function(n,r){return r(e,t,n)||n}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}n.d(t,"a",(function(){return w}));var v,O,g,_=n(138),S=(n.n(_),n(351)),E=n(367),P=n(393),C=n.n(P),w=(v=g=(function(e){function t(){var e,n;s(this,t);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return n=p(this,(e=f(t)).call.apply(e,[this].concat(o))),m(d(n),"_isRecipientsDiffEnabled",O,d(n)),n}return y(t,e),l(t,[{key:"setIsRecipientsDiffEnabled",value:function(e){this._isRecipientsDiffEnabled=this.isRecipientsDiffAvailable&&e}},{key:"isEmptyDiff",value:function(e){return Object(_.isEqual)(e,this._emptyDiff)}},{key:"_getContactsDict",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return[].concat(o(e),o(t)).reduce((function(e,t){return t.isValid&&!t.isValid()?e:(e[t.email]=t,e)}),{})}},{key:"_getDiff",value:function(e,t){return Object.keys(e).reduce((function(n,r){return t[r]||n.push(e[r]),n}),[]).sort((function(e,t){return String(e.email).localeCompare(t.email)}))}},{key:"getRecipientsDiff",value:function(){if(!this.isRecipientsDiffAvailable)return this._emptyDiff;var e=this._getContactsDict(this.data.addresses.initial_to,this.data.addresses.initial_cc),t=Object.keys(e).length;if(!t)return this._emptyDiff;var n=this._getContactsDict(this.data.addresses.to,this.data.addresses.cc),r=this._getDiff(n,e),o=this._getDiff(e,n),i=this._createLoginsDict(r,o),a=0!==o.length,c=o.length===t,s=t-o.length==1;return{added:this._extractLogins(r,i),removed:this._extractLogins(o,i),removeAll:a&&(c||s)}}},{key:"_createLoginsDict",value:function(e,t){var n=this,r=[].concat(o(e),o(t)),i={};return r.forEach((function(e){var t=n._parseLoginInfo(e.email),r=t.login;i[r]=(i[r]||0)+1})),i}},{key:"_parseLoginInfo",value:function(e){return{login:"".concat(e.replace(/@.*/gi,""),"@"),email:e}}},{key:"_extractLogins",value:function(e,t){var n=this;return e.map((function(e){var r=n._parseLoginInfo(e.email),o=r.login,i=r.email;return{login:1===t[o]?o:i,contact:e}}))}},{key:"_formatLine",value:function(){return"<div>".concat(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"&nbsp;","</div>")}},{key:"_formatLoginsSection",value:function(e,t){var n=e.join(", ");return this._formatLine("".concat(t).concat(n))}},{key:"_formatContactsSection",value:function(e,t){var n=e.map((function(e){return e.login}));return this._formatLoginsSection(n,t)}},{key:"insertDiffIntoMessage",value:function(e,t){if(!this.isRecipientsDiffEnabled||this.isEmptyDiff(t))return e;var n=Object(E.default)("compose-react/RecipientsAll"),r="";return t.added&&t.added.length&&(r+=this._formatContactsSection(t.added,"+ ")),t.removeAll?r+=this._formatLoginsSection([n],"- "):t.removed&&t.removed.length&&(r+=this._formatContactsSection(t.removed,"- ")),r?"".concat(r).concat(this._formatLine()).concat(e):e}},{key:"paramsService",get:function(){return this.services.composeParams}},{key:"_isTemplate",get:function(){return this.paramsService.isTemplate()}},{key:"_isNewMessage",get:function(){return!this.paramsService.hasMessage}},{key:"_isForward",get:function(){return this.paramsService.isForward()}},{key:"_emptyDiff",get:function(){return{added:[],removed:[],removeAll:!1}}},{key:"isRecipientsDiffAvailable",get:function(){return Boolean(!this._isTemplate&&!this._isNewMessage&&!this._isForward)}},{key:"isRecipientsDiffEnabled",get:function(){return this._isRecipientsDiffEnabled&&this.isRecipientsDiffAvailable}}]),t})(C.a),O=h(v.prototype,"_isRecipientsDiffEnabled",[S.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),h(v.prototype,"isRecipientsDiffEnabled",[S.computed],Object.getOwnPropertyDescriptor(v.prototype,"isRecipientsDiffEnabled"),v.prototype),h(v.prototype,"setIsRecipientsDiffEnabled",[S.action],Object.getOwnPropertyDescriptor(v.prototype,"setIsRecipientsDiffEnabled"),v.prototype),v)},3517:function(e,t,n){"use strict";function r(e){"@babel/helpers - typeof";return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}function c(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?s(e):t}function s(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}n.d(t,"a",(function(){return y}));var f=n(393),d=n.n(f),y=(function(e){function t(){var e,n;o(this,t);for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return n=c(this,(e=u(t)).call.apply(e,[this].concat(i))),n.onBrowserLeave=function(){n._onQuit()},n.onPageReload=function(){n._onQuit(),n.closeCompose()},n._onQuit=function(){n.pageReloadService.hasChanges=n.visualState.hasChanges},n}return l(t,e),a(t,[{key:"init",value:function(){this._disposer.add(this,[this.pageReloadService.subscribe(),this.pageReloadService.events.leaveBrowser.on(this.onBrowserLeave),this.pageReloadService.events.leavePage.on(this.onPageReload)])}},{key:"destroy",value:function(){this._disposer.disposeAll()}},{key:"closeCompose",value:function(){this.controllers.compose.closeCompose()}},{key:"pageReloadService",get:function(){return this.services.pageReload}}]),t})(d.a)},3518:function(e,t,n){"use strict";function r(e){"@babel/helpers - typeof";return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?l(e):t}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function l(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function p(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function f(e,t,n){return t&&p(e.prototype,t),n&&p(e,n),e}function d(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&y(e,t)}function y(e,t){return(y=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function b(e,t,n,r){n&&Object.defineProperty(e,t,{enumerable:n.enumerable,configurable:n.configurable,writable:n.writable,value:n.initializer?n.initializer.call(r):void 0})}function m(e,t,n,r,o){var i={};return Object.keys(r).forEach((function(e){i[e]=r[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce((function(n,r){return r(e,t,n)||n}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}n.d(t,"a",(function(){return M}));var h,v,O,g,_=n(138),S=n.n(_),E=n(351),P=n(393),C=n.n(P),w=n(425),T=n(384),k=n(681),R=n(366),A=(n.n(R),n(792)),j=n(3519),M=(n.n(j),h=g=(function(e){function t(e){var n;return c(this,t),n=s(this,u(t).call(this,e)),n._lastSavedData=null,n._queue=new j.RequestQueue,b(l(n),"setHasChanges",v,l(n)),n._onSaveError=function(e,t){n.composeRequestService.removeMidFromFailedMessages(t.overwrite),e.code===R.SendError.ILLEGAL_PARAMS&&n.autoSave.stopAutosave(),n.environmentAdapter.onSaveFailed({error:e.code})},b(l(n),"_onSentError",O,l(n)),n.subscribeToChanges(),n}return d(t,e),f(t,[{key:"composeParamsService",get:function(){return this.services.composeParams}},{key:"composeRequestService",get:function(){return this.services.composeRequest}},{key:"dateService",get:function(){return this.services.date}},{key:"settingsService",get:function(){return this.services.settings}},{key:"attachmentsController",get:function(){return this.controllers.attachments}},{key:"composeController",get:function(){return this.controllers.compose}},{key:"serializationController",get:function(){return this.controllers.serialization}},{key:"validationController",get:function(){return this.controllers.validation}},{key:"recipientsDiff",get:function(){return this.controllers.recipientsDiff}},{key:"isSaving",get:function(){return this._queue.isWorking}},{key:"isSaved",get:function(){return Boolean(this._lastSavedData&&this._lastSavedData.overwrite)}},{key:"autoSave",get:function(){return this.controllers.autoSave}}]),f(t,[{key:"subscribeToChanges",value:function(){var e=this;Object(E.reaction)((function(){return e.data&&e.serializationController.createSendData()}),(function(t){e.setHasChanges(t),e.autoSave.startAutosave()}))}},{key:"init",value:function(){this._lastSavedData=this.serializationController.createSendData()}},{key:"saveMessage",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.isForce,r=t.asTemplate;return n||this.visualState.hasChanges?this._queue.enqueueDraft((function(){var t=e.serializationController.createSendData({asTemplate:r});return e.composeParamsService.data=t,e.data.isTemplate&&!r&&e.markAsDraft(),e.composeRequestService.makeRequest({data:i({},t,{nosend:"yes"})}).then((function(n){return e._onSaveSuccess(n,t)}),(function(n){return e._onSaveError(n||new Error,t)}))})):this._queue.pending()}},{key:"markAsDraft",value:function(){this.data.isTemplate=!1}},{key:"_onSaveSuccess",value:function(e,t){var n={ignOverwrite:"no",overwriteIds:e.storedmid||t.overwrite,currentFolder:e.store_fid||this.composeParamsService.data.current_folder,attachmentsJson:e.attachment||t.attachment,lastSaved:this.dateService.passportNow};t.current_folder=n.currentFolder,t.overwrite=n.overwriteIds,t.ign_overwrite=n.ignOverwrite,this.attachmentsController.updateAfterSave(this.data.attachments,n.attachmentsJson,n.overwriteIds),S.a.extend(t,this.attachmentsController.createSendData(this.data.attachments)),this._lastSavedData=t,this.composeParamsService.data=t;var r=this.composeController.getComposeParamsData();Object.assign(this.data,n);var o=this.composeController.getMiniData();this.setHasChanges(this.serializationController.createSendData()),this.environmentAdapter.onSaveSuccess({dataUpdate:n,composeParamsData:r,responseData:e,miniData:o})}},{key:"sendMessage",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.withoutUndoAndDelay;if(this.composeParamsService.getParams().isQuickReply||w.a.getActiveScenario(T.b).logStep(k.f,this.composeController.getParamsForQualityMetrics()),this._validateData())return this.startSending(),this._queue.enqueueSend(Object(E.action)((function(){var t=e.serializationController.createSendData({withoutUndoAndDelay:n});e.composeParamsService.data=t;var r=e.recipientsDiff.getRecipientsDiff();return t.send=e.recipientsDiff.insertDiffIntoMessage(t.send,r),e.composeRequestService.makeRequest({data:t,send:!0}).then(Object(E.action)((function(t){return e._onSentSuccess(t,{withoutUndoAndDelay:n})})),Object(E.action)((function(n){return e._onSentError(n,t)}))).then(Object(E.action)((function(){return e.finishSending()})))})))}},{key:"_validateData",value:function(){if(!this.validationController.validateData()){var e=this.validation.getAddressError();return!this.composeParamsService.getParams().isQuickReply&&(w.a.getActiveScenario(T.b).logStep(k.g,i({error:e},this.composeController.getParamsForQualityMetrics())),!1)}return!(!this.data.allowEmptySubject&&!this.data.subject&&this.settingsService.hasEmptySubjectPopup)||(this.validation.sendError={error:R.SendError.EMPTY_SUBJECT},this.environmentAdapter.onSendFailed(this.validation.sendError),!1)}},{key:"startSending",value:function(){this.visualState.isLocked=!0,this.visualState.isSending=!0,this.environmentAdapter.onSending()}},{key:"finishSending",value:function(){this.visualState.isSending=!1}},{key:"retryToSendMessageWithoutUndoAndDelayed",value:function(){return this.sendMessage({withoutUndoAndDelay:!0})}},{key:"_onSentSuccess",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=n.withoutUndoAndDelay;this.composeParamsService.getParams().isQuickReply||w.a.finishScenario(T.b,A.h,this.composeController.getQualityMetrics());var o=this._checkLimitedRecipients(e.limited),i=this.composeController.getComposeParamsData(),a=this.composeController.getMiniData();this.environmentAdapter.onSendSuccess({responseData:e,composeParamsData:i,miniData:a,withUndo:r?null:this._withUndo(),sendTime:r?null:this.data.sendTime,preventLeave:o})}},{key:"_withUndo",value:function(){return Daria.SendMail.shouldShowUndoSend()&&!this.data.sendTime}},{key:"_checkLimitedRecipients",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.recipient;return!(!Array.isArray(t)||!t.length)&&(this.validation.limitedRecipients=t.map(Object(E.action)((function(e){var t=e.login,n=e.domain;return"".concat(t,"@").concat(n)}))),!0)}}]),t})(C.a),v=m(h.prototype,"setHasChanges",[E.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){e.visualState.hasChanges=e.serializationController.compareSendData(e._lastSavedData,t)}}}),m(h.prototype,"markAsDraft",[E.action],Object.getOwnPropertyDescriptor(h.prototype,"markAsDraft"),h.prototype),m(h.prototype,"_onSaveSuccess",[E.action],Object.getOwnPropertyDescriptor(h.prototype,"_onSaveSuccess"),h.prototype),m(h.prototype,"sendMessage",[E.action],Object.getOwnPropertyDescriptor(h.prototype,"sendMessage"),h.prototype),m(h.prototype,"startSending",[E.action],Object.getOwnPropertyDescriptor(h.prototype,"startSending"),h.prototype),m(h.prototype,"finishSending",[E.action],Object.getOwnPropertyDescriptor(h.prototype,"finishSending"),h.prototype),m(h.prototype,"_checkLimitedRecipients",[E.action],Object.getOwnPropertyDescriptor(h.prototype,"_checkLimitedRecipients"),h.prototype),O=m(h.prototype,"_onSentError",[E.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t,n){if(e.composeParamsService.getParams().isQuickReply||w.a.getActiveScenario(T.b).logStep(k.g,i({error:t.code},e.composeController.getParamsForQualityMetrics())),[R.SendError.UNDO_MESSAGE_SAVED,R.SendError.DELAYED_MESSAGE_SAVED].includes(t.code)){var r=t.data.storedmid;e._onSaveSuccess({storedmid:r},n)}e.composeRequestService.removeMidFromFailedMessages(n.overwrite);var o=t.data||{};e.validation.sendError={error:t.code,captchaKey:o.captcha_key,captchaUrl:o.captcha_url,banReason:o.banReason},e.environmentAdapter.onSendFailed(e.validation.sendError)}}}),h)},3519:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RequestQueue=void 0;var r=(function(){function e(){this._queue=Promise.resolve(),this._closed=!1,this._queuedCount=0}return Object.defineProperty(e.prototype,"isWorking",{get:function(){return this._queuedCount>0},enumerable:!1,configurable:!0}),e.prototype.enqueueDraft=function(e){return this._queuedCount>1?this._queue:this._enqueue(e)},e.prototype.enqueueSend=function(e){var t=this,n=this._enqueue(e).then((function(e){return t._closed=!1,e}));return this._closed=!0,n},e.prototype.pending=function(){return this._queue},e.prototype._enqueue=function(e){var t=this;return this._closed?this._queue:(this._queuedCount++,this._queue=this._queue.then(e).then((function(e){return t._queuedCount--,e})),this._queue)},e})();t.RequestQueue=r},3520:function(e,t,n){"use strict";function r(e){"@babel/helpers - typeof";return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e){return c(e)||a(e)||i()}function i(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function a(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function c(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function l(e,t,n){return t&&u(e.prototype,t),n&&u(e,n),e}function p(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?f(e):t}function f(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function d(e){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function y(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&b(e,t)}function b(e,t){return(b=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}n.d(t,"a",(function(){return E}));var m,h,v=n(351),O=n(444),g=n(366),_=(n.n(g),n(393)),S=n.n(_),E=(m=h=(function(e){function t(){var e,n;s(this,t);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return n=p(this,(e=d(t)).call.apply(e,[this].concat(o))),n._onChangedFromName=function(e){var t=e.previousValue,r=n.data.addresses.from.name===t,o=r&&!n.services.composeParams.isDraft();n.updateFromNameAndAddresses(o)},n}return y(t,e),l(t,[{key:"init",value:function(){this._disposer.add(this,[this.services.settings.registerChangeSettingsHandler(this._onChangedFromName,g.Settings.FROM_NAME)])}},{key:"setFrom",value:function(e){var t=e.email,n=e.name;this.availableAddresses.length&&this.availableAddresses[0].name===n||(this.availableAddresses=this.availableAddresses.map((function(e){return{email:e.email,name:n}})));var r=t.toLowerCase(),o=this.availableAddresses.filter((function(e){return e.email.toLowerCase()===r}));this.data.addresses.from=o.length?o[0]:{email:t,name:n}}},{key:"processSelfRecipient",value:function(e){var t=e.contacts,n=void 0===t?[]:t,r=e.suggestType;if(!this.data.addresses.from)return n;var i=this._markSelfInSuggestContacts(n);return r!==g.SuggestTypes.POPULAR?n:(i||this._hasSelfAddress()||(i=this._generateSelfContact()),i?[i].concat(o(n.filter((function(e){return e.email!==i.email})))):n)}},{key:"_markSelfInSuggestContacts",value:function(e){var t,n=this.data.addresses.from.email;return e.forEach((function(e){e.isSelf=e.email===n,e.isSelf&&(t=e)})),t}},{key:"_hasSelfAddress",value:function(){var e=this;return this.controllers.contactsSuggest.excludedAddresses.some((function(t){return t===e.data.addresses.from.email}))}},{key:"_generateSelfContact",value:function(){var e=this.data.addresses.from,t=this.stores.contacts.findContactByEmail(e.email);return t||(t=O.b.of(e),this.services.contacts.loadContact(t).then((function(e){t.name=e.name,t.emailList=e.emailList})),this.stores.contacts.writeContact(t)),t.isSelf=!0,t}},{key:"updateFromNameAndAddresses",value:function(e){var t=this.services.composeParams.getFromName();e&&(this.data.addresses.from.name=t),this.availableAddresses=this.services.composeParams.getAvailableFromEmails().map(Object(v.action)((function(e){return{email:e,name:t}})))}},{key:"availableAddresses",get:function(){return this.stores.addressesFrom.addresses||[]},set:function(e){this.stores.addressesFrom.addresses=e}}]),t})(S.a),(function(e,t,n,r,o){var i={};return Object.keys(r).forEach((function(e){i[e]=r[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce((function(n,r){return r(e,t,n)||n}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i})(m.prototype,"updateFromNameAndAddresses",[v.action],Object.getOwnPropertyDescriptor(m.prototype,"updateFromNameAndAddresses"),m.prototype),m)},3521:function(e,t,n){"use strict";function r(e){"@babel/helpers - typeof";return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e){return c(e)||a(e)||i()}function i(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function a(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function c(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function u(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){l(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function p(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function f(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function d(e,t,n){return t&&f(e.prototype,t),n&&f(e,n),e}function y(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?b(e):t}function b(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function m(e){return(m=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function h(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&v(e,t)}function v(e,t){return(v=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}n.d(t,"a",(function(){return T}));var O=n(138),g=n.n(O),_=n(355),S=n.n(_),E=n(393),P=n.n(E),C=n(444),w=n(139),T=(n.n(w),(function(e){function t(){var e,n;p(this,t);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return n=y(this,(e=m(t)).call.apply(e,[this].concat(o))),n._formatContact=function(e){return n.services.contactsFormatter.contactToString(e)},n}return h(t,e),d(t,[{key:"createSendData",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.asTemplate,n=e.withoutUndoAndDelay;return u({from_mailbox:this.data.addresses.from.email,from_name:this.data.addresses.from.name,to:this._mapAddresses(this.data.addresses.to),cc:this._mapAddresses(this.data.addresses.cc),bcc:this._mapAddresses(this.data.addresses.bcc),subj:this.data.subject,send:this._formatMessageBody(this.controllers.messageBody.text),ttype:this.data.messageFormat,inreplyto:this.data.inReplyTo,current_folder:this.data.currentFolder,overwrite:this.data.overwriteIds,ign_overwrite:this.data.ignOverwrite,references:this.data.references,mark_ids:this.data.markIds,mark_as:this.data.markAs,message_id:this.data.messageId,current_time:this.dateService.now,send_time:this._getSendTime(n),notify_on_send:this.data.notifications.delivery?"yes":"no",captcha_key:this.data.captcha.key,captcha_entered:this.data.captcha.value,captcha_token:this.data.checkboxCaptcha.token},this._serializeLabelsAndNotifications(),{},this._serializeAttachments(),{},this._serializeUndoData(n),{},this._serializeTemplateData(t))}},{key:"_mapAddresses",value:function(e){return g.a.unique(C.b.flattenContacts(e,this._formatContact)).join(", ")}},{key:"_formatMessageBody",value:function(e){return this.settingsService.isMobile?e.replace(/<br\/>/gi,"<br>"):this.composeParamsService.getParams().isQuickReply?e+this.composeParamsService.getReplyBody():e}},{key:"_getSendTime",value:function(e){if(this.data.sendTime&&!e)return this.dateService.convertPassportDateToTimestamp(this.data.sendTime)}},{key:"_serializeLabelsAndNotifications",value:function(){var e=[].concat(o(this.data.userLabels.map((function(e){return e.lid}))),o(this.data.otherLabels.map((function(e){return e.lid}))));if(this.data.notifications.reply){var t=this.labelsService.waitingForReplyLabel.lid,n=S()(this.data.notifications.replyTime).diff(this.dateService.passportNow,"seconds");return{lids:[].concat(o(e),[t]),remind_period:n}}return{lids:e}}},{key:"_serializeAttachments",value:function(){return this.attachmentsController.createSendData(this.attachmentsController.validAttachments)}},{key:"_serializeUndoData",value:function(e){return!Daria.SendMail.shouldShowUndoSend()||this.data.sendTime||e?{}:{send_time:Daria.SendMail.getUndoSendTime(),relative:!0}}},{key:"_serializeTemplateData",value:function(e){return e?{save_symbol:w.WellKnownFolderSymbol.TEMPLATE,templates_fid:this.data.templatesFolderId}:{}}},{key:"compareSendData",value:function(e,t){return!(this.composeParamsService.isDraft()||this.composeParamsService.isTemplate())&&!this.composeParamsService.isPredefinedDataEmpty()||e&&!this._isRelevantDataEqual(e,t)}},{key:"_isRelevantDataEqual",value:function(e,t){var n=["ids","mark_ids","save_symbol","templates_fid","current_time"],r=g.a.omit.apply(g.a,[e].concat(n)),o=g.a.omit.apply(g.a,[t].concat(n));return g.a.isEqual(r,o)}},{key:"isEmpty",value:function(){var e=this.createSendData();return this.services.checkEmptyDraft.isEmpty(e)}},{key:"settingsService",get:function(){return this.services.settings}},{key:"dateService",get:function(){return this.services.date}},{key:"labelsService",get:function(){return this.services.labels}},{key:"composeParamsService",get:function(){return this.services.composeParams}},{key:"attachmentsController",get:function(){return this.controllers.attachments}}]),t})(P.a))},3522:function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e}function a(e,t,n,r){n&&Object.defineProperty(e,t,{enumerable:n.enumerable,configurable:n.configurable,writable:n.writable,value:n.initializer?n.initializer.call(r):void 0})}function c(e,t,n,r,o){var i={};return Object.keys(r).forEach((function(e){i[e]=r[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce((function(n,r){return r(e,t,n)||n}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}n.d(t,"a",(function(){return f}));var s,u,l,p=n(351),f=(s=l=(function(){function e(t){r(this,e),a(this,"settings",u,this),this.service=t}return i(e,[{key:"toggleAutocomplete",value:function(){this.service.toggleAutocomplete()}},{key:"destroy",value:function(){}},{key:"areHotkeysEnabled",get:function(){return this.service.areHotkeysEnabled}},{key:"isAutocompleteEnabled",get:function(){return this.service.isComposeAutocompleteEnabled}}]),e})(),u=c(s.prototype,"settings",[p.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),c(s.prototype,"areHotkeysEnabled",[p.computed],Object.getOwnPropertyDescriptor(s.prototype,"areHotkeysEnabled"),s.prototype),c(s.prototype,"isAutocompleteEnabled",[p.computed],Object.getOwnPropertyDescriptor(s.prototype,"isAutocompleteEnabled"),s.prototype),s)},3523:function(e,t,n){"use strict";function r(e){"@babel/helpers - typeof";return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t,n,r,o,i,a){try{var c=e[i](a),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,o)}function i(e){return function(){var t=this,n=arguments;return new Promise(function(r,i){function a(e){o(s,r,i,a,c,"next",e)}function c(e){o(s,r,i,a,c,"throw",e)}var s=e.apply(t,n);a(void 0)})}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t,n){return t&&c(e.prototype,t),n&&c(e,n),e}function u(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?l(e):t}function l(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function f(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&d(e,t)}function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}n.d(t,"a",(function(){return O}));var y,b=n(351),m=n(366),h=(n.n(m),n(393)),v=n.n(h),O=(y=(function(e){function t(){return a(this,t),u(this,p(t).apply(this,arguments))}return f(t,e),s(t,[{key:"getSignatures",value:function(e,t){return this.services.signatures.getSignatures(e,t)}},{key:"openSettings",value:(function(){function e(){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.controllers.compose.closeCompose({leaveType:m.LeaveTypes.COLLAPSE}),e.next=3,this.environmentAdapter.openSignaturesSettings();case 3:case"end":return e.stop()}}),e,this)})));return e})()},{key:"setSignature",value:function(e){this.data.signature=e}}]),t})(v.a),(function(e,t,n,r,o){var i={};return Object.keys(r).forEach((function(e){i[e]=r[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce((function(n,r){return r(e,t,n)||n}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i})(y.prototype,"setSignature",[b.action],Object.getOwnPropertyDescriptor(y.prototype,"setSignature"),y.prototype),y)},3524:function(e,t,n){"use strict";function r(e){"@babel/helpers - typeof";return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function c(e,t,n,r,o,i,a){try{var c=e[i](a),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,o)}function s(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){function i(e){c(s,r,o,i,a,"next",e)}function a(e){c(s,r,o,i,a,"throw",e)}var s=e.apply(t,n);i(void 0)})}}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function p(e,t,n){return t&&l(e.prototype,t),n&&l(e,n),e}function f(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?d(e):t}function d(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function y(e){return(y=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function b(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&m(e,t)}function m(e,t){return(m=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}n.d(t,"a",(function(){return w}));var h,v=n(351),O=n(366),g=(n.n(O),n(425)),S=n(384),E=n(681),P=n(393),C=n.n(P),w=(h=(function(e){function t(){return u(this,t),f(this,y(t).apply(this,arguments))}return b(t,e),p(t,[{key:"getSmartSubjectsForInput",value:(function(){function e(){return t.apply(this,arguments)}var t=s(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._getSmartSubjects(O.SmartSubjectType.INPUT);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return e})()},{key:"getSmartSubjectForPopup",value:(function(){function e(){return t.apply(this,arguments)}var t=s(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._getSmartSubjects(O.SmartSubjectType.POPUP);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return e})()},{key:"_getSmartSubjects",value:(function(){function e(e){return t.apply(this,arguments)}var t=s(regeneratorRuntime.mark((function e(t){var n,r,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.services.settings.hasEmptySubjectPopup){e.next=3;break}return this._updateResults([],"",""),e.abrupt("return");case 3:return e.prev=3,e.next=6,this.services.smartSubject.getSmartSubjects({position:t,messageId:this.data.messageId,threadId:this.services.composeParams.relatedThreadId,text:this.controllers.messageBody.text,addresses:Object(v.toJS)(this.data.addresses),attaches:Object(v.toJS)(this.data.attachments)});case 6:n=e.sent,r=n.items,o=n.requestId,this._updateResults(r,t,o),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(3),this._updateResults([],"","");case 15:case"end":return e.stop()}}),e,this,[[3,12]])})));return e})()},{key:"_updateResults",value:function(e,t,n){if(this.subjectsSuggest.suggestItems=e,this.subjectsSuggest.suggestType=t,this.subjectsSuggest.requestId=n,n){var r=g.a.getActiveScenario(S.b);r&&r.logStep(E.i,i({reqid:n,position:t,answersCount:e.length,showedAnswersCount:this._getShownItemsCount(e,t)},this.controllers.compose.getParamsForQualityMetrics()))}}},{key:"logSuggestSelect",value:function(e){var t=g.a.getActiveScenario(S.b),n=this.subjectsSuggest,r=n.requestId,o=n.suggestItems,i=n.suggestType;t&&t.logStep(E.h,{reqid:r,position:i,answersCount:o.length,showedAnswersCount:this._getShownItemsCount(o,i),answerLen:(e&&e.text||"").length,clickPosition:_.indexOf(o,e)}),this.complexityLogger.addSmartSubjectUsage(e,o)}},{key:"_getShownItemsCount",value:function(e,t){return t===O.SmartSubjectType.POPUP?Math.min(e.length,O.Limits.MAX_SUGGEST_ITEMS_FOR_POPUP):e.length}},{key:"complexityLogger",get:function(){return this.controllers.compose.complexityLogger}},{key:"subjectsSuggest",get:function(){return this.visualState.subjectsSuggest}}]),t})(C.a),(function(e,t,n,r,o){var i={};return Object.keys(r).forEach((function(e){i[e]=r[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce((function(n,r){return r(e,t,n)||n}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i})(h.prototype,"_updateResults",[v.action],Object.getOwnPropertyDescriptor(h.prototype,"_updateResults"),h.prototype),h)},3525:function(e,t,n){"use strict";function r(e){"@babel/helpers - typeof";return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e){return c(e)||a(e)||i()}function i(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function a(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function c(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function l(e,t,n){return t&&u(e.prototype,t),n&&u(e,n),e}function p(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?f(e):t}function f(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function d(e){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function y(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&b(e,t)}function b(e,t){return(b=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function m(e,t,n,r,o){var i={};return Object.keys(r).forEach((function(e){i[e]=r[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce((function(n,r){return r(e,t,n)||n}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}n.d(t,"a",(function(){return E}));var h,v=n(444),O=n(366),g=(n.n(O),n(393)),_=n.n(g),S=n(351),E=(h=(function(e){function t(){return s(this,t),p(this,d(t).apply(this,arguments))}return y(t,e),l(t,[{key:"searchContacts",value:function(e,t){this._search(O.SuggestTypes.QUERY,e,t)}},{key:"searchPopular",value:function(e){this._search(O.SuggestTypes.POPULAR,null,e)}},{key:"_search",value:function(e,t,n){var r=this;this.showSuggest({field:n,query:t});var o=this.excludedAddresses,i=Promise.resolve([]);e===O.SuggestTypes.POPULAR?i=this.suggestService.getPopularContactsSuggest(o):e===O.SuggestTypes.QUERY&&t?i=this.suggestService.getQuerySuggest(t,o):e=null,i.then((function(t){return r._updateContacts(t,e,n)}))}},{key:"showSuggest",value:function(e){var t=e.field,n=e.query;this.suggest.field=t,this.suggest.query=n,this.logSuggestService.markSuggestShown(t)}},{key:"closeSuggest",value:function(e){this._updateContacts([],null,e),this.suggest.field===e&&(this.suggest.field="")}},{key:"_updateContacts",value:function(e,t,n){if(this.suggest.field===n){var r=this.selfRecipientController.processSelfRecipient({contacts:e,suggestType:t});this.suggest.contacts=r,this.suggest.type=t}}},{key:"getSuggestContacts",value:function(e){return e===this.suggest.field?this.suggest.contacts:S.observable.array([])}},{key:"suggestService",get:function(){return this.services.suggest}},{key:"selfRecipientController",get:function(){return this.controllers.selfRecipient}},{key:"logSuggestService",get:function(){return this.services.logSuggest}},{key:"suggest",get:function(){return this.visualState.contactsSuggest}},{key:"excludedAddresses",get:function(){return[].concat(o(v.b.flattenContacts(this.data.addresses.to)),o(v.b.flattenContacts(this.data.addresses.cc)),o(v.b.flattenContacts(this.data.addresses.bcc)))}}]),t})(_.a),m(h.prototype,"showSuggest",[S.action],Object.getOwnPropertyDescriptor(h.prototype,"showSuggest"),h.prototype),m(h.prototype,"closeSuggest",[S.action],Object.getOwnPropertyDescriptor(h.prototype,"closeSuggest"),h.prototype),m(h.prototype,"_updateContacts",[S.action],Object.getOwnPropertyDescriptor(h.prototype,"_updateContacts"),h.prototype),h)},3526:function(e,t,n){"use strict";function r(e){"@babel/helpers - typeof";return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t,n,r,o,i,a){try{var c=e[i](a),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,o)}function i(e){return function(){var t=this,n=arguments;return new Promise(function(r,i){function a(e){o(s,r,i,a,c,"next",e)}function c(e){o(s,r,i,a,c,"throw",e)}var s=e.apply(t,n);a(void 0)})}}function a(e){return u(e)||s(e)||c()}function c(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function s(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function u(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function p(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function f(e,t,n){return t&&p(e.prototype,t),n&&p(e,n),e}function d(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?y(e):t}function y(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function b(e){return(b=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function m(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&h(e,t)}function h(e,t){return(h=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function v(e,t,n,r,o){var i={};return Object.keys(r).forEach((function(e){i[e]=r[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce((function(n,r){return r(e,t,n)||n}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}n.d(t,"a",(function(){return R}));var O,g=n(138),_=n.n(g),S=n(351),E=n(908),P=n(905),C=(n.n(P),n(367)),w=n(393),T=n.n(w),k="<div><br/></div>",R=(O=(function(e){function t(){return l(this,t),d(this,b(t).apply(this,arguments))}return m(t,e),f(t,[{key:"openTemplate",value:function(e){var t=this,n=this.controllers.serialization.isEmpty();if(this.services.composeParams.isNewMessage()&&n)return void this.environmentAdapter.openTemplate({params:{ids:e.mid}});this.services.templates.loadTemplateData(e.mid,this.services.composeParams.getMessageType()).then((function(e){return t.applyTemplateData(e)}))}},{key:"applyTemplateData",value:function(e){var t=this,n=this.services.checkEmptyDraft.isSubjectEmpty(this.data.subject),r=this.services.checkEmptyDraft.isSubjectEmpty(e.subject);n&&!r&&(this.data.subject=e.subject),["to","cc","bcc"].forEach(Object(S.action)((function(n){t.data.addresses[n]=t.mergeContacts(t.data.addresses[n],e.addresses[n])}))),e.messageBody&&this.controllers.messageBody.replaceText(this.makeMessageBody(e.messageBody,this.controllers.messageBody.text)),this.data.attachments=[].concat(a(this.data.attachments),a(e.attachments))}},{key:"makeMessageBody",value:function(e,t){var n=Object(E.b)({messageBody:t,signatureMatches:this.services.signatures.getMatches()}),r=n.quotes,o=n.forward;if(!r&&!o)return e;var i=Object(E.c)({messageBody:e,signatureMatches:this.services.signatures.getMatches()}),a=i.beforeSignature,c=i.signature,s=i.afterSignature;return this.concatBodyParts({quotes:r,forward:o,beforeSignature:a,signature:c,afterSignature:s})}},{key:"concatBodyParts",value:function(e){var t=e.forward,n=e.quotes,r=e.beforeSignature,o=e.signature,i=e.afterSignature,a=r;return this.services.settings.isTopSignature&&(a+=o),t&&(a=this.smartPadText(a),a+=t),n&&(a=this.smartPadText(a),a+=n),o&&!this.services.settings.isTopSignature&&((t||n)&&(a=this.smartPadText(a)),a+=o),a+=i}},{key:"smartPadText",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,n=e;t&&(_.a.endsWith(n,k)||_.a.endsWith(n,"<div>&nbsp;</div>"));){var r=_.a.endsWith(n,k)?k.length:"<div>&nbsp;</div>".length;n=n.substring(0,n.length-r),t-=1}for(;t>0;)e+=k,t-=1;return e}},{key:"mergeContacts",value:function(e,t){var n=[].concat(a(e),a(t));return _.a.uniq(n,(function(e){return e.email}))}},{key:"createTemplate",value:(function(){function e(){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.saveTemplate();case 2:if(!e.sent){e.next=4;break}this.environmentAdapter.onShowNotification({name:"template_created"});case 4:case"end":return e.stop()}}),e,this)})));return e})()},{key:"updateTemplate",value:(function(){function e(){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.saveTemplate();case 2:if(!e.sent){e.next=6;break}t=this.data.subject||Object(C.default)("compose-react/Без_темы")||"",t.length>15&&(t="".concat(t.substring(0,12),"...")),this.environmentAdapter.onShowNotification({name:"template_updated",params:{name:t}});case 6:case"end":return e.stop()}}),e,this)})));return e})()},{key:"saveTemplate",value:(function(){function e(){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.prepareTemplate();case 2:if(!e.sent){e.next=6;break}return e.next=5,this.controllers.saveSend.saveMessage({asTemplate:!0,isForce:!0});case 5:return e.abrupt("return",!0);case 6:case"end":return e.stop()}}),e,this)})));return e})()},{key:"prepareTemplate",value:(function(){function e(){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark((function e(){var t,n,r,o=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=o.length>0&&void 0!==o[0]?o[0]:{},n=t.asNew,e.prev=1,e.next=4,this.services.templates.ensureTemplatesFolder();case 4:return r=e.sent,this.markAsTemplate(r,n),this.controllers.autoSave.stopAutosave(),e.abrupt("return",!0);case 10:return e.prev=10,e.t0=e.catch(1),this.services.errors.sendException(P.TEMPLATES_FOLDER_CREATION_FAILED,e.t0),e.abrupt("return",!1);case 14:case"end":return e.stop()}}),e,this,[[1,10]])})));return e})()},{key:"markAsTemplate",value:function(e,t){this.data.isTemplate=!0,this.data.templatesFolderId=e,t&&(this.data.overwriteIds=null)}},{key:"saveAsNewTemplate",value:(function(){function e(){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.prepareTemplate({asNew:!0});case 2:if(!e.sent){e.next=6;break}return e.next=5,this.controllers.saveSend.saveMessage({asTemplate:!0,isForce:!0});case 5:this.environmentAdapter.onShowNotification({name:"template_created"});case 6:case"end":return e.stop()}}),e,this)})));return e})()},{key:"manageTemplates",value:(function(){function e(){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.environmentAdapter.openTemplatesManager();case 2:case"end":return e.stop()}}),e,this)})));return e})()}]),t})(T.a),v(O.prototype,"applyTemplateData",[S.action],Object.getOwnPropertyDescriptor(O.prototype,"applyTemplateData"),O.prototype),v(O.prototype,"markAsTemplate",[S.action],Object.getOwnPropertyDescriptor(O.prototype,"markAsTemplate"),O.prototype),O)},3527:function(e,t,n){"use strict";function r(e){"@babel/helpers - typeof";return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t,n,r,o,i,a){try{var c=e[i](a),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,o)}function i(e){return function(){var t=this,n=arguments;return new Promise(function(r,i){function a(e){o(s,r,i,a,c,"next",e)}function c(e){o(s,r,i,a,c,"throw",e)}var s=e.apply(t,n);a(void 0)})}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t,n){return t&&c(e.prototype,t),n&&c(e,n),e}function u(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?p(e):t}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function p(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function f(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&d(e,t)}function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function y(e,t,n,r){n&&Object.defineProperty(e,t,{enumerable:n.enumerable,configurable:n.configurable,writable:n.writable,value:n.initializer?n.initializer.call(r):void 0})}function b(e,t,n,r,o){var i={};return Object.keys(r).forEach((function(e){i[e]=r[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce((function(n,r){return r(e,t,n)||n}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}n.d(t,"a",(function(){return E}));var m,h,v,O=n(351),g=n(393),_=n.n(g),S=n(360),E=(n.n(S),m=v=(function(e){function t(){var e,n;a(this,t);for(var r=arguments.length,o=new Array(r),c=0;c<r;c++)o[c]=arguments[c];return n=u(this,(e=l(t)).call.apply(e,[this].concat(o))),y(p(n),"doAfterTranslate",h,p(n)),n.toggleTranslator=i(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=!n.isTranslatorEnabled)){e.next=6;break}return n.controllers.messageBody.dumpText({withRaw:!0}),e.next=5,n.services.translate.init();case 5:n.setDefaultLanguages();case 6:n.isTranslatorEnabled=t,n.services.metrika.sendFooterMetrika(S.COMPOSE_METRIKA_TRANSLATION_TRANSLATE_BUTTON);case 8:case"end":return e.stop()}}),e)}))),n}return f(t,e),s(t,[{key:"setDefaultLanguages",value:function(){var e=this.visualState.translate;e.translateFrom||(e.translateFrom=this.services.translate.getDefaultLanguageFrom(this.controllers.messageBody.text)),e.translateTo||(e.translateTo=this.services.translate.getDefaultLanguageTo(e.translateFrom))}},{key:"isTranslatorEnabled",get:function(){return this.visualState.translate.isEnabled},set:function(e){this.visualState.translate.isEnabled=e}}]),t})(_.a),b(m.prototype,"isTranslatorEnabled",[O.computed],Object.getOwnPropertyDescriptor(m.prototype,"isTranslatorEnabled"),m.prototype),h=b(m.prototype,"doAfterTranslate",[O.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t,n){var r=e.services.translate;if(r.currentTranslationPromise)return t.isLocked=!0,void r.currentTranslationPromise.then(Object(O.action)((function(){return e.doAfterTranslate(t,n)})));t.isLocked=!1;var o=t.translate.translation,i=t.translate.postTranslation?t.translate.postTranslation(o):o;n(i)}}}),b(m.prototype,"setDefaultLanguages",[O.action],Object.getOwnPropertyDescriptor(m.prototype,"setDefaultLanguages"),m.prototype),m)},3528:function(e,t,n){"use strict";function r(e){"@babel/helpers - typeof";return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e){return c(e)||a(e)||i()}function i(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function a(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function c(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function l(e,t,n){return t&&u(e.prototype,t),n&&u(e,n),e}function p(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?f(e):t}function f(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function d(e){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function y(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&b(e,t)}function b(e,t){return(b=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}n.d(t,"a",(function(){return S}));var m,h=n(138),v=(n.n(h),n(351)),O=n(369),g=n(393),_=n.n(g),S=(m=(function(e){function t(){return s(this,t),p(this,d(t).apply(this,arguments))}return y(t,e),l(t,[{key:"validateData",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this._getValidationErrors(e);return this.validation.errors=t,!t.length}},{key:"_getValidationErrors",value:function(e){var t=this._validateAddresses("addresses",[{fieldName:"to",addresses:this.data.addresses.to},{fieldName:"cc",addresses:this.data.addresses.cc},{fieldName:"bcc",addresses:this.data.addresses.bcc}]);return[].concat(o(this._validateRequiredAddresses("addresses",["to"],[].concat(o(this.data.addresses.to),o(this.data.addresses.cc),o(this.data.addresses.bcc)))),o(e?t:[]),o(this._validateAttachments("attachments",this.data.attachments)))}},{key:"_validateRequiredAddresses",value:function(e,t,n){return n&&n.length?[]:[{fieldName:e,additionalFieldNames:t,errorKey:"compose-react/Validation_errors_RecipientRequired"}]}},{key:"_trimEmail",value:function(e){return e.length>23?"".concat(e.slice(0,22),"…"):e}},{key:"_validateAddresses",value:function(e,t){var n=new Set,r=[],i=0,a=!0,c=!1,s=void 0;try{for(var u,l=t[Symbol.iterator]();!(a=(u=l.next()).done);a=!0){var p=u.value,f=p.fieldName,d=p.addresses,y=!0,b=!1,m=void 0;try{for(var h,v=d[Symbol.iterator]();!(y=(h=v.next()).done);y=!0){var O=h.value;i++;var g=this.contactsStore.findContactByEmail(O.email);g&&g.isValid()||(this.logService.logValidationFail(O.email,g),r.push(O.email),n.add(f))}}catch(e){b=!0,m=e}finally{try{y||null==v.return||v.return()}finally{if(b)throw m}}}}catch(e){c=!0,s=e}finally{try{a||null==l.return||l.return()}finally{if(c)throw s}}var _=[];if(r.length>0){var S=1===i?"compose-react/Validation_errors_InvalidOnlyOneEmail_Detailed":"compose-react/Validation_errors_InvalidEmails_Detailed",E=r.length>3?[].concat(o(r.slice(0,3)),[".."]):r,P=E.map(this._trimEmail),C={fieldName:e,additionalFieldNames:o(n),errorTitleKey:"compose-react/Validation_errors_InvalidEmails_Title",errorTitleKeyParams:{isOne:1===r.length},errorKey:S,errorKeyParams:{count:r.length,emails:P.join(", "),email:P[0]}};_.push(C)}return _}},{key:"_validateAttachments",value:function(e,t){return t.filter((function(e){return e.status!==O.c.COMPLETED})).length?[{fieldName:e,errorTitleKey:"compose-react/Validation_errors_AttachmentsLoading_Title",errorKey:"compose-react/Validation_errors_AttachmentsLoading"}]:[]}},{key:"processValidationErrors",value:function(e,t){var n=this;e.forEach((function(e){var r=e.fieldName,o=e.additionalFieldNames;"addresses"===r&&o.forEach((function(e){["to","cc","bcc"].includes(e)&&(t.addresses[e]=Object(h.sortBy)(t.addresses[e],(function(e){var t=n.contactsStore.findContactByEmail(e.email);return t&&t.isValid()})))}))}))}},{key:"contactsStore",get:function(){return this.stores.contacts}},{key:"logService",get:function(){return this.services.logContactValidation}}]),t})(_.a),(function(e,t,n,r,o){var i={};return Object.keys(r).forEach((function(e){i[e]=r[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce((function(n,r){return r(e,t,n)||n}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i})(m.prototype,"validateData",[v.action],Object.getOwnPropertyDescriptor(m.prototype,"validateData"),m.prototype),m)},3529:function(e,t,n){"use strict";function r(e){"@babel/helpers - typeof";return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}function c(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?s(e):t}function s(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function f(e,t,n,r,o){var i={};return Object.keys(r).forEach((function(e){i[e]=r[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce((function(n,r){return r(e,t,n)||n}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}n.d(t,"a",(function(){return g}));var d,y=n(393),b=n.n(y),m=n(351),h=n(399),v=(n.n(h),n(501)),O=n(366),g=(n.n(O),d=(function(e){function t(){return o(this,t),c(this,u(t).apply(this,arguments))}return l(t,e),a(t,[{key:"onClosePromo",value:function(){this.visualState.currentPromo=null,this.environmentAdapter.onClosePromo()}},{key:"onShowPromo",value:function(){this.environmentAdapter.onShowPromo()}},{key:"collapseAllComposes",value:function(){this.environmentAdapter.collapseAllComposes()}},{key:"closeCurrentPopup",value:function(){this.visualState.currentPopup="",this.visualState.isLocked=!1,this.validation.sendError=null}},{key:"openPopup",value:function(){this.visualState.currentPopup=O.Popups.EMPTY_SUBJECT}},{key:"isSmall",get:function(){return this.visualState.size===h.ComposeSizes.SMALL}},{key:"moreButtonOptions",get:function(){var e=[];return e.push(v.a.LABELS),e.push(v.a.SIGNATURES),e.push(v.a.SEPARATOR),this.isSmall&&e.push(v.a.TRANSLATOR),e.push(v.a.AUTOCOMPLETE),e.push(v.a.SMART_SUBJECT),e}}]),t})(b.a),f(d.prototype,"isSmall",[m.computed],Object.getOwnPropertyDescriptor(d.prototype,"isSmall"),d.prototype),f(d.prototype,"moreButtonOptions",[m.computed],Object.getOwnPropertyDescriptor(d.prototype,"moreButtonOptions"),d.prototype),f(d.prototype,"onClosePromo",[m.action],Object.getOwnPropertyDescriptor(d.prototype,"onClosePromo"),d.prototype),f(d.prototype,"closeCurrentPopup",[m.action],Object.getOwnPropertyDescriptor(d.prototype,"closeCurrentPopup"),d.prototype),f(d.prototype,"openPopup",[m.action],Object.getOwnPropertyDescriptor(d.prototype,"openPopup"),d.prototype),d)},3530:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n.d(t,"ATTACHMENTS",(function(){return r})),n.d(t,"ATTACHMENTS_DISK",(function(){return o})),n.d(t,"ATTACHMENTS_MAIL",(function(){return i})),n.d(t,"AUTOCOMPLETE",(function(){return a})),n.d(t,"DELAYED_SENDING",(function(){return c})),n.d(t,"DELETE_DRAFT",(function(){return s})),n.d(t,"LABELS",(function(){return u})),n.d(t,"NOTIFICATIONS",(function(){return l})),n.d(t,"SMART_SUBJECT",(function(){return p})),n.d(t,"TEMPLATES",(function(){return f})),n.d(t,"TRANSLATOR",(function(){return d})),n.d(t,"SEPARATOR",(function(){return y})),n.d(t,"SIGNATURES",(function(){return b}));var r="Attachments",o="Attachments Disk",i="Attachments Mail",a="Autocomplete",c="DelayedSending",s="DeleteDraft",u="Labels",l="Notifications",p="Smart Subject",f="Templates",d="Translator",y="Separator",b="Signatures"},3531:function(e,t,n){"use strict";var r=this&&this.__extends||(function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}})(),o=this&&this.__decorate||function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.MessageBodyController=void 0;var a=n(351),c=i(n(393)),s=(function(e){function t(t){var n=e.call(this,t)||this;return n._text="",n._rawText="",n._text=t.data.initialMessageBody,n}return r(t,e),t.prototype.connect=function(e){this.textGetters=e},t.prototype.dumpText=function(e){var t=e.withRaw;this.textGetters&&(this._text=this.textGetters.text(),t&&(this._rawText=this.textGetters.raw()))},t.prototype.replaceText=function(e){var t;this._text=e,null===(t=this.textGetters)||void 0===t||t.onReplace(e)},Object.defineProperty(t.prototype,"text",{get:function(){return this._text},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"rawText",{get:function(){return this._rawText},enumerable:!1,configurable:!0}),o([a.observable],t.prototype,"_text",void 0),o([a.observable],t.prototype,"_rawText",void 0),o([a.action],t.prototype,"dumpText",null),o([a.action],t.prototype,"replaceText",null),o([a.computed],t.prototype,"text",null),o([a.computed],t.prototype,"rawText",null),t})(c.default);t.MessageBodyController=s},3532:function(e,t,n){"use strict";var r=this&&this.__extends||(function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}})(),o=this&&this.__decorate||function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=n(351),c=i(n(393)),s=n(704),u=4*s.SECOND,l=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.isVisible=!1,t.hide=function(){t.isVisible=!1},t}return r(t,e),Object.defineProperty(t.prototype,"settingsService",{get:function(){return this.services.settings},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dateService",{get:function(){return this.services.date},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"metrikaService",{get:function(){return this.services.metrika},enumerable:!1,configurable:!0}),t.prototype.showAutosaveNotification=function(e){var t=this.dateService.now.getTime();this.settingsService.muteAutosavePromoUntil>t||this.settingsService.numberOfAutosavePromoShow>2||(this.settingsService.numberOfAutosavePromoShow++,this.settingsService.muteAutosavePromoUntil=t+this.settingsService.numberOfAutosavePromoShow*s.WEEK,this.show(e),this.metrikaService.sendMetrika("compose tooltip","show","autosave"))},t.prototype.show=function(e){window.clearTimeout(this.timer),this.content=e,this.isVisible=!0,this.timer=window.setTimeout(this.hide,u)},o([a.observable],t.prototype,"isVisible",void 0),o([a.observable],t.prototype,"content",void 0),o([a.action],t.prototype,"show",null),o([a.action],t.prototype,"hide",void 0),t})(c.default);t.default=l},3533:function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e}function a(e,t,n,r){n&&Object.defineProperty(e,t,{enumerable:n.enumerable,configurable:n.configurable,writable:n.writable,value:n.initializer?n.initializer.call(r):void 0})}function c(e,t,n,r,o){var i={};return Object.keys(r).forEach((function(e){i[e]=r[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce((function(n,r){return r(e,t,n)||n}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}n.d(t,"a",(function(){return U}));var s,u,l,p,f,d,y,b,m,h,v,O,g,S,E,P,C,w,T,k,R,A,j,M,I,D,N,L,x,z,B=n(351),F=n(139),U=(n.n(F),s=B.observable.ref,u=B.observable.ref,l=B.observable.ref,p=z=(function(){function e(t,n,o){r(this,e),a(this,"addresses",f,this),a(this,"subject",d,this),a(this,"_initialMessageBody",y,this),a(this,"messageFormat",b,this),a(this,"inReplyTo",m,this),a(this,"currentFolder",h,this),a(this,"overwriteIds",v,this),a(this,"ignOverwrite",O,this),a(this,"references",g,this),a(this,"markIds",S,this),a(this,"markAs",E,this),a(this,"lastSaved",P,this),a(this,"attachments",C,this),a(this,"sendTime",w,this),a(this,"messageId",T,this),a(this,"notifications",k,this),a(this,"captcha",R,this),a(this,"checkboxCaptcha",A,this),a(this,"labelIds",j,this),a(this,"userLabels",M,this),a(this,"otherLabels",I,this),a(this,"templatesFolderId",D,this),a(this,"isTemplate",N,this),a(this,"allowEmptySubject",L,this),a(this,"signature",x,this),this.addresses={from:t,to:n.to,cc:n.cc,bcc:n.bcc,initial_to:n.initial_to||[],initial_cc:n.initial_cc||[]},this.subject=n.subj,this._initialMessageBody=n.send,this.messageFormat=n.ttype,this.inReplyTo=n.inreplyto,this.currentFolder=n.current_folder,this.overwriteIds=n.overwrite,this.ignOverwrite=n.ign_overwrite,this.references=n.references,this.markIds=n.mark_ids||[],this.markAs=n.mark_as,this.sendTime=n.send_time?new Date(n.send_time):null,this.labelIds=n.lids||[],this.templatesFolderId=n.templates_fid,this.isTemplate=n.save_symbol===F.WellKnownFolderSymbol.TEMPLATE,this.messageId=n.message_id,this.signature=o}return i(e,[{key:"hasNotifications",get:function(){return _.values(this.notifications).filter((function(e){return e})).length>0}},{key:"initialMessageBody",get:function(){return this._initialMessageBody}}]),e})(),f=c(p.prototype,"addresses",[B.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),d=c(p.prototype,"subject",[B.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),y=c(p.prototype,"_initialMessageBody",[B.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),b=c(p.prototype,"messageFormat",[B.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),m=c(p.prototype,"inReplyTo",[B.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),h=c(p.prototype,"currentFolder",[B.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),v=c(p.prototype,"overwriteIds",[s],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),O=c(p.prototype,"ignOverwrite",[B.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),g=c(p.prototype,"references",[B.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),S=c(p.prototype,"markIds",[u],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),E=c(p.prototype,"markAs",[B.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),P=c(p.prototype,"lastSaved",[B.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),C=c(p.prototype,"attachments",[B.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),w=c(p.prototype,"sendTime",[B.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),T=c(p.prototype,"messageId",[B.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),k=c(p.prototype,"notifications",[B.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{delivery:!1,reply:!1,replyTime:null}}}),R=c(p.prototype,"captcha",[B.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{key:"",imgUrl:"",value:""}}}),A=c(p.prototype,"checkboxCaptcha",[B.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{token:""}}}),j=c(p.prototype,"labelIds",[l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),M=c(p.prototype,"userLabels",[B.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),I=c(p.prototype,"otherLabels",[B.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),D=c(p.prototype,"templatesFolderId",[B.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),N=c(p.prototype,"isTemplate",[B.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),L=c(p.prototype,"allowEmptySubject",[B.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),x=c(p.prototype,"signature",[B.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),c(p.prototype,"hasNotifications",[B.computed],Object.getOwnPropertyDescriptor(p.prototype,"hasNotifications"),p.prototype),c(p.prototype,"initialMessageBody",[B.computed],Object.getOwnPropertyDescriptor(p.prototype,"initialMessageBody"),p.prototype),p)},3534:function(e,t,n){"use strict";function r(e){return Daria.requestModelsForCompose(e)}t.a=r},3535:function(e,t,n){"use strict";function r(e,t,n,r,o,i,a){try{var c=e[i](a),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,o)}function o(e){return function(){var t=this,n=arguments;return new Promise(function(o,i){function a(e){r(s,o,i,a,c,"next",e)}function c(e){r(s,o,i,a,c,"throw",e)}var s=e.apply(t,n);a(void 0)})}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function c(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),e}n.d(t,"a",(function(){return s}));var s=(function(){function e(t){i(this,e),this.metaState=t}return c(e,[{key:"waitLoad",value:(function(){function e(){return t.apply(this,arguments)}var t=o(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return e})()},{key:"disconnect",value:function(){}}]),e})()},3536:function(e,t,n){"use strict";function r(e){"@babel/helpers - typeof";return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function c(e,t,n,r,o,i,a){try{var c=e[i](a),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,o)}function s(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){function i(e){c(s,r,o,i,a,"next",e)}function a(e){c(s,r,o,i,a,"throw",e)}var s=e.apply(t,n);i(void 0)})}}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function p(e,t,n){return t&&l(e.prototype,t),n&&l(e,n),e}function f(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?d(e):t}function d(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function y(e){return(y=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function b(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&m(e,t)}function m(e,t){return(m=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}n.d(t,"a",(function(){return _}));var h=n(3537),v=n(1794),O=n(1008),g=(n.n(O),n(363)),_=(function(e){function t(e){var n;return u(this,t),n=f(this,y(t).call(this)),n.metaState=e,n}return b(t,e),p(t,[{key:"onSaveSuccess",value:(function(){function e(){return t.apply(this,arguments)}var t=s(regeneratorRuntime.mark((function e(){var t,n=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(t=this.metaState).onSaveSuccess.apply(t,n));case 1:case"end":return e.stop()}}),e,this)})));return e})()},{key:"onSaveFailed",value:(function(){function e(){return t.apply(this,arguments)}var t=s(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return e})()},{key:"onSending",value:(function(){function e(){return t.apply(this,arguments)}var t=s(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.metaState.undoSendController.logSendMail();case 1:case"end":return e.stop()}}),e,this)})));return e})()},{key:"onSendSuccess",value:(function(){function e(){return t.apply(this,arguments)}var t=s(regeneratorRuntime.mark((function e(){var t,n=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(t=this.metaState).onSendSuccess.apply(t,n));case 1:case"end":return e.stop()}}),e,this)})));return e})()},{key:"onSendFailed",value:(function(){function e(){return t.apply(this,arguments)}var t=s(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return e})()},{key:"onShowNotification",value:(function(){function e(e){return t.apply(this,arguments)}var t=s(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Daria.Statusline.show(i({shouldSkipAnimation:!0,hideOnClick:!1,timeout:3e3},t));case 1:case"end":return e.stop()}}),e)})));return e})()},{key:"onNeedRemoveDraft",value:(function(){function e(e){return t.apply(this,arguments)}var t=s(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,h.a.removeDraft(t);case 3:e.next=7;break;case 5:e.prev=5,e.t0=e.catch(0);case 7:Daria.Statusline.show({shouldSkipAnimation:!0,hideOnClick:!1,timeout:3e3,name:"draft_removed"});case 8:case"end":return e.stop()}}),e,null,[[0,5]])})));return e})()},{key:"onFieldChanged",value:(function(){function e(e){return t.apply(this,arguments)}var t=s(regeneratorRuntime.mark((function e(t){var n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.fieldName,r=this.metaState.undoSendController,e.t0=n,e.next="to"===e.t0?5:"cc"===e.t0?5:"bcc"===e.t0?5:"subject"===e.t0?7:"body"===e.t0?9:"attachments"===e.t0?11:13;break;case 5:return r.logRecipientsChanged(n),e.abrupt("break",13);case 7:return r.logSubjectChanged(),e.abrupt("break",13);case 9:return r.logBodyChanged(),e.abrupt("break",13);case 11:return r.logAttachesChanged(),e.abrupt("break",13);case 13:case"end":return e.stop()}}),e,this)})));return e})()},{key:"onClose",value:(function(){function e(e){return t.apply(this,arguments)}var t=s(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.leaveType,this.metaState.onClose({leaveType:n});case 2:case"end":return e.stop()}}),e,this)})));return e})()},{key:"openTemplate",value:(function(){function e(e){return t.apply(this,arguments)}var t=s(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.params,e.next=3,Daria.composeGo(n);case 3:this.metaState.setWaitToClose(!0);case 4:case"end":return e.stop()}}),e,this)})));return e})()},{key:"openTemplatesManager",value:(function(){function e(){return t.apply(this,arguments)}var t=s(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:ns.page.go("#template");case 1:case"end":return e.stop()}}),e)})));return e})()},{key:"openSignaturesSettings",value:(function(){function e(){return t.apply(this,arguments)}var t=s(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:ns.page.go("#setup/sender");case 1:case"end":return e.stop()}}),e)})));return e})()},{key:"manageLabels",value:(function(){function e(){return t.apply(this,arguments)}var t=s(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.metaState.setWaitToCollapse(!0),ns.page.go("#setup/folders");case 2:case"end":return e.stop()}}),e,this)})));return e})()},{key:"changeSize",value:(function(){function e(e,n){return t.apply(this,arguments)}var t=s(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.metaState.changeSize(t,n);case 1:case"end":return e.stop()}}),e,this)})));return e})()},{key:"onClosePromo",value:(function(){function e(){return t.apply(this,arguments)}var t=s(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.metaState.onClosePromo();case 1:case"end":return e.stop()}}),e,this)})));return e})()},{key:"onShowPromo",value:(function(){function e(){return t.apply(this,arguments)}var t=s(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.metaState.onShowPromo();case 1:case"end":return e.stop()}}),e,this)})));return e})()},{key:"collapseAllComposes",value:function(){this.metaState.collapseAllComposes()}},{key:"checkAuthConfirmed",value:function(e){return O.PassportStore.instance().checkAuthConfirmed(e)}},{key:"showAbookPopup",value:function(e){return this.metaState.showAbookPopup(e)}},{key:"showPddRestrictPopup",value:function(){Object(g.getPddRestrictModel)().showPopup()}}]),t})(v.a)},3537:function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e}var a=(function(){function e(){r(this,e)}return i(e,[{key:"_getMessage",value:function(e){return ns.Model.get("message",{ids:e})}},{key:"removeDraft",value:function(e){return Daria.MOPS["remove.draft"](this._getMessage(e).getMessagesCheckedModel())}}]),e})();t.a=new a},3538:function(e,t,n){"use strict";function r(e,t,n,r,o,i,a){try{var c=e[i](a),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,o)}function o(e){return function(){var t=this,n=arguments;return new Promise(function(o,i){function a(e){r(s,o,i,a,c,"next",e)}function c(e){r(s,o,i,a,c,"throw",e)}var s=e.apply(t,n);a(void 0)})}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function c(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),e}n.d(t,"a",(function(){return u}));var s=n(1795),u=(function(){function e(){i(this,e)}return c(e,[{key:"loadWithParams",value:(function(){function e(e){return t.apply(this,arguments)}var t=o(regeneratorRuntime.mark((function e(t){var n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.initParams,r=t.options;case 1:case"end":return e.stop()}}),e)})));return e})()},{key:"saveData",value:(function(){function e(){return t.apply(this,arguments)}var t=o(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return e})()},{key:"changeWorkMode",value:(function(){function e(e){return t.apply(this,arguments)}var t=o(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.mode;case 1:case"end":return e.stop()}}),e)})));return e})()},{key:"changeSize",value:(function(){function e(e){return t.apply(this,arguments)}var t=o(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return e})()},{key:"setCurrentPromo",value:(function(){function e(e,n){return t.apply(this,arguments)}var t=o(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return e})()}]),e})();Object(s.a)(u)},3539:function(e,t,n){"use strict";function r(e){"@babel/helpers - typeof";return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t,n,r,o,i,a){try{var c=e[i](a),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,o)}function i(e){return function(){var t=this,n=arguments;return new Promise(function(r,i){function a(e){o(s,r,i,a,c,"next",e)}function c(e){o(s,r,i,a,c,"throw",e)}var s=e.apply(t,n);a(void 0)})}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t,n){return t&&c(e.prototype,t),n&&c(e,n),e}function u(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?p(e):t}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function p(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function f(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&d(e,t)}function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function y(e,t,n,r){E||(E="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=r;else if(i>1){for(var a=new Array(i),c=0;c<i;c++)a[c]=arguments[c+3];t.children=a}if(t&&o)for(var s in o)void 0===t[s]&&(t[s]=o[s]);else t||(t=o||{});return{$$typeof:E,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function b(e,t,n,r){n&&Object.defineProperty(e,t,{enumerable:n.enumerable,configurable:n.configurable,writable:n.writable,value:n.initializer?n.initializer.call(r):void 0})}function m(e,t,n,r,o){var i={};return Object.keys(r).forEach((function(e){i[e]=r[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce((function(n,r){return r(e,t,n)||n}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}n.d(t,"a",(function(){return I}));var h,v,O,g,_,S,E,P=n(137),C=n.n(P),w=n(348),T=n.n(w),k=n(351),R=n(353),A=n(1797),j=n(1852),M=y(j.a,{}),I=Object(R.observer)((S=_=(function(e){function t(){var e,n;a(this,t);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return n=u(this,(e=l(t)).call.apply(e,[this].concat(o))),b(p(n),"isLoaded",O,p(n)),b(p(n),"setIsLoaded",g,p(n)),n}return f(t,e),s(t,[{key:"componentDidMount",value:(function(){function e(){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.props.metaState,e.next=3,t.waitLoad();case 3:this.setIsLoaded(!0);case 4:case"end":return e.stop()}}),e,this)})));return e})()},{key:"render",value:function(){var e=this.props,t=e.cls,n=e.metaState;if(!this.isLoaded)return null;var r=n.composeAdapter,o=r.composeState;return C.a.createElement(R.Provider,o.providedState,y(A.a,{cls:t}),M)}}]),t})(C.a.PureComponent),_.propTypes={cls:T.a.string,Meta:T.a.func,metaState:T.a.object},v=S,O=m(v.prototype,"isLoaded",[k.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),g=m(v.prototype,"setIsLoaded",[k.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){e.isLoaded=t}}}),h=v))||h},3540:function(e,t,n){"use strict";var r=n(353),o=n(530),i=r.PropTypes.arrayOrObservableArrayOf;o.a.arrayOf=i},3541:function(e,t,n){"use strict";var r=n(348),o=(n.n(r),n(530)),i=n(3542),a=n(3543),c=n(3544),s=n(682);t.a=r.PropTypes.shape({addresses:i.a.isRequired,allowEmptySubject:r.PropTypes.bool,subject:r.PropTypes.string,initialMessageBody:r.PropTypes.string.isRequired,attachments:o.a.arrayOf(s.a),captcha:a.a,checkboxCaptcha:c.a})},3542:function(e,t,n){"use strict";var r=n(348),o=(n.n(r),n(530)),i=n(793);t.a=r.PropTypes.shape({from:i.a,to:o.a.arrayOf(i.a),cc:o.a.arrayOf(i.a),bcc:o.a.arrayOf(i.a),initial_to:o.a.arrayOf(i.a),initial_cc:o.a.arrayOf(i.a)})},3543:function(e,t,n){"use strict";var r=n(348);n.n(r);t.a=r.PropTypes.shape({key:r.PropTypes.string,imgUrl:r.PropTypes.string,value:r.PropTypes.string})},3544:function(e,t,n){"use strict";var r=n(348);n.n(r);t.a=r.PropTypes.shape({token:r.PropTypes.string})},3545:function(e,t,n){"use strict";var r=n(138),o=(n.n(r),n(348)),i=n.n(o),a=n(3546),c=n(3547),s=n(369);t.a=i.a.shape({id:i.a.string.isRequired,type:i.a.oneOf(Object(r.values)(s.d)).isRequired,att_id:i.a.string,class:i.a.string,diskSrcPath:i.a.string,extension:c.a,external_transformer_filetype:i.a.string,external_transformer:i.a.string,file:i.a.object,folder:i.a.bool,from_template:i.a.bool,hid:i.a.string,mediaType:i.a.string,mid:i.a.string,name:i.a.string,narod:a.a,narodPreview:i.a.string,narodUrl:i.a.string,previewHref:i.a.string,previewSrc:i.a.string,size:i.a.oneOfType([i.a.string,i.a.number]),template_hid:i.a.string,template_mid:i.a.string,url:i.a.string})},3546:function(e,t,n){"use strict";var r=n(348),o=n.n(r);t.a=o.a.shape({url:o.a.string.isRequired,oid:o.a.string,getProgressTimer:o.a.number})},3547:function(e,t,n){"use strict";var r=n(348),o=n.n(r);t.a=o.a.shape({icon:o.a.string})},3548:function(e,t,n){"use strict";var r=n(348),o=n.n(r),i=n(138),a=n.n(i),c=n(1283),s=n(366);n.n(s);t.a=o.a.shape({contactsSuggest:o.a.arrayOf(o.a.instanceOf(c.a)),suggestField:o.a.string,suggestType:o.a.oneOf(a.a.values(s.SuggestTypes)),suggestQuery:o.a.string})},3549:function(e,t,n){"use strict";var r=n(348),o=n.n(r);t.a=o.a.shape({url:o.a.string,monogram:o.a.string,color:o.a.string})},3550:function(e,t,n){"use strict";var r=n(348),o=n.n(r);t.a=o.a.shape({isEnabled:o.a.bool.isRequired,translateFrom:o.a.string,translateTo:o.a.string,source:o.a.string,translation:o.a.string,translationsInProgress:o.a.number,postTranslation:o.a.func})},3551:function(e,t){},3552:function(e,t){},3553:function(e,t){},3554:function(e,t,n){"use strict";var r=n(137),o=(n.n(r),n(1283)),i=function(e){var t=e.contact;return t&&t.email||null};t.a=i,i.propTypes={contact:o.a}},3555:function(e,t,n){"use strict";function r(e){"@babel/helpers - typeof";return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function c(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),e}function s(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?u(e):t}function u(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function p(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function d(e,t,n,r){O||(O="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=r;else if(i>1){for(var a=new Array(i),c=0;c<i;c++)a[c]=arguments[c+3];t.children=a}if(t&&o)for(var s in o)void 0===t[s]&&(t[s]=o[s]);else t||(t=o||{});return{$$typeof:O,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}n.d(t,"a",(function(){return B}));var y,b,m,h,v,O,g=n(137),_=n.n(g),S=n(348),E=n.n(S),P=n(350),C=n.n(P),w=n(353),T=n(351),k=n(793),R=n(365),A=n(352),j=n(3556),M=n(3558),I=n(3560),D=n(444),N=n(3571),L=(n.n(N),"ComposeYabbleMenu"),x={Block:L,Block_mobile:"".concat(L,"_mobile"),Block_desktop:"".concat(L,"_desktop"),Addresses:"".concat(L,"-Addresses"),Actions:"".concat(L,"-Actions"),Item:"".concat(L,"-Item"),Item_hover:"".concat(L,"-Item_hover"),Item_active:"".concat(L,"-Item_active"),Item_address:"".concat(L,"-Item_address")},z=d("hr",{}),B=(y=Object(w.inject)("services"))(b=Object(w.observer)((v=h=(function(e){function t(){var e,n;i(this,t);for(var r=arguments.length,a=new Array(r),c=0;c<r;c++)a[c]=arguments[c];return n=s(this,(e=l(t)).call.apply(e,[this].concat(a))),n.copyActionRef=_.a.createRef(),n.renderAddress=function(e){var t=e.email,r=t===n.props.contact.email,i=C()(x.Item,x.Item_address,o({},x.Item_active,r));return d(j.a,{selected:r,address:e,cls:i,onClick:function(){return n.onSelectAddress(e)}},t)},n.renderAction=function(e){var t=e.key,n=e.Content,r=e.handler,o=e.ref;return d(M.a,{cls:x.Item,innerRef:o,onClick:r},t,n)},n}return p(t,e),c(t,[{key:"makeActionContent",value:function(e){return d(A.default,{className:x.Item.Content,loc:e})}},{key:"componentDidMount",value:function(){this._initClipboard()}},{key:"_initClipboard",value:function(){var e=this;if(this.copyActionRef.current){var t=new I.a(this.copyActionRef.current,{getText:function(){return e.props.contact.email},hoverClass:x.Item_hover});this.clip=t,t.on("success",(function(){e.props.onCopy&&e.props.onCopy()}))}}},{key:"componentWillUnmount",value:function(){this.clip&&this.clip.destroy()}},{key:"render",value:function(){var e=this.props.availableAddresses,t=this.actions,n=e.length&&t.length;return d("div",{className:C()(x.Block,this.isMobile?x.Block_mobile:x.Block_desktop)},void 0,e.length?d("div",{className:x.Addresses},void 0,e.map(this.renderAddress)):null,n?z:null,d("div",{className:x.Actions},void 0,t.map(this.renderAction)))}},{key:"onSelectAddress",value:function(e){this.props.onSelectAddress&&this.props.onSelectAddress(e.email,this.props.contact)}},{key:"isMobile",get:function(){return this.props.services.settings.isMobile}},{key:"actions",get:function(){if(D.b.isGroupContact(this.props.contact))return[];var e=[{Content:this.makeActionContent("compose-react/Edit"),key:"edit",handler:this.props.onEdit},{Content:this.makeActionContent("compose-react/WriteToThisContact"),key:"write",handler:this.props.onWriteOnly}];return I.a.canUse&&e.unshift({Content:this.makeActionContent("compose-react/Copy"),key:"copy",handler:this.props.onCopy,ref:this.copyActionRef}),e}}]),t})(_.a.PureComponent),h.propTypes={contact:k.a,availableAddresses:E.a.arrayOf(k.a).isRequired,onEdit:E.a.func,onCopy:E.a.func,onSelectAddress:E.a.func,onWriteOnly:E.a.func,services:R.a.isRequired},m=v,(function(e,t,n,r,o){var i={};return Object.keys(r).forEach((function(e){i[e]=r[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce((function(n,r){return r(e,t,n)||n}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i})(m.prototype,"isMobile",[T.computed],Object.getOwnPropertyDescriptor(m.prototype,"isMobile"),m.prototype),b=m))||b)||b},3556:function(e,t,n){"use strict";function r(e){"@babel/helpers - typeof";return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}function c(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?s(e):t}function s(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function f(e,t,n,r){v||(v="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=r;else if(i>1){for(var a=new Array(i),c=0;c<i;c++)a[c]=arguments[c+3];t.children=a}if(t&&o)for(var s in o)void 0===t[s]&&(t[s]=o[s]);else t||(t=o||{});return{$$typeof:v,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}n.d(t,"a",(function(){return D}));var d,y,b,m,h,v,O=n(137),g=n.n(O),_=n(348),S=n.n(_),E=n(350),P=n.n(E),C=n(353),w=n(351),T=n(793),k=n(365),R=n(618),A=n(140),j=(n.n(A),n(3557)),M=(n.n(j),"ComposeAddressItem"),I={Block:M,Avatar:"".concat(M,"-Avatar"),Name:"".concat(M,"-Name"),Email:"".concat(M,"-Email")},D=(d=Object(C.inject)("services"))(y=Object(C.observer)((h=m=(function(e){function t(){return o(this,t),c(this,u(t).apply(this,arguments))}return l(t,e),a(t,[{key:"render",value:function(){return f("div",{className:P()(this.props.cls,I.Block),onMouseDown:function(e){return e.preventDefault()},onClick:this.props.onClick},void 0,f(R.a,{contact:this.props.address,cls:I.Avatar}),this.renderName())}},{key:"renderName",value:function(){var e=this.props.address,t=e.name,n=e.email;if(this.isMobile)return f("span",{className:I.Name},void 0,n);var r=this.props.selected?"medium":"regular";return g.a.createElement(g.a.Fragment,null,f(A.Text,{weight:r,typography:"body-long-m",className:I.Name},void 0,t),f(A.Text,{weight:r,typography:"body-long-m",color:"secondary",className:I.Email},void 0,n))}},{key:"isMobile",get:function(){return this.props.services.settings.isMobile}}]),t})(g.a.PureComponent),m.propTypes={address:T.a,cls:S.a.string,onClick:S.a.func,services:k.a.isRequired,selected:S.a.bool},b=h,(function(e,t,n,r,o){var i={};return Object.keys(r).forEach((function(e){i[e]=r[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce((function(n,r){return r(e,t,n)||n}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i})(b.prototype,"isMobile",[w.computed],Object.getOwnPropertyDescriptor(b.prototype,"isMobile"),b.prototype),y=b))||y)||y},3557:function(e,t){},3558:function(e,t,n){"use strict";function r(e){"@babel/helpers - typeof";return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}function c(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?s(e):t}function s(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function f(e,t,n,r){d||(d="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=r;else if(i>1){for(var a=new Array(i),c=0;c<i;c++)a[c]=arguments[c+3];t.children=a}if(t&&o)for(var s in o)void 0===t[s]&&(t[s]=o[s]);else t||(t=o||{});return{$$typeof:d,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}n.d(t,"a",(function(){return P}));var d,y=n(137),b=n.n(y),m=n(348),h=n.n(m),v=n(350),O=n.n(v),g=n(140),_=(n.n(g),n(3559)),S=(n.n(_),"ComposeActionItem"),E={Block:S,Content:"".concat(S,"-Content")},P=(function(e){function t(){return o(this,t),c(this,u(t).apply(this,arguments))}return l(t,e),a(t,[{key:"render",value:function(){return b.a.createElement("div",{className:O()(this.props.cls,E.Block),onClick:this.props.onClick,ref:this.props.innerRef},f(g.Text,{typography:"body-long-m",className:E.Content},void 0,this.props.children))}}]),t})(b.a.PureComponent);P.propTypes={cls:h.a.string,innerRef:h.a.oneOfType([h.a.func,h.a.shape({current:h.a.object})]),onClick:h.a.func}},3559:function(e,t){},3560:function(e,t,n){"use strict";var r=n(3561);n.d(t,"a",(function(){return r.a}))},3561:function(e,t,n){"use strict";function r(e){"@babel/helpers - typeof";return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?l(e):t}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function l(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function p(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function f(e,t,n){return t&&p(e.prototype,t),n&&p(e,n),e}function d(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&y(e,t)}function y(e,t){return(y=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}n.d(t,"a",(function(){return w}));var b=n(1274),m=n.n(b),h=n(3562),v=n.n(h),O=n(3565),g=n.n(O),_=n(3568),S=n(3569),E=[{name:"native",adapter:_.a},{name:"flash",adapter:S.a}],P=g()(E,(function(e){return e.adapter.canUse})),C=P?P.name:null,w=(function(e){function t(e,n){var r;if(c(this,t),!t.canUse)throw new Error("Clipboard not supported");if(!n||"function"!=typeof n.getText)throw new Error("Options.getText is required for Clipboard");return r=s(this,u(t).call(this)),r.destroy=function(){return r._target&&(r._target.removeEventListener("mousedown",r._onMouseDown),r._target=null),r._currentCommand.then((function(){v()(l(r)),r._clipboard.destroy()}))},r._initAdapter=function(e,n){r._clipboard=new t.ClipboardAdapter(e,i({onReady:function(){return r.emit("ready")},onSuccess:function(){r.emit("success"),r.emit("complete")},onError:function(e){r.emit("error",e),r.emit("complete")}},n))},r._onMouseDown=function(){r._currentCommand=r._currentCommand.then((function(){return new Promise(function(e){return r.once("complete",e)})}))},r._currentCommand=Promise.resolve(),r._target=e,r._target.addEventListener("mousedown",r._onMouseDown),r._initAdapter(e,n),r}return d(t,e),f(t,null,[{key:"canUse",get:function(){return Boolean(this.tech)}},{key:"ClipboardAdapter",get:function(){var e=g()(E,{name:this.tech});return e?e.adapter:null}}]),t})(m.a);w.tech=C,window.ReactClipboard=w},3568:function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e}n.d(t,"a",(function(){return l}));var a=n(1771),c=n.n(a),s=n(5),u=(function(){return!(!s.a.UA||"MSIE"!==s.a.UA.BrowserName)&&document.documentMode})(),l=(function(){function e(t,n){var o=this,i=n.getText,a=n.onReady,s=n.onSuccess,u=n.onError;r(this,e),this._clip=null,this.destroy=function(){o._clip&&o._clip.destroy()};var l=new c.a(t,{text:i});l.on("success",s),l.on("error",u),this._clip=l,setTimeout(a)}return i(e,null,[{key:"canUse",get:function(){var e;try{e=document.queryCommandSupported("copy"),e&&!u&&document.execCommand("copy")}catch(t){e=!1}return e}}]),e})()},3569:function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e}n.d(t,"a",(function(){return u}));var a=n(1772),c=n.n(a),s=(n(1234),n(3570));c.a.config({swfPath:s,trustedDomains:[window.location.protocol+"//"+window.location.host],allowScriptAccess:"always"});var u=(function(){function e(t,n){var o=this,i=n.getText,a=n.hoverClass,s=n.onReady,u=n.onSuccess,l=n.onError;r(this,e),this._clipboard=null,this.destroy=function(){c.a.destroy(),o._clipboard&&o._clipboard.destroy()},this._target=t,c.a.config({hoverClass:a}),this._clipboard=new c.a(t),this._clipboard.on("ready",(function(){return setTimeout(s)})),this._clipboard.on("copy",(function(){o._clipboard.setText(i()),u()})),this._clipboard.on("error",l)}return i(e,null,[{key:"canUse",get:function(){return window.swfobject.hasFlashPlayerVersion("11.0.0")}}]),e})()},3570:function(e,t,n){e.exports=n.p+"_/a573941f02f4331f81046356ebb667eb-ZeroClipboard.swf"},3571:function(e,t){},3572:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return o(t,e),t},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var c=i(n(137)),s=n(353),u=a(n(350)),l=n(1803),p=a(n(3575)),f=n(620),d=s.observer((function(e){var t=e.anchor,n=e.cls,r=e.children,o=e.onClose,i=c.useRef(document.querySelector(".js-mail-App")?document.querySelector(".js-mail-App"):document.documentElement),a=f.useStores().visual.composeContainerRef;return c.default.createElement(l.Popup,{scope:a,className:u.default(p.default.root,"qa-ComposeYabblePopupDesktop",n),anchor:t,direction:["bottom-start","bottom","bottom-end"],onClose:o,visible:!0,boundary:i,hasTail:!0},r)}));t.default=d},3574:function(e,t){e.exports={root:"Popup__root--2YGQq"}},3575:function(e,t){e.exports={root:"YabblePopup__root--1ZI9z"}},3576:function(e,t,n){"use strict";function r(e){"@babel/helpers - typeof";return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}function c(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?s(e):t}function s(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var f=n(137),d=n.n(f),y=n(141),b=n.n(y),m=n(1300),h=n(3577),v=n(3578),O=(n.n(v),(function(e){function t(){var e,n;o(this,t);for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return n=c(this,(e=u(t)).call.apply(e,[this].concat(i))),n.containerRef=d.a.createRef(),n}return l(t,e),a(t,[{key:"render",value:function(){var e=this.props,t=e.scope,n=e.anchor,r=e.children;if(!t)return null;var o=n.current?{top:n.current.offsetTop+n.current.clientHeight}:null;return b.a.createPortal(d.a.createElement("div",{className:"ComposeYabblePopupMobile",ref:this.containerRef,style:o},r),t)}}]),t})(d.a.Component));O.propTypes=h.a,t.a=Object(m.a)(O)},3577:function(e,t,n){"use strict";var r=n(348),o=n.n(r),i=n(380);t.a={anchor:o.a.object,cls:o.a.string,scope:o.a.object,bounds:o.a.object,onClose:o.a.func,visual:i.a}},3578:function(e,t){},3579:function(e,t,n){"use strict";function r(e){"@babel/helpers - typeof";return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?c(e):t}function a(e){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function c(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e,t,n){return t&&s(e.prototype,t),n&&s(e,n),e}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function f(e,t,n,r){v||(v="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=r;else if(i>1){for(var a=new Array(i),c=0;c<i;c++)a[c]=arguments[c+3];t.children=a}if(t&&o)for(var s in o)void 0===t[s]&&(t[s]=o[s]);else t||(t=o||{});return{$$typeof:v,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}n.d(t,"a",(function(){return L}));var d,y,b,m,h,v,O=n(137),g=n.n(O),_=n(348),S=n.n(_),E=n(350),P=n.n(E),C=n(351),w=n(353),T=n(370),k=n(352),R=n(395),A=n.n(R),j=n(365),M=n(360),I=(n.n(M),n(3580)),D=(n.n(I),{Block:"BeautifulEmailAddressFromPromo"}),N=f(T.default.Description,{},void 0,f(k.default,{loc:"promo-react/beautiful-email-promo-compose-address"})),L=(d=Object(w.inject)("services"))(y=Object(w.observer)((h=m=(function(e){function t(e){var n;return o(this,t),n=i(this,a(t).call(this,e)),n.disposer=new A.a,n.onCloseClick=function(){n.close(),n.metrikaService.sendHeaderMetrika(M.COMPOSE_METRIKA_HEADER_PROMO_BEAUTIFUL_EMAIL_CLOSE)},n.logShow=function(e){e&&n.metrikaService.sendHeaderMetrika(M.COMPOSE_METRIKA_HEADER_PROMO_BEAUTIFUL_EMAIL_SHOW)},n.disposer.add(c(n),[Object(C.reaction)((function(){return n.props.canBeShowed}),n.logShow,{fireImmediately:!0})]),n}return l(t,e),u(t,[{key:"close",value:function(){this.props.onClose&&this.props.onClose()}},{key:"metrikaService",get:function(){return this.props.services.metrika}}]),u(t,[{key:"componentWillUnmount",value:function(){this.disposer.disposeAll()}},{key:"render",value:function(){var e=this.props,t=e.promoRef,n=e.anchorRef,r=e.scopeRef,o=e.cls,i=e.canBeShowed,a=this.onCloseClick;if(!this.wasRendered&&!i)return null;this.wasRendered=!0,this.props.onShow&&this.props.onShow();var c={hiding:!0,mainOffset:0,secondaryOffset:-8,style:{position:"absolute"},tailOffset:32,zIndex:1e4};return n.current&&g.a.createElement(T.default,{ref:t,cls:P()(D.Block,o),theme:"promo",tone:"default",size:"m",anchor:n.current,scope:r.current,visible:i,to:["top-center","top-left","top-right"],popupProps:c,tail:!0},f(T.default.Close,{onClick:a}),N)}}]),t})(g.a.PureComponent),m.propTypes={promoRef:S.a.object,anchorRef:S.a.object,scopeRef:S.a.object,canBeShowed:S.a.bool,cls:S.a.string,onClose:S.a.func,onShow:S.a.func,services:j.a.isRequired},b=h,(function(e,t,n,r,o){var i={};return Object.keys(r).forEach((function(e){i[e]=r[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce((function(n,r){return r(e,t,n)||n}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i})(b.prototype,"metrikaService",[C.computed],Object.getOwnPropertyDescriptor(b.prototype,"metrikaService"),b.prototype),y=b))||y)||y},3580:function(e,t){},3581:function(e,t,n){"use strict";function r(e){"@babel/helpers - typeof";return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}function c(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?s(e):t}function s(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function f(e,t,n,r){v||(v="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=r;else if(i>1){for(var a=new Array(i),c=0;c<i;c++)a[c]=arguments[c+3];t.children=a}if(t&&o)for(var s in o)void 0===t[s]&&(t[s]=o[s]);else t||(t=o||{});return{$$typeof:v,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}n.d(t,"a",(function(){return D}));var d,y,b,m,h,v,O=n(137),g=n.n(O),_=n(348),S=n.n(_),E=n(352),P=n(417),C=n(560),w=n(351),T=n(353),k=n(365),R=n(360),A=(n.n(R),n(3582)),j=(n.n(A),{Tooltip:"SuggestBeautifulEmailPromoTooltip",Description:"SuggestBeautifulEmailPromoTooltip__Description",Button:"SuggestBeautifulEmailPromoTooltip__Button"}),M=f(P.default,{}),I=f(E.default,{loc:"promo-react/suggest-beautiful-email-promo-compose-button"}),D=(d=Object(T.inject)("services"))(y=Object(T.observer)((h=m=(function(e){function t(){var e,n;o(this,t);for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return n=c(this,(e=u(t)).call.apply(e,[this].concat(i))),n.onCloseClick=function(){n.props.onClose&&n.props.onClose(),n.metrikaService.sendHeaderMetrika(R.COMPOSE_METRIKA_HEADER_PROMO_SUGGEST_BEAUTIFUL_EMAIL_CLOSE)},n.onActionClick=function(){n.props.onAction&&n.props.onAction(),n.props.onClose&&n.props.onClose(),n.metrikaService.sendHeaderMetrika(R.COMPOSE_METRIKA_HEADER_PROMO_SUGGEST_BEAUTIFUL_EMAIL_ACTION)},n}return l(t,e),a(t,[{key:"componentDidMount",value:function(){this.props.onShow&&this.props.onShow(),this.metrikaService.sendHeaderMetrika(R.COMPOSE_METRIKA_HEADER_PROMO_SUGGEST_BEAUTIFUL_EMAIL_SHOW)}},{key:"render",value:function(){var e=this.props,t=e.promoRef,n=e.anchorRef,r=e.scopeRef,o=e.suggestedEmail,i=e.toBottom,a=this.onCloseClick,c={hiding:!0,style:{position:"absolute"}},s=i?["bottom-center"]:["right-center","bottom-center"];return g.a.createElement(C.f,{ref:t,cls:j.Tooltip,anchor:n.current,scope:r.current,visible:!0,to:s,popupProps:c},f(C.f.Close,{onClick:a},void 0,M),f("div",{className:j.Description},void 0,f(E.default,{loc:"promo-react/suggest-beautiful-email-promo-compose-text",params:{email:o}})),f(C.a,{cls:j.Button,theme:"clear",view:"default",tone:"default",type:"link",url:"#setup/beautiful-email",onClick:this.onActionClick},void 0,I))}},{key:"metrikaService",get:function(){return this.props.services.metrika}}]),t})(g.a.PureComponent),m.propTypes={promoRef:S.a.object,anchorRef:S.a.object,scopeRef:S.a.object,onClose:S.a.func,onShow:S.a.func,onAction:S.a.func,toBottom:S.a.bool,suggestedEmail:S.a.string.isRequired,services:k.a.isRequired},b=h,(function(e,t,n,r,o){var i={};return Object.keys(r).forEach((function(e){i[e]=r[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce((function(n,r){return r(e,t,n)||n}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i})(b.prototype,"metrikaService",[w.computed],Object.getOwnPropertyDescriptor(b.prototype,"metrikaService"),b.prototype),y=b))||y)||y},3582:function(e,t){},3583:function(e,t){},3584:function(e,t,n){"use strict";function r(e){"@babel/helpers - typeof";return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){if(null==e)return{};var n,r,o=i(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function i(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t,n){return t&&c(e.prototype,t),n&&c(e,n),e}function u(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?l(e):t}function l(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function f(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&d(e,t)}function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function y(e,t,n,r,o){var i={};return Object.keys(r).forEach((function(e){i[e]=r[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce((function(n,r){return r(e,t,n)||n}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}n.d(t,"a",(function(){return A}));var b,m,h,v,O,g=n(137),_=n.n(g),S=n(353),E=n(351),P=n(799),C=n(3585),w=n(3818),T=n(382),k=n(366),R=(n.n(k),n(3840)),A=(n.n(R),(b=Object(S.inject)("controllers","data","services","visual"))(m=Object(S.observer)((O=v=(function(e){function t(){var e,n;a(this,t);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return n=u(this,(e=p(t)).call.apply(e,[this].concat(o))),n._disposer=new T.a,n.onWorkModeChanged=function(e){e===k.WorkModes.FOREGROUND&&n.initialized&&n.focus()},n}return f(t,e),s(t,[{key:"componentDidMount",value:function(){var e=this;this.hotkeysController.attachNode(this.composeContainerRef),this._disposer.add(this,[Object(E.reaction)((function(){return e.props.visual.workMode}),this.onWorkModeChanged)]);var t=setTimeout((function(){e.focus(),e.initialized=!0}));this._disposer.add(this,(function(){return clearTimeout(t)}))}},{key:"focus",value:function(){var e=this;this.composeParamsService.isReplyAny()?setTimeout((function(){return e.composeController.focusComposeField("body")}),0):this.composeController.focusComposeField("addresses.to")}},{key:"componentWillUnmount",value:function(){this._disposer.dispose(this)}},{key:"render",value:function(){var e=this.props,t=e.services,n=o(e,["services"]);return t.settings.isMobile?_.a.createElement(w.a,n):_.a.createElement(C.a,n)}},{key:"autoSaveController",get:function(){return this.props.controllers.autoSave}},{key:"hotkeysController",get:function(){return this.props.controllers.hotkeys}},{key:"composeController",get:function(){return this.props.controllers.compose}},{key:"composeParamsService",get:function(){return this.props.services.composeParams}},{key:"saveOnCloseController",get:function(){return this.props.controllers.saveOnClose}},{key:"composeContainerRef",get:function(){return this.props.visual.refs.composeContainer}}]),t})(_.a.Component),v.propTypes=P.a,h=O,y(h.prototype,"autoSaveController",[E.computed],Object.getOwnPropertyDescriptor(h.prototype,"autoSaveController"),h.prototype),y(h.prototype,"hotkeysController",[E.computed],Object.getOwnPropertyDescriptor(h.prototype,"hotkeysController"),h.prototype),y(h.prototype,"composeController",[E.computed],Object.getOwnPropertyDescriptor(h.prototype,"composeController"),h.prototype),y(h.prototype,"composeParamsService",[E.computed],Object.getOwnPropertyDescriptor(h.prototype,"composeParamsService"),h.prototype),y(h.prototype,"saveOnCloseController",[E.computed],Object.getOwnPropertyDescriptor(h.prototype,"saveOnCloseController"),h.prototype),y(h.prototype,"composeContainerRef",[E.computed],Object.getOwnPropertyDescriptor(h.prototype,"composeContainerRef"),h.prototype),m=h))||m)||m)},3585:function(e,t,n){"use strict";function r(e){"@babel/helpers - typeof";return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t,n,r,o,i,a){try{var c=e[i](a),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,o)}function i(e){return function(){var t=this,n=arguments;return new Promise(function(r,i){function a(e){o(s,r,i,a,c,"next",e)}function c(e){o(s,r,i,a,c,"throw",e)}var s=e.apply(t,n);a(void 0)})}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t,n){return t&&c(e.prototype,t),n&&c(e,n),e}function u(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?p(e):t}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function p(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function f(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&d(e,t)}function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function y(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function b(e,t,n,r){G||(G="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=r;else if(i>1){for(var a=new Array(i),c=0;c<i;c++)a[c]=arguments[c+3];t.children=a}if(t&&o)for(var s in o)void 0===t[s]&&(t[s]=o[s]);else t||(t=o||{});return{$$typeof:G,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function m(e,t,n,r){n&&Object.defineProperty(e,t,{enumerable:n.enumerable,configurable:n.configurable,writable:n.writable,value:n.initializer?n.initializer.call(r):void 0})}function h(e,t,n,r,o){var i={};return Object.keys(r).forEach((function(e){i[e]=r[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce((function(n,r){return r(e,t,n)||n}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}n.d(t,"a",(function(){return Le}));var v,O,g,_,S,E,P,C,w,T,k,R,A,j,M,I,D,N,L,x,z,B,F,U,K,H,W,G,Y,q=n(138),V=n.n(q),$=n(137),Q=n.n($),J=n(351),X=n(353),Z=n(350),ee=n.n(Z),te=n(367),ne=n(799),re=n(382),oe=n(397),ie=(n.n(oe),n(3586)),ae=n(1301),ce=(n.n(ae),n(3587)),se=n(1302),ue=n(1826),le=n(917),pe=n(921),fe=n(1837),de=n(3785),ye=n(1311),be=n(3792),me=n(3796),he=n(3798),ve=n(3800),Oe=n(366),ge=(n.n(Oe),n(399)),_e=(n.n(ge),n(1838)),Se=n(360),Ee=(n.n(Se),n(887)),Pe=(n.n(Ee),n(3812)),Ce=(n.n(Pe),n(3817)),we=(n.n(Ce),{SCROLLABLE_CONTENT:"composeReact__scrollable-content",MBodyPanels:"composeReact-MBodyPanels"}),Te={TOP_CONTENT:124,TOP_FIElD:36},ke=(W={},y(W,Oe.FixedModes.NORMAL,{minContentHeight:504}),y(W,Oe.FixedModes.SMALL,{minContentHeight:291}),W),Re=7,Ae=b(Pe.HeaderButtons,{}),je=b(be.a,{}),Me=b(he.a,{}),Ie=b(se.b,{}),De=b(le.a,{}),Ne=b(me.a,{}),Le=(v=Object(X.inject)("data","visual","services","controllers"),O=J.observable.ref,v(g=Object(X.observer)((H=K=(function(e){function t(){var e,n;a(this,t);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return n=u(this,(e=l(t)).call.apply(e,[this].concat(o))),n.afterUpdateQueue=[],n.disposer=new re.a,n.domNode=null,n.messageBodyRef=Q.a.createRef(),n.footerRef=Q.a.createRef(),n.attachmentsBodyRef=Q.a.createRef(),n.attachmentsHeaderRef=Q.a.createRef(),n.firstAttachmentRef=Q.a.createRef(),n.attachmentsIntersectionObserver=null,n.toolbarNodeId=V.a.uniqueId("ComposeReact-Toolbar"),n.subjectRef=Q.a.createRef(),m(p(n),"mainContent",S,p(n)),m(p(n),"attachesHeaderFixed",E,p(n)),n.bodyHeader=Q.a.createRef(),m(p(n),"setMainContent",P,p(n)),n.afterUpdate=function(e){n.afterUpdateQueue.push(e)},n.focus=function(){n.domNode&&(n.domNode.focus(),n.domNode.tabIndex=-1)},n.focusBody=function(){n.focus();var e=n.messageBodyRef.current;e&&e.focus()},m(p(n),"focusField",C,p(n)),m(p(n),"saveComposeContainerRef",w,p(n)),m(p(n),"saveTopContentRef",T,p(n)),m(p(n),"saveScrollableContentRef",k,p(n)),m(p(n),"onChangeSize",R,p(n)),m(p(n),"onDeleteAll",A,p(n)),m(p(n),"onAttachmentIntersection",j,p(n)),m(p(n),"blockScrollWidth",M,p(n)),m(p(n),"hasScroll",I,p(n)),m(p(n),"fixedMode",D,p(n)),m(p(n),"onEditorInit",N,p(n)),m(p(n),"recalculateFixedContent",L,p(n)),m(p(n),"onToggleRecipients",x,p(n)),m(p(n),"onRecipientsFieldFocus",z,p(n)),m(p(n),"onRecipientsFieldDragStart",B,p(n)),m(p(n),"onWorkModeChanged",F,p(n)),n.recalculateTopFixedContent=function(){var e=n.mainContent,t=e.offsetTop-n.topContentCollapsedHeight;t<0&&(t=0);var r=n.scrollableContent.scrollTop>t;if(r!==n.topContentInFixedMode&&(n.topContentInFixedMode=r,r)){var o=n.scrollableContent.scrollHeight-n.scrollableContent.scrollTop;n.afterUpdate((function(){Object(ae.scrollTo)(n.scrollableContent,{top:n.scrollableContent.scrollHeight-o,isSmooth:!1})}))}},n.onAttachesExpand=function(){n.metrikaService.sendAttachmentsMetrika(Se.COMPOSE_METRIKA_ATTACHMENTS_TOGGLE),n.attachesHeaderFixed&&n.firstAttachmentRef.current&&Object(ae.scrollIntoView)(n.firstAttachmentRef.current,!1)},n.expandLabels=function(){n.topContentInFixedMode&&Object(ae.scrollTo)(n.scrollableContent,{top:0})},n.onSubjectFocus=function(){n.data.subject||n.props.controllers.smartSubject.getSmartSubjectsForInput()},m(p(n),"onSubjectClick",U,p(n)),n.getInlineDropZone=function(){return n.scrollableContent},n.scrollCursorIntoView=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.boundingRect,r=e.reserveBottom,o=void 0!==r&&r,i=e.reserveTop,a=void 0!==i&&i;if(t&&!Object.keys(t).every((function(e){return 0===e}))){var c=t.height+Re,s=a?c:0,u=o?c:0,l=n.checkCursorForTop({boundingRect:t,reserveHeight:s})||n.checkCursorForBottom({boundingRect:t,reserveHeight:u});if(null!==l){var p=n.scrollableContent.scrollTop;Object(ae.scrollTo)(n.scrollableContent,{top:p+l,isSmooth:!1})}}},n.onKeyboardMove=function(e){var t=e.boundingRect,r=e.keyCode;n.scrollCursorIntoView({boundingRect:t,reserveBottom:r===oe.KeyCodes.DOWN,reserveTop:r===oe.KeyCodes.UP})},n.onChange=function(e){n.scrollCursorIntoView({boundingRect:e}),n.recalculateFixedContent()},n}return f(t,e),s(t,[{key:"getDropZoneCssRule",value:(function(){function e(){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Y){e.next=4;break}return e.next=3,Object(ie.a)(".".concat(we.SCROLLABLE_CONTENT,".cke_pasteimage_placeholder::after"));case 3:Y=e.sent;case 4:return e.abrupt("return",Y);case 5:case"end":return e.stop()}}),e)})));return e})()},{key:"componentDidMount",value:function(){var e=this;this.createAttachmentsIntersectionObserver(),window.addEventListener("resize",this.recalculateFixedContent),this.disposer.add(this,(function(){return window.removeEventListener("resize",e.recalculateFixedContent)})),this.disposer.add(this,[Object(J.reaction)((function(){return e.props.visual.focusedField}),this.focusField),Object(J.reaction)((function(){return e.props.visual.size}),this.onChangeSize),Object(J.reaction)((function(){return e.props.visual.workMode}),this.onWorkModeChanged)])}},{key:"componentDidUpdate",value:function(){this.afterUpdateQueue.forEach((function(e){return e()})),this.afterUpdateQueue=[],this.observeAttachmentBody()}},{key:"componentWillUnmount",value:function(){this.disposer.dispose(this)}},{key:"createAttachmentsIntersectionObserver",value:function(){var e=this;if(this.scrollableComposeContainer&&window.IntersectionObserver){var t={root:this.scrollableComposeContainer};this.attachmentsIntersectionObserver=new IntersectionObserver(this.onAttachmentIntersection,t),this.disposer.add(this,(function(){return e.attachmentsIntersectionObserver.disconnect()}))}}},{key:"observeAttachmentBody",value:function(){this.attachmentsIntersectionObserver&&this.attachmentsBodyRef.current&&(this.attachmentsIntersectionObserver.disconnect(),this.attachmentsIntersectionObserver.observe(this.attachmentsBodyRef.current))}},{key:"recalculateFixedMode",value:function(){if(!this.scrollableContent)return Oe.FixedModes.NONE;var e=this.scrollableContent.clientHeight;return e<ke[Oe.FixedModes.SMALL].minContentHeight?Oe.FixedModes.NONE:e>ke[Oe.FixedModes.NORMAL].minContentHeight?Oe.FixedModes.NORMAL:Oe.FixedModes.SMALL}},{key:"scrollTopIfFixed",value:function(){this.topContentInFixedMode&&Object(ae.scrollTo)(this.scrollableContent,{top:0})}},{key:"checkCursorForTop",value:function(e){var t=e.boundingRect,n=e.reserveHeight;if(!this.topContentInFixedMode)return null;var r=this.scrollableContent.getBoundingClientRect(),o=t.top+this.scrollableContent.scrollTop-r.top,i=this.scrollableContent.scrollTop,a=this.topContentCollapsedHeight+i,c=Math.max(o-n,this.headerPanelHeight+1),s=a-c;return s>0?-1*s:null}},{key:"checkCursorForBottom",value:function(e){var t=e.boundingRect,n=e.reserveHeight;if(!this.attachesHeaderFixed||!this.attachmentsHeaderRef.current)return null;var r=this.attachmentsHeaderRef.current.getBoundingClientRect(),o=t.bottom+n-r.top;return o>0?o:null}},{key:"render",value:function(){var e=this,t=this.props.cls,n=this.topContentInFixedMode,r=this.blockScrollWidth,o=this.toolbarNodeId,i=this.areAdditionalAddressesExpanded,a=this.onToggleRecipients,c=this.onRecipientsFieldFocus,s=this.onRecipientsFieldDragStart,u=this.onSubjectFocus,l={marginRight:"".concat(r,"px")},p=n?l:{},f={height:"".concat(n?this.headerPanelHeight:0,"px")},d=ee()({"composeReact__scrollable-top-content":!0,"composeReact__scrollable-top-content__fixed":n}),y=ee()("composeReact",t);return Q.a.createElement("div",{className:y,ref:this.saveComposeContainerRef,tabIndex:"-1"},b("div",{className:"composeReact__inner"},void 0,Q.a.createElement("div",{className:"composeReact__scrollable-container",ref:function(t){return e.scrollableComposeContainer=t}},Q.a.createElement("div",{className:we.SCROLLABLE_CONTENT,ref:this.saveScrollableContentRef,onScroll:this.recalculateFixedContent},Q.a.createElement("div",{className:d,ref:this.saveTopContentRef,style:p},b("div",{className:"composeReact__header"},void 0,b("div",{className:"composeReact__headerInputs"},void 0,b(fe.a,{isShowAdditionalAddresses:i,onToggleExpandedState:a,onFieldFocus:c,isAddressesCollapsed:n,onFieldDragStart:s},void 0,b(ye.a,{inputRef:this.subjectRef,title:"compose-react/Header_Subject",onFocus:u}),b(de.a,{scope:this.props.visual.refs.topContent,anchor:this.subjectRef.current}),b(ue.a,{onExpand:this.expandLabels}))),b("div",{className:"composeReact__headerButtons"},void 0,Ae,b(_e.a,{cls:"ComposeRecipients-Expander",isExpanded:i,onToggleExpanded:a}))),b("div",{id:o,className:"composeReact__toolbar"}),je),b("div",{className:"composeReact__placeholder",style:f}),Q.a.createElement("div",{className:"composeReact__main-content",ref:this.setMainContent},b(ve.a,{innerRef:this.bodyHeader,containerRef:this.mainContent}),b("div",{className:we.MBodyPanels},void 0,Q.a.createElement(pe.a,{cls:"composeReact__message-body",getInlineDropZone:this.getInlineDropZone,onChange:this.onChange,onKeyboardMove:this.onKeyboardMove,onEditorInit:this.onEditorInit,placeholder:Object(te.default)("compose-react/Editor_Placeholder"),ref:this.messageBodyRef,toolbarNodeId:o}),Me)),b("div",{className:"composeReact__scrollable-bottom-content-new"},void 0,this.shouldShowAttachments&&b(ce.a,{onDeleteAll:this.onDeleteAll,onExpand:this.onAttachesExpand,onMount:this.onAttachesMount,isFixed:this.attachesHeaderFixed,attachmentsBodyRef:this.attachmentsBodyRef,attachmentsHeaderRef:this.attachmentsHeaderRef,firstAttachmentRef:this.firstAttachmentRef})))),Q.a.createElement("div",{className:"composeReact__footer",ref:this.footerRef},Ie),b(Ee.Tooltip,{direction:"top",view:"default",size:"s",state:"warning",anchor:this.footerRef,visible:Boolean(this.notificationController.isVisible),mainOffset:23},void 0,this.notificationController.content),De,Ne))}},{key:"composeController",get:function(){return this.props.controllers.compose}},{key:"contactsController",get:function(){return this.props.controllers.contacts}},{key:"notificationController",get:function(){return this.props.controllers.notification}},{key:"metrikaService",get:function(){return this.props.services.metrika}},{key:"data",get:function(){return this.props.data}},{key:"topContentInFixedMode",get:function(){return this.props.visual.topContentInFixedMode},set:function(e){this.props.visual.topContentInFixedMode=e}},{key:"areAdditionalAddressesExpanded",get:function(){var e=this.props.visual;return!this.topContentInFixedMode&&e.additionalAddressesAreExpanded}},{key:"headerPanelHeight",get:function(){var e=this.props.visual.additionalAddressesAreExpanded?3*Te.TOP_FIElD:0;return this.topContentCollapsedHeight+e}},{key:"hasLabelsRow",get:function(){return this.props.data.userLabels.length>0}},{key:"topContentCollapsedHeight",get:function(){return Te.TOP_CONTENT+(this.hasLabelsRow?Te.TOP_FIElD:0)}},{key:"shouldShowAttachments",get:function(){return 0!==this.props.controllers.attachments.validAttachments.length}}]),t})(Q.a.Component),K.propTypes=ne.a,_=H,S=h(_.prototype,"mainContent",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),E=h(_.prototype,"attachesHeaderFixed",[J.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),P=h(_.prototype,"setMainContent",[J.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){e.mainContent=t||e.mainContent}}}),h(_.prototype,"composeController",[J.computed],Object.getOwnPropertyDescriptor(_.prototype,"composeController"),_.prototype),h(_.prototype,"contactsController",[J.computed],Object.getOwnPropertyDescriptor(_.prototype,"contactsController"),_.prototype),h(_.prototype,"notificationController",[J.computed],Object.getOwnPropertyDescriptor(_.prototype,"notificationController"),_.prototype),h(_.prototype,"metrikaService",[J.computed],Object.getOwnPropertyDescriptor(_.prototype,"metrikaService"),_.prototype),h(_.prototype,"data",[J.computed],Object.getOwnPropertyDescriptor(_.prototype,"data"),_.prototype),h(_.prototype,"topContentInFixedMode",[J.computed],Object.getOwnPropertyDescriptor(_.prototype,"topContentInFixedMode"),_.prototype),h(_.prototype,"areAdditionalAddressesExpanded",[J.computed],Object.getOwnPropertyDescriptor(_.prototype,"areAdditionalAddressesExpanded"),_.prototype),h(_.prototype,"headerPanelHeight",[J.computed],Object.getOwnPropertyDescriptor(_.prototype,"headerPanelHeight"),_.prototype),h(_.prototype,"hasLabelsRow",[J.computed],Object.getOwnPropertyDescriptor(_.prototype,"hasLabelsRow"),_.prototype),h(_.prototype,"topContentCollapsedHeight",[J.computed],Object.getOwnPropertyDescriptor(_.prototype,"topContentCollapsedHeight"),_.prototype),h(_.prototype,"shouldShowAttachments",[J.computed],Object.getOwnPropertyDescriptor(_.prototype,"shouldShowAttachments"),_.prototype),C=h(_.prototype,"focusField",[J.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){if(e.props.visual.focusedField="","compose"===t)return void e.focus();if("body"===t)return void e.focusBody();var n=-1!==["addresses.cc","addresses.bcc"].indexOf(t),r=!1;n&&!e.areAdditionalAddressesExpanded&&(e.topContentInFixedMode&&Object(ae.scrollTo)(e.scrollableContent,{top:0,isSmooth:!1}),e.props.visual.additionalAddressesAreExpanded=!0,r=!0);var o=Object(J.action)((function(){e.composeController.focusComposeField(t)}));r?e.afterUpdate(o):o()}}}),w=h(_.prototype,"saveComposeContainerRef",[J.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){e.domNode=t,e.props.visual.refs.composeContainer=t}}}),T=h(_.prototype,"saveTopContentRef",[J.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){e.topContent=t,e.props.visual.refs.topContent=t}}}),k=h(_.prototype,"saveScrollableContentRef",[J.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){e.scrollableContent=t,e.props.visual.refs.composeScrollableContainer=t}}}),R=h(_.prototype,"onChangeSize",[J.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){t===ge.ComposeSizes.SMALL?e.fixedMode=Oe.FixedModes.SMALL:e.fixedMode=Oe.FixedModes.NORMAL}}}),A=h(_.prototype,"onDeleteAll",[J.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){e.attachmentsIntersectionObserver&&e.attachmentsIntersectionObserver.disconnect(),e.props.data.attachments=[],e.metrikaService.sendAttachmentsMetrika(Se.COMPOSE_METRIKA_ATTACHMENTS_REMOVE_ALL),e.attachesHeaderFixed=!1}}}),j=h(_.prototype,"onAttachmentIntersection",[J.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){var n=t.find(Object(J.action)((function(t){return t.target===e.attachmentsBodyRef.current}))),r=n&&n.isIntersecting;e.attachesHeaderFixed=!r}}}),M=h(_.prototype,"blockScrollWidth",[J.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),I=h(_.prototype,"hasScroll",[J.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),D=h(_.prototype,"fixedMode",[J.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return Oe.FixedModes.NONE}}),N=h(_.prototype,"onEditorInit",[J.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){e.recalculateFixedContent(),e.observeAttachmentBody(),e.props.controllers.compose.init(),e.props.controllers.saveSend.init(),e.props.visual.hasChanges=!1;var t=b("span",{},void 0,Object(te.default)("compose-react/AutosaveNotification"));e.notificationController.showAutosaveNotification(t)}}}),L=h(_.prototype,"recalculateFixedContent",[J.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){if(e.scrollableContent){var t=e.recalculateFixedMode();if(t!==e.fixedMode&&(e.fixedMode=t),e.fixedMode===Oe.FixedModes.NONE)return void(e.topContentInFixedMode=!1);e.blockScrollWidth||(e.blockScrollWidth=e.scrollableContent.offsetWidth-e.scrollableContent.clientWidth),e.hasScroll=e.scrollableContent.scrollHeight>e.scrollableContent.clientHeight,e.recalculateTopFixedContent()}}}}),x=h(_.prototype,"onToggleRecipients",[J.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){e.topContentInFixedMode?(Object(ae.scrollTo)(e.scrollableContent,{top:0}),e.props.visual.additionalAddressesAreExpanded=!0):e.props.visual.additionalAddressesAreExpanded=!e.props.visual.additionalAddressesAreExpanded,e.metrikaService.sendHeaderMetrika(Se.COMPOSE_METRIKA_HEADER_TOGGLE_ADDRESSES)}}}),z=h(_.prototype,"onRecipientsFieldFocus",[J.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){"addresses.to"===t&&(e.scrollTopIfFixed(),(e.data.addresses.cc.length||e.data.addresses.bcc.length)&&(e.props.visual.additionalAddressesAreExpanded=!0))}}}),B=h(_.prototype,"onRecipientsFieldDragStart",[J.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){"addresses.to"===t&&(e.scrollTopIfFixed(),e.props.visual.additionalAddressesAreExpanded=!0)}}}),F=h(_.prototype,"onWorkModeChanged",[J.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){t===Oe.WorkModes.BACKGROUND&&e.notificationController.hide()}}}),U=h(_.prototype,"onSubjectClick",[J.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){e.data.subject||(e.props.visual.subjectsSuggest.suggestType=Oe.SmartSubjectType.INPUT)}}}),g=_))||g)||g)},3586:function(e,t,n){"use strict";function r(e,t,n,r,o,i,a){try{var c=e[i](a),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,o)}function o(e){return function(){var t=this,n=arguments;return new Promise(function(o,i){function a(e){r(s,o,i,a,c,"next",e)}function c(e){r(s,o,i,a,c,"throw",e)}var s=e.apply(t,n);a(void 0)})}}function i(){return i=o(regeneratorRuntime.mark((function e(){var t=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.a;case 2:return e.abrupt("return",c.apply(void 0,t));case 3:case"end":return e.stop()}}),e)}))),i.apply(this,arguments)}var a=n(152),c=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:document.styleSheets;if(!t||!t.length)return null;for(var n=t.length-1;n>=0;n--){var r=t[n],o=null;try{o=r.rules||r.cssRules}catch(e){}if(o)for(var i=o.length-1;i>=0;i--){var a=o[i],c=a&&a.selectorText;if(c&&c.indexOf(e)>=0)return a}}return null};t.a=function(){return i.apply(this,arguments)}},3587:function(e,t,n){"use strict";var r=n(3588);n.d(t,"a",(function(){return r.a}))},3588:function(e,t,n){"use strict";function r(e){"@babel/helpers - typeof";return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}function c(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?u(e):t}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function u(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function f(e,t,n,r){T||(T="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=r;else if(i>1){for(var a=new Array(i),c=0;c<i;c++)a[c]=arguments[c+3];t.children=a}if(t&&o)for(var s in o)void 0===t[s]&&(t[s]=o[s]);else t||(t=o||{});return{$$typeof:T,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function d(e,t,n,r){n&&Object.defineProperty(e,t,{enumerable:n.enumerable,configurable:n.configurable,writable:n.writable,value:n.initializer?n.initializer.call(r):void 0})}function y(e,t,n,r,o){var i={};return Object.keys(r).forEach((function(e){i[e]=r[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce((function(n,r){return r(e,t,n)||n}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}n.d(t,"a",(function(){return q}));var b,m,h,v,O,g,_,S,E,P,C,w,T,k=n(137),R=n.n(k),A=n(348),j=n.n(A),M=n(350),I=n.n(M),D=n(351),N=n(353),L=n(367),x=n(3589),z=n(3596),B=n(372),F=n(376),U=n(365),K=n(502),H=n(369),W=n(529),G=n(3606),Y=n.n(G),q=(b=Object(N.inject)("controllers","data","services","visual"))(m=Object(N.observer)((w=C=(function(e){function t(){var e,n;o(this,t);for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return n=c(this,(e=s(t)).call.apply(e,[this].concat(i))),n.headerRef=R.a.createRef(),d(u(n),"isHovered",v,u(n)),d(u(n),"isFocused",O,u(n)),d(u(n),"onItemRemoveOrCancel",g,u(n)),d(u(n),"setHovered",_,u(n)),d(u(n),"unsetHovered",S,u(n)),d(u(n),"setFocused",E,u(n)),d(u(n),"unsetFocused",P,u(n)),n.focus=function(e){"attachments"===e&&n.headerRef.current&&n.headerRef.current.focus()},n.renderAttachmentItem=function(e,t){return R.a.createElement("li",{key:e.info.id,className:Y.a.item,ref:0===t?n.props.firstAttachmentRef:null},f(z.a,{onClose:n.onItemRemoveOrCancel,onCancelLoading:n.onItemRemoveOrCancel,item:e}))},n}return l(t,e),a(t,[{key:"componentDidMount",value:function(){var e=this;this.props.onMount&&this.props.onMount(),this.dispose=Object(D.reaction)((function(){return e.props.visual.focusedField}),this.focus)}},{key:"componentWillUnmount",value:function(){this.dispose()}},{key:"render",value:function(){return f("div",{className:I()(Y.a.wrap,"qa-Compose-Attachments",this.isFocused?"focused":"unfocused"),onMouseEnter:this.setHovered,onMouseLeave:this.unsetHovered,role:"group","aria-label":Object(L.default)("compose-react/attachmentsLabel"),onFocus:this.setFocused,onBlur:this.unsetFocused},void 0,R.a.createElement(x.a,{ref:this.headerRef,cls:Y.a.header,count:this.validAttachments.length,onDeleteAll:this.props.onDeleteAll,onExpand:this.props.onExpand,size:this.totalSize,showDeleteAllButton:this.isHovered||this.isFocused,isFixed:this.props.isFixed,innerRef:this.props.attachmentsHeaderRef,uploadedCount:this.uploadedCount,yaDiskCount:this.yaDiskCount}),R.a.createElement("ul",{className:I()(Y.a.body,"qa-Compose-Attachments-List"),ref:this.props.attachmentsBodyRef,role:"list"},this.validAttachments.map(this.renderAttachmentItem)))}},{key:"attachmentsController",get:function(){return this.props.controllers.attachments}},{key:"attachments",get:function(){return this.props.data.attachments||[]}},{key:"validAttachments",get:function(){return this.attachmentsController.validAttachments||[]}},{key:"totalSize",get:function(){return this.validAttachments.map((function(e){return Object(W.a)(e.info)||0})).reduce((function(e,t){return e+t}),0)}},{key:"uploadedCount",get:function(){return this.attachmentsController.uploadedCount}},{key:"yaDiskCount",get:function(){return this.attachmentsController.yaDiskCount}}]),t})(R.a.Component),C.propTypes={controllers:B.a.isRequired,data:F.a.isRequired,services:U.a.isRequired,visual:K.a.isRequired,isFixed:j.a.bool,onExpand:j.a.func,onMount:j.a.func,onDeleteAll:j.a.func,attachmentsBodyRef:j.a.object,firstAttachmentRef:j.a.object,attachmentsHeaderRef:j.a.object},h=w,v=y(h.prototype,"isHovered",[D.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),O=y(h.prototype,"isFocused",[D.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),y(h.prototype,"attachmentsController",[D.computed],Object.getOwnPropertyDescriptor(h.prototype,"attachmentsController"),h.prototype),y(h.prototype,"attachments",[D.computed],Object.getOwnPropertyDescriptor(h.prototype,"attachments"),h.prototype),y(h.prototype,"validAttachments",[D.computed],Object.getOwnPropertyDescriptor(h.prototype,"validAttachments"),h.prototype),y(h.prototype,"totalSize",[D.computed],Object.getOwnPropertyDescriptor(h.prototype,"totalSize"),h.prototype),y(h.prototype,"uploadedCount",[D.computed],Object.getOwnPropertyDescriptor(h.prototype,"uploadedCount"),h.prototype),y(h.prototype,"yaDiskCount",[D.computed],Object.getOwnPropertyDescriptor(h.prototype,"yaDiskCount"),h.prototype),g=y(h.prototype,"onItemRemoveOrCancel",[D.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){t.status=H.c.ABORTED,e.attachments.remove(t)}}}),_=y(h.prototype,"setHovered",[D.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){e.isHovered=!0}}}),S=y(h.prototype,"unsetHovered",[D.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){e.isHovered=!1}}}),E=y(h.prototype,"setFocused",[D.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){e.timer&&(clearTimeout(e.timer),e.timer=null),e.isFocused=!0}}}),P=y(h.prototype,"unsetFocused",[D.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){e.timer=setTimeout(Object(D.action)((function(){Object(D.runInAction)(Object(D.action)((function(){e.isFocused=!1})))})),0)}}}),m=h))||m)||m},3589:function(e,t,n){"use strict";var r=n(3590);n.d(t,"a",(function(){return r.a}))},3590:function(e,t,n){"use strict";function r(e){"@babel/helpers - typeof";return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function c(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),e}function s(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?u(e):t}function u(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function p(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function d(e,t,n,r){y||(y="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=r;else if(i>1){for(var a=new Array(i),c=0;c<i;c++)a[c]=arguments[c+3];t.children=a}if(t&&o)for(var s in o)void 0===t[s]&&(t[s]=o[s]);else t||(t=o||{});return{$$typeof:y,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}n.d(t,"a",(function(){return j}));var y,b=n(137),m=n.n(b),h=n(348),v=n.n(h),O=n(350),g=n.n(O),_=n(479),S=(n.n(_),n(352)),E=n(367),P=n(142),C=(n.n(P),n(140)),w=(n.n(C),n(1010)),T=(n.n(w),n(3591)),k=n(3595),R=n.n(k),A=d(C.Text,{typography:"body-long-m"},void 0,d(S.default,{loc:"compose-react/Attachments_Delete_All"})),j=(function(e){function t(){var e,n;i(this,t);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return n=s(this,(e=l(t)).call.apply(e,[this].concat(o))),n.buttonRef=m.a.createRef(),n.onDeleteAll=function(e){e.stopPropagation(),n.props.onDeleteAll()},n.onExpand=function(){n.props.isFixed&&n.props.onExpand()},n}return p(t,e),c(t,[{key:"focus",value:function(){this.buttonRef.current&&this.buttonRef.current.focus()}},{key:"render",value:function(){var e,t=this.props.isFixed?{marginRight:"".concat(w.SmartScroll.scrollbarWidth,"px")}:{};return d("div",{className:g()(R.a.wrapper,"qa-Compose-AttachmentsHeader",(e={},o(e,R.a.fixed,this.props.isFixed),o(e,"qa-Compose-AttachmentsHeader-fixed",this.props.isFixed),e))},void 0,d("div",{className:R.a.stub}),m.a.createElement("div",{className:g()(R.a.header),style:t,ref:this.props.innerRef},d(T.a,{cls:R.a.progress}),m.a.createElement("button",{ref:this.buttonRef,className:R.a.showAttachments,onClick:this.onExpand,"aria-expanded":!this.props.isFixed},d(C.Text,{typography:"body-long-m",className:g()(R.a.count,"qa-Compose-AttachmentsHeader-Count")},void 0,this.renderCountWithDiskLabel()),d(C.Text,{typography:"body-long-m",color:"secondary",className:g()(R.a.size,"qa-Compose-AttachmentsHeader-Size")},void 0,d(_.HumanFileSize,{bytes:this.props.size}))),this.maybeRenderActions()))}},{key:"renderCountWithDiskLabel",value:function(){var e=this.props,t=e.count,n=e.yaDiskCount,r=t-n;return r&&n?d(S.default,{loc:"compose-react/attachmentsCountConcat",params:{files:Object(E.default)("compose-react/Attachments_Count",{count:r}),disk:Object(E.default)("compose-react/attachmentsCountDisk",{count:n})}}):r?d(S.default,{loc:"compose-react/Attachments_Count",params:{count:r}}):d(S.default,{loc:"compose-react/attachmentsCountDisk",params:{count:n}})}},{key:"maybeRenderActions",value:function(){return d("div",{className:R.a.actions},void 0,this.maybeRenderDeleteAllButton())}},{key:"maybeRenderDeleteAllButton",value:function(){return this.props.showDeleteAllButton?d(P.Button,{onClick:this.onDeleteAll,cls:g()(R.a.button,"qa-Compose-AttachmentsHeader-DeleteAll"),view:"clear"},void 0,A):null}}]),t})(m.a.PureComponent);j.propTypes={count:v.a.number,onDeleteAll:v.a.func,onExpand:v.a.func,isFixed:v.a.bool,size:v.a.number,uploadedCount:v.a.number,showDeleteAllButton:v.a.bool,innerRef:v.a.object,yaDiskCount:v.a.number}},3591:function(e,t,n){"use strict";var r=n(3592);n.d(t,"a",(function(){return r.a}))},3592:function(e,t,n){"use strict";function r(e){"@babel/helpers - typeof";return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}function c(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?s(e):t}function s(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function f(e,t,n,r){O||(O="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=r;else if(i>1){for(var a=new Array(i),c=0;c<i;c++)a[c]=arguments[c+3];t.children=a}if(t&&o)for(var s in o)void 0===t[s]&&(t[s]=o[s]);else t||(t=o||{});return{$$typeof:O,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function d(e,t,n,r,o){var i={};return Object.keys(r).forEach((function(e){i[e]=r[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce((function(n,r){return r(e,t,n)||n}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}n.d(t,"a",(function(){return I}));var y,b,m,h,v,O,g=n(137),_=n.n(g),S=n(348),E=n.n(S),P=n(350),C=n.n(P),w=n(351),T=n(353),k=n(1804),R=(n.n(k),n(372)),A=n(369),j=n(3594),M=n.n(j),I=(y=Object(T.inject)("controllers"))(b=Object(T.observer)((v=h=(function(e){function t(){return o(this,t),c(this,u(t).apply(this,arguments))}return l(t,e),a(t,[{key:"render",value:function(){var e=this.props.cls,t=this.progress;return 1===t?null:f("div",{className:C()(M.a.wrap,e)},void 0,f(k.Progress,{progress:100*t}))}},{key:"validAttachments",get:function(){return this.props.controllers.attachments.validAttachments||[]}},{key:"progress",get:function(){return this.validAttachments.map((function(e){return e.status===A.c.COMPLETED?100:e.progress})).reduce((function(e,t){return t+e}),0)/this.validAttachments.length/100}}]),t})(_.a.PureComponent),h.propTypes={cls:E.a.string,controllers:R.a.isRequired},m=v,d(m.prototype,"validAttachments",[w.computed],Object.getOwnPropertyDescriptor(m.prototype,"validAttachments"),m.prototype),d(m.prototype,"progress",[w.computed],Object.getOwnPropertyDescriptor(m.prototype,"progress"),m.prototype),b=m))||b)||b},3593:function(e,t){e.exports={progress:"LoadingProgress__progress--10oXR",progress_inner:"LoadingProgress__progress_inner--17aDJ"}},3594:function(e,t){e.exports={wrap:"LoadingProgress__wrap--M-LFt"}},3595:function(e,t){e.exports={wrapper:"AttachmentsHeader__wrapper--EkR3p",header:"AttachmentsHeader__header--1eT0o",stub:"AttachmentsHeader__stub--2kUD3",fixed:"AttachmentsHeader__fixed--2dgKo",count:"AttachmentsHeader__count--3VdHy",size:"AttachmentsHeader__size--3N26Q",actions:"AttachmentsHeader__actions--2fkWP",button:"AttachmentsHeader__button--1R9pP",buttonContainer:"AttachmentsHeader__buttonContainer--26bVY",progress:"AttachmentsHeader__progress--1EjE0",showAttachments:"AttachmentsHeader__showAttachments--3IrjP"}},3596:function(e,t,n){"use strict";var r=n(3597);n.d(t,"a",(function(){return r.a}))},3597:function(e,t,n){"use strict";function r(e){"@babel/helpers - typeof";return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}function c(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?u(e):t}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function u(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function f(e,t,n,r){v||(v="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=r;else if(i>1){for(var a=new Array(i),c=0;c<i;c++)a[c]=arguments[c+3];t.children=a}if(t&&o)for(var s in o)void 0===t[s]&&(t[s]=o[s]);else t||(t=o||{});return{$$typeof:v,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}n.d(t,"a",(function(){return I}));var d,y,b,m,h,v,O=n(137),g=n.n(O),_=n(348),S=n.n(_),E=n(351),P=n(353),C=n(1805),w=(n.n(C),n(3603)),T=n(682),k=n(365),R=n(369),A=n(529),j=n(360),M=(n.n(j),Object(w.a)(C.AttachmentItem)),I=(d=Object(P.inject)("services"))(y=Object(P.observer)((h=m=(function(e){function t(){var e,n;o(this,t);for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return n=c(this,(e=s(t)).call.apply(e,[this].concat(i))),n.state={isUsingThumbnail:!1},n.onCloseClick=function(){var e=n.props,t=e.item,r=e.onClose;n.metrikaService.sendAttachmentsMetrika(j.COMPOSE_METRIKA_ATTACHMENTS_REMOVE),r&&r(t)},n.onCancelClick=function(){var e=n.props,t=e.item,r=e.onCancelLoading;n.metrikaService.sendAttachmentsMetrika(j.COMPOSE_METRIKA_ATTACHMENTS_CANCEL_UPLOAD),r&&r(t)},n.onPreviewClick=function(e){var t=n.props.item,r={mid:t.visual.mid,hid:t.visual.hid};return t.info.type===R.d.YADISK?void n.metrikaService.sendAttachmentsMetrika(j.COMPOSE_METRIKA_ATTACHMENTS_PREVIEW):t.previewSupported?void((r.mid||r.hid)&&(n.props.services.attachments.showImagePreview("attachments.image-preview",r,u(n),e),n.metrikaService.sendAttachmentsMetrika(j.COMPOSE_METRIKA_ATTACHMENTS_PREVIEW))):void n.metrikaService.sendAttachmentsMetrika(j.COMPOSE_METRIKA_ATTACHMENTS_DOWNLOAD)},n}return l(t,e),a(t,[{key:"componentDidMount",value:function(){this.loadPreview()}},{key:"componentWillUnmount",value:function(){this.image&&(this.image.onload=null)}},{key:"loadPreview",value:function(){var e=this,t=this.props.item.info,n=t.previewSrc;n&&this.previousPreviewSrc!==n&&(this.image=new Image,this.image.onload=function(){return e.setState({isUsingThumbnail:!0})},this.image.src=n,this.previousPreviewSrc=n)}},{key:"componentDidUpdate",value:function(){this.loadPreview()}},{key:"render",value:function(){var e=this.props.services,t=this.props.item,n=t.info,r=t.status,o=t.progress,i=t.visual,a=n.previewHref||i.narodUrl||i.url,c=this.state.isUsingThumbnail;return f(M,{onPreviewClick:this.onPreviewClick,fileType:this.mediaType,attachType:n.type,extension:i.fileext,name:i.name,sourceType:n.type,previewSrc:c?n.previewSrc:null,sourceHref:a,onClose:this.onCloseClick,isMobile:e.settings.isMobile,progress:o,onCancelLoading:this.onCancelClick,size:Object(A.a)(n),status:r})}},{key:"metrikaService",get:function(){return this.props.services.metrika}},{key:"mediaType",get:function(){var e=this.props.item,t=e.info,n=e.visual;return Boolean(t.folder)?"folder":".eml"===n.fileext?"mail":n.class}}]),t})(g.a.Component),m.propTypes={item:T.a,onClose:S.a.func,onCancelLoading:S.a.func,services:k.a},b=h,(function(e,t,n,r,o){var i={};return Object.keys(r).forEach((function(e){i[e]=r[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce((function(n,r){return r(e,t,n)||n}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i})(b.prototype,"mediaType",[E.computed],Object.getOwnPropertyDescriptor(b.prototype,"mediaType"),b.prototype),y=b))||y)||y},360:function(e,t,n){"use strict";var r,o,i=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),c=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&i(t,e,n);return a(t,e),t},s=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a},u=this&&this.__spread||function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(s(arguments[t]));return e};Object.defineProperty(t,"__esModule",{value:!0}),t.COMPOSE_METRIKA_WYSIWIG_FONT=t.COMPOSE_METRIKA_WYSIWIG_STRIKETHROUGH=t.COMPOSE_METRIKA_WYSIWIG_UNDERLINE=t.COMPOSE_METRIKA_WYSIWIG_ITALIC=t.COMPOSE_METRIKA_WYSIWIG_BOLD=t.COMPOSE_METRIKA_WYSIWIG_REDO=t.COMPOSE_METRIKA_WYSIWIG_UNDO=t.COMPOSE_METRIKA_WYSIWIG=t.COMPOSE_SIGNATURES_POPUP_GO_TO_SETTINGS=t.COMPOSE_SIGNATURES_POPUP_WITHOUT_SIGNATURE=t.COMPOSE_SIGNATURES_POPUP_CHANGE_SIGNATURE=t.COMPOSE_SIGNATURES_POPUP_OPEN=t.COMPOSE_SIGNATURES_POPUP=t.COMPOSE_METRIKA_RECIPIENTS_DIFF_PROMO_CLOSED=t.COMPOSE_METRIKA_RECIPIENTS_DIFF_PROMO_SHOWN=t.COMPOSE_METRIKA_RECIPIENTS_DIFF_EXPANDED=t.COMPOSE_METRIKA_RECIPIENTS_DIFF_COLLAPSED=t.COMPOSE_METRIKA_RECIPIENTS_DIFF_SHOWN=t.COMPOSE_METRIKA_RECIPIENTS_DIFF=t.COMPOSE_HEADER_FIELDS_METRIKA=t.COMPOSE_METRIKA_HEADER_LABELS_REMOVE=t.COMPOSE_METRIKA_HEADER_LABELS=t.COMPOSE_METRIKA_HEADER_PROMO_SUGGEST_BEAUTIFUL_EMAIL_ACTION=t.COMPOSE_METRIKA_HEADER_PROMO_SUGGEST_BEAUTIFUL_EMAIL_CLOSE=t.COMPOSE_METRIKA_HEADER_PROMO_SUGGEST_BEAUTIFUL_EMAIL_SHOW=t.COMPOSE_METRIKA_HEADER_PROMO_BEAUTIFUL_EMAIL_CLOSE=t.COMPOSE_METRIKA_HEADER_PROMO_BEAUTIFUL_EMAIL_SHOW=t.COMPOSE_METRIKA_HEADER_YABBLE_POPUP_WRITE_ONLY=t.COMPOSE_METRIKA_HEADER_YABBLE_POPUP_EDIT=t.COMPOSE_METRIKA_HEADER_YABBLE_POPUP_COPY=t.COMPOSE_METRIKA_HEADER_YABBLE_POPUP_EMAIL=t.COMPOSE_METRIKA_HEADER_YABBLE_POPUP=t.COMPOSE_METRIKA_HEADER_SUGGEST_OTHER=t.COMPOSE_METRIKA_HEADER_SUGGEST_SELF=t.COMPOSE_METRIKA_HEADER_SUGGEST=t.COMPOSE_METRIKA_HEADER_STACK_DRAFTS_LINK=t.COMPOSE_METRIKA_HEADER_TOGGLE_STACK=t.COMPOSE_METRIKA_HEADER_THUMB_CLICK=t.COMPOSE_METRIKA_HEADER_EXPAND=t.COMPOSE_METRIKA_HEADER_CLOSE=t.COMPOSE_METRIKA_HEADER_COLLAPSE=t.COMPOSE_METRIKA_HEADER_TOGGLE_ADDRESSES=t.COMPOSE_METRIKA_HEADER_SUBJECT=t.COMPOSE_METRIKA_HEADER_FROM_SHOW=t.COMPOSE_METRIKA_HEADER_FROM_CLICK=t.COMPOSE_METRIKA_HEADER_BCC=t.COMPOSE_METRIKA_HEADER_CC=t.COMPOSE_METRIKA_HEADER_TO=t.COMPOSE_METRIKA_HEADER=t.COMPOSE_METRIKA=void 0,t.COMPOSE_METRIKA_FOOTER_DELAYED_SENDING_CANCEL_CUSTOM_DATETIME=t.COMPOSE_METRIKA_FOOTER_DELAYED_SENDING_SELECT_CUSTOM_DATETIME=t.COMPOSE_METRIKA_FOOTER_DELAYED_SENDING_SEND=t.COMPOSE_METRIKA_FOOTER_DELAYED_SENDING_CLEAR=t.COMPOSE_METRIKA_FOOTER_DELAYED_SENDING_CUSTOM_DATETIME=t.COMPOSE_METRIKA_FOOTER_DELAYED_SENDING_CLICK=t.COMPOSE_METRIKA_FOOTER_DELAYED_SENDING=t.COMPOSE_METRIKA_FOOTER_ATTACHMENTS_CLICK=t.COMPOSE_METRIKA_FOOTER_ATTACHMENTS=t.COMPOSE_METRIKA_FOOTER_PROMO_AUTOCOMPLETE_CLOSE=t.COMPOSE_METRIKA_FOOTER_PROMO_AUTOCOMPLETE_SHOW=t.COMPOSE_METRIKA_FOOTER_MORE_SIGNATURES_CLICK=t.COMPOSE_METRIKA_FOOTER_MORE_LABELS_CLICK=t.COMPOSE_METRIKA_FOOTER_MORE_SMARTSUBJECT_OFF=t.COMPOSE_METRIKA_FOOTER_MORE_SMARTSUBJECT_ON=t.COMPOSE_METRIKA_FOOTER_MORE_AUTOCOMPLETE_OFF=t.COMPOSE_METRIKA_FOOTER_MORE_AUTOCOMPLETE_ON=t.COMPOSE_METRIKA_FOOTER_MORE=t.COMPOSE_METRIKA_FOOTER_BETA=t.COMPOSE_METRIKA_FOOTER_ATTACH_MAIL=t.COMPOSE_METRIKA_FOOTER_ATTACH_DISK=t.COMPOSE_METRIKA_FOOTER_ATTACH_LOCAL=t.COMPOSE_METRIKA_FOOTER_SEND=t.COMPOSE_METRIKA_FOOTER=t.COMPOSE_METRIKA_WYSIWIG_INLINE_IMAGES_FROM_LOCAL=t.COMPOSE_METRIKA_WYSIWIG_INLINE_IMAGES_FROM_URL=t.COMPOSE_METRIKA_WYSIWIG_INLINE_IMAGES_INSERT_FILE=t.COMPOSE_METRIKA_WYSIWIG_INLINE_IMAGES_CLICK_OPTION=t.COMPOSE_METRIKA_WYSIWIG_INLINE_IMAGES_CLICK_TOOLBAR=t.COMPOSE_METRIKA_WYSIWIG_INLINE_IMAGES=t.COMPOSE_METRIKA_WYSIWYG_AUTOCOMPLETE_USE_WITH_KEYBOARD=t.COMPOSE_METRIKA_WYSIWYG_AUTOCOMPLETE_USE_WITH_MOUSE=t.COMPOSE_METRIKA_WYSIWIG_AUTOCOMPLETE_USE=t.COMPOSE_METRIKA_WYSIWIG_AUTOCOMPLETE_SHOW=t.COMPOSE_METRIKA_WYSIWIG_AUTOCOMPLETE=t.COMPOSE_METRIKA_WYSIWIG_BODY=t.COMPOSE_METRIKA_WYSIWIG_CLEAR_FORMAT=t.COMPOSE_METRIKA_WYSIWIG_BULLETED_LIST=t.COMPOSE_METRIKA_WYSIWIG_NUMBERED_LIST=t.COMPOSE_METRIKA_WYSIWIG_ALIGN_RIGHT=t.COMPOSE_METRIKA_WYSIWIG_ALIGN_CENTER=t.COMPOSE_METRIKA_WYSIWIG_ALIGN_LEFT=t.COMPOSE_METRIKA_WYSIWIG_ALIGN=t.COMPOSE_METRIKA_WYSIWIG_QUOTE=t.COMPOSE_METRIKA_WYSIWIG_REMOVE_LINK=t.COMPOSE_METRIKA_WYSIWIG_ADD_LINK=t.COMPOSE_METRIKA_WYSIWIG_EMOJI=t.COMPOSE_METRIKA_WYSIWIG_BACKGROUND_COLOR=t.COMPOSE_METRIKA_WYSIWIG_TEXT_COLOR=t.COMPOSE_METRIKA_WYSIWIG_FONT_SIZE=void 0,t.COMPOSE_METRIKA_POPUPS_LIMITED_RECIPIENTS=t.COMPOSE_METRIKA_POPUPS_SEND_FAILED_CLOSE=t.COMPOSE_METRIKA_POPUPS_SEND_FAILED_CANCEL=t.COMPOSE_METRIKA_POPUPS_SEND_FAILED_RETRY=t.COMPOSE_METRIKA_POPUPS_SEND_FAILED_SHOW=t.COMPOSE_METRIKA_POPUPS_SEND_FAILED=t.COMPOSE_METRIKA_POPUPS=t.COMPOSE_METRIKA_ATTACHMENTS_PLACE=t.COMPOSE_METRIKA_ATTACHMENTS_CANCEL_UPLOAD=t.COMPOSE_METRIKA_ATTACHMENTS_TOGGLE=t.COMPOSE_METRIKA_ATTACHMENTS_REMOVE_ALL=t.COMPOSE_METRIKA_ATTACHMENTS_REMOVE=t.COMPOSE_METRIKA_ATTACHMENTS_DOWNLOAD=t.COMPOSE_METRIKA_ATTACHMENTS_PREVIEW=t.COMPOSE_METRIKA_ATTACHMENTS=t.TIME_PRESETS_METRIKA=t.COMPOSE_METRIKA_FOOTER_TIME_PRESET_NEXT_WEEK=t.COMPOSE_METRIKA_FOOTER_TIME_PRESET_WEEKEND=t.COMPOSE_METRIKA_FOOTER_TIME_PRESET_TOMORROW=t.COMPOSE_METRIKA_FOOTER_TIME_PRESET_TODAY=t.COMPOSE_METRIKA_FOOTER_OVERFLOW_CLICK=t.COMPOSE_METRIKA_FOOTER_OVERFLOW=t.COMPOSE_METRIKA_FOOTER_LABELS_ADD_USER=t.COMPOSE_METRIKA_FOOTER_LABELS_ADD_IMPORTANT=t.COMPOSE_METRIKA_FOOTER_LABELS_MANAGE=t.COMPOSE_METRIKA_FOOTER_LABELS_CLICK=t.COMPOSE_METRIKA_FOOTER_LABELS=t.COMPOSE_METRIKA_FOOTER_TEMPLATES_MANAGE=t.COMPOSE_METRIKA_FOOTER_TEMPLATES_UPDATE=t.COMPOSE_METRIKA_FOOTER_TEMPLATES_SAVE_AS_NEW=t.COMPOSE_METRIKA_FOOTER_TEMPLATES_SAVE=t.COMPOSE_METRIKA_FOOTER_TEMPLATES_SELECT=t.COMPOSE_METRIKA_FOOTER_TEMPLATES_CLICK=t.COMPOSE_METRIKA_FOOTER_TEMPLATES=t.COMPOSE_METRIKA_FOOTER_NOTIFICATIONS_REPLY_COLLAPSE=t.COMPOSE_METRIKA_FOOTER_NOTIFICATIONS_REPLY_EXPAND=t.COMPOSE_METRIKA_FOOTER_NOTIFICATIONS_REPLY_OFF=t.COMPOSE_METRIKA_FOOTER_NOTIFICATIONS_REPLY_ON=t.COMPOSE_METRIKA_FOOTER_NOTIFICATIONS_DELIVERY_OFF=t.COMPOSE_METRIKA_FOOTER_NOTIFICATIONS_DELIVERY_ON=t.COMPOSE_METRIKA_FOOTER_NOTIFICATIONS_CLICK=t.COMPOSE_METRIKA_FOOTER_NOTIFICATIONS=t.COMPOSE_METRIKA_TRANSLATION_EDIT_BUTTON=t.COMPOSE_METRIKA_TRANSLATION_SEND_BUTTON=t.COMPOSE_METRIKA_TRANSLATION_TRANSLATE_BUTTON=t.COMPOSE_METRIKA_TRANSLATION_CHOOSE_LANGUAGE=t.COMPOSE_METRIKA_TRANSLATION_OPEN_LANGUAGE_SELECTOR=t.COMPOSE_METRIKA_TRANSLATION_TO=t.COMPOSE_METRIKA_TRANSLATION_FROM=t.COMPOSE_METRIKA_TRANSLATION_PANE=void 0,t.DONE_SCREEN_PROMO_BEAUTIFUL_EMAIL_SHOW=t.DONE_SCREEN_PROMO_BEAUTIFUL_EMAIL=t.DONE_SCREEN_PROMO_HOTKEYS_ACTION=t.DONE_SCREEN_PROMO_HOTKEYS_SHOW=t.DONE_SCREEN_PROMO_HOTKEYS=t.DONE_SCREEN_SHOW=t.DONE_SCREEN=t.PROMO_ON_DONE=t.EDITOR_TOOLBAR_COMMANDS_METRIKA=t.COMPOSE_METRIKA_POPUPS_SMART_SUBJECT_SELECT_FROM_SUGGEST=t.COMPOSE_METRIKA_POPUPS_EMPTY_SUBJECT_CLICK_DO_NOT_SHOW=t.COMPOSE_METRIKA_POPUPS_EMPTY_SUBJECT_CLOSE=t.COMPOSE_METRIKA_POPUPS_EMPTY_SUBJECT_CANCEL=t.COMPOSE_METRIKA_POPUPS_EMPTY_SUBJECT_SEND=t.COMPOSE_METRIKA_POPUPS_EMPTY_SUBJECT_SEND_EMPTY=t.COMPOSE_METRIKA_POPUPS_EMPTY_SUBJECT_SHOW=t.COMPOSE_METRIKA_POPUPS_SMART_SUBJECT=t.COMPOSE_METRIKA_POPUPS_EMPTY_SUBJECT=t.COMPOSE_METRIKA_POPUPS_CAPTCHA_CANCEL=t.COMPOSE_METRIKA_POPUPS_CAPTCHA_SEND=t.COMPOSE_METRIKA_POPUPS_CAPTCHA_REFRESH=t.COMPOSE_METRIKA_POPUPS_CAPTCHA_SHOW=t.COMPOSE_METRIKA_POPUPS_CAPTCHA=t.COMPOSE_METRIKA_POPUPS_ATTACHMENTS_ERRORS_CLOSE=t.COMPOSE_METRIKA_POPUPS_ATTACHMENTS_ERRORS_ACTION=t.COMPOSE_METRIKA_POPUPS_ATTACHMENTS_ERRORS_DISK_TECHNICAL_WORK=t.COMPOSE_METRIKA_POPUPS_ATTACHMENTS_ERRORS_DISK_TRAFFIC_LIMIT=t.COMPOSE_METRIKA_POPUPS_ATTACHMENTS_ERRORS_SHOW=t.COMPOSE_METRIKA_POPUPS_ATTACHMENTS_ERRORS=t.COMPOSE_METRIKA_POPUPS_REMOVE_DRAFT_CLOSE=t.COMPOSE_METRIKA_POPUPS_REMOVE_DRAFT_CANCEL=t.COMPOSE_METRIKA_POPUPS_REMOVE_DRAFT_ACTION=t.COMPOSE_METRIKA_POPUPS_REMOVE_DRAFT_SHOW=t.COMPOSE_METRIKA_POPUPS_REMOVE_DRAFT=t.COMPOSE_METRIKA_POPUPS_CONFIRM_REMOVE_CLOSE=t.COMPOSE_METRIKA_POPUPS_CONFIRM_REMOVE_CANCEL=t.COMPOSE_METRIKA_POPUPS_CONFIRM_REMOVE_ACTION=t.COMPOSE_METRIKA_POPUPS_CONFIRM_REMOVE_SHOW=t.COMPOSE_METRIKA_POPUPS_CONFIRM_REMOVE=t.COMPOSE_METRIKA_POPUPS_CONFIRM_SAVE_CLOSE=t.COMPOSE_METRIKA_POPUPS_CONFIRM_SAVE_CANCEL=t.COMPOSE_METRIKA_POPUPS_CONFIRM_SAVE_ACTION=t.COMPOSE_METRIKA_POPUPS_CONFIRM_SAVE_SHOW=t.COMPOSE_METRIKA_POPUPS_CONFIRM_SAVE=t.COMPOSE_METRIKA_POPUPS_VALIDATION_ERRORS_CLOSE=t.COMPOSE_METRIKA_POPUPS_VALIDATION_ERRORS_ACTION=t.COMPOSE_METRIKA_POPUPS_VALIDATION_ERRORS_SHOW=t.COMPOSE_METRIKA_POPUPS_VALIDATION_ERRORS=t.COMPOSE_METRIKA_POPUPS_LIMITED_RECIPIENTS_CLOSE=t.COMPOSE_METRIKA_POPUPS_LIMITED_RECIPIENTS_SHOW=void 0,t.QUICK_REPLY_CLICK_ON_RECIPIENTS=t.QUICK_REPLY_CLICK_ON_COMPOSE=t.QUICK_REPLY_CLICK_ON_CLOSE=t.QUICK_REPLY=t.ABOOK_POPUP_SHOW_SUGGEST=t.ABOOK_POPUP_SHOW_FIELD_TITLE=t.ABOOK_POPUP_SHOW=t.ABOOK_POPUP=t.DONE_SCREEN_CLOSE_ON_BEAUTIFUL_EMAIL=t.DONE_SCREEN_CLOSE_ON_CROSS=t.DONE_SCREEN_CLOSE_ON_OUTBOX_CLICK=t.DONE_SCREEN_CLOSE_ON_SETTINGS_CLICK=t.DONE_SCREEN_CLOSE_ON_INBOX_CLICK=t.DONE_SCREEN_CLOSE_ON_CLICK=t.DONE_SCREEN_CLOSE_ON_KEY=t.DONE_SCREEN_CLOSE_ON_TIMER=t.DONE_SCREEN_PROMO_BEAUTIFUL_EMAIL_ACTION=void 0;var l=n(519),p=c(n(518));t.COMPOSE_METRIKA="Letter writing (new)",t.COMPOSE_METRIKA_HEADER="in header",t.COMPOSE_METRIKA_HEADER_TO='focus on "To"',t.COMPOSE_METRIKA_HEADER_CC='focus on "Cc"',t.COMPOSE_METRIKA_HEADER_BCC='focus on "Bcc"',t.COMPOSE_METRIKA_HEADER_FROM_CLICK='click on another address in "From"',t.COMPOSE_METRIKA_HEADER_FROM_SHOW='show addresses in "From"',t.COMPOSE_METRIKA_HEADER_SUBJECT='focus on "Theme"',t.COMPOSE_METRIKA_HEADER_TOGGLE_ADDRESSES='click on "Expand/Collapse addresses"',t.COMPOSE_METRIKA_HEADER_COLLAPSE='click on "Collapse compose"',t.COMPOSE_METRIKA_HEADER_CLOSE='click on "Close compose"',t.COMPOSE_METRIKA_HEADER_EXPAND='click on "Expand compose"',t.COMPOSE_METRIKA_HEADER_THUMB_CLICK="click on collapsed compose header",t.COMPOSE_METRIKA_HEADER_TOGGLE_STACK='click on "Expand/Collapse stack"',t.COMPOSE_METRIKA_HEADER_STACK_DRAFTS_LINK='click on "Show all drafts"',t.COMPOSE_METRIKA_HEADER_SUGGEST="in suggest",t.COMPOSE_METRIKA_HEADER_SUGGEST_SELF='click on "self" contact',t.COMPOSE_METRIKA_HEADER_SUGGEST_OTHER="click on other contact",t.COMPOSE_METRIKA_HEADER_YABBLE_POPUP="in yabble popup",t.COMPOSE_METRIKA_HEADER_YABBLE_POPUP_EMAIL="click on email",t.COMPOSE_METRIKA_HEADER_YABBLE_POPUP_COPY='click on "Copy"',t.COMPOSE_METRIKA_HEADER_YABBLE_POPUP_EDIT='click on "Edit"',t.COMPOSE_METRIKA_HEADER_YABBLE_POPUP_WRITE_ONLY='click on "Write to this contact only"',t.COMPOSE_METRIKA_HEADER_PROMO_BEAUTIFUL_EMAIL_SHOW="showing beautiful email promo",t.COMPOSE_METRIKA_HEADER_PROMO_BEAUTIFUL_EMAIL_CLOSE="closing beautiful email promo",t.COMPOSE_METRIKA_HEADER_PROMO_SUGGEST_BEAUTIFUL_EMAIL_SHOW="showing suggest beautiful email promo",t.COMPOSE_METRIKA_HEADER_PROMO_SUGGEST_BEAUTIFUL_EMAIL_CLOSE="closing suggest beautiful email promo",t.COMPOSE_METRIKA_HEADER_PROMO_SUGGEST_BEAUTIFUL_EMAIL_ACTION="action from suggest beautiful email promo",t.COMPOSE_METRIKA_HEADER_LABELS="Labels",t.COMPOSE_METRIKA_HEADER_LABELS_REMOVE="click on remove",t.COMPOSE_HEADER_FIELDS_METRIKA={to:t.COMPOSE_METRIKA_HEADER_TO,cc:t.COMPOSE_METRIKA_HEADER_CC,bcc:t.COMPOSE_METRIKA_HEADER_BCC},t.COMPOSE_METRIKA_RECIPIENTS_DIFF="in recipients diff",t.COMPOSE_METRIKA_RECIPIENTS_DIFF_SHOWN="show",t.COMPOSE_METRIKA_RECIPIENTS_DIFF_COLLAPSED="collapsed",t.COMPOSE_METRIKA_RECIPIENTS_DIFF_EXPANDED="expanded",t.COMPOSE_METRIKA_RECIPIENTS_DIFF_PROMO_SHOWN="promo shown",t.COMPOSE_METRIKA_RECIPIENTS_DIFF_PROMO_CLOSED="promo closed",t.COMPOSE_SIGNATURES_POPUP="in signatures popup",t.COMPOSE_SIGNATURES_POPUP_OPEN="open",t.COMPOSE_SIGNATURES_POPUP_CHANGE_SIGNATURE="change",t.COMPOSE_SIGNATURES_POPUP_WITHOUT_SIGNATURE='choose "Empty"',t.COMPOSE_SIGNATURES_POPUP_GO_TO_SETTINGS='click on "Manage Settings"',t.COMPOSE_METRIKA_WYSIWIG="in wysiwig",t.COMPOSE_METRIKA_WYSIWIG_UNDO='click on "Undo"',t.COMPOSE_METRIKA_WYSIWIG_REDO='click on "Redo"',t.COMPOSE_METRIKA_WYSIWIG_BOLD='click on "Bold"',t.COMPOSE_METRIKA_WYSIWIG_ITALIC='click on "Italic"',t.COMPOSE_METRIKA_WYSIWIG_UNDERLINE='click on "Underline"',t.COMPOSE_METRIKA_WYSIWIG_STRIKETHROUGH='click on "Strikethrough"',t.COMPOSE_METRIKA_WYSIWIG_FONT='click on "Font"',t.COMPOSE_METRIKA_WYSIWIG_FONT_SIZE='click on "Font size"',t.COMPOSE_METRIKA_WYSIWIG_TEXT_COLOR='click on "Text color"',t.COMPOSE_METRIKA_WYSIWIG_BACKGROUND_COLOR='click on "Background color"',t.COMPOSE_METRIKA_WYSIWIG_EMOJI='click on "Emoji"',t.COMPOSE_METRIKA_WYSIWIG_ADD_LINK='click on "Add/Edit link"',t.COMPOSE_METRIKA_WYSIWIG_REMOVE_LINK='click on "Remove link"',t.COMPOSE_METRIKA_WYSIWIG_QUOTE='click on "Blockquote"',t.COMPOSE_METRIKA_WYSIWIG_ALIGN='click on "Alignment"',t.COMPOSE_METRIKA_WYSIWIG_ALIGN_LEFT='click on "Align left"',t.COMPOSE_METRIKA_WYSIWIG_ALIGN_CENTER='click on "Align center"',t.COMPOSE_METRIKA_WYSIWIG_ALIGN_RIGHT='click on "Align right"',t.COMPOSE_METRIKA_WYSIWIG_NUMBERED_LIST='click on "Numbered list"',t.COMPOSE_METRIKA_WYSIWIG_BULLETED_LIST='click on "Bulleted list"',t.COMPOSE_METRIKA_WYSIWIG_CLEAR_FORMAT='click on "Clear format"',t.COMPOSE_METRIKA_WYSIWIG_BODY='focus on "Body"',t.COMPOSE_METRIKA_WYSIWIG_AUTOCOMPLETE="Autocomplete",t.COMPOSE_METRIKA_WYSIWIG_AUTOCOMPLETE_SHOW="show",t.COMPOSE_METRIKA_WYSIWIG_AUTOCOMPLETE_USE="use",t.COMPOSE_METRIKA_WYSIWYG_AUTOCOMPLETE_USE_WITH_MOUSE="with mouse",t.COMPOSE_METRIKA_WYSIWYG_AUTOCOMPLETE_USE_WITH_KEYBOARD="with keyboard",t.COMPOSE_METRIKA_WYSIWIG_INLINE_IMAGES="Inline images",t.COMPOSE_METRIKA_WYSIWIG_INLINE_IMAGES_CLICK_TOOLBAR="click on toolbar button",t.COMPOSE_METRIKA_WYSIWIG_INLINE_IMAGES_CLICK_OPTION="click on option",t.COMPOSE_METRIKA_WYSIWIG_INLINE_IMAGES_INSERT_FILE="insert file",t.COMPOSE_METRIKA_WYSIWIG_INLINE_IMAGES_FROM_URL="from url",t.COMPOSE_METRIKA_WYSIWIG_INLINE_IMAGES_FROM_LOCAL="from computer",t.COMPOSE_METRIKA_FOOTER="in footer",t.COMPOSE_METRIKA_FOOTER_SEND='click on "Send"',t.COMPOSE_METRIKA_FOOTER_ATTACH_LOCAL='click on "Files from computer"',t.COMPOSE_METRIKA_FOOTER_ATTACH_DISK='click on "Files from Disk"',t.COMPOSE_METRIKA_FOOTER_ATTACH_MAIL='click on "Files from mail"',t.COMPOSE_METRIKA_FOOTER_BETA='click on "Beta"',t.COMPOSE_METRIKA_FOOTER_MORE='click on "More" button',t.COMPOSE_METRIKA_FOOTER_MORE_AUTOCOMPLETE_ON='click on "enable autocomplete"',t.COMPOSE_METRIKA_FOOTER_MORE_AUTOCOMPLETE_OFF='click on "disable autocomplete"',t.COMPOSE_METRIKA_FOOTER_MORE_SMARTSUBJECT_ON='click on "enable smartsubject"',t.COMPOSE_METRIKA_FOOTER_MORE_SMARTSUBJECT_OFF='click on "disable samrtsubject"',t.COMPOSE_METRIKA_FOOTER_MORE_LABELS_CLICK="click on labels in more menu",t.COMPOSE_METRIKA_FOOTER_MORE_SIGNATURES_CLICK="click on signatures in more menu",t.COMPOSE_METRIKA_FOOTER_PROMO_AUTOCOMPLETE_SHOW="showing autocomplete promo",t.COMPOSE_METRIKA_FOOTER_PROMO_AUTOCOMPLETE_CLOSE="closing autocomplete promo",t.COMPOSE_METRIKA_FOOTER_ATTACHMENTS="Attachments",t.COMPOSE_METRIKA_FOOTER_ATTACHMENTS_CLICK='click on "Attachments" button',t.COMPOSE_METRIKA_FOOTER_DELAYED_SENDING="Delayed sending",t.COMPOSE_METRIKA_FOOTER_DELAYED_SENDING_CLICK='click on "Delayed sending" button',t.COMPOSE_METRIKA_FOOTER_DELAYED_SENDING_CUSTOM_DATETIME='click on "Select date&time"',t.COMPOSE_METRIKA_FOOTER_DELAYED_SENDING_CLEAR='click on "Reset delayed sending"',t.COMPOSE_METRIKA_FOOTER_DELAYED_SENDING_SEND='click on "Send" with delayed options',t.COMPOSE_METRIKA_FOOTER_DELAYED_SENDING_SELECT_CUSTOM_DATETIME="select datetime in calendar",t.COMPOSE_METRIKA_FOOTER_DELAYED_SENDING_CANCEL_CUSTOM_DATETIME="cancel datetime in calendar",t.COMPOSE_METRIKA_TRANSLATION_PANE="in translation pane",t.COMPOSE_METRIKA_TRANSLATION_FROM="language from",t.COMPOSE_METRIKA_TRANSLATION_TO="language to",t.COMPOSE_METRIKA_TRANSLATION_OPEN_LANGUAGE_SELECTOR='click on "Choose language"',t.COMPOSE_METRIKA_TRANSLATION_CHOOSE_LANGUAGE="select language",t.COMPOSE_METRIKA_TRANSLATION_TRANSLATE_BUTTON='click on "Translator"',t.COMPOSE_METRIKA_TRANSLATION_SEND_BUTTON='click on "Send translation"',t.COMPOSE_METRIKA_TRANSLATION_EDIT_BUTTON='click on "Edit translation"',t.COMPOSE_METRIKA_FOOTER_NOTIFICATIONS="Notifications",t.COMPOSE_METRIKA_FOOTER_NOTIFICATIONS_CLICK='click on "Notifications" button',t.COMPOSE_METRIKA_FOOTER_NOTIFICATIONS_DELIVERY_ON='enable "Delivery" notification',t.COMPOSE_METRIKA_FOOTER_NOTIFICATIONS_DELIVERY_OFF='disable "Delivery" notification',t.COMPOSE_METRIKA_FOOTER_NOTIFICATIONS_REPLY_ON='enable "Reply" notification',t.COMPOSE_METRIKA_FOOTER_NOTIFICATIONS_REPLY_OFF='disable "Reply" notification',t.COMPOSE_METRIKA_FOOTER_NOTIFICATIONS_REPLY_EXPAND='expanded "Reply" notification options',t.COMPOSE_METRIKA_FOOTER_NOTIFICATIONS_REPLY_COLLAPSE='collapsed "Reply" notification options',t.COMPOSE_METRIKA_FOOTER_TEMPLATES="Templates",t.COMPOSE_METRIKA_FOOTER_TEMPLATES_CLICK='click on "Templates" button',t.COMPOSE_METRIKA_FOOTER_TEMPLATES_SELECT="select template from list",t.COMPOSE_METRIKA_FOOTER_TEMPLATES_SAVE='click on "Save as template"',t.COMPOSE_METRIKA_FOOTER_TEMPLATES_SAVE_AS_NEW='click on "Save as new template"',t.COMPOSE_METRIKA_FOOTER_TEMPLATES_UPDATE='click on "Update current template"',t.COMPOSE_METRIKA_FOOTER_TEMPLATES_MANAGE='click on "Manage templates"',t.COMPOSE_METRIKA_FOOTER_LABELS="Labels",t.COMPOSE_METRIKA_FOOTER_LABELS_CLICK='click on "Labels" button',t.COMPOSE_METRIKA_FOOTER_LABELS_MANAGE='click on "Manage labels"',t.COMPOSE_METRIKA_FOOTER_LABELS_ADD_IMPORTANT="add important label to letter",t.COMPOSE_METRIKA_FOOTER_LABELS_ADD_USER="add user label to letter",t.COMPOSE_METRIKA_FOOTER_OVERFLOW="Overflow",t.COMPOSE_METRIKA_FOOTER_OVERFLOW_CLICK='click on "Overflow" button',t.COMPOSE_METRIKA_FOOTER_TIME_PRESET_TODAY='click on "Today" preset',t.COMPOSE_METRIKA_FOOTER_TIME_PRESET_TOMORROW='click on "Tomorrow" preset',t.COMPOSE_METRIKA_FOOTER_TIME_PRESET_WEEKEND='click on "Weekend" preset',t.COMPOSE_METRIKA_FOOTER_TIME_PRESET_NEXT_WEEK='click on "Next week" preset',t.TIME_PRESETS_METRIKA=(r={},r[p.TODAY]=t.COMPOSE_METRIKA_FOOTER_TIME_PRESET_TODAY,r[p.TOMORROW]=t.COMPOSE_METRIKA_FOOTER_TIME_PRESET_TOMORROW,r[p.WEEKEND]=t.COMPOSE_METRIKA_FOOTER_TIME_PRESET_WEEKEND,r[p.NEXT_WEEK]=t.COMPOSE_METRIKA_FOOTER_TIME_PRESET_NEXT_WEEK,r),t.COMPOSE_METRIKA_ATTACHMENTS="Attachments",t.COMPOSE_METRIKA_ATTACHMENTS_PREVIEW='click "show"/preview',t.COMPOSE_METRIKA_ATTACHMENTS_DOWNLOAD='click "download one"',t.COMPOSE_METRIKA_ATTACHMENTS_REMOVE='click on "Close"',t.COMPOSE_METRIKA_ATTACHMENTS_REMOVE_ALL='click on "Remove all"',t.COMPOSE_METRIKA_ATTACHMENTS_TOGGLE='click "Fold"',t.COMPOSE_METRIKA_ATTACHMENTS_CANCEL_UPLOAD='click on "Cancel upload"',t.COMPOSE_METRIKA_ATTACHMENTS_PLACE="in compose react",t.COMPOSE_METRIKA_POPUPS="Popups",t.COMPOSE_METRIKA_POPUPS_SEND_FAILED="in send failed popup",t.COMPOSE_METRIKA_POPUPS_SEND_FAILED_SHOW="show",t.COMPOSE_METRIKA_POPUPS_SEND_FAILED_RETRY='click on "Retry"',t.COMPOSE_METRIKA_POPUPS_SEND_FAILED_CANCEL='click on "Cancel"',t.COMPOSE_METRIKA_POPUPS_SEND_FAILED_CLOSE='click on "Close"',t.COMPOSE_METRIKA_POPUPS_LIMITED_RECIPIENTS="in limited recipients popup",t.COMPOSE_METRIKA_POPUPS_LIMITED_RECIPIENTS_SHOW="show",t.COMPOSE_METRIKA_POPUPS_LIMITED_RECIPIENTS_CLOSE='click on "Close"',t.COMPOSE_METRIKA_POPUPS_VALIDATION_ERRORS="in validation errors popup",t.COMPOSE_METRIKA_POPUPS_VALIDATION_ERRORS_SHOW="show",t.COMPOSE_METRIKA_POPUPS_VALIDATION_ERRORS_ACTION='click on "Action"',t.COMPOSE_METRIKA_POPUPS_VALIDATION_ERRORS_CLOSE='click on "Close"',t.COMPOSE_METRIKA_POPUPS_CONFIRM_SAVE="in confirm save popup",t.COMPOSE_METRIKA_POPUPS_CONFIRM_SAVE_SHOW="show",t.COMPOSE_METRIKA_POPUPS_CONFIRM_SAVE_ACTION='click on "Save"',t.COMPOSE_METRIKA_POPUPS_CONFIRM_SAVE_CANCEL='click on "Do not save"',t.COMPOSE_METRIKA_POPUPS_CONFIRM_SAVE_CLOSE='click on "Close"',t.COMPOSE_METRIKA_POPUPS_CONFIRM_REMOVE="in confirm remove popup",t.COMPOSE_METRIKA_POPUPS_CONFIRM_REMOVE_SHOW="show",t.COMPOSE_METRIKA_POPUPS_CONFIRM_REMOVE_ACTION='click on "Remove draft"',t.COMPOSE_METRIKA_POPUPS_CONFIRM_REMOVE_CANCEL='click on "Keep draft"',t.COMPOSE_METRIKA_POPUPS_CONFIRM_REMOVE_CLOSE='click on "Close"',t.COMPOSE_METRIKA_POPUPS_REMOVE_DRAFT="in remove draft popup",t.COMPOSE_METRIKA_POPUPS_REMOVE_DRAFT_SHOW="show",t.COMPOSE_METRIKA_POPUPS_REMOVE_DRAFT_ACTION='click on "Remove draft"',t.COMPOSE_METRIKA_POPUPS_REMOVE_DRAFT_CANCEL='click on "Cancel"',t.COMPOSE_METRIKA_POPUPS_REMOVE_DRAFT_CLOSE='click on "Close"',t.COMPOSE_METRIKA_POPUPS_ATTACHMENTS_ERRORS="in attachments errors popup",t.COMPOSE_METRIKA_POPUPS_ATTACHMENTS_ERRORS_SHOW="show",t.COMPOSE_METRIKA_POPUPS_ATTACHMENTS_ERRORS_DISK_TRAFFIC_LIMIT="traffic limit",t.COMPOSE_METRIKA_POPUPS_ATTACHMENTS_ERRORS_DISK_TECHNICAL_WORK="technical work",t.COMPOSE_METRIKA_POPUPS_ATTACHMENTS_ERRORS_ACTION='click on "OK"',t.COMPOSE_METRIKA_POPUPS_ATTACHMENTS_ERRORS_CLOSE='click on "Close"',t.COMPOSE_METRIKA_POPUPS_CAPTCHA="in captcha popup",t.COMPOSE_METRIKA_POPUPS_CAPTCHA_SHOW="show",t.COMPOSE_METRIKA_POPUPS_CAPTCHA_REFRESH="refresh",t.COMPOSE_METRIKA_POPUPS_CAPTCHA_SEND="send",t.COMPOSE_METRIKA_POPUPS_CAPTCHA_CANCEL="cancel",t.COMPOSE_METRIKA_POPUPS_EMPTY_SUBJECT="in empty subject popup",t.COMPOSE_METRIKA_POPUPS_SMART_SUBJECT="in smart subject popup",t.COMPOSE_METRIKA_POPUPS_EMPTY_SUBJECT_SHOW="show",t.COMPOSE_METRIKA_POPUPS_EMPTY_SUBJECT_SEND_EMPTY="send_empty",t.COMPOSE_METRIKA_POPUPS_EMPTY_SUBJECT_SEND="send",t.COMPOSE_METRIKA_POPUPS_EMPTY_SUBJECT_CANCEL="cancel",t.COMPOSE_METRIKA_POPUPS_EMPTY_SUBJECT_CLOSE="close",t.COMPOSE_METRIKA_POPUPS_EMPTY_SUBJECT_CLICK_DO_NOT_SHOW="click do not show",t.COMPOSE_METRIKA_POPUPS_SMART_SUBJECT_SELECT_FROM_SUGGEST="click on suggest item",t.EDITOR_TOOLBAR_COMMANDS_METRIKA=(o={},o[l.ToolbarCommands.UNDO]=t.COMPOSE_METRIKA_WYSIWIG_UNDO,o[l.ToolbarCommands.REDO]=t.COMPOSE_METRIKA_WYSIWIG_REDO,o[l.ToolbarCommands.BOLD]=t.COMPOSE_METRIKA_WYSIWIG_BOLD,o[l.ToolbarCommands.ITALIC]=t.COMPOSE_METRIKA_WYSIWIG_ITALIC,o[l.ToolbarCommands.UNDERLINE]=t.COMPOSE_METRIKA_WYSIWIG_UNDERLINE,o[l.ToolbarCommands.STRIKETHROUGH]=t.COMPOSE_METRIKA_WYSIWIG_STRIKETHROUGH,o[l.ToolbarCommands.FONT]=t.COMPOSE_METRIKA_WYSIWIG_FONT,o[l.ToolbarCommands.FONT_SIZE]=t.COMPOSE_METRIKA_WYSIWIG_FONT_SIZE,o[l.ToolbarCommands.TEXT_COLOR]=t.COMPOSE_METRIKA_WYSIWIG_TEXT_COLOR,o[l.ToolbarCommands.BACKGROUND_COLOR]=t.COMPOSE_METRIKA_WYSIWIG_BACKGROUND_COLOR,o[l.ToolbarCommands.EMOJI]=t.COMPOSE_METRIKA_WYSIWIG_EMOJI,o[l.ToolbarCommands.ADD_LINK]=t.COMPOSE_METRIKA_WYSIWIG_ADD_LINK,o[l.ToolbarCommands.REMOVE_LINK]=t.COMPOSE_METRIKA_WYSIWIG_REMOVE_LINK,o[l.ToolbarCommands.QUOTE]=t.COMPOSE_METRIKA_WYSIWIG_QUOTE,o[l.ToolbarCommands.ALIGN]=t.COMPOSE_METRIKA_WYSIWIG_ALIGN,o[l.ToolbarCommands.ALIGN_LEFT]=t.COMPOSE_METRIKA_WYSIWIG_ALIGN_LEFT,o[l.ToolbarCommands.ALIGN_CENTER]=t.COMPOSE_METRIKA_WYSIWIG_ALIGN_CENTER,o[l.ToolbarCommands.ALIGN_RIGHT]=t.COMPOSE_METRIKA_WYSIWIG_ALIGN_RIGHT,o[l.ToolbarCommands.NUMBERED_LIST]=t.COMPOSE_METRIKA_WYSIWIG_NUMBERED_LIST,o[l.ToolbarCommands.BULLETED_LIST]=t.COMPOSE_METRIKA_WYSIWIG_BULLETED_LIST,o[l.ToolbarCommands.CLEAR_FORMAT]=t.COMPOSE_METRIKA_WYSIWIG_CLEAR_FORMAT,o),t.PROMO_ON_DONE="Промо на Done",t.DONE_SCREEN="Done-react",t.DONE_SCREEN_SHOW="Show",t.DONE_SCREEN_PROMO_HOTKEYS="Hot-keys-react",t.DONE_SCREEN_PROMO_HOTKEYS_SHOW="Show",t.DONE_SCREEN_PROMO_HOTKEYS_ACTION="Click on more information",t.DONE_SCREEN_PROMO_BEAUTIFUL_EMAIL="done screen beautiful email",t.DONE_SCREEN_PROMO_BEAUTIFUL_EMAIL_SHOW="show";t.DONE_SCREEN_PROMO_BEAUTIFUL_EMAIL_ACTION="action",t.DONE_SCREEN_CLOSE_ON_TIMER="Close on timer",t.DONE_SCREEN_CLOSE_ON_KEY="Close on key",t.DONE_SCREEN_CLOSE_ON_CLICK="Close on click",t.DONE_SCREEN_CLOSE_ON_INBOX_CLICK="Close on inbox click",t.DONE_SCREEN_CLOSE_ON_SETTINGS_CLICK="Close on settings click",t.DONE_SCREEN_CLOSE_ON_OUTBOX_CLICK="Close on sent outbox click",t.DONE_SCREEN_CLOSE_ON_CROSS="Close on cross click",t.DONE_SCREEN_CLOSE_ON_BEAUTIFUL_EMAIL="Close on beautiful email",t.ABOOK_POPUP="Abook popup",t.ABOOK_POPUP_SHOW="show popup",t.ABOOK_POPUP_SHOW_FIELD_TITLE="on click on field title",t.ABOOK_POPUP_SHOW_SUGGEST='on click on "All contacts" in suggest',t.QUICK_REPLY="Quick Reply (new)";var f=[t.QUICK_REPLY,"click on"];t.QUICK_REPLY_CLICK_ON_CLOSE=u(f,["close"]),t.QUICK_REPLY_CLICK_ON_COMPOSE=u(f,["compose"]),t.QUICK_REPLY_CLICK_ON_RECIPIENTS=u(f,["recipients"])},3603:function(e,t,n){"use strict";var r=n(3604);n.d(t,"a",(function(){return r.a}))},3604:function(e,t,n){"use strict";function r(){return r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},r.apply(this,arguments)}function o(e){"@babel/helpers - typeof";return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t,n){return t&&c(e.prototype,t),n&&c(e,n),e}function u(e,t){return!t||"object"!==o(t)&&"function"!=typeof t?l(e):t}function l(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function f(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&d(e,t)}function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function y(e,t,n,r){m||(m="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=r;else if(i>1){for(var a=new Array(i),c=0;c<i;c++)a[c]=arguments[c+3];t.children=a}if(t&&o)for(var s in o)void 0===t[s]&&(t[s]=o[s]);else t||(t=o||{});return{$$typeof:m,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function b(e){var t,n;return n=t=(function(t){function n(){var e,t;a(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return t=u(this,(e=p(n)).call.apply(e,[this].concat(o))),t.state={cancelButtonHovered:!1},t.cancelButtonRef=g.a.createRef(),t.onCloseClicked=function(e){if(e.preventDefault(),e.stopPropagation(),t.isUploading){var n=t.props.onCancelLoading;n&&n()}else{var r=t.props.onClose;r&&r()}},t}return f(n,t),s(n,[{key:"renderCloseButton",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"qa-Compose-Attachment-CloseButton";return y(C.Button,{onClick:this.onCloseClicked,pin:"circle-circle",view:"raised",className:S()(D.a.close,e),"aria-label":Object(A.default)("compose-react/deleteLabel")},void 0,y(k.default,{cls:D.a.closeIcon,id:"mail--Compose-Cross"}))}},{key:"renderCancelButton",value:function(){return y(P.TooltipStateful,{view:"default",state:"warning",size:"s",direction:"top",content:this.renderCancelButtonTooltip()},void 0,this.renderCloseButton("qa-Compose-Attachment-CancelButton"))}},{key:"maybeRenderSize",value:function(){var e=this.props.size;return e?y("span",{className:D.a.tooltipSize},void 0,y(R.HumanFileSize,{bytes:e})):null}},{key:"maybeRenderProgress",value:function(){var e=this.props,t=e.status,n=e.progress;return t===j.c.COMPLETED?null:y(M.Progress,{className:D.a.progress,progress:n})}},{key:"render",value:function(){var t,n=this.props,o=n.previewSrc,a=n.sourceHref,c=n.status,s=n.onPreviewClick,u=n.sourceType,l=Boolean(o),p=u!==j.d.YADISK&&!l,f=S()(D.a.wrap,"qa-Compose-Attachment",(t={},i(t,"qa-Compose-Attachment-loading",c===j.c.UPLOADING),i(t,"qa-Compose-Attachment-new",c!==j.c.COMPLETED),t));return y(P.TooltipStateful,{view:"default",state:"warning",size:"s",direction:"top",content:this.renderContainerTooltip()},void 0,y("a",{className:f,onClick:s,download:p,href:a,target:"_blank",rel:"noopener noreferrer"},void 0,g.a.createElement(e,r({},this.props,{transparent:this.isUploading})),this.isUploading?this.renderCancelButton():this.renderCloseButton(),this.maybeRenderProgress()))}},{key:"renderContainerTooltip",value:function(){var e=this.props.name;return y("div",{className:D.a.tooltip},void 0,y(w.Text,{color:"inverse",typography:"body-long-m"},void 0,e,this.maybeRenderSize()),this.isDisk&&y(w.Text,{color:"secondary",typography:"body-long-m",className:D.a.tooltipDisk},void 0,N))}},{key:"renderCancelButtonTooltip",value:function(){return L}},{key:"isUploading",get:function(){return this.props.status===j.c.NEW||this.props.status===j.c.UPLOADING}},{key:"isDisk",get:function(){return this.props.sourceType===j.d.YADISK}}]),n})(g.a.Component),t.propTypes={status:v.a.oneOf(Object(E.values)(j.c)),progress:v.a.number,onClose:v.a.func,onCancelLoading:v.a.func,previewSrc:v.a.string,size:v.a.number,name:v.a.string,sourceHref:v.a.string,onPreviewClick:v.a.func,sourceType:v.a.oneOf(Object(E.values)(j.d))},n}t.a=b;var m,h=n(348),v=n.n(h),O=n(137),g=n.n(O),_=n(350),S=n.n(_),E=n(138),P=(n.n(E),n(143)),C=(n.n(P),n(142)),w=(n.n(C),n(140)),T=(n.n(w),n(352)),k=n(368),R=n(479),A=(n.n(R),n(367)),j=n(369),M=n(1804),I=(n.n(M),n(3605)),D=n.n(I),N=y(T.default,{loc:"compose-react/attachmentsDiskTooltip"}),L=y(T.default,{loc:"compose-react/Attachments_CancelLoading_Tooltip"})},3605:function(e,t){e.exports={close:"withControls__close--3dGMt",closeIcon:"withControls__closeIcon--3-6W0",wrap:"withControls__wrap--ll0S5",progress:"withControls__progress--2-wKp",tooltip:"withControls__tooltip--BNOLo",tooltipDisk:"withControls__tooltipDisk--1KQxK",tooltipSize:"withControls__tooltipSize--3hHjg"}},3606:function(e,t){e.exports={progress:"Attachments__progress--hHexK",body:"Attachments__body--UhETx",item:"Attachments__item--1av-z",item_collapsed:"Attachments__item_collapsed--1oFMG",wrap:"Attachments__wrap--8z8BG"}},3607:function(e,t,n){"use strict";var r=n(433),o=n(3608),i=n(3675);t.a=Object(r.a)(i.a,o.a)},3608:function(e,t,n){"use strict";function r(e){"@babel/helpers - typeof";return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}function c(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?u(e):t}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function u(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function f(e,t,n,r){E||(E="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=r;else if(i>1){for(var a=new Array(i),c=0;c<i;c++)a[c]=arguments[c+3];t.children=a}if(t&&o)for(var s in o)void 0===t[s]&&(t[s]=o[s]);else t||(t=o||{});return{$$typeof:E,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function d(e,t,n,r){n&&Object.defineProperty(e,t,{enumerable:n.enumerable,configurable:n.configurable,writable:n.writable,value:n.initializer?n.initializer.call(r):void 0})}function y(e,t,n,r,o){var i={};return Object.keys(r).forEach((function(e){i[e]=r[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce((function(n,r){return r(e,t,n)||n}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}n.d(t,"a",(function(){return K}));var b,m,h,v,O,g,_,S,E,P=n(137),C=n.n(P),w=n(350),T=n.n(w),k=n(138),R=n.n(k),A=n(351),j=n(353),M=n(395),I=n.n(M),D=n(501),N=n(915),L=n(1303),x=n(1807),z=n(3666),B=n(1307),F=n(3669),U=n(3674),K=(n.n(U),(b=Object(j.inject)("controllers"))(m=Object(j.observer)((S=_=(function(e){function t(){var e,n;o(this,t);for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return n=c(this,(e=s(t)).call.apply(e,[this].concat(i))),n.innerRef=C.a.createRef(),n.leftPartRef=C.a.createRef(),n.sendButtonRef=C.a.createRef(),n.mainPartRef=C.a.createRef(),n.disposer=new I.a,d(u(n),"maxVisibleButtonsCount",v,u(n)),d(u(n),"closeCompose",O,u(n)),d(u(n),"updateVisibleButtons",g,u(n)),n.renderExtraButton=function(e){var t=x.a[e],n=t.Button,r=t.buttonCls;return f(n,{cls:T()(N.a.Button,r),isMobile:!0},e)},n}return l(t,e),a(t,[{key:"getFullWidth",value:function(e){return e?e.offsetWidth+parseInt(window.getComputedStyle(e).marginRight,10):0}},{key:"componentDidMount",value:function(){var e=R.a.throttle(this.updateVisibleButtons,50);this.disposer.add(this,[Object(M.addEventListener)({eventName:"resize",listener:e})]),this.updateVisibleButtons()}},{key:"componentWillUnmount",value:function(){this.disposer.dispose(this)}},{key:"render",value:function(){var e=T()(N.a.Block,"".concat(N.a.Block,"_mobile"),this.props.cls);return C.a.createElement("div",{className:e,ref:this.innerRef},C.a.createElement("div",{className:N.a.Part,ref:this.leftPartRef},f(z.a,{cls:T()(N.a.CloseButton,N.a.Button),onClick:this.closeCompose})),C.a.createElement("div",{className:N.a.Part,ref:this.mainPartRef},this.hasOverflow&&this.renderOverflowButton(),this.visibleExtraButtons.map(this.renderExtraButton),f(B.a,{innerRef:this.sendButtonRef,cls:T()(N.a.SendButton,N.a.Button)})))}},{key:"renderOverflowButton",value:function(){return f(F.a,{cls:N.a.Button,contentOptions:{buttons:this.hiddenExtraButtons}})}},{key:"panelWidth",get:function(){return this.innerRef.current?this.innerRef.current.clientWidth:0}},{key:"sendButtonWidth",get:function(){return this.getFullWidth(this.sendButtonRef.current)}},{key:"leftPartWidth",get:function(){return this.getFullWidth(this.leftPartRef.current)}},{key:"iconButtonWidth",get:function(){var e=this.mainPartRef.current,t=e&&e.querySelector(".".concat(N.a.Button));return this.getFullWidth(t)}},{key:"visibleExtraButtons",get:function(){return this.hasOverflow?this.maxVisibleButtonsCount<=1?[]:t.extraButtons.slice(1-this.maxVisibleButtonsCount):t.extraButtons}},{key:"hiddenExtraButtons",get:function(){return this.hasOverflow?this.maxVisibleButtonsCount<=1?t.extraButtons:t.extraButtons.slice(0,t.extraButtons.length-this.maxVisibleButtonsCount+1):[]}},{key:"hasOverflow",get:function(){return this.maxVisibleButtonsCount<t.extraButtons.length}}]),t})(C.a.Component),_.propTypes=L.b,_.extraButtons=[D.a.LABELS,D.a.DELAYED_SENDING,D.a.NOTIFICATIONS,D.a.ATTACHMENTS],h=S,v=y(h.prototype,"maxVisibleButtonsCount",[A.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return K.extraButtons.length}}),O=y(h.prototype,"closeCompose",[A.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){e.props.controllers.compose.closeCompose()}}}),g=y(h.prototype,"updateVisibleButtons",[A.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){var t=e.panelWidth-e.leftPartWidth-e.sendButtonWidth,n=t>0?Math.floor(t/e.iconButtonWidth):0;n!==e.maxVisibleButtonsCount&&(e.maxVisibleButtonsCount=n)}}}),m=h))||m)||m)},3609:function(e,t,n){"use strict";function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t,n,r){a||(a="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=r;else if(i>1){for(var c=new Array(i),s=0;s<i;s++)c[s]=arguments[s+3];t.children=c}if(t&&o)for(var u in o)void 0===t[u]&&(t[u]=o[u]);else t||(t=o||{});return{$$typeof:a,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}n.d(t,"a",(function(){return m}));var a,c=n(137),s=(n.n(c),n(350)),u=n.n(s),l=n(348),p=n.n(l),f=n(368),d=n(455),y=n(503),b=n(3615),m=(n.n(b),{Block:"ComposeAttachFileButton",Popup:"".concat("ComposeAttachFileButton","-Popup")}),h=function(e){var t=e.isMobile?"mail--Compose-Clip":"mail--Compose-Clip_new";return i(d.a,{innerRef:e.innerRef,onMouseEnter:e.onMouseEnter,onMouseLeave:e.onMouseLeave,onClick:e.onClick,className:u()(m.Block,e.cls),iconComponent:i(f.default,{id:t}),upload:e.upload,focused:e.focused})};t.b=h,h.propTypes=(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e})({},y.a,{focused:p.a.bool})},3610:function(e,t,n){"use strict";function r(){return r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},r.apply(this,arguments)}function o(e){"@babel/helpers - typeof";return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){if(null==e)return{};var n,r,o=c(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function c(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function l(e,t,n){return t&&u(e.prototype,t),n&&u(e,n),e}function p(e,t){return!t||"object"!==o(t)&&"function"!=typeof t?f(e):t}function f(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function d(e){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function y(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&b(e,t)}function b(e,t){return(b=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}n.d(t,"a",(function(){return w}));var m=n(137),h=n.n(m),v=n(350),O=n.n(v),g=n(348),_=n.n(g),S=n(402),E=n(3611),P=(n.n(E),"ComposeControlPanelButton"),C={Block:P,Button:"".concat(P,"-Button"),Button_action:"".concat(P,"-Button_action"),Button_icon:"".concat(P,"-Button_icon"),Block_sidePadding:"".concat(P,"-Button_sidePadding"),Button_clear:"".concat(P,"-Button_clear"),Block_notification:"".concat(P,"_notification"),Button_upload:"".concat(P,"-Button_upload")},w=(function(e){function t(){return s(this,t),p(this,d(t).apply(this,arguments))}return y(t,e),l(t,[{key:"render",value:function(){var e,t=this.props,n=t.className,o=t.isAction,c=t.isClear,s=t.hasNotification,u=t.innerRef,l=t.iconComponent,p=t.children,f=t.upload,d=a(t,["className","isAction","isClear","hasNotification","innerRef","iconComponent","children","upload"]),y=O()(C.Block,i({},C.Block_notification,s),n),b=O()(C.Button,(e={},i(e,C.Button_action,o),i(e,C.Button_icon,Boolean(l)),i(e,C.Button_clear,c),i(e,C.Block_sidePadding,Boolean(p)),i(e,C.Button_upload,Boolean(f)),e)),m=h.a.createElement(h.a.Fragment,null,l,p);return h.a.createElement("div",{className:y,ref:u},h.a.createElement(S.a,r({cls:b,theme:o?"action":"normal",tone:"default",size:"l",pin:"circle-circle",view:"default"},d),m,f&&f()))}}]),t})(h.a.PureComponent);w.propTypes={className:_.a.string,isAction:_.a.bool,isClear:_.a.bool,hasNotification:_.a.bool,innerRef:_.a.oneOfType([_.a.object,_.a.func]),iconComponent:_.a.element,upload:_.a.func},w.defaultProps={isAction:!1}},3611:function(e,t){},3612:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ControlPanelButton=void 0;var r=n(3613);Object.defineProperty(t,"ControlPanelButton",{enumerable:!0,get:function(){return r.ControlPanelButton}})},3613:function(e,t,n){"use strict";var r=this&&this.__extends||(function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}})(),o=this&&this.__assign||function(){return o=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},o.apply(this,arguments)},i=this&&this.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var o=0,r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]]);return n},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.ControlPanelButton=void 0;var c=a(n(137)),s=a(n(350)),u=n(142),l=a(n(3614)),p=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.render=function(){var e,t,n=this.props,r=n.className,a=n.hasNotification,p=n.innerRef,f=n.iconComponent,d=n.upload,y=(n.isAction,n.focused),b=i(n,["className","hasNotification","innerRef","iconComponent","upload","isAction","focused"]),m=Boolean(f),h=s.default(l.default.root,"qa-Compose-ControlPanelButton",(e={},e[l.default.notification]=a,e["qa-Compose-ControlPanelButton-notification"]=a,e),r),v=m&&!b.children,O=Boolean(d),g=v?function(e){var t;return c.default.createElement("span",{className:s.default(e,l.default.icon,(t={},t[l.default.withUpload]=O,t))},f,d&&d())}:void 0,_=m&&!v?function(e){return c.default.createElement("span",{className:s.default(e,l.default.icon,l.default.icon_withText)},f)}:void 0;return c.default.createElement("div",{className:h,ref:p},c.default.createElement(u.Button,o({className:s.default((t={},t[l.default.focused]=y,t)),view:"clear",size:"l",icon:g,iconLeft:_,as:O?"span":"button"},b)))},t})(c.default.PureComponent);t.ControlPanelButton=p},3614:function(e,t){e.exports={icon:"new__icon--1nFOX",withUpload:"new__withUpload--9cWEz",icon_withText:"new__icon_withText--1O4BW",root:"new__root--3qgLa",notification:"new__notification--2BKKY",focused:"new__focused--3GmWj"}},3615:function(e,t){},3616:function(e,t,n){"use strict";var r=n(433),o=n(3617),i=n(3620);t.a=Object(r.a)(o.a,i.a)},3617:function(e,t,n){"use strict";function r(e){"@babel/helpers - typeof";return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}function c(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?s(e):t}function s(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function f(e,t,n,r){d||(d="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=r;else if(i>1){for(var a=new Array(i),c=0;c<i;c++)a[c]=arguments[c+3];t.children=a}if(t&&o)for(var s in o)void 0===t[s]&&(t[s]=o[s]);else t||(t=o||{});return{$$typeof:d,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}n.d(t,"a",(function(){return g}));var d,y=n(137),b=n.n(y),m=n(1808),h=n(1809),v=n(1305),O=n(3619),g=(n.n(O),(function(e){function t(){return o(this,t),c(this,u(t).apply(this,arguments))}return l(t,e),a(t,[{key:"render",value:function(){return f(m.a,{cls:"ComposeAttachmentSourcesDesktop",onSelectSource:this.props.onAction,sources:this.sources})}},{key:"sources",get:function(){return[{type:v.a.LOCAL,icon:"mail--Compose-AttachLocal",loc:"compose-react/Attachments_Add_Local"},{type:v.a.DISK,icon:"mail--Compose-AttachDisk",loc:"compose-react/Attachments_Add_Disk"},{type:v.a.MAIL,icon:"mail--Compose-AttachMail",loc:"compose-react/Attachments_Add_Mail"}]}}]),t})(b.a.PureComponent));g.propTypes=h.a},3618:function(e,t){},3619:function(e,t){},3620:function(e,t,n){"use strict";function r(e){"@babel/helpers - typeof";return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t,n){return t&&c(e.prototype,t),n&&c(e,n),e}function u(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?l(e):t}function l(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function f(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&d(e,t)}function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function y(e,t,n,r){O||(O="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=r;else if(i>1){for(var a=new Array(i),c=0;c<i;c++)a[c]=arguments[c+3];t.children=a}if(t&&o)for(var s in o)void 0===t[s]&&(t[s]=o[s]);else t||(t=o||{});return{$$typeof:O,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}n.d(t,"a",(function(){return I}));var b,m,h,v,O,g=n(137),_=n.n(g),S=n(353),E=n(1809),P=n(352),C=n(1808),w=n(1305),T=n(455),k=n(365),R=n(3621),A=(n.n(R),"ComposeAttachmentSourcesMobile"),j={Block:A,Menu:"".concat(A,"-Menu"),Footer:"".concat(A,"-Footer"),Button:"".concat(A,"-Button"),ButtonText:"".concat(A,"-ButtonText")},M=y(P.default,{loc:"compose-react/AttachmentsPopup_ActionText"}),I=(b=Object(S.inject)("services"))(m=Object(S.observer)((v=h=(function(e){function t(){return a(this,t),u(this,p(t).apply(this,arguments))}return f(t,e),s(t,[{key:"render",value:function(){return y("div",{className:j.Block},void 0,y(C.a,{cls:j.Menu,onSelectSource:this.props.onAction,sources:this.sources}),y("div",{className:j.Footer},void 0,y(T.a,{className:j.Button,onClick:this.props.onAction},void 0,y("div",{className:j.ButtonText},void 0,M))))}},{key:"sources",get:function(){var e=this.props.services;return[{type:w.a.LOCAL,icon:"mail--Compose-Clip",loc:e.settings.isTablet?"compose-react/Attachments_Add_Tablet":"compose-react/Attachments_Add_Phone"},{type:w.a.DISK,icon:"mail--Compose-AttachDisk",loc:"compose-react/Attachments_Add_Disk"},{type:w.a.MAIL,icon:"mail--Compose-AttachMail",loc:"compose-react/Attachments_Add_Mail"}]}}]),t})(_.a.PureComponent),h.propTypes=(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e})({},E.a,{services:k.a.isRequired}),m=v))||m)||m},3621:function(e,t){},3622:function(e,t,n){"use strict";function r(){return r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},r.apply(this,arguments)}var o=n(137),i=n.n(o),a=n(916),c=function(e){return i.a.createElement(a.a,r({icon:"mail--Compose-Clip",loc:"compose-react/AttachmentsPopup_Title"},e))};t.a=c},3623:function(e,t){},3624:function(e,t,n){"use strict";var r=n(3625);n.d(t,"a",(function(){return r.a}))},3625:function(e,t,n){"use strict";function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function o(e){"@babel/helpers - typeof";return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t,n){return t&&c(e.prototype,t),n&&c(e,n),e}function u(e,t){return!t||"object"!==o(t)&&"function"!=typeof t?l(e):t}function l(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function f(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&d(e,t)}function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function y(e,t,n,r){b||(b="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=r;else if(i>1){for(var a=new Array(i),c=0;c<i;c++)a[c]=arguments[c+3];t.children=a}if(t&&o)for(var s in o)void 0===t[s]&&(t[s]=o[s]);else t||(t=o||{});return{$$typeof:b,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}n.d(t,"a",(function(){return R}));var b,m=n(137),h=n.n(m),v=n(141),O=n.n(v),g=n(348),_=n.n(g),S=n(350),E=n.n(S),P=n(3626),C=n(3627),w=n(3629),T=n(3630),k=(n.n(T),{Block:"ComposeMobilePopup",Content:"".concat("ComposeMobilePopup","-Content")}),R=(function(e){function t(){var e,n;a(this,t);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return n=u(this,(e=p(t)).call.apply(e,[this].concat(o))),n.contentRef=h.a.createRef(),n.onClick=function(e){if(!n.contentRef.current||!n.contentRef.current.contains(e.target)){var t=n.props.onClose;t&&t(e)}},n}return f(t,e),s(t,[{key:"render",value:function(){var e="function"==typeof this.props.scope?this.props.scope():this.props.scope;e||(e=document.body);var t=E()(this.props.cls,k.Block,"".concat(k.Block,"_").concat(this.props.type),i({},"".concat(k.Block,"_hidden"),!this.props.visible)),n=this.props.onClose,r="top"===this.props.type?w.a:C.a;return O.a.createPortal(y("div",{className:t,onClick:this.onClick},void 0,y(r,{cls:k.Content,innerRef:this.contentRef,onClose:n,title:this.props.title},void 0,this.props.children)),e)}}]),t})(h.a.PureComponent);R.propTypes=(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e})({},P.a,{title:_.a.string,type:_.a.oneOf(["top","bottom"])}),R.defaultProps={type:"bottom"}},3626:function(e,t,n){"use strict";var r=n(348),o=n.n(r);t.a={anchor:o.a.object,scope:o.a.oneOfType([o.a.object,o.a.func]),className:o.a.string,onClose:o.a.func,visible:o.a.bool}},3627:function(e,t,n){"use strict";function r(e){"@babel/helpers - typeof";return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}function c(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?s(e):t}function s(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function f(e,t,n,r){d||(d="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=r;else if(i>1){for(var a=new Array(i),c=0;c<i;c++)a[c]=arguments[c+3];t.children=a}if(t&&o)for(var s in o)void 0===t[s]&&(t[s]=o[s]);else t||(t=o||{});return{$$typeof:d,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}n.d(t,"a",(function(){return w}));var d,y=n(137),b=n.n(y),m=n(348),h=n.n(m),v=n(350),O=n.n(v),g=n(368),_=n(560),S=n(3628),E=(n.n(S),"ComposeBottomPopup"),P={Block:E,Header:"".concat(E,"-Header"),Title:"".concat(E,"-Title"),Close:"".concat(E,"-Close"),Separator:"".concat(E,"-Separator")},C=f(g.default,{id:"mail--Compose-Close-Mobile"}),w=(function(e){function t(){return o(this,t),c(this,u(t).apply(this,arguments))}return l(t,e),a(t,[{key:"render",value:function(){return b.a.createElement("div",{className:O()(P.Block,this.props.cls),ref:this.props.innerRef},f("div",{className:P.Header},void 0,f("span",{className:P.Title},void 0,this.props.title),f(_.a,{cls:P.Close,onClick:this.props.onClose,view:"default",tone:"default",theme:"clear"},void 0,C)),f("div",{className:P.Separator}),this.props.children)}}]),t})(b.a.PureComponent);w.propTypes={cls:h.a.string,innerRef:h.a.object,onClose:h.a.func,title:h.a.string}},3628:function(e,t){},3629:function(e,t,n){"use strict";function r(e){"@babel/helpers - typeof";return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}function c(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?s(e):t}function s(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}n.d(t,"a",(function(){return O}));var f=n(137),d=n.n(f),y=n(348),b=n.n(y),m=n(350),h=n.n(m),v={Block:"ComposeTopPopup"},O=(function(e){function t(){return o(this,t),c(this,u(t).apply(this,arguments))}return l(t,e),a(t,[{key:"render",value:function(){return d.a.createElement("div",{className:h()(v.Block,this.props.cls),ref:this.props.innerRef},this.props.children)}}]),t})(d.a.PureComponent);O.propTypes={cls:b.a.string,innerRef:b.a.object}},3630:function(e,t){},3631:function(e,t,n){"use strict";function r(){return r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},r.apply(this,arguments)}function o(e){"@babel/helpers - typeof";return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){if(null==e)return{};var n,r,o=a(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function a(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e,t,n){return t&&s(e.prototype,t),n&&s(e,n),e}function l(e,t){return!t||"object"!==o(t)&&"function"!=typeof t?p(e):t}function p(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function d(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&y(e,t)}function y(e,t){return(y=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function b(e,t,n,r){h||(h="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=r;else if(i>1){for(var a=new Array(i),c=0;c<i;c++)a[c]=arguments[c+3];t.children=a}if(t&&o)for(var s in o)void 0===t[s]&&(t[s]=o[s]);else t||(t=o||{});return{$$typeof:h,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function m(e){function t(e,t){return O.a.createElement(a,r({},e,{forwardedRef:t}))}var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=n.label,a=(function(t){function n(){var e,t;c(this,n);for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return t=l(this,(e=f(n)).call.apply(e,[this].concat(i))),t.state={focused:!1},t.onClick=function(e){var n=t.props,r=n.onClick,o=n.onFileInputClick;t.props.isUploadDisabled?r&&r(e):o&&o(e)},t.onChangeFile=function(e){e.stopPropagation(),e.preventDefault();var n=Array.from(e.target.files);t.props.onChangeFiles&&t.props.onChangeFiles(n),e.target.value=null},t.onFocus=function(){t.setState({focused:!0})},t.onBlur=function(){t.setState({focused:!1})},t.renderUpload=function(e){return b("div",{className:E()(w.Block,e)},void 0,b("input",{className:E()(w.FileInput,"qa-Compose-FileInput2"),type:"file",multiple:!0,onChange:t.onChangeFile,"aria-label":Object(P.default)(o),onFocus:t.onFocus,onBlur:t.onBlur}))},t}return d(n,t),u(n,[{key:"render",value:function(){var t=this.props,n=t.forwardedRef,o=i(t,["forwardedRef"]);return O.a.createElement(e,r({ref:n},o,{onClick:this.onClick,upload:this.props.isUploadDisabled?null:this.renderUpload,focused:this.state.focused}))}}]),n})(O.a.Component);a.propTypes={forwardedRef:_.a.object,onClick:_.a.func,isUploadDisabled:_.a.bool,onFileInputClick:_.a.func,onChangeFiles:_.a.func};var s=e.displayName||e.name;return t.displayName=s?"withUpload(".concat(s,")"):"withUpload",O.a.forwardRef(t)}t.a=m;var h,v=n(137),O=n.n(v),g=n(348),_=n.n(g),S=n(350),E=n.n(S),P=n(367),C=n(3632),w=(n.n(C),{Block:"WithUpload",FileInput:"".concat("WithUpload","-FileInput")})},3632:function(e,t){},3633:function(e,t,n){"use strict";function r(){return r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},r.apply(this,arguments)}function o(e){"@babel/helpers - typeof";return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){if(null==e)return{};var n,r,o=a(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function a(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e,t,n){return t&&s(e.prototype,t),n&&s(e,n),e}function l(e,t){return!t||"object"!==o(t)&&"function"!=typeof t?p(e):t}function p(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function d(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&y(e,t)}function y(e,t){return(y=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function b(e,t,n,r,o){var i={};return Object.keys(r).forEach((function(e){i[e]=r[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce((function(n,r){return r(e,t,n)||n}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}function m(e){function t(e,t){return v.a.createElement(m,r({},e,{forwardedRef:t}))}var n,o,a,s,p,y=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{shouldCheckUploadDisabled:!0},m=(n=Object(S.inject)("controllers","services"))(o=Object(S.observer)((p=s=(function(t){function n(){var e,t;c(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return t=l(this,(e=f(n)).call.apply(e,[this].concat(o))),t.onAttachLocal=function(){t.metrikaService.sendFooterMetrika(C.COMPOSE_METRIKA_FOOTER_ATTACH_LOCAL)},t.onChangeFiles=function(e){t.props.controllers.attachments.attachFilesFromLocal(e),setTimeout((function(){return t.props.controllers.compose.focusAttachments()}),100)},t}return d(n,t),u(n,[{key:"render",value:function(){var t=this.props,n=t.forwardedRef,o=i(t,["forwardedRef"]);return v.a.createElement(e,r({ref:n,isUploadDisabled:this.isUploadDisabled,onFileInputClick:this.onAttachLocal,onChangeFiles:this.onChangeFiles},o))}},{key:"isUploadDisabled",get:function(){return y.shouldCheckUploadDisabled&&this.props.services.attachments.hasDisk}},{key:"metrikaService",get:function(){return this.props.services.metrika}}]),n})(v.a.Component),s.propTypes={controllers:E.a.isRequired,forwardedRef:g.a.object,services:P.a.isRequired},a=p,b(a.prototype,"isUploadDisabled",[_.computed],Object.getOwnPropertyDescriptor(a.prototype,"isUploadDisabled"),a.prototype),b(a.prototype,"metrikaService",[_.computed],Object.getOwnPropertyDescriptor(a.prototype,"metrikaService"),a.prototype),o=a))||o)||o,h=e.displayName||e.name;return t.displayName=h?"withUploadAdapter(".concat(h,")"):"withUploadAdapter",v.a.forwardRef(t)}t.a=m;var h=n(137),v=n.n(h),O=n(348),g=n.n(O),_=n(351),S=n(353),E=n(372),P=n(365),C=n(360);n.n(C)},3634:function(e,t){},3635:function(e,t,n){"use strict";function r(e){"@babel/helpers - typeof";return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}function c(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?u(e):t}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function u(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function f(e,t,n,r){T||(T="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=r;else if(i>1){for(var a=new Array(i),c=0;c<i;c++)a[c]=arguments[c+3];t.children=a}if(t&&o)for(var s in o)void 0===t[s]&&(t[s]=o[s]);else t||(t=o||{});return{$$typeof:T,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function d(e,t,n,r){n&&Object.defineProperty(e,t,{enumerable:n.enumerable,configurable:n.configurable,writable:n.writable,value:n.initializer?n.initializer.call(r):void 0})}function y(e,t,n,r,o){var i={};return Object.keys(r).forEach((function(e){i[e]=r[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce((function(n,r){return r(e,t,n)||n}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}n.d(t,"a",(function(){return K}));var b,m,h,v,O,g,_,S,E,P,C,w,T,k=n(137),R=n.n(k),A=n(348),j=n.n(A),M=n(355),I=n.n(M),D=n(351),N=n(353),L=n(3636),x=n(3642),z=n(376),B=n(365),F=n(380),U=n(360),K=(n.n(U),(b=Object(N.inject)("data","services","visual"))(m=Object(N.observer)((w=C=(function(e){function t(){var e,n;o(this,t);for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return n=c(this,(e=s(t)).call.apply(e,[this].concat(i))),n.datetimePickerRef=R.a.createRef(),d(u(n),"customDateContainerRef",v,u(n)),d(u(n),"isDateTimePickerVisible",O,u(n)),d(u(n),"setCustomDateContainerRef",g,u(n)),d(u(n),"showDateTimePicker",_,u(n)),d(u(n),"onSelectCustomDate",S,u(n)),d(u(n),"closeDatetimePicker",E,u(n)),d(u(n),"onClearCustomDate",P,u(n)),n.onCancelSelectCustomDate=function(){n.closeDatetimePicker(),n.metrikaService.sendFooterMetrika(U.COMPOSE_METRIKA_FOOTER_DELAYED_SENDING,U.COMPOSE_METRIKA_FOOTER_DELAYED_SENDING_CANCEL_CUSTOM_DATETIME)},n.getInitialDate=function(){var e=n.props.services.date.passportNow;return n.sendTime?I()(n.sendTime):I()(e).add(30,"minutes")},n.getMaxDate=function(){var e=n.props.services.date.passportNow;return I()(e).add(1,"year")},n.getMinDate=function(){var e=n.props.services.date.passportNow;return I()(e).add(5,"minutes")},n.clampDate=function(e){var t=n.props.services.date.passportNow;e=I()(e);var r=I()(t).add(1,"minutes"),o=n.getMaxDate();return o&&e>o&&(e=o),r&&e<r&&(e=r),e.toDate()},n}return l(t,e),a(t,[{key:"render",value:function(){return R.a.createElement(R.a.Fragment,null,this.renderDelayedSendingOptions(),this.renderDateTimePicker())}},{key:"renderDelayedSendingOptions",value:function(){return f(L.a,{onSelectDate:this.props.onAction,onClear:this.props.onAction,onDateTimePickerClick:this.showDateTimePicker,onChange:this.props.onChange,customDateContainer:this.setCustomDateContainerRef})}},{key:"renderDateTimePicker",value:function(){var e=this.isMobile?this.customDateContainerRef:this.props.anchor;return R.a.createElement(x.a,{ref:this.datetimePickerRef,anchor:e,scope:this.props.scope,visible:this.isDateTimePickerVisible,onSelectDate:this.onSelectCustomDate,onCancelSelectDate:this.onCancelSelectCustomDate,onClose:this.closeDatetimePicker,getInitialDate:this.getInitialDate,getMaxDate:this.getMaxDate,getMinDate:this.getMinDate,onClearDate:this.onClearCustomDate,onToggle:this.showDateTimePicker})}},{key:"sendTime",get:function(){return this.props.data.sendTime}},{key:"metrikaService",get:function(){return this.props.services.metrika}},{key:"isMobile",get:function(){return this.props.services.settings.isMobile}}]),t})(R.a.Component),C.propTypes={onChange:j.a.func,onAction:j.a.func,anchor:j.a.object,scope:j.a.object,data:z.a.isRequired,services:B.a.isRequired,visual:F.a.isRequired},h=w,v=y(h.prototype,"customDateContainerRef",[D.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),O=y(h.prototype,"isDateTimePickerVisible",[D.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),y(h.prototype,"sendTime",[D.computed],Object.getOwnPropertyDescriptor(h.prototype,"sendTime"),h.prototype),y(h.prototype,"metrikaService",[D.computed],Object.getOwnPropertyDescriptor(h.prototype,"metrikaService"),h.prototype),y(h.prototype,"isMobile",[D.computed],Object.getOwnPropertyDescriptor(h.prototype,"isMobile"),h.prototype),g=y(h.prototype,"setCustomDateContainerRef",[D.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){e.customDateContainerRef=t}}}),_=y(h.prototype,"showDateTimePicker",[D.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){e.isDateTimePickerVisible=!e.isDateTimePickerVisible,e.isDateTimePickerVisible&&e.metrikaService.sendFooterMetrika(U.COMPOSE_METRIKA_FOOTER_DELAYED_SENDING,U.COMPOSE_METRIKA_FOOTER_DELAYED_SENDING_CUSTOM_DATETIME)}}}),S=y(h.prototype,"onSelectCustomDate",[D.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){e.props.data.sendTime=e.clampDate(t),e.metrikaService.sendFooterMetrika(U.COMPOSE_METRIKA_FOOTER_DELAYED_SENDING,U.COMPOSE_METRIKA_FOOTER_DELAYED_SENDING_SELECT_CUSTOM_DATETIME)}}}),E=y(h.prototype,"closeDatetimePicker",[D.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){e.isDateTimePickerVisible=!1}}}),P=y(h.prototype,"onClearCustomDate",[D.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){e.props.data.sendTime=null,e.closeDatetimePicker()}}}),m=h))||m)||m)},3636:function(e,t,n){"use strict";function r(e){"@babel/helpers - typeof";return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function c(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),e}function s(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?l(e):t}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function l(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function p(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function d(e,t,n,r){E||(E="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=r;else if(i>1){for(var a=new Array(i),c=0;c<i;c++)a[c]=arguments[c+3];t.children=a}if(t&&o)for(var s in o)void 0===t[s]&&(t[s]=o[s]);else t||(t=o||{});return{$$typeof:E,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function y(e,t,n,r){n&&Object.defineProperty(e,t,{enumerable:n.enumerable,configurable:n.configurable,writable:n.writable,value:n.initializer?n.initializer.call(r):void 0})}function b(e,t,n,r,o){var i={};return Object.keys(r).forEach((function(e){i[e]=r[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce((function(n,r){return r(e,t,n)||n}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}n.d(t,"a",(function(){return Y}));var m,h,v,O,g,_,S,E,P=n(137),C=n.n(P),w=n(348),T=n.n(w),k=n(355),R=n.n(k),A=n(350),j=n.n(A),M=n(353),I=n(351),D=n(1812),N=n(352),L=n(1306),x=n(365),z=n(376),B=n(360),F=(n.n(B),n(140)),U=(n.n(F),n(3641)),K=n.n(U),H="DelayedSendingOptions",W={Block:H,Presets:"".concat(H,"-Presets"),Separator:"".concat(H,"-Separator"),Item:"".concat(H,"-Item"),Item_selected:"".concat(H,"-Item_selected"),Label:"".concat(H,"-Label"),ClearControl:"".concat(H,"-ClearControl"),CustomDate:"".concat(H,"-CustomDate"),SelectedDate:"".concat(H,"-SelectedDate")},G=d(N.default,{loc:"compose-react/DelayedSending_Clear"}),Y=(m=Object(M.inject)("data","services"))(h=Object(M.observer)((S=_=(function(e){function t(){var e,n;i(this,t);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return n=s(this,(e=u(t)).call.apply(e,[this].concat(o))),y(l(n),"onSelectDate",O,l(n)),y(l(n),"onClearDate",g,l(n)),n}return p(t,e),c(t,[{key:"render",value:function(){var e=this,t=Boolean(this.sendTime),n=function(){return e.props.services.date.passportNow};return this.options=Object(L.b)(n),d("div",{className:j()(W.Block,K.a.root)},void 0,d(D.a,{cls:W.Presets,selectedDate:this.sendTime,onSelect:this.onSelectDate,options:this.options}),d("div",{className:j()(W.Separator,K.a.separator)}),this.renderDateTimePickerControl(),t&&this.renderClearControl())}},{key:"renderDateTimePickerControl",value:function(){var e=this.sendTime&&this.sendTime.valueOf(),t=this.options.find((function(t){return t.value.valueOf()===e})),n=e&&!t,r=n&&R()(e).format("DD.MM.YYYY HH:mm");return C.a.createElement(F.Text,{weight:n?"medium":"regular",typography:"body-long-m",ref:this.props.customDateContainer,className:j()(K.a.item,W.Item,W.CustomDate,K.a.customDate,o({},"".concat(W.Item_selected," ").concat(K.a.selected),n)),onClick:this.props.onDateTimePickerClick},d(N.default,{className:j()(W.Label,K.a.label),loc:"compose-react/DelayedSending_SelectDateTime"}),n&&d(F.Text,{color:"secondary",className:j()(W.SelectedDate,K.a.selectedDate)},void 0,r))}},{key:"renderClearControl",value:function(){return d(F.Text,{typography:"body-long-m",className:j()(K.a.item,W.Item,W.ClearControl),onClick:this.onClearDate},void 0,G)}},{key:"componentDidUpdate",value:function(){this.props.onChange&&this.props.onChange()}},{key:"sendTime",get:function(){return this.props.data.sendTime}},{key:"metrikaService",get:function(){return this.props.services.metrika}}]),t})(C.a.PureComponent),_.propTypes={onSelectDate:T.a.func,onClear:T.a.func,onDateTimePickerClick:T.a.func,onChange:T.a.func,customDateContainer:T.a.oneOfType([T.a.object,T.a.func]),data:z.a.isRequired,services:x.a.isRequired},v=S,b(v.prototype,"sendTime",[I.computed],Object.getOwnPropertyDescriptor(v.prototype,"sendTime"),v.prototype),b(v.prototype,"metrikaService",[I.computed],Object.getOwnPropertyDescriptor(v.prototype,"metrikaService"),v.prototype),O=b(v.prototype,"onSelectDate",[I.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){var n=t.date,r=t.preset;e.props.data.sendTime=n,e.props.onSelectDate&&e.props.onSelectDate(n),e.metrikaService.sendFooterMetrika(B.COMPOSE_METRIKA_FOOTER_DELAYED_SENDING,B.TIME_PRESETS_METRIKA[r])}}}),g=b(v.prototype,"onClearDate",[I.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){e.props.data.sendTime=null,e.props.onClear&&e.props.onClear(),e.metrikaService.sendFooterMetrika(B.COMPOSE_METRIKA_FOOTER_DELAYED_SENDING,B.COMPOSE_METRIKA_FOOTER_DELAYED_SENDING_CLEAR)}}}),h=v))||h)||h},3637:function(e,t,n){"use strict";function r(e){"@babel/helpers - typeof";return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function c(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),e}function s(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?u(e):t}function u(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function p(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function d(e,t,n,r){y||(y="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=r;else if(i>1){for(var a=new Array(i),c=0;c<i;c++)a[c]=arguments[c+3];t.children=a}if(t&&o)for(var s in o)void 0===t[s]&&(t[s]=o[s]);else t||(t=o||{});return{$$typeof:y,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}n.d(t,"a",(function(){return M}));var y,b=n(137),m=n.n(b),h=n(348),v=n.n(h),O=n(350),g=n.n(O),_=n(355),S=n.n(_),E=n(3638),P=n(352),C=n(366),w=(n.n(C),n(367)),T=n(140),k=(n.n(T),n(3639)),R=n.n(k),A="ComposeTimeOptions",j={Block:"".concat(A),Item:"".concat(A,"-Item"),Item_selected:"".concat(A,"-Item_selected"),Label:"".concat(A,"-Label"),Date:"".concat(A,"-Date"),WeekDay:"".concat(A,"-WeekDay"),Time:"".concat(A,"-Time")},M=(function(e){function t(){return i(this,t),s(this,l(t).apply(this,arguments))}return p(t,e),c(t,[{key:"render",value:function(){var e=this;return d("div",{className:g()(j.Block,this.props.cls)},void 0,this.props.options.map((function(t){return e.renderItem(t)})))}},{key:"renderItem",value:function(e){var t=this,n=e.value,r=e.loc,i=e.preset,a=this.props.selectedDate&&this.props.selectedDate.valueOf()===n.valueOf(),c=i!==C.TimePresets.TODAY,s=a?"medium":"regular",u=g()(R.a.item,j.Item,o({},"".concat(R.a.selected," ").concat(j.Item_selected),a));return n=S()(n),d("div",{className:u,onClick:function(){return t.props.onSelect&&t.props.onSelect({date:n.toDate(),preset:i})}},n.valueOf(),d(T.Text,{weight:s,typography:"body-long-m",className:g()(R.a.label,j.Label)},void 0,d(P.default,{loc:r})),d(T.Text,{weight:s,typography:"body-long-m",color:"secondary",className:g()(R.a.date,j.Date)},void 0,c&&d("div",{className:g()(R.a.weekday,j.WeekDay)},void 0,n.format("dd"),", "),d("div",{className:j.Time},void 0,n.format(Object(w.default)("compose-react/TimeOptions_TimeFormat")))))}}]),t})(m.a.PureComponent);M.propTypes={cls:v.a.string,selectedDate:v.a.instanceOf(Date),onSelect:v.a.func,options:v.a.arrayOf(E.a)}},3638:function(e,t,n){"use strict";var r=n(348),o=n.n(r),i=n(366);n.n(i);t.a=o.a.shape({value:o.a.instanceOf(Date),loc:o.a.string,preset:o.a.oneOf(_.values(i.TimePresets))})},3639:function(e,t){e.exports={variables:'"../../../variables.m.css"',footerItemHeight:"36px",footerItemPadding:"0 var(--space-m)",footerItemBackground:"var(--color-mg-tint-superlight)",item:"TimeOptions__item--3OiIx",selected:"TimeOptions__selected--2SuEM",label:"TimeOptions__label--1O0ZA",date:"TimeOptions__date--ZXdmH",weekday:"TimeOptions__weekday--1od8d"}},3640:function(e,t,n){"use strict";function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var o,i=n(366),a=(n.n(i),n(355)),c=n.n(a);t.a=(o={},r(o,i.TimePresets.TODAY,(function(e,t){var n=c()(e).startOf("day").add(t[i.TimePresets.TODAY],"hour");if(e<n)return{value:n.toDate(),loc:"compose-react/TimeOptions_Today",preset:i.TimePresets.TODAY}})),r(o,i.TimePresets.TOMORROW,(function(e,t){return{value:c()(e).startOf("day").add(1,"day").add(t[i.TimePresets.TOMORROW],"hour").toDate(),loc:"compose-react/TimeOptions_Tomorrow",preset:i.TimePresets.TOMORROW}})),r(o,i.TimePresets.WEEKEND,(function(e,t){var n=c()(e).startOf("day").day(6).add(t[i.TimePresets.WEEKEND],"hour");if(e.day()>0&&e.day()<6)return{value:n.toDate(),loc:"compose-react/TimeOptions_Weekend",preset:i.TimePresets.WEEKEND}})),r(o,i.TimePresets.NEXT_WEEK,(function(e,t){return{value:c()(e).startOf("day").add(7,"day").add(t[i.TimePresets.NEXT_WEEK],"hour").toDate(),loc:"compose-react/TimeOptions_NextWeek",preset:i.TimePresets.NEXT_WEEK}})),o)},3641:function(e,t){e.exports={variables:'"../../../../variables.m.css"',footerPopupPadding:"var(--space-xs) 0",footerSeparatorHeight:"1px",footerSeparatorColor:"var(--color-mg-stroke-default-base)",footerSeparatorMargin:"var(--space-2-xs) var(--space-s)",footerItemHeight:"36px",footerItemPadding:"0 var(--space-m)",footerItemBackground:"var(--color-mg-tint-superlight)",root:"DelayedSendingButton__root--1FOfg",separator:"DelayedSendingButton__separator--2Ev4f",item:"DelayedSendingButton__item--3LOzx",selected:"DelayedSendingButton__selected--2uo5B",label:"DelayedSendingButton__label--3IjW5",selectedDate:"DelayedSendingButton__selectedDate--3cqtw",customDate:"DelayedSendingButton__customDate--3CQD-"}},3642:function(e,t,n){"use strict";var r=n(433),o=n(3643),i=n(3648);t.a=Object(r.a)(o.a,i.a)},3643:function(e,t,n){"use strict";function r(e){"@babel/helpers - typeof";return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t,n){return t&&c(e.prototype,t),n&&c(e,n),e}function u(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?l(e):t}function l(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function f(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&d(e,t)}function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function y(e,t,n,r){_||(_="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=r;else if(i>1){for(var a=new Array(i),c=0;c<i;c++)a[c]=arguments[c+3];t.children=a}if(t&&o)for(var s in o)void 0===t[s]&&(t[s]=o[s]);else t||(t=o||{});return{$$typeof:_,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function b(e,t,n,r,o){var i={};return Object.keys(r).forEach((function(e){i[e]=r[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce((function(n,r){return r(e,t,n)||n}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}n.d(t,"a",(function(){return D}));var m,h,v,O,g,_,S=n(137),E=n.n(S),P=n(348),C=n.n(P),w=n(351),T=n(353),k=n(621),R=n(3644),A=n(1814),j=n(376),M=n(365),I=n(380),D=(m=Object(T.inject)("data","services","visual"))(h=Object(T.observer)((g=O=(function(e){function t(){var e,n;a(this,t);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return n=u(this,(e=p(t)).call.apply(e,[this].concat(o))),n.popupRef=E.a.createRef(),n.popupDirections=["top"],n.onSelectDate=function(e){var t=n.props,r=t.onSelectDate,o=t.onClose;r&&r(e),o&&o()},n}return f(t,e),s(t,[{key:"render",value:function(){return y(k.a,{scope:"inplace",innerRef:this.popupRef,anchor:this.props.anchor,visible:this.props.visible,direction:this.popupDirections,onClose:this.props.onClose,hasTail:!0},void 0,this.renderContents())}},{key:"renderContents",value:function(){return y(R.a,{initialDate:this.props.getInitialDate(),onSelectDate:this.onSelectDate,onCancel:this.props.onCancelSelectDate,maxDate:this.props.getMaxDate(),minDate:this.props.getMinDate(),isVisible:this.props.visible})}},{key:"containerRef",get:function(){return this.props.visual.refs.composeContainer}},{key:"sendTime",get:function(){return this.props.data.sendTime}}]),t})(E.a.Component),O.propTypes=(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e})({},A.a,{scope:C.a.object,onClose:C.a.func,data:j.a.isRequired,services:M.a.isRequired,visual:I.a.isRequired}),v=g,b(v.prototype,"containerRef",[w.computed],Object.getOwnPropertyDescriptor(v.prototype,"containerRef"),v.prototype),b(v.prototype,"sendTime",[w.computed],Object.getOwnPropertyDescriptor(v.prototype,"sendTime"),v.prototype),h=v))||h)||h},3644:function(e,t,n){"use strict";function r(){return r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},r.apply(this,arguments)}function o(e){"@babel/helpers - typeof";return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){if(null==e)return{};var n,r,o=a(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function a(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e,t,n){return t&&s(e.prototype,t),n&&s(e,n),e}function l(e,t){return!t||"object"!==o(t)&&"function"!=typeof t?f(e):t}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function f(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function d(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&y(e,t)}function y(e,t){return(y=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function b(e,t,n,r){R||(R="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=r;else if(i>1){for(var a=new Array(i),c=0;c<i;c++)a[c]=arguments[c+3];t.children=a}if(t&&o)for(var s in o)void 0===t[s]&&(t[s]=o[s]);else t||(t=o||{});return{$$typeof:R,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function m(e,t,n,r){n&&Object.defineProperty(e,t,{enumerable:n.enumerable,configurable:n.configurable,writable:n.writable,value:n.initializer?n.initializer.call(r):void 0})}function h(e,t,n,r,o){var i={};return Object.keys(r).forEach((function(e){i[e]=r[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce((function(n,r){return r(e,t,n)||n}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}n.d(t,"a",(function(){return Z}));var v,O,g,_,S,E,P,C,w,T,k,R,A=n(137),j=n.n(A),M=n(348),I=n.n(M),D=n(355),N=n.n(D),L=n(351),x=n(353),z=n(350),B=n.n(z),F=n(560),U=n(142),K=(n.n(U),n(3645)),H=n(3646),W=n(621),G=n(352),Y=n(140),q=(n.n(Y),n(1187)),V=n.n(q),$=n(365),Q=n(3647),J=(n.n(Q),"ComposeDateTimePicker"),X={Block:J,Calendar:"".concat(J,"-Calendar"),Controls:"".concat(J,"-Controls"),Inputs:{Container:"".concat(J,"-Inputs"),Input:"".concat(J,"-Input"),Date:"".concat(J,"-Input_date"),TimeInput:"".concat(J,"-Input_time"),Title:"".concat(J,"-InputTitle"),Field:"".concat(J,"-InputField")},Buttons:{Container:"".concat(J,"-Buttons"),Button:"".concat(J,"-Button"),Save:"".concat(J,"-Button_save"),Cancel:"".concat(J,"-Button_cancel")},Picker:"DelayedDatePicker"},Z=(v=Object(x.inject)("services"))(O=Object(x.observer)((k=T=(function(e){function t(){var e,n;c(this,t);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return n=l(this,(e=p(t)).call.apply(e,[this].concat(o))),m(f(n),"selectedDate",_,f(n)),m(f(n),"isTimePickerPopupVisible",S,f(n)),n.inputesRef=j.a.createRef(),n.direction=["right-end"],m(f(n),"onChangeSelectedDate",E,f(n)),m(f(n),"toggleTimerPopupVisibility",P,f(n)),m(f(n),"setTimerPopupVisibility",C,f(n)),m(f(n),"onSelectDateFromCalendar",w,f(n)),n.now=function(){return n.props.services.date.passportNow},n.onTimeSelect=function(e){n.onChangeSelectedDate(e),n.setTimerPopupVisibility(!1)},n.clampDate=function(e){var t=n.props,r=t.maxDate,o=t.services,i=o.date.passportNow,a=N()(i).add(1,"minutes");r&&e>r&&(e=N()(r)),a&&e<a&&(e=N()(a)),n.onChangeSelectedDate(e)},n.onOutsideClick=function(e){n.isTimePickerPopupVisible&&!n.inputesRef.current.contains(e.target)&&n.setTimerPopupVisibility(!1)},n.onSave=function(){var e=n.props.onSelectDate;e&&(n.clampDate(n.selectedDate),e(n.selectedDate.toDate()))},n}return d(t,e),u(t,[{key:"componentDidUpdate",value:function(e){this.props.isVisible!==e.isVisible&&this.onChangeSelectedDate(this.props.initialDate)}},{key:"render",value:function(){var e=V.a[this.props.services.settings.lang];return b("div",{className:X.Block},void 0,b("div",{className:X.Calendar},void 0,b(F.b,{locale:e,minDate:this.props.minDate,maxDate:this.props.maxDate,selected:this.selectedDate,onChange:this.onSelectDateFromCalendar,inline:!0})),b("div",{className:X.Controls},void 0,this.renderInputs(),this.renderButtons()))}},{key:"renderTimePickerPopup",value:function(){return b(W.a,{scope:"inplace",className:X.Picker,anchor:this.inputesRef,mainOffset:-70,secondaryOffset:-16,hasTail:!1,onClose:this.onOutsideClick,visible:this.isTimePickerPopupVisible,direction:this.direction},void 0,b(H.a,{date:this.selectedDate,maxDate:this.props.maxDate,onChange:this.onTimeSelect,now:this.now}))}},{key:"renderButton",value:function(e){var t=e.key,n=e.className,o=e.onClick,a=e.loc,c=i(e,["key","className","onClick","loc"]);return j.a.createElement(U.Button,r({key:t,className:B()(X.Buttons.Button,n),size:"m",width:"max",onClick:o,view:"default"},c),b(G.default,{loc:a}))}},{key:"renderButtons",value:function(){var e=this,t=[{key:"save",className:X.Buttons.Save,view:"action",onClick:this.onSave,loc:"compose-react/DatetimePicker_Confirm"},{key:"cancel",className:X.Buttons.Cancel,view:"default",onClick:this.props.onCancel,loc:"compose-react/DatetimePicker_Cancel"}];return b("div",{className:X.Buttons.Container},void 0,t.map((function(t){return e.renderButton(t)})))}},{key:"renderInput",value:function(e){var t=e.key,n=e.cls,o=e.loc,a=e.children,c=i(e,["key","cls","loc","children"]);return b("div",{className:B()(X.Inputs.Input,n)},t,b(Y.Text,{typography:"body-long-m",color:"secondary",className:X.Inputs.Title},void 0,b(G.default,{loc:o})),j.a.createElement(K.a,r({date:this.selectedDate,cls:X.Inputs.Field,onChange:this.clampDate},c)),a)}},{key:"renderInputs",value:function(){var e=this,t=[{key:"date",cls:X.Inputs.Date,loc:"compose-react/DatetimePicker_Date",onClick:function(){return e.setTimerPopupVisibility(!1)}},{key:"time",cls:X.Inputs.TimeInput,loc:"compose-react/DatetimePicker_Time",format:"HH:mm",onInput:function(){return e.setTimerPopupVisibility(!1)},onClick:this.toggleTimerPopupVisibility,children:this.renderTimePickerPopup()}];return j.a.createElement("div",{ref:this.inputesRef,className:X.Inputs.Container},t.map((function(t){return e.renderInput(t)})))}}]),t})(j.a.Component),T.propTypes={initialDate:I.a.objectOf(N.a),maxDate:I.a.objectOf(N.a),minDate:I.a.objectOf(N.a),onCancel:I.a.func,onSelectDate:I.a.func,isVisible:I.a.bool,services:$.a.isRequired},g=k,_=h(g.prototype,"selectedDate",[L.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return this.props.initialDate}}),S=h(g.prototype,"isTimePickerPopupVisible",[L.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),E=h(g.prototype,"onChangeSelectedDate",[L.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){return e.selectedDate=t}}}),P=h(g.prototype,"toggleTimerPopupVisibility",[L.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){e.isTimePickerPopupVisible=!e.isTimePickerPopupVisible}}}),C=h(g.prototype,"setTimerPopupVisibility",[L.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){e.isTimePickerPopupVisible=t}}}),w=h(g.prototype,"onSelectDateFromCalendar",[L.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t,n){n.preventDefault(),n.stopPropagation(),e.clampDate(t)}}}),O=g))||O)||O},3646:function(e,t,n){"use strict";function r(e,t,n,r){o||(o="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,a=arguments.length-3;if(t||0===a||(t={children:void 0}),1===a)t.children=r;else if(a>1){for(var c=new Array(a),s=0;s<a;s++)c[s]=arguments[s+3];t.children=c}if(t&&i)for(var u in i)void 0===t[u]&&(t[u]=i[u]);else t||(t=i||{});return{$$typeof:o,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}var o,i=n(137),a=(n.n(i),n(348)),c=n.n(a),s=n(355),u=n.n(s),l=n(350),p=n.n(l),f=n(1813),d=function(e,t,n){return r("div",{className:t,onClick:n},e,e)},y=function(e){var t=e.date,n=e.maxDate,o=e.minDate,i=e.onChange,a=e.now,c=new f.b(t,"HH:mm");return o||(o=u()(a()).add(1,"minutes")),r("div",{className:"DelayedTimePicker__Container"},void 0,c.getTimeItemsWithThirtyMinutesStep(o,n).map((function(e){var t=p()("DelayedTimePicker__Button",{isDisable:e.isDisable}),n=function(){return!e.isDisable&&i(e.date)};return d(e.timeStr,t,n)})))};y.propTypes={date:c.a.objectOf(u.a),maxDate:c.a.objectOf(u.a),minDate:c.a.objectOf(u.a),onChange:c.a.func.isRequired,now:c.a.func.isRequired},t.a=y},3647:function(e,t){},3648:function(e,t,n){"use strict";function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function o(e){"@babel/helpers - typeof";return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t,n){return t&&c(e.prototype,t),n&&c(e,n),e}function u(e,t){return!t||"object"!==o(t)&&"function"!=typeof t?l(e):t}function l(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function f(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&d(e,t)}function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function y(e,t,n,r){b||(b="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=r;else if(i>1){for(var a=new Array(i),c=0;c<i;c++)a[c]=arguments[c+3];t.children=a}if(t&&o)for(var s in o)void 0===t[s]&&(t[s]=o[s]);else t||(t=o||{});return{$$typeof:b,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}n.d(t,"a",(function(){return j}));var b,m=n(137),h=n.n(m),v=n(141),O=n.n(v),g=n(355),_=n.n(g),S=n(350),E=n.n(S),P=n(348),C=n.n(P),w=n(1814),T=n(3649),k=(n.n(T),"YYYY-MM-DDTHH:mm"),R="ComposeDelayedDateTimePickerMobile",A={Block:R,hidden:"".concat(R,"_hidden"),Label:"".concat(R,"-Label"),Input:"".concat(R,"-Input")},j=(function(e){function t(){var e,n;a(this,t);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return n=u(this,(e=p(t)).call.apply(e,[this].concat(o))),n.inputRef=h.a.createRef(),n.onChange=function(e){if(!e.target.value)return void(n.props.onClearDate&&n.props.onClearDate());n.props.onSelectDate(_()(e.target.value,k).toDate())},n.clearDefault=function(e){var t=e.nativeEvent.target;setTimeout((function(){return t.defaultValue=""}),0)},n.onClick=function(){n.props.onToggle&&n.props.onToggle(),n.props.onSelectDate(n.props.getInitialDate().toDate())},n}return f(t,e),s(t,[{key:"render",value:function(){var e=this.props,t=e.anchor,n=e.visible;return t?O.a.createPortal(y("div",{className:E()(A.Block,i({},A.hidden,!n))},void 0,y("label",{className:A.Label},void 0,h.a.createElement("input",{ref:this.inputRef,className:A.Input,type:"datetime-local",value:this.selectedDate,pattern:"[0-9]{4}-[0-9]{2}-[0-9]{2}T[0-9]{2}:[0-9]{2}",min:this.minDate,max:this.maxDate,onChange:this.onChange,onFocus:this.clearDefault,onClick:this.onClick,onBlur:this.onClose}))),t):null}},{key:"selectedDate",get:function(){return this.props.getInitialDate().format(k)}},{key:"maxDate",get:function(){return this.props.getMaxDate().format(k)}},{key:"minDate",get:function(){return this.props.getMinDate().format(k)}}]),t})(h.a.Component);j.propTypes=(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e})({},w.a,{onClearDate:C.a.func,onToggle:C.a.func})},3649:function(e,t){},365:function(e,t,n){"use strict";var r=n(348),o=(n.n(r),n(728)),i=n(1781),a=n(1785),c=n(1784);t.a=r.PropTypes.shape({avatars:r.PropTypes.instanceOf(o.a),contactsFormatter:r.PropTypes.instanceOf(i.a),suggest:r.PropTypes.instanceOf(a.a),settings:r.PropTypes.instanceOf(c.a)})},3650:function(e,t,n){"use strict";function r(){return r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},r.apply(this,arguments)}function o(e){"@babel/helpers - typeof";return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function c(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),e}function s(e,t){return!t||"object"!==o(t)&&"function"!=typeof t?u(e):t}function u(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function p(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}n.d(t,"a",(function(){return w}));var d,y,b,m,h,v=n(137),O=n.n(v),g=n(353),_=n(351),S=n(376),E=n(563),P=n(501),C=n(916),w=(d=Object(g.inject)("data"))(y=Object(g.observer)((h=m=(function(e){function t(){return i(this,t),s(this,l(t).apply(this,arguments))}return p(t,e),c(t,[{key:"render",value:function(){return O.a.createElement(C.a,r({icon:"mail--Compose-DelayedSending",loc:"compose-react/DelayedSending_Title",hasNotification:this.hasNotification},this.props))}},{key:"hasNotification",get:function(){return E.a[P.a.DELAYED_SENDING]({data:this.props.data})}}]),t})(O.a.Component),m.propTypes={data:S.a.isRequired},b=h,(function(e,t,n,r,o){var i={};return Object.keys(r).forEach((function(e){i[e]=r[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce((function(n,r){return r(e,t,n)||n}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i})(b.prototype,"hasNotification",[_.computed],Object.getOwnPropertyDescriptor(b.prototype,"hasNotification"),b.prototype),y=b))||y)||y},3651:function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var r=n(622),o=n(532),i=n(1815),a=n(3656),c=n(3658),s=n(360),u=(n.n(s),{PopupContent:i.a,cls:a.a.Popup,metrikaArgs:[s.COMPOSE_METRIKA_FOOTER_LABELS,s.COMPOSE_METRIKA_FOOTER_LABELS_CLICK],directions:["top"],title:"compose-react/Header_Labels"}),l=Object(o.a)(u,a.b);t.b=Object(r.a)("compose-react/ControlPanel_Labels_Tooltip",l);var p=Object(o.a)(u,c.a)},3652:function(e,t,n){"use strict";var r=n(348),o=n.n(r);t.a=o.a.shape({count:o.a.number,lid:o.a.string,name:o.a.string,symbolicName:o.a.string,user:o.a.bool,default:o.a.bool,color:o.a.string})},3655:function(e,t){e.exports={variables:'"../../../../variables.m.css"',footerPopupPadding:"var(--space-xs) 0",footerItemHeight:"36px",footerItemSmallPadding:"0 var(--space-s)",footerItemBackground:"var(--color-mg-tint-superlight)",footerSeparatorHeight:"1px",footerSeparatorColor:"var(--color-mg-stroke-default-base)",footerSeparatorMargin:"var(--space-2-xs) var(--space-s)",root:"LabelButton__root--3ecd3",desktop:"LabelButton__desktop--A6E7y",mobile:"LabelButton__mobile--2QP3U",list:"LabelButton__list--7VFXw",item:"LabelButton__item--1hj_m",separator:"LabelButton__separator---ISRm",actions:"LabelButton__actions--eTQki"}},3656:function(e,t,n){"use strict";function r(e){"@babel/helpers - typeof";return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}function c(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?s(e):t}function s(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function f(e,t,n,r){d||(d="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=r;else if(i>1){for(var a=new Array(i),c=0;c<i;c++)a[c]=arguments[c+3];t.children=a}if(t&&o)for(var s in o)void 0===t[s]&&(t[s]=o[s]);else t||(t=o||{});return{$$typeof:d,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}n.d(t,"a",(function(){return E})),n.d(t,"b",(function(){return C}));var d,y=n(137),b=n.n(y),m=n(348),h=n.n(m),v=n(350),O=n.n(v),g=n(427),_=n(455),S=n(3657),E=(n.n(S),{Block:"ComposeLabelButton",Popup:"".concat("ComposeLabelButton","-Popup")}),P=f(g.a,{id:"mail--ComposeReact-Label"}),C=(function(e){function t(){return o(this,t),c(this,u(t).apply(this,arguments))}return l(t,e),a(t,[{key:"render",value:function(){return f(_.a,{innerRef:this.props.innerRef,onMouseEnter:this.props.onMouseEnter,onMouseLeave:this.props.onMouseLeave,onClick:this.props.onClick,className:O()(E.Block,this.props.cls),iconComponent:P})}}]),t})(b.a.PureComponent);C.propTypes={cls:h.a.string,innerRef:h.a.object,onMouseEnter:h.a.func,onMouseLeave:h.a.func,onClick:h.a.func}},3657:function(e,t){},3658:function(e,t,n){"use strict";function r(){return r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},r.apply(this,arguments)}var o=n(137),i=n.n(o),a=n(916),c=function(e){return i.a.createElement(a.a,r({icon:"mail--ComposeReact-Label",loc:"compose-react/Header_Labels"},e))};t.a=c},3659:function(e,t,n){"use strict";function r(e){"@babel/helpers - typeof";return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}function c(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?u(e):t}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function u(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function f(e,t,n,r){S||(S="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=r;else if(i>1){for(var a=new Array(i),c=0;c<i;c++)a[c]=arguments[c+3];t.children=a}if(t&&o)for(var s in o)void 0===t[s]&&(t[s]=o[s]);else t||(t=o||{});return{$$typeof:S,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function d(e,t,n,r){n&&Object.defineProperty(e,t,{enumerable:n.enumerable,configurable:n.configurable,writable:n.writable,value:n.initializer?n.initializer.call(r):void 0})}function y(e,t,n,r,o){var i={};return Object.keys(r).forEach((function(e){i[e]=r[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce((function(n,r){return r(e,t,n)||n}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}n.d(t,"a",(function(){return K}));var b,m,h,v,O,g,_,S,E=n(137),P=n.n(E),C=n(350),w=n.n(C),T=n(348),k=n.n(T),R=n(353),A=n(351),j=n(140),M=(n.n(j),n(148)),I=(n.n(M),n(352)),D=n(3660),N=n(376),L=n(365),x=n(360),z=(n.n(x),n(3662)),B=n.n(z),F="ComposeNotificationsOptions",U={Block:F,Item:"".concat(F,"-Item"),Checkbox:"".concat(F,"-Checkbox"),ReplyOptions:"".concat(F,"-ReplyOptions")},K=(b=Object(R.inject)("data","services"))(m=Object(R.observer)((_=g=(function(e){function t(){var e,n;o(this,t);for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return n=c(this,(e=s(t)).call.apply(e,[this].concat(i))),n.notificationsOptions=P.a.createRef(),d(u(n),"onToggleDelivery",v,u(n)),d(u(n),"onChangeReplyNotifications",O,u(n)),n.renderReplyOptions=function(){return P.a.createElement(D.a,{ref:n.notificationsOptions,cls:w()(U.ReplyOptions,B.a.replyOptions),onChange:n.props.onChange})},n}return l(t,e),a(t,[{key:"collapse",value:function(){this.notificationsOptions.current&&this.notificationsOptions.current.collapse()}},{key:"render",value:function(){var e=this,t=[{name:"reply",handler:this.onChangeReplyNotifications,loc:"compose-react/Notifications_Reply",enabled:this.notifications.reply,additional:this.renderReplyOptions},{name:"delivery",handler:this.onToggleDelivery,loc:"compose-react/Notifications_Delivery",enabled:this.notifications.delivery}];return f("div",{className:w()(U.Block,B.a.root)},void 0,t.map((function(t){return e.renderItem(t)})))}},{key:"renderItem",value:function(e){var t=e.name,n=e.handler,r=e.loc,o=e.enabled,i=e.additional;return f("div",{className:w()(U.Item,B.a.item)},t,f(M.Checkbox,{name:t,className:w()(U.Checkbox,B.a.checkbox),size:"s",lines:"one",view:"default",checked:o,onChange:n,label:f(j.Text,{typography:"body-long-m"},void 0,f(I.default,{loc:r}))}),i&&i())}},{key:"notifications",get:function(){return this.props.data.notifications}},{key:"metrikaService",get:function(){return this.props.services.metrika}}]),t})(P.a.Component),g.propTypes={onChange:k.a.func,services:L.a.isRequired,data:N.a.isRequired},h=_,y(h.prototype,"notifications",[A.computed],Object.getOwnPropertyDescriptor(h.prototype,"notifications"),h.prototype),y(h.prototype,"metrikaService",[A.computed],Object.getOwnPropertyDescriptor(h.prototype,"metrikaService"),h.prototype),v=y(h.prototype,"onToggleDelivery",[A.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){e.notifications.delivery=!e.notifications.delivery;var t=e.notifications.delivery?x.COMPOSE_METRIKA_FOOTER_NOTIFICATIONS_DELIVERY_ON:x.COMPOSE_METRIKA_FOOTER_NOTIFICATIONS_DELIVERY_OFF;e.metrikaService.sendFooterMetrika(x.COMPOSE_METRIKA_FOOTER_NOTIFICATIONS,t)}}}),O=y(h.prototype,"onChangeReplyNotifications",[A.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){e.notifications.reply=!e.notifications.reply,e.props.onChange&&e.props.onChange();var t=e.notifications.reply?x.COMPOSE_METRIKA_FOOTER_NOTIFICATIONS_REPLY_ON:x.COMPOSE_METRIKA_FOOTER_NOTIFICATIONS_REPLY_OFF;e.metrikaService.sendFooterMetrika(x.COMPOSE_METRIKA_FOOTER_NOTIFICATIONS,t)}}}),m=h))||m)||m},366:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return o(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.BanReason=t.WorkModes=t.TimePresets=t.SuggestTypes=t.SmartSubjectType=t.Settings=t.SendError=t.ResolutionTypes=t.PromoTypes=t.Popups=t.Limits=t.LeaveTypes=t.InputTypes=t.FixedModes=void 0;var a=i(n(597));t.FixedModes=a;var c=i(n(598));t.InputTypes=c;var s=i(n(557));t.LeaveTypes=s;var u=i(n(558));t.Limits=u;var l=i(n(496));t.Popups=l;var p=i(n(599));t.PromoTypes=p;var f=i(n(600));t.ResolutionTypes=f;var d=i(n(663));t.SendError=d;var y=i(n(601));t.Settings=y;var b=i(n(602));t.SmartSubjectType=b;var m=i(n(603));t.SuggestTypes=m;var h=i(n(518));t.TimePresets=h;var v=i(n(604));t.WorkModes=v;var O=n(605);Object.defineProperty(t,"BanReason",{enumerable:!0,get:function(){return O.BanReason}})},3660:function(e,t,n){"use strict";function r(e){"@babel/helpers - typeof";return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function c(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),e}function s(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?l(e):t}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function l(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function p(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function d(e,t,n,r){P||(P="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=r;else if(i>1){for(var a=new Array(i),c=0;c<i;c++)a[c]=arguments[c+3];t.children=a}if(t&&o)for(var s in o)void 0===t[s]&&(t[s]=o[s]);else t||(t=o||{});return{$$typeof:P,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function y(e,t,n,r){n&&Object.defineProperty(e,t,{enumerable:n.enumerable,configurable:n.configurable,writable:n.writable,value:n.initializer?n.initializer.call(r):void 0})}function b(e,t,n,r,o){var i={};return Object.keys(r).forEach((function(e){i[e]=r[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce((function(n,r){return r(e,t,n)||n}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}n.d(t,"a",(function(){return q}));var m,h,v,O,g,_,S,E,P,C=n(137),w=n.n(C),T=n(348),k=n.n(T),R=n(351),A=n(353),j=n(658),M=n(366),I=(n.n(M),n(376)),D=n(365),N=n(350),L=n.n(N),x=n(352),z=n(1306),B=n(427),F=n(1812),U=n(140),K=(n.n(U),n(360)),H=(n.n(K),n(3661)),W=(n.n(H),n(382)),G="ComposeReplyNotificationOptions",Y={Block:G,Block_expanded:"".concat(G,"_expanded"),Header:"".concat(G,"-Header"),ExpandIcon:"".concat(G,"-ExpandIcon"),List:"".concat(G,"-List")},q=(m=Object(A.inject)("data","services"))(h=Object(A.observer)((E=S=(function(e){function t(e){var n;i(this,t),n=s(this,u(t).call(this,e)),n.disposer=new W.a,y(l(n),"isExpanded",O,l(n)),y(l(n),"onSelectTime",g,l(n)),y(l(n),"onToggleExpanded",_,l(n));var r=function(){return n.props.services.date.passportNow};return n.timeOptions=Object(z.b)(r),n}return p(t,e),c(t,[{key:"collapse",value:function(){this.isExpanded=!1}},{key:"componentDidMount",value:function(){var e=this;this.replyReaction=new j.a(function(){return e.notifications.reply},function(){return e.initTimeOptions()}),this.disposer.add(this,[function(){return e.replyReaction.cancel()}])}},{key:"componentWillUnmount",value:function(){this.disposer.dispose(this)}},{key:"componentDidUpdate",value:function(){this.props.onChange&&this.props.onChange()}},{key:"initTimeOptions",value:function(){var e=this,t=function(){return e.props.services.date.passportNow};if(this.timeOptions=Object(z.b)(t),this.notifications.reply){var n=this.getOption(M.TimePresets.TOMORROW);this.notifications.replyTime=n.value}else this.notifications.replyTime=null;this.isExpanded=this.notifications.reply}},{key:"getOption",value:function(e){return this.timeOptions.find((function(t){return t.preset===e}))}},{key:"render",value:function(){var e=this.notifications.replyTime,t=L()(Y.Block,o({},Y.Block_expanded,this.isExpanded),this.props.cls),n=e&&w.a.createElement(w.a.Fragment,null,d(x.default,{loc:"compose-react/Notifications_ReplyTime",params:Object(z.a)(e)}),d(B.a,{id:"mail--Compose-SmallDropdown",cls:Y.ExpandIcon}));return d("div",{className:t},void 0,d(U.Text,{typography:"body-long-m",weight:"medium",className:Y.Header,onClick:this.onToggleExpanded},void 0,n),d(F.a,{cls:Y.List,options:this.timeOptions,selectedDate:e,onSelect:this.onSelectTime}))}},{key:"metrikaService",get:function(){return this.props.services.metrika}},{key:"notifications",get:function(){return this.props.data.notifications}}]),t})(w.a.Component),S.propTypes={cls:k.a.string,onChange:k.a.func,data:I.a.isRequired,services:D.a.isRequired},v=E,O=b(v.prototype,"isExpanded",[R.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),b(v.prototype,"metrikaService",[R.computed],Object.getOwnPropertyDescriptor(v.prototype,"metrikaService"),v.prototype),b(v.prototype,"notifications",[R.computed],Object.getOwnPropertyDescriptor(v.prototype,"notifications"),v.prototype),g=b(v.prototype,"onSelectTime",[R.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){var n=t.date,r=t.preset;e.notifications.replyTime=n,e.metrikaService.sendFooterMetrika(K.COMPOSE_METRIKA_FOOTER_NOTIFICATIONS,K.TIME_PRESETS_METRIKA[r])}}}),_=b(v.prototype,"onToggleExpanded",[R.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){e.isExpanded=!e.isExpanded,e.metrikaService.sendFooterMetrika(K.COMPOSE_METRIKA_FOOTER_NOTIFICATIONS,e.isExpanded?K.COMPOSE_METRIKA_FOOTER_NOTIFICATIONS_REPLY_EXPAND:K.COMPOSE_METRIKA_FOOTER_NOTIFICATIONS_REPLY_COLLAPSE)}}}),b(v.prototype,"collapse",[R.action],Object.getOwnPropertyDescriptor(v.prototype,"collapse"),v.prototype),h=v))||h)||h},3661:function(e,t){},3662:function(e,t){e.exports={variables:'"../../../../variables.m.css"',footerPopupPadding:"var(--space-xs) 0",footerItemSmallPadding:"0 var(--space-s)",footerItemHeight:"36px",footerItemBackground:"var(--color-mg-tint-superlight)",root:"NotificationsButton__root--Ri05W",item:"NotificationsButton__item--ExtEt",checkbox:"NotificationsButton__checkbox--5K-e7",replyOptions:"NotificationsButton__replyOptions--2zmAP"}},3663:function(e,t,n){"use strict";function r(){return r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},r.apply(this,arguments)}function o(e){"@babel/helpers - typeof";return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function c(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),e}function s(e,t){return!t||"object"!==o(t)&&"function"!=typeof t?u(e):t}function u(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function p(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}n.d(t,"a",(function(){return w}));var d,y,b,m,h,v=n(137),O=n.n(v),g=n(353),_=n(351),S=n(916),E=n(376),P=n(563),C=n(501),w=(d=Object(g.inject)("data"))(y=Object(g.observer)((h=m=(function(e){function t(){return i(this,t),s(this,l(t).apply(this,arguments))}return p(t,e),c(t,[{key:"render",value:function(){return O.a.createElement(S.a,r({icon:"mail--Compose-Notification",loc:"compose-react/Notifications_Title",hasNotification:this.hasNotification},this.props))}},{key:"hasNotification",get:function(){return P.a[C.a.NOTIFICATIONS]({data:this.props.data})}}]),t})(O.a.Component),m.propTypes={data:E.a.isRequired},b=h,(function(e,t,n,r,o){var i={};return Object.keys(r).forEach((function(e){i[e]=r[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce((function(n,r){return r(e,t,n)||n}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i})(b.prototype,"hasNotification",[_.computed],Object.getOwnPropertyDescriptor(b.prototype,"hasNotification"),b.prototype),y=b))||y)||y},3664:function(e,t,n){"use strict";function r(e){"@babel/helpers - typeof";return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t,n){return t&&c(e.prototype,t),n&&c(e,n),e}function u(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?l(e):t}function l(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function f(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&d(e,t)}function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function y(e,t,n,r){g||(g="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=r;else if(i>1){for(var a=new Array(i),c=0;c<i;c++)a[c]=arguments[c+3];t.children=a}if(t&&o)for(var s in o)void 0===t[s]&&(t[s]=o[s]);else t||(t=o||{});return{$$typeof:g,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}n.d(t,"a",(function(){return L})),n.d(t,"b",(function(){return x}));var b,m,h,v,O,g,_=n(137),S=n.n(_),E=n(350),P=n.n(E),C=n(353),w=n(351),T=n(376),k=n(503),R=n(563),A=n(501),j=n(367),M=n(455),I=n(427),D=n(3665),N=(n.n(D),n(87)),L=(n.n(N),{Block:"ComposeNotificationsButton",Popup:"".concat("ComposeNotificationsButton","-Popup")}),x=(b=Object(C.inject)("data"))(m=Object(C.observer)((O=v=(function(e){function t(){return a(this,t),u(this,p(t).apply(this,arguments))}return f(t,e),s(t,[{key:"render",value:function(){var e=Object(N.hasFeature)(N.Features.WEB_MOBILE_COMPOSE)?"mail--Compose-Notification":"mail--Compose-Notification_new";return y(M.a,{innerRef:this.props.innerRef,onMouseEnter:this.props.onMouseEnter,onMouseLeave:this.props.onMouseLeave,onClick:this.props.onClick,className:P()(L.Block,this.props.cls),hasNotification:this.hasNotification,iconComponent:y(I.a,{id:e}),"aria-label":Object(j.default)("compose-react/ControlPanel_Notifications_Tooltip")})}},{key:"hasNotification",get:function(){return R.a[A.a.NOTIFICATIONS]({data:this.props.data})}}]),t})(S.a.PureComponent),v.propTypes=(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e})({},k.a,{data:T.a.isRequired}),h=O,(function(e,t,n,r,o){var i={};return Object.keys(r).forEach((function(e){i[e]=r[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce((function(n,r){return r(e,t,n)||n}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i})(h.prototype,"hasNotification",[w.computed],Object.getOwnPropertyDescriptor(h.prototype,"hasNotification"),h.prototype),m=h))||m)||m},3665:function(e,t){},3666:function(e,t,n){"use strict";function r(e){"@babel/helpers - typeof";return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}function c(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?s(e):t}function s(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function f(e,t,n,r){d||(d="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=r;else if(i>1){for(var a=new Array(i),c=0;c<i;c++)a[c]=arguments[c+3];t.children=a}if(t&&o)for(var s in o)void 0===t[s]&&(t[s]=o[s]);else t||(t=o||{});return{$$typeof:d,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}n.d(t,"a",(function(){return g}));var d,y=n(137),b=n.n(y),m=n(427),h=n(455),v=n(503),O=f(m.a,{id:"mail--Compose-Close-Mobile"}),g=(function(e){function t(){return o(this,t),c(this,u(t).apply(this,arguments))}return l(t,e),a(t,[{key:"render",value:function(){return f(h.a,{innerRef:this.props.innerRef,className:this.props.cls,onClick:this.props.onClick,iconComponent:O,isClear:!0})}}]),t})(b.a.PureComponent);g.propTypes=v.a},3667:function(e,t,n){"use strict";var r=n(348),o=n.n(r);t.a=o.a.shape({fieldName:o.a.string,additionalFieldNames:o.a.arrayOf(o.a.string),errorKey:o.a.string.isRequired,additionalText:o.a.string})},3668:function(e,t){},3669:function(e,t,n){"use strict";var r=n(532),o=n(3670),i=n(3672),a=n(360);n.n(a);t.a=Object(r.a)({PopupContent:i.a,cls:o.a.Popup,metrikaArgs:[a.COMPOSE_METRIKA_FOOTER_OVERFLOW,a.COMPOSE_METRIKA_FOOTER_OVERFLOW_CLICK],directions:["top"],options:{type:"top"}},o.b)},3670:function(e,t,n){"use strict";function r(e){"@babel/helpers - typeof";return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t,n){return t&&c(e.prototype,t),n&&c(e,n),e}function u(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?l(e):t}function l(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function f(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&d(e,t)}function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function y(e,t,n,r){g||(g="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=r;else if(i>1){for(var a=new Array(i),c=0;c<i;c++)a[c]=arguments[c+3];t.children=a}if(t&&o)for(var s in o)void 0===t[s]&&(t[s]=o[s]);else t||(t=o||{});return{$$typeof:g,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}n.d(t,"a",(function(){return L})),n.d(t,"b",(function(){return z}));var b,m,h,v,O,g,_=n(137),S=n.n(_),E=n(350),P=n.n(E),C=n(348),w=n.n(C),T=n(353),k=n(351),R=n(503),A=n(563),j=n(376),M=n(368),I=n(455),D=n(3671),N=(n.n(D),"ComposeOverflowButton"),L={Block:N,Popup:"".concat(N,"-Popup")},x=y(M.default,{id:"mail--Compose-More"}),z=(b=Object(T.inject)("data"))(m=Object(T.observer)((O=v=(function(e){function t(){return a(this,t),u(this,p(t).apply(this,arguments))}return f(t,e),s(t,[{key:"render",value:function(){var e=this.props.cls;return y("div",{className:P()(L.Block,e)},void 0,y(I.a,{innerRef:this.props.innerRef,onMouseEnter:this.props.onMouseEnter,onMouseLeave:this.props.onMouseLeave,onClick:this.props.onClick,hasNotification:this.hasNotifications,iconComponent:x}))}},{key:"hasNotifications",get:function(){var e=this.props,t=e.contentOptions.buttons,n=e.data,r=function(e){return A.a[e]&&A.a[e]({data:n})};return t.some(r)}}]),t})(S.a.PureComponent),v.propTypes=(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e})({},R.a,{contentOptions:w.a.shape({buttons:w.a.array}),data:j.a.isRequired}),h=O,(function(e,t,n,r,o){var i={};return Object.keys(r).forEach((function(e){i[e]=r[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce((function(n,r){return r(e,t,n)||n}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i})(h.prototype,"hasNotifications",[k.computed],Object.getOwnPropertyDescriptor(h.prototype,"hasNotifications"),h.prototype),m=h))||m)||m},3671:function(e,t){},3672:function(e,t,n){"use strict";function r(e){"@babel/helpers - typeof";return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}function c(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?s(e):t}function s(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function f(e,t,n,r){d||(d="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=r;else if(i>1){for(var a=new Array(i),c=0;c<i;c++)a[c]=arguments[c+3];t.children=a}if(t&&o)for(var s in o)void 0===t[s]&&(t[s]=o[s]);else t||(t=o||{});return{$$typeof:d,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}n.d(t,"a",(function(){return _}));var d,y=n(137),b=n.n(y),m=n(348),h=n.n(m),v=n(1807),O=n(3673),g=(n.n(O),{Block:"OverflowOptions",Item:"".concat("OverflowOptions","-Item")}),_=(function(e){function t(){return o(this,t),c(this,u(t).apply(this,arguments))}return l(t,e),a(t,[{key:"render",value:function(){var e=this;return f("div",{className:g.Block},void 0,this.props.buttons.map((function(t){return e.renderButtonAsMenuItem(t)})))}},{key:"renderButtonAsMenuItem",value:function(e){return f(v.a[e].MenuItem,{onClick:this.props.onAction,cls:g.Item},e)}}]),t})(b.a.Component);_.propTypes={buttons:h.a.array,onAction:h.a.func}},3673:function(e,t){},3674:function(e,t){},3675:function(e,t,n){"use strict";function r(e){"@babel/helpers - typeof";return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}function c(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?s(e):t}function s(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function f(e,t,n,r){O||(O="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=r;else if(i>1){for(var a=new Array(i),c=0;c<i;c++)a[c]=arguments[c+3];t.children=a}if(t&&o)for(var s in o)void 0===t[s]&&(t[s]=o[s]);else t||(t=o||{});return{$$typeof:O,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function d(e,t,n,r,o){var i={};return Object.keys(r).forEach((function(e){i[e]=r[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce((function(n,r){return r(e,t,n)||n}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}n.d(t,"a",(function(){return W}));var y,b,m,h,v,O,g=n(137),_=n.n(g),S=n(350),E=n.n(S),P=n(351),C=n(353),w=n(1307),T=n(622),k=n(1304),R=n(1810),A=n(1818),j=n(1819),M=n(3677),I=n(3683),D=n(3685),N=n(915),L=n(1303),x=n(399),z=(n.n(x),n(367)),B=n(356),F=n(1825),U=(n.n(F),E()(N.a.Button,N.a.ButtonNew)),K=Object(T.a)("compose-react/MoreOptions_AttachmentsDisk",j.a),H=Object(T.a)("compose-react/MoreOptions_AttachmentsMail",j.a),W=(y=Object(C.inject)("services","visual"))(b=Object(C.observer)((v=h=(function(e){function t(){return o(this,t),c(this,u(t).apply(this,arguments))}return l(t,e),a(t,[{key:"render",value:function(){return f("div",{className:E()(N.a.Block,"".concat(N.a.Block,"_desktop"),this.props.cls,this.isSmall&&"".concat(N.a.Block,"_small"))},void 0,this.renderMainPart(),this.renderAdditionalPart())}},{key:"renderMainPart",value:function(){return f("div",{className:N.a.Part},void 0,f(w.a,{cls:E()(U,N.a.SendButton,"qa-Compose-SendButton")}),f(R.b,{cls:E()(U,N.a.DelayedSendingButton,"qa-Compose-DelayedSendingButton")}),f(A.b,{cls:E()(U,N.a.NotificationsButton,"qa-Compose-NotificationsButton")}),f(M.a,{cls:E()(U,N.a.TemplatesButton,"qa-Compose-TemplatesButton"),isIconOnly:!0}),f(k.b,{cls:E()(U,"qa-Compose-AttachFileButton")}),this.hasDisk&&f(K,{type:"disk",cls:E()(U,"qa-Compose-AttachDiskButton"),"aria-label":Object(z.default)("compose-react/MoreOptions_AttachmentsDisk")}),!this.isCorp&&f(H,{type:"mail",cls:E()(U,"qa-Compose-AttachMailButton"),"aria-label":Object(z.default)("compose-react/MoreOptions_AttachmentsMail")}),f(D.a,{cls:E()(U,N.a.MoreButton,"qa-Compose-MoreButton"),isHorizontal:!0,withIconActiveState:!1}))}},{key:"renderAdditionalPart",value:function(){return f("div",{className:N.a.Part},void 0,!this.isSmall&&f(I.a,{cls:E()(U,N.a.TranslatorButton,"qa-Compose-TranslatorButton"),isIconOnly:this.size===x.ComposeSizes.SMALL}))}},{key:"size",get:function(){return this.props.visual.size}},{key:"isSmall",get:function(){return this.size===x.ComposeSizes.SMALL}},{key:"hasDisk",get:function(){return this.props.services.attachments.hasDisk&&Object(B.hasSid)("59")}},{key:"isCorp",get:function(){return this.props.services.attachments.isCorp}},{key:"isTranslated",get:function(){return this.props.visual.translate.isEnabled}}]),t})(_.a.Component),h.propTypes=L.a,m=v,d(m.prototype,"size",[P.computed],Object.getOwnPropertyDescriptor(m.prototype,"size"),m.prototype),d(m.prototype,"isSmall",[P.computed],Object.getOwnPropertyDescriptor(m.prototype,"isSmall"),m.prototype),d(m.prototype,"hasDisk",[P.computed],Object.getOwnPropertyDescriptor(m.prototype,"hasDisk"),m.prototype),d(m.prototype,"isCorp",[P.computed],Object.getOwnPropertyDescriptor(m.prototype,"isCorp"),m.prototype),d(m.prototype,"isTranslated",[P.computed],Object.getOwnPropertyDescriptor(m.prototype,"isTranslated"),m.prototype),b=m))||b)||b},3676:function(e,t,n){"use strict";function r(e){"@babel/helpers - typeof";return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t,n){return t&&c(e.prototype,t),n&&c(e,n),e}function u(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?p(e):t}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function p(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function f(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&d(e,t)}function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function y(e,t,n,r){E||(E="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=r;else if(i>1){for(var a=new Array(i),c=0;c<i;c++)a[c]=arguments[c+3];t.children=a}if(t&&o)for(var s in o)void 0===t[s]&&(t[s]=o[s]);else t||(t=o||{});return{$$typeof:E,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function b(e,t,n,r){n&&Object.defineProperty(e,t,{enumerable:n.enumerable,configurable:n.configurable,writable:n.writable,value:n.initializer?n.initializer.call(r):void 0})}function m(e,t,n,r,o){var i={};return Object.keys(r).forEach((function(e){i[e]=r[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce((function(n,r){return r(e,t,n)||n}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}n.d(t,"a",(function(){return F}));var h,v,O,g,_,S,E,P=n(137),C=n.n(P),w=n(348),T=n.n(w),k=n(350),R=n.n(k),A=n(351),j=n(353),M=n(368),I=n(455),D=n(503),N=n(531),L=n(366),x=(n.n(L),n(360)),z=(n.n(x),n(365)),B=n(380),F=(h=Object(j.inject)("services","visual"))(v=Object(j.observer)((S=_=(function(e){function t(){var e,n;a(this,t);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return n=u(this,(e=l(t)).call.apply(e,[this].concat(o))),b(p(n),"onClick",g,p(n)),n}return f(t,e),s(t,[{key:"render",value:function(){return y(I.a,{innerRef:this.props.innerRef,onMouseEnter:this.props.onMouseEnter,onMouseLeave:this.props.onMouseLeave,onClick:this.onClick,className:R()("ComposeAttachmentsButton",this.props.cls),iconComponent:y(M.default,{id:this.iconName}),"aria-label":this.props["aria-label"]})}},{key:"metrikaService",get:function(){return this.props.services.metrika}},{key:"isDiskAttachments",get:function(){return"disk"===this.props.type}},{key:"iconName",get:function(){return"mail--Compose-Attachments-".concat(this.isDiskAttachments?"Disk":"Mail")}}]),t})(C.a.Component),_.propTypes=(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e})({},D.a,{type:T.a.oneOf(["disk","mail"]),services:z.a.isRequired,visual:B.a.isRequired}),O=S,m(O.prototype,"metrikaService",[A.computed],Object.getOwnPropertyDescriptor(O.prototype,"metrikaService"),O.prototype),m(O.prototype,"isDiskAttachments",[A.computed],Object.getOwnPropertyDescriptor(O.prototype,"isDiskAttachments"),O.prototype),m(O.prototype,"iconName",[A.computed],Object.getOwnPropertyDescriptor(O.prototype,"iconName"),O.prototype),g=m(O.prototype,"onClick",[A.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){e.props.visual.diskResourcesPath=e.isDiskAttachments?N.a:N.b,e.props.visual.currentPopup=L.Popups.DISK_RESOURCES;var t=e.isDiskAttachments?x.COMPOSE_METRIKA_FOOTER_ATTACH_DISK:x.COMPOSE_METRIKA_FOOTER_ATTACH_MAIL;e.metrikaService.sendFooterMetrika(t)}}}),v=O))||v)||v},3677:function(e,t,n){"use strict";var r=n(3678),o=n(532),i=n(1820),a=n(360),c=(n.n(a),n(622)),s={PopupContent:i.a,cls:r.a.Popup,metrikaArgs:[a.COMPOSE_METRIKA_FOOTER_TEMPLATES,a.COMPOSE_METRIKA_FOOTER_TEMPLATES_CLICK],directions:["top","top-end","top-start"],title:"compose-react/Templates_Title"},u=Object(o.a)(s,r.b),l=Object(c.a)("compose-react/Templates_Title",u);t.a=l},3678:function(e,t,n){"use strict";function r(e){"@babel/helpers - typeof";return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t,n){return t&&c(e.prototype,t),n&&c(e,n),e}function u(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?l(e):t}function l(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function f(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&d(e,t)}function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function y(e,t,n,r){g||(g="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=r;else if(i>1){for(var a=new Array(i),c=0;c<i;c++)a[c]=arguments[c+3];t.children=a}if(t&&o)for(var s in o)void 0===t[s]&&(t[s]=o[s]);else t||(t=o||{});return{$$typeof:g,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}n.d(t,"a",(function(){return F})),n.d(t,"b",(function(){return K}));var b,m,h,v,O,g,_=n(137),S=n.n(_),E=n(348),P=n.n(E),C=n(350),w=n.n(C),T=n(353),k=n(351),R=n(455),A=n(368),j=n(352),M=n(367),I=n(376),D=n(380),N=n(503),L=n(563),x=n(501),z=n(3679),B=(n.n(z),"ComposeTemplatesButton"),F={Block:B,Button:"".concat(B,"-Button"),Popup:"".concat(B,"-Popup"),Text:"".concat(B,"-Text"),OnlyIcon:"".concat(B,"_onlyIcon")},U=y(A.default,{id:"mail--Compose-Templates"}),K=(b=Object(T.inject)("data","visual"))(m=Object(T.observer)((O=v=(function(e){function t(){return a(this,t),u(this,p(t).apply(this,arguments))}return f(t,e),s(t,[{key:"render",value:function(){var e=this.props,t=e.cls,n=e.isIconOnly,r=w()(F.Block,t,i({},F.OnlyIcon,n));return y(R.a,{innerRef:this.props.innerRef,className:r,onClick:this.props.onClick,hasNotification:this.hasNotification,iconComponent:U,onMouseEnter:this.props.onMouseEnter,onMouseLeave:this.props.onMouseLeave,"aria-label":Object(M.default)("compose-react/Templates_Title")},void 0,!n&&y(j.default,{className:F.Text,loc:"compose-react/Templates_Title"}))}},{key:"hasNotification",get:function(){return L.a[x.a.TEMPLATES]({data:this.props.data,visual:this.props.visual})}}]),t})(S.a.PureComponent),v.propTypes=(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e})({},N.a,{isIconOnly:P.a.bool,data:I.a.isRequired,visual:D.a.isRequired}),h=O,(function(e,t,n,r,o){var i={};return Object.keys(r).forEach((function(e){i[e]=r[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce((function(n,r){return r(e,t,n)||n}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i})(h.prototype,"hasNotification",[k.computed],Object.getOwnPropertyDescriptor(h.prototype,"hasNotification"),h.prototype),m=h))||m)||m},3679:function(e,t){},3680:function(e,t,n){"use strict";function r(e){"@babel/helpers - typeof";return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e){return c(e)||a(e)||i()}function i(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function a(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function c(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}function s(e,t,n,r,o,i,a){try{var c=e[i](a),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,o)}function u(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){function i(e){s(c,r,o,i,a,"next",e)}function a(e){s(c,r,o,i,a,"throw",e)}var c=e.apply(t,n);i(void 0)})}}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function p(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function f(e,t,n){return t&&p(e.prototype,t),n&&p(e,n),e}function d(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?b(e):t}function y(e){return(y=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function b(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function m(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&h(e,t)}function h(e,t){return(h=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function v(e,t,n,r){A||(A="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=r;else if(i>1){for(var a=new Array(i),c=0;c<i;c++)a[c]=arguments[c+3];t.children=a}if(t&&o)for(var s in o)void 0===t[s]&&(t[s]=o[s]);else t||(t=o||{});return{$$typeof:A,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function O(e,t,n,r){n&&Object.defineProperty(e,t,{enumerable:n.enumerable,configurable:n.configurable,writable:n.writable,value:n.initializer?n.initializer.call(r):void 0})}function g(e,t,n,r,o){var i={};return Object.keys(r).forEach((function(e){i[e]=r[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce((function(n,r){return r(e,t,n)||n}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}n.d(t,"a",(function(){return J}));var _,S,E,P,C,w,T,k,R,A,j=n(137),M=n.n(j),I=n(348),D=n.n(I),N=n(350),L=n.n(N),x=n(138),z=n.n(x),B=n(353),F=n(351),U=n(365),K=n(487),H=n(140),W=(n.n(H),n(3681)),G=n.n(W),Y="ComposeTemplatesList",q={Block:Y,Item:"".concat(Y,"-Item"),Text:"".concat(Y,"-Text"),Loader:"".concat(Y,"-Loader")},V=200,$=32,Q=v(K.default,{size:"xs"}),J=(_=Object(B.inject)("services"))(S=Object(B.observer)((R=k=(function(e){function t(e){var n;return l(this,t),n=d(this,y(t).call(this,e)),n.canLoadMore=!0,O(b(n),"templates",P,b(n)),O(b(n),"isLoading",C,b(n)),O(b(n),"setTemplates",w,b(n)),O(b(n),"setIsLoading",T,b(n)),n.loadTemplates=u(regeneratorRuntime.mark((function e(){var t,r,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.setIsLoading(!0),e.next=3,n.templatesService.loadTemplates({first:n.templates.length});case 3:t=e.sent,r=t.canLoadMore,o=t.items,n.canLoadMore=r,n.setTemplates(o),n.setIsLoading(!1);case 9:case"end":return e.stop()}}),e)}))),n.scroll=function(e){if(!n.isLoading&&n.canLoadMore){var t=e.target;t.scrollHeight-t.scrollTop-t.clientHeight<$&&n.loadTemplates()}},n.onScroll=function(e){e.persist(),n.throttledScroll(e)},n.throttledScroll=z.a.throttle(n.scroll,V),n}return m(t,e),f(t,[{key:"componentDidMount",value:function(){this.loadTemplates()}},{key:"componentDidUpdate",value:function(){this.props.onChange&&this.props.onChange()}},{key:"render",value:function(){var e=this;return v("div",{className:L()(q.Block,this.props.cls),onScroll:this.onScroll},void 0,this.templates.map((function(t){return e.renderItem(t)})),this.maybeRenderLoader())}},{key:"renderItem",value:function(e){var t=this.props.onSelectTemplate;return v("div",{className:L()(q.Item,G.a.item),onClick:function(){return t&&t(e)}},e.key,v(H.Text,{typography:"body-long-m",className:L()(q.Text,G.a.text)},void 0,e.subject))}},{key:"maybeRenderLoader",value:function(){return this.isLoading?v("div",{className:L()(q.Loader,G.a.loader)},void 0,Q):null}},{key:"templatesService",get:function(){return this.props.services.templates}}]),t})(M.a.Component),k.propTypes={cls:D.a.string,onChange:D.a.func,onSelectTemplate:D.a.func,services:U.a.isRequired},E=R,P=g(E.prototype,"templates",[F.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),C=g(E.prototype,"isLoading",[F.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),g(E.prototype,"templatesService",[F.computed],Object.getOwnPropertyDescriptor(E.prototype,"templatesService"),E.prototype),w=g(E.prototype,"setTemplates",[F.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){e.templates=[].concat(o(e.templates),o(t))}}}),T=g(E.prototype,"setIsLoading",[F.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){e.isLoading=t}}}),S=E))||S)||S},3681:function(e,t){e.exports={variables:'"../../../../variables.m.css"',footerPopupPadding:"var(--space-xs) 0",footerItemPadding:"0 var(--space-m)",footerItemHeight:"36px",footerItemBackground:"var(--color-mg-tint-superlight)",item:"TemplatesButton__item--1a3os",text:"TemplatesButton__text--2Ehe0",loader:"TemplatesButton__loader--3ngNx"}},3682:function(e,t){e.exports={variables:'"../../../../variables.m.css"',footerSeparatorHeight:"1px",footerSeparatorColor:"var(--color-mg-stroke-default-base)",footerSeparatorMargin:"var(--space-2-xs) var(--space-s)",footerItemHeight:"36px",footerItemPadding:"0 var(--space-m)",footerItemBackground:"var(--color-mg-tint-superlight)",root:"TemplatesButton__root--1hklX",list:"TemplatesButton__list--ZkaFx",separator:"TemplatesButton__separator--1VY3R",action:"TemplatesButton__action--17iDj"}},3683:function(e,t,n){"use strict";function r(e){"@babel/helpers - typeof";return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function c(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),e}function s(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?u(e):t}function u(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function p(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function d(e,t,n,r){g||(g="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=r;else if(i>1){for(var a=new Array(i),c=0;c<i;c++)a[c]=arguments[c+3];t.children=a}if(t&&o)for(var s in o)void 0===t[s]&&(t[s]=o[s]);else t||(t=o||{});return{$$typeof:g,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function y(e,t,n,r,o){var i={};return Object.keys(r).forEach((function(e){i[e]=r[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce((function(n,r){return r(e,t,n)||n}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}n.d(t,"a",(function(){return U}));var b,m,h,v,O,g,_=n(137),S=n.n(_),E=n(348),P=n.n(E),C=n(350),w=n.n(C),T=n(351),k=n(353),R=n(372),A=n(376),j=n(502),M=n(365),I=n(352),D=n(427),N=n(455),L=n(3684),x=(n.n(L),"ComposeTranslatorButton"),z={Block:x,Selected:"".concat(x,"_selected"),OnlyIcon:"".concat(x,"_onlyIcon")},B=d(D.a,{id:"mail--ComposeReact-Translate"}),F=d(I.default,{loc:"compose-react/Translator_TranslateButton"}),U=(b=Object(k.inject)("controllers","data","services","visual"))(m=Object(k.observer)((O=v=(function(e){function t(){var e,n;i(this,t);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return n=s(this,(e=l(t)).call.apply(e,[this].concat(o))),n.onClick=function(){n.props.controllers.translate.toggleTranslator()},n}return p(t,e),c(t,[{key:"render",value:function(){var e=this.onClick,t=this.isEnabled,n=this.props,r=n.cls,i=n.isIconOnly;return d("div",{className:w()(z.Block,o({},z.Selected,t),o({},z.OnlyIcon,i),r)},void 0,d(N.a,{onClick:e,iconComponent:B,hasNotification:t},void 0,!i&&F))}},{key:"messageBody",get:function(){return this.props.controllers.messageBody.text}},{key:"service",get:function(){return this.props.services.translate}},{key:"isEnabled",get:function(){return this.props.visual.translate.isEnabled}},{key:"metrika",get:function(){return this.props.services.metrika}}]),t})(S.a.Component),v.propTypes={cls:P.a.string,isIconOnly:P.a.bool,controllers:R.a.isRequired,data:A.a.isRequired,visual:j.a.isRequired,services:M.a.isRequired},h=O,y(h.prototype,"messageBody",[T.computed],Object.getOwnPropertyDescriptor(h.prototype,"messageBody"),h.prototype),y(h.prototype,"service",[T.computed],Object.getOwnPropertyDescriptor(h.prototype,"service"),h.prototype),y(h.prototype,"isEnabled",[T.computed],Object.getOwnPropertyDescriptor(h.prototype,"isEnabled"),h.prototype),y(h.prototype,"metrika",[T.computed],Object.getOwnPropertyDescriptor(h.prototype,"metrika"),h.prototype),m=h))||m)||m},3684:function(e,t){},3685:function(e,t,n){"use strict";var r=n(532),o=n(3686),i=n(3703),a=n(360),c=(n.n(a),Object(r.a)({PopupContent:o.a,cls:i.a.Popup,metrikaArgs:[a.COMPOSE_METRIKA_FOOTER_MORE],directions:["top-end"],options:{}},i.b));t.a=c},3686:function(e,t,n){"use strict";var r=n(3687);n.d(t,"a",(function(){return r.a}))},3687:function(e,t,n){"use strict";function r(){return r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},r.apply(this,arguments)}function o(e){"@babel/helpers - typeof";return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){c(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(e,t){if(null==e)return{};var n,r,o=u(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function u(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function p(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function f(e,t,n){return t&&p(e.prototype,t),n&&p(e,n),e}function d(e,t){return!t||"object"!==o(t)&&"function"!=typeof t?b(e):t}function y(e){return(y=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function b(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function m(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&h(e,t)}function h(e,t){return(h=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function v(e,t,n,r){M||(M="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=r;else if(i>1){for(var a=new Array(i),c=0;c<i;c++)a[c]=arguments[c+3];t.children=a}if(t&&o)for(var s in o)void 0===t[s]&&(t[s]=o[s]);else t||(t=o||{});return{$$typeof:M,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function O(e,t,n,r){n&&Object.defineProperty(e,t,{enumerable:n.enumerable,configurable:n.configurable,writable:n.writable,value:n.initializer?n.initializer.call(r):void 0})}function g(e,t,n,r,o){var i={};return Object.keys(r).forEach((function(e){i[e]=r[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce((function(n,r){return r(e,t,n)||n}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}n.d(t,"a",(function(){return le}));var _,S,E,P,C,w,T,k,R,A,j,M,I=n(137),D=n.n(I),N=n(348),L=n.n(N),x=n(351),z=n(353),B=n(1821),F=n.n(B),U=n(3690),K=n(372),H=n(376),W=n(365),G=n(380),Y=n(3691),q=(n.n(Y),n(531)),V=n(532),$=n(1815),Q=n(366),J=(n.n(Q),n(360)),X=(n.n(J),n(399)),Z=(n.n(X),n(501)),ee=n(563),te=n(1822),ne=n(3693),re=n.n(ne),oe=n(350),ie=n.n(oe),ae=n(3694),ce=Object(V.a)({PopupContent:$.a,cls:te.a.Popup,metrikaArgs:[J.COMPOSE_METRIKA_FOOTER_MORE_LABELS_CLICK],directions:["left"],title:"compose-react/Header_Labels"},F.a),se=Object(V.a)({PopupContent:ae.a,cls:te.a.Popup,metrikaArgs:[J.COMPOSE_METRIKA_FOOTER_MORE_SIGNATURES_CLICK],directions:["left"],title:"compose-react/Header_Labels"},F.a),ue=v(Y.Separator,{className:"qa-Compose-MoreOptions-Separator"}),le=(_=Object(z.inject)("controllers","data","services","visual"))(S=Object(z.observer)((j=A=(function(e){function t(e){var n;return l(this,t),n=d(this,y(t).call(this,e)),O(b(n),"isAutocompleteEnabled",P,b(n)),O(b(n),"isSmartSubjectEnabled",C,b(n)),O(b(n),"toggleSmartSubject",w,b(n)),O(b(n),"toggleAutocomplete",T,b(n)),n.toggleTranslator=function(){n.props.controllers.translate.toggleTranslator(),n.props.controllers.compose.changeSize(X.ComposeSizes.LARGE)},O(b(n),"onAttachMail",k,b(n)),O(b(n),"onAttachDisk",R,b(n)),n.onAction=function(){n.props.onAction()},n.renderItem=function(e){var t=e.key,n=e.Component,o=void 0===n?F.a:n,i=s(e,["key","Component"]);return D.a.createElement(o,r({key:t},i))},n.isAutocompleteEnabled=n.settingsController.isAutocompleteEnabled,n.isSmartSubjectEnabled=n.props.services.settings.isSmartSubjectEnabled,n}return m(t,e),f(t,[{key:"render",value:function(){return v("div",{className:ie()(re.a.root,te.a.Block,"qa-Compose-MoreOptions")},void 0,this.items.map(this.renderItem))}},{key:"isTemplate",get:function(){return this.props.data.isTemplate}},{key:"hasChanges",get:function(){return this.props.data.hasChanges}},{key:"settingsController",get:function(){return this.props.controllers.settings}},{key:"metrikaService",get:function(){return this.props.services.metrika}},{key:"isTranslatorEnabled",get:function(){return this.props.visual.translate.isEnabled}},{key:"optionsParams",get:function(){var e;return e={},c(e,Z.a.ATTACHMENTS_DISK,{icon:"mail--Compose-Disk_more",loc:"compose-react/MoreOptions_AttachmentsDisk",onClick:this.onAttachDisk,cls:"qa-Compose-MoreOptions-AttachmentsDisk"}),c(e,Z.a.ATTACHMENTS_MAIL,{icon:"mail--Compose-Mail_more",loc:"compose-react/MoreOptions_AttachmentsMail",onClick:this.onAttachMail,cls:"qa-Compose-MoreOptions-AttachmentsMail"}),c(e,Z.a.SEPARATOR,{Component:function(){return ue}}),c(e,Z.a.LABELS,{icon:"mail--ComposeReact-Label_more",loc:"compose-react/MoreOptions_Labels",Component:ce,onAction:this.onAction,cls:"qa-Compose-MoreOptions-Labels"}),c(e,Z.a.AUTOCOMPLETE,{icon:"mail--ComposeReact-Autocomplete",loc:"compose-react/MoreOptions_AutocompleteLabel",checked:this.isAutocompleteEnabled,onToggle:this.toggleAutocomplete,cls:"qa-Compose-MoreOptions-Autocomplete"}),c(e,Z.a.SMART_SUBJECT,{icon:"mail--ComposeReact-SmartSubject",loc:"compose-react/MoreOptions_SmartSubjectLabel",checked:this.isSmartSubjectEnabled,onToggle:this.toggleSmartSubject,cls:"qa-Compose-MoreOptions-SmartSubject"}),c(e,Z.a.TEMPLATES,{icon:"mail--Compose-Templates",loc:"compose-react/Templates_Title",cls:ie()(te.a.TemplatesButton,"qa-Compose-MoreOptions-Templates"),Component:U.a}),c(e,Z.a.TRANSLATOR,{icon:"mail--ComposeReact-Translate",loc:"compose-react/Translator_TranslateButton",checked:this.isTranslatorEnabled,onToggle:this.toggleTranslator,cls:"qa-Compose-MoreOptions-Translator"}),c(e,Z.a.SIGNATURES,{icon:"mail--ComposeReact-Signature",loc:"compose-react/MoreOptions_Signatures",Component:se,onAction:this.onAction,cls:"qa-Compose-MoreOptions-Signatures"}),e}},{key:"items",get:function(){var e=this,t=this.props,n=t.data,r=t.visual,o=this.props.controllers.visual.moreButtonOptions.map((function(t,o){return a({key:t===Z.a.SEPARATOR?t+o:t,hasNotification:ee.a[t]&&ee.a[t]({data:n,visual:r})},e.optionsParams[t])}));if(this.props.controllers.visual.moreButtonOptions.includes(Z.a.TEMPLATES)){var i=o.length-1,c=40*i+8;o[0].popupProps={secondaryOffset:-1*c,tailOffset:c}}return o}}]),t})(D.a.PureComponent),A.propTypes={onAction:L.a.func.isRequired,controllers:K.a.isRequired,data:H.a.isRequired,services:W.a.isRequired,visual:G.a.isRequired},E=j,P=g(E.prototype,"isAutocompleteEnabled",[x.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),C=g(E.prototype,"isSmartSubjectEnabled",[x.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),g(E.prototype,"isTemplate",[x.computed],Object.getOwnPropertyDescriptor(E.prototype,"isTemplate"),E.prototype),g(E.prototype,"hasChanges",[x.computed],Object.getOwnPropertyDescriptor(E.prototype,"hasChanges"),E.prototype),g(E.prototype,"settingsController",[x.computed],Object.getOwnPropertyDescriptor(E.prototype,"settingsController"),E.prototype),g(E.prototype,"metrikaService",[x.computed],Object.getOwnPropertyDescriptor(E.prototype,"metrikaService"),E.prototype),g(E.prototype,"isTranslatorEnabled",[x.computed],Object.getOwnPropertyDescriptor(E.prototype,"isTranslatorEnabled"),E.prototype),w=g(E.prototype,"toggleSmartSubject",[x.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){e.isSmartSubjectEnabled=!e.isSmartSubjectEnabled,e.props.services.settings.isSmartSubjectEnabled=e.isSmartSubjectEnabled,e.metrikaService.sendFooterMetrika(e.isSmartSubjectEnabled?J.COMPOSE_METRIKA_FOOTER_MORE_SMARTSUBJECT_ON:J.COMPOSE_METRIKA_FOOTER_MORE_SMARTSUBJECT_OFF)}}}),T=g(E.prototype,"toggleAutocomplete",[x.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){e.isAutocompleteEnabled=!e.isAutocompleteEnabled,e.settingsController.toggleAutocomplete(),e.metrikaService.sendFooterMetrika(e.isAutocompleteEnabled?J.COMPOSE_METRIKA_FOOTER_MORE_AUTOCOMPLETE_ON:J.COMPOSE_METRIKA_FOOTER_MORE_AUTOCOMPLETE_OFF)}}}),k=g(E.prototype,"onAttachMail",[x.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){e.props.visual.diskResourcesPath=q.b,e.props.visual.currentPopup=Q.Popups.DISK_RESOURCES,e.metrikaService.sendFooterMetrika(J.COMPOSE_METRIKA_FOOTER_ATTACH_MAIL),e.props.onAction()}}}),R=g(E.prototype,"onAttachDisk",[x.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){e.props.visual.diskResourcesPath=q.a,e.props.visual.currentPopup=Q.Popups.DISK_RESOURCES,e.metrikaService.sendFooterMetrika(J.COMPOSE_METRIKA_FOOTER_ATTACH_DISK),e.props.onAction()}}}),g(E.prototype,"optionsParams",[x.computed],Object.getOwnPropertyDescriptor(E.prototype,"optionsParams"),E.prototype),g(E.prototype,"items",[x.computed],Object.getOwnPropertyDescriptor(E.prototype,"items"),E.prototype),S=E))||S)||S},3688:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=r(n(137)),i=r(n(350)),a=r(n(352)),c=n(155),s=r(n(368)),u=n(140),l=r(n(3689)),p="ComposeOptionItem",f={Block:p,withToggle:p+"_withToggle",checked:p+"_checked",Label:p+"-Label",Icon:p+"-Icon",withNotification:p+"_withNotification"},d=function(e){var t,n=e.checked,r=e.isPopupVisible,p=void 0!==r&&r,d=e.cls,y=e.hasNotification,b=e.icon,m=e.innerRef,h=e.loc,v=e.onClick,O=e.onToggle,g=e.url,_=g?"a":"div",S=o.default.createElement(o.default.Fragment,null,o.default.createElement("div",{className:i.default(l.default.iconWrap,f.Icon)},o.default.createElement(s.default,{cls:l.default.icon,id:b})),o.default.createElement(u.Text,{typography:"body-long-m",className:i.default(l.default.label,f.Label)},o.default.createElement(a.default,{loc:h})));return O?o.default.createElement(c.Tumbler,{className:i.default(l.default.root,d,l.default.withToggle,f.Block,f.withToggle),view:"default",size:"s",checked:n,onChange:O,labelBefore:S}):o.default.createElement(_,{className:i.default(l.default.root,f.Block,d,(t={},t[l.default.withNotification+" "+f.withNotification]=y,t[l.default.checked+" "+f.checked]=p,t)),onClick:v,ref:m,target:g?"_blank":void 0,href:g,rel:g?"noreferrer noopener":void 0},S)};d.propTypes={},t.default=d},3689:function(e,t){e.exports={variables:'"../../../../../../variables.m.css"',footerItemHeight:"36px",footerItemSmallPadding:"0 var(--space-s)",footerItemBackground:"var(--color-mg-tint-superlight)",notificationColor:"var(--button-view-action-fill-color-base)",notificationBadgeSize:"var(--space-xs) var(--space-m)",root:"OptionItem__root--3hAQK",checked:"OptionItem__checked--1WV2K",withToggle:"OptionItem__withToggle--1aGOM",iconWrap:"OptionItem__iconWrap--TxGZ_",icon:"OptionItem__icon--1lbyA",withNotification:"OptionItem__withNotification--1rXYE",label:"OptionItem__label--1mfGg"}},369:function(e,t,n){"use strict";var r=n(787),o=n(679),i=n(788),a=n(1262),c=n(1263);n.d(t,"a",(function(){return c})),n.d(t,"c",(function(){return r})),n.d(t,"d",(function(){return i})),n.d(t,"b",(function(){return a})),n.d(t,"e",(function(){return o}))},3690:function(e,t,n){"use strict";var r=n(532),o=n(1820),i=n(1821),a=n.n(i),c=n(1822),s=n(360),u=(n.n(s),Object(r.a)({PopupContent:o.a,cls:c.a.TemplatesPopup,metrikaArgs:[s.COMPOSE_METRIKA_FOOTER_TEMPLATES,s.COMPOSE_METRIKA_FOOTER_TEMPLATES_CLICK],directions:["left-end"]},a.a));t.a=u},3691:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Separator=void 0;var o=r(n(137)),i=r(n(350)),a=r(n(3692)),c=function(e){var t=e.className;return o.default.createElement("div",{className:i.default(a.default.separator,t)})};t.Separator=c},3692:function(e,t){e.exports={variables:'"../../../../../variables.m.css"',footerSeparatorHeight:"1px",footerSeparatorColor:"var(--color-mg-stroke-default-base)",footerSeparatorMargin:"var(--space-2-xs) var(--space-s)",separator:"MoreOptions__separator--lqGat"}},3693:function(e,t){e.exports={variables:'"../../../../../variables.m.css"',footerPopupPadding:"var(--space-xs) 0",root:"MoreOptions__root--37dHX"}},3694:function(e,t,n){"use strict";function r(e){"@babel/helpers - typeof";return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}function c(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?s(e):t}function s(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function f(e,t,n,r){h||(h="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=r;else if(i>1){for(var a=new Array(i),c=0;c<i;c++)a[c]=arguments[c+3];t.children=a}if(t&&o)for(var s in o)void 0===t[s]&&(t[s]=o[s]);else t||(t=o||{});return{$$typeof:h,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}n.d(t,"a",(function(){return C}));var d,y,b,m,h,v=n(137),O=n.n(v),g=n(348),_=n.n(g),S=n(353),E=n(1823),P=n(372),C=(d=Object(S.inject)("data","controllers"))((m=b=(function(e){function t(){var e,n;o(this,t);for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return n=c(this,(e=u(t)).call.apply(e,[this].concat(i))),n._handleApplySignature=function(e){n.props.controllers.signatures.setSignature(e),n.props.onAction&&n.props.onAction()},n._handleClose=function(){n.props.onAction&&n.props.onAction()},n}return l(t,e),a(t,[{key:"render",value:function(){return f(E.a,{applySignature:this._handleApplySignature,onClose:this._handleClose})}}]),t})(O.a.Component),b.propTypes={onAction:_.a.func,controllers:P.a.isRequired},y=m))||y},3695:function(e,t,n){"use strict";function r(){return r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},r.apply(this,arguments)}function o(e){"@babel/helpers - typeof";return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e){return s(e)||c(e)||a()}function a(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function c(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function s(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function p(e,t,n){return t&&l(e.prototype,t),n&&l(e,n),e}function f(e,t){return!t||"object"!==o(t)&&"function"!=typeof t?d(e):t}function d(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function y(e){return(y=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function b(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&m(e,t)}function m(e,t){return(m=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function h(e,t,n,r){P||(P="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=r;else if(i>1){for(var a=new Array(i),c=0;c<i;c++)a[c]=arguments[c+3];t.children=a}if(t&&o)for(var s in o)void 0===t[s]&&(t[s]=o[s]);else t||(t=o||{});return{$$typeof:P,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function v(e,t,n,r,o){var i={};return Object.keys(r).forEach((function(e){i[e]=r[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce((function(n,r){return r(e,t,n)||n}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}n.d(t,"a",(function(){return W}));var O,g,_,S,E,P,C=n(137),w=n.n(C),T=n(348),k=n.n(T),R=n(350),A=n.n(R),j=n(351),M=n(353),I=n(376),D=n(380),N=n(365),L=n(372),x=n(367),z=n(382),B=n(360),F=(n.n(B),n(1824)),U=n(3700),K=(n.n(U),"SignaturesPopupMenu"),H={Block:K,BlockDesktop:"".concat(K,"_desktop"),BlockMobile:"".concat(K,"_mobile"),SignaturesList:"".concat(K,"-SignaturesList"),Separator:"".concat(K,"-Separator")},W=(O=Object(M.inject)("data","visual","services","controllers"))(g=Object(M.observer)((E=S=(function(e){function t(){var e,n;u(this,t);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return n=f(this,(e=y(t)).call.apply(e,[this].concat(o))),n._disposer=new z.a,n._openSettings=function(){n.props.onClose(),n.props.controllers.signatures.openSettings(),n._sendMetrika(B.COMPOSE_SIGNATURES_POPUP_GO_TO_SETTINGS)},n}return b(t,e),p(t,[{key:"_sendMetrika",value:function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];(e=this.metrika).sendMetrika.apply(e,[B.COMPOSE_METRIKA,B.COMPOSE_SIGNATURES_POPUP].concat(n))}},{key:"componentWillUnmount",value:function(){this._disposer.dispose(this)}},{key:"render",value:function(){return h("div",{className:A()(H.Block,this.isMobile?H.BlockMobile:H.BlockDesktop)},void 0,this.renderSignatures(),this.renderMenuItems())}},{key:"renderSignatures",value:function(){var e=[this._createCleanSignatureItem()].concat(i(this._getUserSignatures()));return h("div",{className:H.SignaturesList},void 0,e.map((function(e){return w.a.createElement(F.a,r({key:e.idx},e))})))}},{key:"renderMenuItems",value:function(){if(this.isMobile)return null;var e=this._getMenuItems();return w.a.createElement(w.a.Fragment,null,h("div",{className:H.Separator}),e.map((function(e){return w.a.createElement(F.a,r({key:e.idx},e))})))}},{key:"_applySignature",value:function(e){this.props.applySignature(e),this.props.onClose(),this._sendMetrika(e.html?B.COMPOSE_SIGNATURES_POPUP_CHANGE_SIGNATURE:B.COMPOSE_SIGNATURES_POPUP_WITHOUT_SIGNATURE),this.props.controllers.compose.complexityLogger.setSignatureWasChanged(!0)}},{key:"_createCleanSignatureItem",value:function(){var e=this;return{idx:-1,handler:function(){return e._applySignature({})},name:Object(x.default)("compose-react/SignaturesPopup_Empty")}}},{key:"_getUserSignatures",value:function(){var e=this,t=this.emailFrom,n=this.lang;return this.props.controllers.signatures.getSignatures(t,n).map((function(t){return{idx:t.idx,name:t.name,handler:function(){return e._applySignature(t)}}}))}},{key:"_getMenuItems",value:function(){return[{idx:"settings",handler:this._openSettings,name:Object(x.default)("compose-react/SignaturesPopup_Manage")}]}},{key:"emailFrom",get:function(){return this.props.data.addresses.from.email}},{key:"lang",get:function(){return this.props.services.settings.lang}},{key:"metrika",get:function(){return this.props.services.metrika}},{key:"isMobile",get:function(){return this.props.services.settings.isMobile}}]),t})(w.a.Component),S.propTypes={data:I.a.isRequired,visual:D.a.isRequired,services:N.a.isRequired,controllers:L.a.isRequired,onClose:k.a.func.isRequired,applySignature:k.a.func.isRequired},_=E,v(_.prototype,"emailFrom",[j.computed],Object.getOwnPropertyDescriptor(_.prototype,"emailFrom"),_.prototype),v(_.prototype,"lang",[j.computed],Object.getOwnPropertyDescriptor(_.prototype,"lang"),_.prototype),v(_.prototype,"metrika",[j.computed],Object.getOwnPropertyDescriptor(_.prototype,"metrika"),_.prototype),v(_.prototype,"isMobile",[j.computed],Object.getOwnPropertyDescriptor(_.prototype,"isMobile"),_.prototype),g=_))||g)||g},3696:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=r(n(137)),i=r(n(3697)),a=function(e){var t=e.handler,n=e.name;return o.default.createElement("div",{className:i.default.item,onClick:t},o.default.createElement("div",{className:i.default.text},n))};t.default=a},3697:function(e,t){e.exports={item:"SignatureOptionItem__item--1WWRo",text:"SignatureOptionItem__text--1epW_"}},3698:function(e,t,n){"use strict";function r(e,t,n,r){o||(o="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,a=arguments.length-3;if(t||0===a||(t={children:void 0}),1===a)t.children=r;else if(a>1){for(var c=new Array(a),s=0;s<a;s++)c[s]=arguments[s+3];t.children=c}if(t&&i)for(var u in i)void 0===t[u]&&(t[u]=i[u]);else t||(t=i||{});return{$$typeof:o,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}var o,i=n(137),a=(n.n(i),n(348)),c=n.n(a),s=n(350),u=n.n(s),l=n(140),p=(n.n(l),n(3699)),f=n.n(p),d=function(e){var t=e.handler,n=e.name,o=Object(i.useMemo)((function(){return n.replace(/\n/g," ").trim()}),[n]);return r("div",{className:u()(f.a.item,"qa-Compose-SignaturesPopup-Item"),onClick:t},void 0,r(l.Text,{typography:"body-long-m",className:f.a.text},void 0,o))};d.propTypes={name:c.a.string.isRequired,handler:c.a.func.isRequired},t.a=d},3699:function(e,t){e.exports={variables:'"../../../variables.m.css"',footerItemHeight:"36px",footerItemHorizontalPadding:"var(--space-m)",footerItemBackground:"var(--color-mg-tint-superlight)",item:"SignatureOptionItem__item--1z5Nd",text:"SignatureOptionItem__text--3a-T8"}},3700:function(e,t){},3701:function(e,t,n){"use strict";function r(){return r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},r.apply(this,arguments)}function o(e){"@babel/helpers - typeof";return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e){return s(e)||c(e)||a()}function a(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function c(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function s(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function p(e,t,n){return t&&l(e.prototype,t),n&&l(e,n),e}function f(e,t){return!t||"object"!==o(t)&&"function"!=typeof t?d(e):t}function d(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function y(e){return(y=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function b(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&m(e,t)}function m(e,t){return(m=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function h(e,t,n,r){P||(P="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=r;else if(i>1){for(var a=new Array(i),c=0;c<i;c++)a[c]=arguments[c+3];t.children=a}if(t&&o)for(var s in o)void 0===t[s]&&(t[s]=o[s]);else t||(t=o||{});return{$$typeof:P,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function v(e,t,n,r,o){var i={};return Object.keys(r).forEach((function(e){i[e]=r[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce((function(n,r){return r(e,t,n)||n}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}n.d(t,"a",(function(){return W}));var O,g,_,S,E,P,C=n(137),w=n.n(C),T=n(348),k=n.n(T),R=n(350),A=n.n(R),j=n(351),M=n(353),I=n(376),D=n(380),N=n(365),L=n(372),x=n(367),z=n(360),B=(n.n(z),n(3702)),F=n.n(B),U=n(1824),K="SignaturesPopupMenuNew",H={Block:K,SignaturesList:"".concat(K,"-SignaturesList"),Separator:"".concat(K,"-Separator")},W=(O=Object(M.inject)("data","visual","services","controllers"))(g=Object(M.observer)((E=S=(function(e){function t(){var e,n;u(this,t);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return n=f(this,(e=y(t)).call.apply(e,[this].concat(o))),n._openSettings=function(){n.props.onClose(),n.props.controllers.signatures.openSettings(),n._sendMetrika(z.COMPOSE_SIGNATURES_POPUP_GO_TO_SETTINGS)},n}return b(t,e),p(t,[{key:"_sendMetrika",value:function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];(e=this.metrika).sendMetrika.apply(e,[z.COMPOSE_METRIKA,z.COMPOSE_SIGNATURES_POPUP].concat(n))}},{key:"render",value:function(){return h("div",{className:A()(F.a.root,H.Block,"qa-Compose-SignaturesPopup")},void 0,this.renderSignatures(),this.renderMenuItems())}},{key:"renderSignatures",value:function(){var e=[this._createCleanSignatureItem()].concat(i(this._getUserSignatures()));return h("div",{className:A()(F.a.list,H.SignaturesList,"qa-Compose-SignaturesPopup-List")},void 0,e.map((function(e){return w.a.createElement(U.a,r({key:e.idx},e))})))}},{key:"renderMenuItems",value:function(){if(this.isMobile)return null;var e=this._getMenuItems();return w.a.createElement(w.a.Fragment,null,h("div",{className:A()(F.a.separator,H.Separator,"qa-Compose-SignaturesPopup-Separator")}),e.map((function(e){return w.a.createElement(U.a,r({key:e.idx},e))})))}},{key:"_applySignature",value:function(e){this.props.applySignature(e),this.props.onClose(),this._sendMetrika(e.html?z.COMPOSE_SIGNATURES_POPUP_CHANGE_SIGNATURE:z.COMPOSE_SIGNATURES_POPUP_WITHOUT_SIGNATURE),this.props.controllers.compose.complexityLogger.setSignatureWasChanged(!0)}},{key:"_createCleanSignatureItem",value:function(){var e=this;return{idx:-1,handler:function(){return e._applySignature({})},name:Object(x.default)("compose-react/SignaturesPopup_Empty")}}},{key:"_getUserSignatures",value:function(){var e=this,t=this.emailFrom,n=this.lang;return this.props.controllers.signatures.getSignatures(t,n).map((function(t){return{idx:t.idx,name:t.name,handler:function(){return e._applySignature(t)}}}))}},{key:"_getMenuItems",value:function(){return[{idx:"settings",handler:this._openSettings,name:Object(x.default)("compose-react/SignaturesPopup_Manage")}]}},{key:"emailFrom",get:function(){return this.props.data.addresses.from.email}},{key:"lang",get:function(){return this.props.services.settings.lang}},{key:"metrika",get:function(){return this.props.services.metrika}},{key:"isMobile",get:function(){return this.props.services.settings.isMobile}}]),t})(w.a.Component),S.propTypes={data:I.a.isRequired,visual:D.a.isRequired,services:N.a.isRequired,controllers:L.a.isRequired,onClose:k.a.func.isRequired,applySignature:k.a.func.isRequired},_=E,v(_.prototype,"emailFrom",[j.computed],Object.getOwnPropertyDescriptor(_.prototype,"emailFrom"),_.prototype),v(_.prototype,"lang",[j.computed],Object.getOwnPropertyDescriptor(_.prototype,"lang"),_.prototype),v(_.prototype,"metrika",[j.computed],Object.getOwnPropertyDescriptor(_.prototype,"metrika"),_.prototype),v(_.prototype,"isMobile",[j.computed],Object.getOwnPropertyDescriptor(_.prototype,"isMobile"),_.prototype),g=_))||g)||g},3702:function(e,t){e.exports={variables:'"../../../../variables.m.css"',footerPopupPadding:"var(--space-xs) 0",footerSeparatorHeight:"1px",footerSeparatorColor:"var(--color-mg-stroke-default-base)",footerSeparatorMargin:"var(--space-2-xs) var(--space-s)",root:"new__root--3X3wW",list:"new__list--23YqG",separator:"new__separator--1GSSu"}},3703:function(e,t,n){"use strict";function r(e){"@babel/helpers - typeof";return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t,n){return t&&c(e.prototype,t),n&&c(e,n),e}function u(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?l(e):t}function l(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function f(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&d(e,t)}function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function y(e,t,n,r){g||(g="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=r;else if(i>1){for(var a=new Array(i),c=0;c<i;c++)a[c]=arguments[c+3];t.children=a}if(t&&o)for(var s in o)void 0===t[s]&&(t[s]=o[s]);else t||(t=o||{});return{$$typeof:g,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}n.d(t,"a",(function(){return z})),n.d(t,"b",(function(){return B}));var b,m,h,v,O,g,_=n(137),S=n.n(_),E=n(348),P=n.n(E),C=n(350),w=n.n(C),T=n(353),k=n(351),R=n(503),A=n(376),j=n(372),M=n(380),I=n(563),D=n(368),N=n(455),L=n(3704),x=(n.n(L),"ComposeMoreButton"),z={Block:x,Popup:"".concat(x,"-Popup"),Promo:"".concat(x,"-Promo"),Icon:"".concat(x,"-Icon")},B=(b=Object(T.inject)("controllers","data","visual"))(m=Object(T.observer)((O=v=(function(e){function t(){return a(this,t),u(this,p(t).apply(this,arguments))}return f(t,e),s(t,[{key:"render",value:function(){var e=this.props,t=e.cls,n=e.isPopupVisible,r=e.withIconActiveState,o=n&&r?"mail--Compose-More_expanded":"mail--Compose-More";return y("div",{className:w()(z.Block,t)},void 0,y(N.a,{innerRef:this.props.innerRef,onMouseEnter:this.props.onMouseEnter,onMouseLeave:this.props.onMouseLeave,onClick:this.props.onClick,hasNotification:this.hasNotification,iconComponent:y(D.default,{id:o,cls:w()(z.Icon,i({},z.Icon+"_horizontal",this.props.isHorizontal))})}))}},{key:"hasNotification",get:function(){var e=this.props,t=e.data,n=e.visual;return this.props.controllers.visual.moreButtonOptions.some((function(e){return I.a[e]&&I.a[e]({data:t,visual:n})}))}}]),t})(S.a.Component),v.propTypes=(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e})({},R.a,{controllers:j.a.isRequired,data:A.a.isRequired,visual:M.a.isRequired,isHorizontal:P.a.bool,withIconActiveState:P.a.bool}),v.defaultProps={withIconActiveState:!0},h=O,(function(e,t,n,r,o){var i={};return Object.keys(r).forEach((function(e){i[e]=r[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce((function(n,r){return r(e,t,n)||n}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i})(h.prototype,"hasNotification",[k.computed],Object.getOwnPropertyDescriptor(h.prototype,"hasNotification"),h.prototype),m=h))||m)||m},3704:function(e,t){},3705:function(e,t,n){"use strict";function r(e){"@babel/helpers - typeof";return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}function c(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?s(e):t}function s(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function f(e,t,n,r){O||(O="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=r;else if(i>1){for(var a=new Array(i),c=0;c<i;c++)a[c]=arguments[c+3];t.children=a}if(t&&o)for(var s in o)void 0===t[s]&&(t[s]=o[s]);else t||(t=o||{});return{$$typeof:O,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function d(e,t,n,r,o){var i={};return Object.keys(r).forEach((function(e){i[e]=r[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce((function(n,r){return r(e,t,n)||n}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}n.d(t,"a",(function(){return x}));var y,b,m,h,v,O,g=n(137),_=n.n(g),S=n(350),E=n.n(S),P=n(351),C=n(353),w=n(1307),T=n(622),k=n(1304),R=n(1819),A=n(915),j=n(1303),M=n(356),I=n(1825),D=(n.n(I),E()(A.a.Button,A.a.ButtonNew)),N=Object(T.a)("compose-react/MoreOptions_AttachmentsDisk",R.a),L=Object(T.a)("compose-react/MoreOptions_AttachmentsMail",R.a),x=(y=Object(C.inject)("services","visual"))(b=Object(C.observer)((v=h=(function(e){function t(){return o(this,t),c(this,u(t).apply(this,arguments))}return l(t,e),a(t,[{key:"render",value:function(){return f("div",{className:E()(A.a.Block,"".concat(A.a.Block,"_desktop"))},void 0,f("div",{className:A.a.Part},void 0,f(w.a,{cls:E()("qa-QuickReply-SendButton",D,A.a.SendButton)}),f(k.b,{cls:E()("qa-QuickReply-AttachLocalFileButton",D)}),this.hasDisk&&f(N,{type:"disk",cls:E()("qa-QuickReply-AttachDiskFileButton",D)}),!this.isCorp&&f(L,{type:"mail",cls:E()("qa-QuickReply-AttachMailFileButton",D)})))}},{key:"hasDisk",get:function(){return this.props.services.attachments.hasDisk&&Object(M.hasSid)("59")}},{key:"isCorp",get:function(){return this.props.services.attachments.isCorp}}]),t})(_.a.Component),h.propTypes=j.a,m=v,d(m.prototype,"hasDisk",[P.computed],Object.getOwnPropertyDescriptor(m.prototype,"hasDisk"),m.prototype),d(m.prototype,"isCorp",[P.computed],Object.getOwnPropertyDescriptor(m.prototype,"isCorp"),m.prototype),b=m))||b)||b},3706:function(e,t){},3707:function(e,t,n){"use strict";function r(e){"@babel/helpers - typeof";return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}function c(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?s(e):t}function s(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function f(e,t,n,r){d||(d="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=r;else if(i>1){for(var a=new Array(i),c=0;c<i;c++)a[c]=arguments[c+3];t.children=a}if(t&&o)for(var s in o)void 0===t[s]&&(t[s]=o[s]);else t||(t=o||{});return{$$typeof:d,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}n.d(t,"a",(function(){return S}));var d,y=n(137),b=n.n(y),m=n(682),h=n(3708),v=n(479),O=(n.n(v),n(918)),g=n(920),_=n(3740),S=(n.n(_),(function(e){function t(){return o(this,t),c(this,u(t).apply(this,arguments))}return l(t,e),a(t,[{key:"render",value:function(){var e=this.props.attachment,t=e.info,n=e.previewSupported,r=t.class,o=Object(g.a)(t),i=t.folder,a=n?t.previewSrc:null,c=i?Object(O.b)():Object(O.a)(o,r),s=!i&&!Object(O.c)(g.a,r);return f("div",{className:"compose-AttachmentListItem"},void 0,f(h.a,{className:"compose-AttachmentListItem-Thumbnail",previewUrl:a,iconUrl:c,isDefaultIcon:s,extension:o}),f("div",{className:"compose-AttachmentListItem-Title"},void 0,f("div",{className:"compose-AttachmentListItem-Name"},void 0,t.name),this.maybeRenderFileSize()))}},{key:"maybeRenderFileSize",value:function(){var e=this.props.attachment.info;return e.folder?null:f("div",{className:"compose-AttachmentListItem-Size"},void 0,f(v.HumanFileSize,{bytes:e.size}))}}]),t})(b.a.PureComponent));S.propTypes={attachment:m.a.isRequired}},3708:function(e,t,n){"use strict";function r(e){"@babel/helpers - typeof";return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function c(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),e}function s(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?u(e):t}function u(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function p(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function d(e,t,n,r){y||(y="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=r;else if(i>1){for(var a=new Array(i),c=0;c<i;c++)a[c]=arguments[c+3];t.children=a}if(t&&o)for(var s in o)void 0===t[s]&&(t[s]=o[s]);else t||(t=o||{});return{$$typeof:y,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}n.d(t,"a",(function(){return S}));var y,b=n(137),m=n.n(b),h=n(350),v=n.n(h),O=n(348),g=n.n(O),_=n(3709),S=(n.n(_),(function(e){function t(){return i(this,t),s(this,l(t).apply(this,arguments))}return p(t,e),c(t,[{key:"render",value:function(){var e=this.props,t=e.previewUrl,n=e.iconUrl,r=e.className,i=e.isDefaultIcon,a=e.extension,c="compose-AttachmentThumbnail";return d("div",{className:v()(r,c)},void 0,d("img",{className:v()("".concat(c,"-Img"),o({},"".concat(c,"-Img_preview"),Boolean(t))),src:t||n,"data-fallback-src":n,"data-role":"js-browse-disk-thumbnail","data-clear-class":"".concat(c,"-Img_preview")}),i&&d("div",{className:"".concat(c,"-CustomExtension")},void 0,a))}}]),t})(m.a.PureComponent));S.propTypes={previewUrl:g.a.string,iconUrl:g.a.string,className:g.a.string,isDefaultIcon:g.a.bool,extension:g.a.string}},3709:function(e,t){},372:function(e,t,n){"use strict";var r=n(348),o=(n.n(r),n(1277));t.a=r.PropTypes.shape({avatars:r.PropTypes.instanceOf(o.c),compose:r.PropTypes.instanceOf(o.e),contactsSuggest:r.PropTypes.instanceOf(o.u),settings:r.PropTypes.instanceOf(o.r),selfRecipient:r.PropTypes.instanceOf(o.p),messageBody:r.PropTypes.instanceOf(o.j),attachments:r.PropTypes.instanceOf(o.a)})},3740:function(e,t){},3741:function(e,t,n){"use strict";function r(e){"@babel/helpers - typeof";return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}function c(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?s(e):t}function s(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function f(e,t,n,r){d||(d="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=r;else if(i>1){for(var a=new Array(i),c=0;c<i;c++)a[c]=arguments[c+3];t.children=a}if(t&&o)for(var s in o)void 0===t[s]&&(t[s]=o[s]);else t||(t=o||{});return{$$typeof:d,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}n.d(t,"a",(function(){return C}));var d,y=n(137),b=n.n(y),m=n(350),h=n.n(m),v=n(348),O=n.n(v),g=n(530),_=n(682),S=n(1834),E=n(3742),P=(n.n(E),O.a.shape({errorCode:O.a.number,title:O.a.oneOfType([O.a.element,O.a.string]),description:O.a.oneOfType([O.a.element,O.a.string]),items:g.a.arrayOf(_.a).isRequired})),C=(function(e){function t(){return o(this,t),c(this,u(t).apply(this,arguments))}return l(t,e),a(t,[{key:"render",value:function(){var e=this,t=this.props.errorGroups,n=1===t.length;return f("div",{className:h()("compose-AttachmentsErrors",{"compose-AttachmentsErrors_single":n})},void 0,t.map((function(t){return e.renderErrorGroup(t)})))}},{key:"renderErrorGroup",value:function(e){return f("div",{className:"compose-AttachmentsErrors-Group","data-key":e.errorCode},e.errorCode,f("div",{className:"compose-AttachmentsErrors-GroupHeader"},void 0,e.description),f(S.a,{attachments:e.items}))}}]),t})(b.a.PureComponent);C.propTypes={errorGroups:g.a.arrayOf(P).isRequired}},3742:function(e,t){},3743:function(e,t,n){"use strict";function r(e){"@babel/helpers - typeof";return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}function c(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?s(e):t}function s(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}n.d(t,"a",(function(){return h}));var f=n(137),d=n.n(f),y=n(348),b=n.n(y),m=n(1301),h=(n.n(m),(function(e){function t(){var e,n;o(this,t);for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return n=c(this,(e=u(t)).call.apply(e,[this].concat(i))),n.listRef=d.a.createRef(),n}return l(t,e),a(t,[{key:"componentDidUpdate",value:function(e){var t=e&&e.selectedIndex,n=this.props.selectedIndex;n!==t&&this._scrollToIndex(n)}},{key:"_scrollToIndex",value:function(e){var t=this.listRef.current;if(t){var n=this.props.itemHeight,r=Math.floor(t.scrollTop/n),o=t.offsetHeight/n;e>=r&&e<r+o||Object(m.scrollTo)(t,{top:e*n})}}},{key:"render",value:function(){var e=this.props,t=e.cls,n=e.children;return d.a.createElement("div",{ref:this.listRef,className:t},n)}}]),t})(d.a.Component));h.propTypes={cls:b.a.string,itemHeight:b.a.number.isRequired,selectedIndex:b.a.number.isRequired,children:b.a.oneOfType([b.a.element,b.a.arrayOf(b.a.element)]).isRequired}},3744:function(e,t,n){"use strict";function r(e){"@babel/helpers - typeof";return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}function c(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?s(e):t}function s(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}n.d(t,"a",(function(){return h}));var f,d=n(137),y=n.n(d),b=n(3745),m=(n.n(b),(function(e,t,n,r){f||(f="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=r;else if(i>1){for(var a=new Array(i),c=0;c<i;c++)a[c]=arguments[c+3];t.children=a}if(t&&o)for(var s in o)void 0===t[s]&&(t[s]=o[s]);else t||(t=o||{});return{$$typeof:f,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}})("div",{className:"lockScreen"})),h=(function(e){function t(){return o(this,t),c(this,u(t).apply(this,arguments))}return l(t,e),a(t,[{key:"componentDidMount",value:function(){document&&document.activeElement&&document.activeElement.blur()}},{key:"render",value:function(){return m}}]),t})(y.a.Component)},3745:function(e,t){},3746:function(e,t){},3747:function(e,t,n){"use strict";function r(e){"@babel/helpers - typeof";return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}function c(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?u(e):t}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function u(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function f(e,t,n,r){n&&Object.defineProperty(e,t,{enumerable:n.enumerable,configurable:n.configurable,writable:n.writable,value:n.initializer?n.initializer.call(r):void 0})}function d(e,t,n,r,o){var i={};return Object.keys(r).forEach((function(e){i[e]=r[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce((function(n,r){return r(e,t,n)||n}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}n.d(t,"a",(function(){return z}));var y,b,m,h,v,O,g,_,S=n(137),E=n.n(S),P=n(348),C=n.n(P),w=n(351),T=n(353),k=n(382),R=n(3748),A=n(372),j=n(376),M=n(365),I=n(502),D=n(360),N=(n.n(D),n(366)),L=(n.n(N),n(3754)),x=n(519),z=(n.n(x),(y=Object(T.inject)("data","controllers","services","visual"))(b=Object(T.observer)((_=g=(function(e){function t(){var e,n;o(this,t);for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return n=c(this,(e=s(t)).call.apply(e,[this].concat(i))),n.editorRef=E.a.createRef(),n.signaturesPopupRef=E.a.createRef(),n.disposer=new k.a,n.mailAutocomplete={getDraftId:function(){return n.props.data.overwriteIds||""},getMessageId:function(){return n.props.data.messageId},getThreadId:function(){return n.props.services.composeParams.relatedThreadId},toggleAutocomplete:function(){return null},getDebounceDelay:function(){return n.props.services.settings.autocompleteDelay}},n.focus=function(){var e=n.editorRef.current;e&&e.focus()},n.onEditorContentChange=function(e){var t=e.boundingRect;n.props.controllers.messageBody.dumpText({withRaw:n.props.visual.translate.isEnabled}),n.props.onChange&&t&&n.props.onChange(t)},n.onEditorInit=function(e){var t=e.dataProcessor,r=e.postTranslation;if(t){var o=n.htmlProcessorService;o.initDataProcessor(t),n.disposer.add(u(n),(function(){return o.resetDataProcessor()}))}n._initPostTranslation(r),n.props.onEditorInit&&n.props.onEditorInit()},n.onEditorDestroy=function(){n.htmlProcessorService.resetDataProcessor()},f(u(n),"_initPostTranslation",h,u(n)),n.onEditorToolbarCommandClick=function(e){n.metrikaService.sendWysiwigMetrika(D.EDITOR_TOOLBAR_COMMANDS_METRIKA[e])},f(u(n),"onEditorPopupStateChanged",v,u(n)),n.bootstrapSignaturesPopup=function(){if(n.signaturesPopupRef.current&&n.signaturesData){var e=n.signaturesPopupRef.current,t=n.signaturesData,r=t.isOpen,o=t.anchor,i=t.applySignature;e.applySignature=i,e.anchor=r?o:null}},n.onEditorFocus=function(){n.metrikaService.sendWysiwigMetrika(D.COMPOSE_METRIKA_WYSIWIG_BODY)},f(u(n),"onPasteFiles",O,u(n)),n.onToggleAutocomplete=function(e){e.previousValue!==n.settingsService.disableAutocompleteReact&&n.editorRef.current&&n.editorRef.current.toggleAutocomplete&&n.editorRef.current.toggleAutocomplete()},n.onInput=function(e){var t=e.inputType;e.selectionLength>0||(t!==N.InputTypes.INSERT_TEXT&&t!==N.InputTypes.INSERT_LINE_BREAK||n.complexityLogger.increaseBodyInsertCount(),t===N.InputTypes.DELETE_CONTENT_BACKWARD&&n.complexityLogger.increaseBodyDeleteCount())},n}return l(t,e),a(t,[{key:"componentDidMount",value:function(){var e=this;this.disposer.add(this,[this.settingsService.registerChangeSettingsHandler(this.onToggleAutocomplete,N.Settings.DISABLE_AUTOCOMPLETE_REACT),Object(w.reaction)((function(){return e.signaturesPopupRef.current}),this.bootstrapSignaturesPopup,{fireImmediately:!0}),Object(w.reaction)((function(){return e.props.data.signature}),(function(t){return e.signaturesData.applySignature(t)}))])}},{key:"componentWillUnmount",value:function(){this.disposer.dispose(this),this.props.services.signatures.reset()}},{key:"render",value:function(){var e=this;return E.a.createElement(E.a.Fragment,null,E.a.createElement(R.a,{ref:this.editorRef,cls:this.props.cls,placeholder:this.props.placeholder,toolbarNodeId:this.props.toolbarNodeId,getComposeContainerRef:function(){return e.composeContainerRef},getScrollableRef:function(){return e.composeScrollableRef},mailAutocomplete:this.mailAutocomplete,signatureMatches:this.signatureMatches,onEditorInit:this.onEditorInit,onEditorDestroy:this.onEditorDestroy,onChange:this.onEditorContentChange,onFocus:this.onEditorFocus,onKeyboardMove:this.props.onKeyboardMove,onPasteFiles:this.onPasteFiles,getInlineDropZone:this.props.getInlineDropZone,onToolbarCommandClick:this.onEditorToolbarCommandClick,onChildPopupStateChanged:this.onEditorPopupStateChanged,complexityLogger:this.complexityLogger,onInput:this.onInput,isCorp:this.props.services.attachments.isCorp,isMobile:this.props.services.settings.isMobile,isQuickReply:this.props.services.composeParams.params.isQuickReply,size:this.props.visual.size,messageBodyController:this.props.controllers.messageBody}),E.a.createElement(L.a,{ref:this.signaturesPopupRef}))}},{key:"messageBody",get:function(){return this.props.controllers.messageBody.text}},{key:"attachments",get:function(){return this.props.data.attachments}},{key:"composeContainerRef",get:function(){return this.props.visual.refs.composeContainer}},{key:"composeScrollableRef",get:function(){return this.props.visual.refs.composeScrollableContainer}},{key:"htmlProcessorService",get:function(){return this.props.services.htmlProcessor}},{key:"metrikaService",get:function(){return this.props.services.metrika}},{key:"attachmentsController",get:function(){return this.props.controllers.attachments}},{key:"hotkeysController",get:function(){return this.props.controllers.hotkeys}},{key:"settingsService",get:function(){return this.props.services.settings}},{key:"complexityLogger",get:function(){return this.props.controllers.compose.complexityLogger}},{key:"signatureMatches",get:function(){return this.props.services.signatures.getMatches()}}]),t})(E.a.Component),g.propTypes={placeholder:C.a.string,cls:C.a.string,data:j.a.isRequired,toolbarNodeId:C.a.string,controllers:A.a.isRequired,services:M.a.isRequired,visual:I.a.isRequired,onChange:C.a.func,onEditorInit:C.a.func,onKeyboardMove:C.a.func,getInlineDropZone:C.a.func},m=_,d(m.prototype,"messageBody",[w.computed],Object.getOwnPropertyDescriptor(m.prototype,"messageBody"),m.prototype),d(m.prototype,"attachments",[w.computed],Object.getOwnPropertyDescriptor(m.prototype,"attachments"),m.prototype),d(m.prototype,"composeContainerRef",[w.computed],Object.getOwnPropertyDescriptor(m.prototype,"composeContainerRef"),m.prototype),d(m.prototype,"composeScrollableRef",[w.computed],Object.getOwnPropertyDescriptor(m.prototype,"composeScrollableRef"),m.prototype),d(m.prototype,"htmlProcessorService",[w.computed],Object.getOwnPropertyDescriptor(m.prototype,"htmlProcessorService"),m.prototype),d(m.prototype,"metrikaService",[w.computed],Object.getOwnPropertyDescriptor(m.prototype,"metrikaService"),m.prototype),d(m.prototype,"attachmentsController",[w.computed],Object.getOwnPropertyDescriptor(m.prototype,"attachmentsController"),m.prototype),d(m.prototype,"hotkeysController",[w.computed],Object.getOwnPropertyDescriptor(m.prototype,"hotkeysController"),m.prototype),d(m.prototype,"settingsService",[w.computed],Object.getOwnPropertyDescriptor(m.prototype,"settingsService"),m.prototype),d(m.prototype,"complexityLogger",[w.computed],Object.getOwnPropertyDescriptor(m.prototype,"complexityLogger"),m.prototype),d(m.prototype,"signatureMatches",[w.computed],Object.getOwnPropertyDescriptor(m.prototype,"signatureMatches"),m.prototype),h=d(m.prototype,"_initPostTranslation",[w.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){e.props.visual.translate.postTranslation=t}}}),v=d(m.prototype,"onEditorPopupStateChanged",[w.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){var n=t.name,r=t.isOpen,o=t.anchor,i=t.applySignature;r?e.hotkeysController.suspend():e.hotkeysController.resume(),n===x.Popups.SIGNATURES&&(e.signaturesData={isOpen:r,anchor:o,applySignature:i},e.bootstrapSignaturesPopup())}}}),O=d(m.prototype,"onPasteFiles",[w.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){e.props.visual.workMode===N.WorkModes.FOREGROUND&&e.attachmentsController.attachFilesFromLocal(t)}}}),b=m))||b)||b)},3748:function(e,t,n){"use strict";var r=n(3749),o=n(3751),i=n(433);r.a.mode="ckeditor",o.a.mode="simple",t.a=Object(i.a)(r.a,o.a)},3749:function(e,t,n){"use strict";function r(e){"@babel/helpers - typeof";return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e,t,n){return t&&s(e.prototype,t),n&&s(e,n),e}function l(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?p(e):t}function p(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function d(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&y(e,t)}function y(e,t){return(y=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function b(e,t,n,r){m||(m="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=r;else if(i>1){for(var a=new Array(i),c=0;c<i;c++)a[c]=arguments[c+3];t.children=a}if(t&&o)for(var s in o)void 0===t[s]&&(t[s]=o[s]);else t||(t=o||{});return{$$typeof:m,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}n.d(t,"a",(function(){return A}));var m,h=n(138),v=n.n(h),O=n(137),g=n.n(O),_=n(350),S=n.n(_),E=n(519),P=(n.n(E),n(1836)),C=n(397),w=n.n(C),T=n(399),k=(n.n(T),n(3750)),R=(n.n(k),{Block:"ComposeMbodyCKEditor"}),A=(function(e){function t(){var e,n;c(this,t);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return n=l(this,(e=f(t)).call.apply(e,[this].concat(o))),n.editorId=v.a.uniqueId("editor"),n._tryInitCKEditor=function(){if(!n.editor)return void setTimeout(n._tryInitCKEditor,10)},n.focus=function(e){n.editor&&(e&&n.editor.container.$.contains(e.nativeEvent.target)||setTimeout((function(){return n.editor.focus()}),0))},n.onEditorInit=function(){var e=n.props.onEditorInit;n.onChange(),e&&e({dataProcessor:n.editor.dataProcessor,postTranslation:n.editor.plugins.collapsedQuotes.collapsedQuotes.processPostTranslation})},n.onEditorKey=function(e){var t=e.data,r=t.keyCode;if([w.a.UP,w.a.DOWN].includes(r)){var o=n.getNativeRect();n.props.onKeyboardMove&&n.props.onKeyboardMove({boundingRect:o,keyCode:r})}},n.onEditorFocused=function(){var e=n.props.onFocus;e&&e()},n.afterCommandExec=function(e){var t=n.props,r=t.onChildPopupStateChanged,o=t.onToolbarCommandClick,i=e.data.name;i===E.ToolbarCommands.ADD_LINK?r&&r({name:E.Popups.ADD_LINK,isOpen:!0}):-1!==E.ToolbarCommandsList.indexOf(i)&&o&&o(i)},n._onSignaturesPopupStateChange=function(e){var t=e.anchor,r=e.isOpen,o=e.applySignature,i=n.props.onChildPopupStateChanged;i&&i({name:E.Popups.SIGNATURES,isOpen:r,anchor:t,applySignature:o})},n.onLinkClosed=function(){var e=n.props.onChildPopupStateChanged;e&&e({name:E.Popups.ADD_LINK,isOpen:!1})},n.onInlineImagePopupStateChanged=function(e){var t=e.isOpen,r=n.props.onChildPopupStateChanged;r&&r({name:E.Popups.INLINE_IMAGE,isOpen:t})},n.onChange=function(){var e=n.props.onChange;e&&e({boundingRect:n.getNativeRect()})},n.onPasteFiles=function(e){var t=e.data.files,r=n.props.onPasteFiles;r&&r(t)},n.onInput=function(e){var t=e.data,r=t.inputType,o=t.selectionLength,i=t.keyCode,a=n.props.onInput;a&&a({inputType:r,selectionLength:o}),"insertText"!==r||i||n.onChange()},n}return d(t,e),u(t,[{key:"_getEventHandlers",value:function(){return{instanceReady:this.onEditorInit,change:this.onChange,afterCommandExec:this.afterCommandExec,"link:closed":this.onLinkClosed,focus:this.onEditorFocused,"pastefile:dropfile":this.onPasteFiles,"inputLogger:input":this.onInput,key:this.onEditorKey}}},{key:"_getCustomConfig",value:function(){var e=this,t={toolbar:"Max",toolbarStartupExpanded:!1,getComplexityLogger:function(){return e.props.complexityLogger},isMobile:this.props.isMobile};return this.props.toolbarNodeId&&(t.sharedSpaces={top:this.props.toolbarNodeId}),this.props.getInlineDropZone&&(t.getPasteFileInlineDropZone=this.props.getInlineDropZone),this.props.isQuickReply&&(t.pastefileDisableFile=!0,t.pastefileGetDropContext=function(e){return e.container.$},t.removePlugins="autogrow,resize,translate,mailAutocomplete"),t.composeContainer={getRef:this.props.getComposeContainerRef,getScrollableRef:this.props.getScrollableRef},t.mailAutocomplete=this.props.mailAutocomplete,t.signatures={popup:{stateChange:this._onSignaturesPopupStateChange},matches:this.props.signatureMatches},t.inlineImages={popup:{stateChange:this.onInlineImagePopupStateChanged,isEnabled:!this.props.isCorp}},t}},{key:"_getConfig",value:function(){var e={};CKEDITOR.editorConfig(e);var t=this._getEventHandlers(),n=this._getCustomConfig(),r=this.props.size===T.ComposeSizes.SMALL?CKEDITOR.ConfigFactory.COMPOSE_REACT_MIN:CKEDITOR.ConfigFactory.COMPOSE_REACT_MAX;return i({},e,{},CKEDITOR.ConfigFactory.getConfig(r,t,n,this),{title:this.props.placeholder})}},{key:"componentDidMount",value:function(){var e=this;this._tryInitCKEditor(),this.updateValue(this.messageBodyController.text),this.messageBodyController.connect({text:function(){return e.editor.getData()},raw:function(){return e.editor.fire("getRawData"),e.editor.getData()},onReplace:function(t){return e.updateValue(t)}})}},{key:"componentDidUpdate",value:function(e){this.props.size!==e.size&&(this.editor&&(this.editor.destroy(),this.props.onEditorDestroy()),CKEDITOR.replace(this.editorId,this._getConfig()))}},{key:"componentWillUnmount",value:function(){this.editor&&this.editor.destroy()}},{key:"getNativeRect",value:function(){var e=document.getSelection(),t=e&&e.rangeCount>0&&e.getRangeAt(0);if(t){if(0===t.getClientRects().length&&t.collapsed){var n=this.getClosestElement(t.commonAncestorContainer);return n&&n.getBoundingClientRect()}return t.getBoundingClientRect()}}},{key:"getClosestElement",value:function(e){return!e||e instanceof HTMLElement?e:e.parentElement}},{key:"toggleAutocomplete",value:function(){this.editor.execCommand("mailAutocomplete:toggle")}},{key:"render",value:function(){var e=this.props,t=e.placeholder,n=e.cls;return b("div",{className:S()(R.Block,n),onClick:this.focus,id:this.editorId,placeholder:t})}},{key:"updateValue",value:function(e){this.editor.setData(e)}},{key:"editor",get:function(){if(!CKEDITOR.instances[this.editorId])try{CKEDITOR.replace(this.editorId,this._getConfig())}catch(e){}return CKEDITOR.instances[this.editorId]}},{key:"messageBodyController",get:function(){return this.props.messageBodyController}}]),t})(g.a.Component);A.propTypes=P.b,A.defaultProps=P.a},3750:function(e,t){},3751:function(e,t,n){"use strict";function r(e){"@babel/helpers - typeof";return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}function c(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?s(e):t}function s(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function f(e){return b(e)||y(e)||d()}function d(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function y(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function b(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}function m(e){var t={contenteditable:!1,target:"_blank"};e.querySelectorAll("a").forEach((function(e){Object.keys(t).forEach((function(n){return e.setAttribute(n,t[n])}))}))}function h(e){var t=document.createElement("a");return t.setAttribute("href",e),t.innerHTML=e,t.outerHTML}function v(e){var t=e.match(M);return t?f(new Set(t)):[]}function O(e){e.childNodes.forEach((function(t){if("A"!==t.nodeName){if(t.nodeValue){var n=t.nodeValue,r=v(n);r.forEach((function(e){var t=new RegExp(e,"g");n=n.replace(t,h(e))})),r.length&&(t.nodeValue="",e.insertAdjacentHTML("afterbegin",n))}O(t)}}))}n.d(t,"a",(function(){return D}));var g=n(137),_=n.n(g),S=n(350),E=n.n(S),P=n(138),C=n.n(P),w=n(382),T=n(519),k=(n.n(T),n(1836)),R=n(3752),A=n(1230),j=n(3753),M=(n.n(j),new RegExp("(?!mailto:)(?:(?:http|https|ftp)://)(?:\\S+(?::\\S*)?@)?(?:(?:(?:[1-9]\\d?|1\\d\\d|2[01]\\d|22[0-3])(?:\\.(?:1?\\d{1,2}|2[0-4]\\d|25[0-5])){2}(?:\\.(?:[0-9]\\d?|1\\d\\d|2[0-4]\\d|25[0-4]))|(?:(?:[a-z\\u00a1-\\uffff0-9]+-?)*[a-z\\u00a1-\\uffff0-9]+)(?:\\.(?:[a-z\\u00a1-\\uffff0-9]+-?)*[a-z\\u00a1-\\uffff0-9]+)*(?:\\.(?:[a-z\\u00a1-\\uffff]{2,})))|localhost)(?::\\d{2,5})?(?:(/|\\?|#)[^\\s]*)?","ig")),I={Block:"ComposeMbodySimpleEditor",Contents:"".concat("ComposeMbodySimpleEditor","-Contents")},D=(function(e){function t(){var e,n;o(this,t);for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return n=c(this,(e=u(t)).call.apply(e,[this].concat(i))),n.disposer=new w.a,n.editorNode=_.a.createRef(),n.editorContainer=_.a.createRef(),n.state={isEmptyText:!1},n._onSignaturesPopupStateChange=function(e){var t=e.anchor,r=e.isOpen,o=e.applySignature,i=n.props.onChildPopupStateChanged;i&&i({name:T.Popups.SIGNATURES,isOpen:r,anchor:t,applySignature:o})},n.config={isMobile:n.props.isMobile,signatures:{popup:{stateChange:n._onSignaturesPopupStateChange},matches:n.props.signatureMatches}},n._onResize=function(){n.editor.emit("resize")},n.checkTextIsEmpty=function(){var e=n.editorNode.current.innerText,t=-1!==["","\r","\n","\r\n"].indexOf(e);n.state.isEmptyText!==t&&n.setState({isEmptyText:t})},n.focus=function(){n.editorNode.current&&n.editorNode.current.focus()},n.onChange=function(){n.checkTextIsEmpty(),n.props.onChange({boundingRect:null})},n.onInput=function(){n.editor.onInput()},n}return l(t,e),a(t,[{key:"shouldComponentUpdate",value:function(e,t){var n=C.a.isEqual(this.props,e),r=C.a.isEqual(this.state,t);return n||r}},{key:"initPlugins",value:function(){this.signaturesPlugin=new A.a(this.editor)}},{key:"componentDidMount",value:function(){var e=this,t=this.editorNode.current;if(this.editor=new R.a(this),this.disposer.add(this,(function(){return e.editor.destroy()})),this.initPlugins(),this.editor.setData(this.props.messageBodyController.text),this.editor.updateElement(),O(t),m(t),Modernizr.msie){var n=new MutationObserver(this.onChange);n.observe(t,{childList:!0,subtree:!0,characterData:!0}),this.disposer.add(this,(function(){return n.disconnect()}))}else t.addEventListener("input",this.onChange),this.disposer.add(this,(function(){return t.removeEventListener("input",e.onChange)}));this.props.onEditorInit&&this.props.onEditorInit({dataProcessor:{toHtml:function(e){return e}}}),this.checkTextIsEmpty(),this.props.messageBodyController.connect({text:function(){return e.editor.getData()},raw:function(){return e.editor.getData()},onReplace:function(t){return e.editor.setData(t)}}),this.disposer.addEventListener(this,{eventName:"resize",element:window,listener:this._onResize})}},{key:"componentWillUnmount",value:function(){this.disposer.dispose(this)}},{key:"render",value:function(){var e=this,t=this.props,n=t.placeholder,r=t.cls,o=t.onFocus,i=this.state.isEmptyText;return _.a.createElement("div",{ref:this.editorContainer,className:E()(I.Block,r)},_.a.createElement("div",{ref:this.editorNode,className:I.Contents,contentEditable:!0,onInput:this.onInput,onFocus:o,onKeyDown:function(t){return e.editor.onKeyDown(t)},placeholder:i?n:""}))}}]),t})(_.a.Component);D.propTypes=k.b,D.defaultProps=k.a},3752:function(e,t,n){"use strict";function r(e){"@babel/helpers - typeof";return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}function c(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?u(e):t}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function u(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}n.d(t,"a",(function(){return b}));var f=n(1228),d=n(397),y=n.n(d),b=(function(e){function t(e){var n;o(this,t),n=c(this,s(t).call(this)),n.onKeyDown=function(e){if(e.keyCode===y.a.BACKSPACE){var t={canceled:!1};n.emit("backspace",t),t.canceled&&e.preventDefault()}},n.editor=e;var r=n.on;return n.on=function(e,t){return r.call(u(n),e,t),function(){return n.off(e,t)}},n}return l(t,e),a(t,[{key:"beforeUpdateElement",value:function(e){this.updateElement=e}},{key:"getConfig",value:function(){return this.editor.config}},{key:"getContainer",value:function(){return this.editor.editorContainer&&this.editor.editorContainer.current}},{key:"getContents",value:function(){return this.editor.editorNode&&this.editor.editorNode.current}},{key:"getData",value:function(){var e={data:{dataValue:this.getContents().innerHTML}};return this.emit("getData",e),e.data.dataValue}},{key:"setData",value:function(e){var t={data:{dataValue:e}};this.emit("setData",t),this.getContents().innerHTML=t.data.dataValue,this.previousData&&this.previousData!==t.data.dataValue&&this.editor.onChange(),this.emit("change"),this.previousData=t.data.dataValue}},{key:"destroy",value:function(){this.emit("destroy")}},{key:"onInput",value:function(){this.emit("change"),this.editor.onChange()}}]),t})(f.a)},3753:function(e,t){},3754:function(e,t,n){"use strict";var r=n(3755);t.a=r.a},3755:function(e,t,n){"use strict";function r(){return r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},r.apply(this,arguments)}function o(e){"@babel/helpers - typeof";return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function c(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),e}function s(e,t){return!t||"object"!==o(t)&&"function"!=typeof t?l(e):t}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function l(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function p(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function d(e,t,n,r){P||(P="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=r;else if(i>1){for(var a=new Array(i),c=0;c<i;c++)a[c]=arguments[c+3];t.children=a}if(t&&o)for(var s in o)void 0===t[s]&&(t[s]=o[s]);else t||(t=o||{});return{$$typeof:P,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function y(e,t,n,r){n&&Object.defineProperty(e,t,{enumerable:n.enumerable,configurable:n.configurable,writable:n.writable,value:n.initializer?n.initializer.call(r):void 0})}function b(e,t,n,r,o){var i={};return Object.keys(r).forEach((function(e){i[e]=r[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce((function(n,r){return r(e,t,n)||n}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}n.d(t,"a",(function(){return F}));var m,h,v,O,g,_,S,E,P,C=n(137),w=n.n(C),T=n(348),k=n.n(T),R=n(351),A=n(353),j=n(367),M=n(380),I=n(376),D=n(365),N=n(372),L=n(382),x=n(621),z=n(360),B=(n.n(z),n(1823)),F=(m=Object(A.inject)("data","visual","services","controllers"),h=R.observable.ref,m(v=Object(A.observer)((E=S=(function(e){function t(){var e,n;i(this,t);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return n=s(this,(e=u(t)).call.apply(e,[this].concat(o))),y(l(n),"anchor",g,l(n)),n._disposer=new L.a,n.applySignature=n.props.onApplySignature,y(l(n),"onClose",_,l(n)),n}return p(t,e),c(t,[{key:"_sendMetrika",value:function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];(e=this.metrika).sendMetrika.apply(e,[z.COMPOSE_METRIKA,z.COMPOSE_SIGNATURES_POPUP].concat(n))}},{key:"componentDidMount",value:function(){var e=this;this._disposer.add(this,[Object(R.reaction)((function(){return e.anchor}),(function(t){t&&e._sendMetrika(z.COMPOSE_SIGNATURES_POPUP_OPEN)})),Object(R.reaction)((function(){return e.emailFrom}),(function(){return e._onFromChanged()}))])}},{key:"componentWillUnmount",value:function(){this._disposer.dispose(this)}},{key:"_onFromChanged",value:function(){var e=this.emailFrom,t=this.lang,n=this.props.controllers.signatures,r=n.getSignatures(e,t);r.length&&this.applySignature(r[0])}},{key:"render",value:function(){var e=this.onClose,t=this.isMobile?{direction:["bottom","top"]}:{direction:["top","right","left"]};return w.a.createElement(x.a,r({anchor:this.anchorRef,onClose:e,visible:this.visible,className:"SignaturesPopup",title:Object(j.default)("compose-react/SignaturesPopup_Title"),hasTail:!0},t),d(B.a,{onClose:e,applySignature:this.applySignature}))}},{key:"anchorRef",get:function(){return{current:this.anchor}}},{key:"visible",get:function(){return Boolean(this.anchor)}},{key:"isMobile",get:function(){return this.props.services.settings.isMobile}},{key:"composeContainerRef",get:function(){return this.props.visual.refs.composeContainer}},{key:"metrika",get:function(){return this.props.services.metrika}},{key:"emailFrom",get:function(){return this.props.data.addresses.from.email}}]),t})(w.a.Component),S.propTypes={data:I.a.isRequired,visual:M.a.isRequired,services:D.a.isRequired,controllers:N.a.isRequired,onApplySignature:k.a.func},S.defaultProps={onApplySignature:function(){}},O=E,g=b(O.prototype,"anchor",[h],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),b(O.prototype,"anchorRef",[R.computed],Object.getOwnPropertyDescriptor(O.prototype,"anchorRef"),O.prototype),b(O.prototype,"visible",[R.computed],Object.getOwnPropertyDescriptor(O.prototype,"visible"),O.prototype),b(O.prototype,"isMobile",[R.computed],Object.getOwnPropertyDescriptor(O.prototype,"isMobile"),O.prototype),b(O.prototype,"composeContainerRef",[R.computed],Object.getOwnPropertyDescriptor(O.prototype,"composeContainerRef"),O.prototype),b(O.prototype,"metrika",[R.computed],Object.getOwnPropertyDescriptor(O.prototype,"metrika"),O.prototype),b(O.prototype,"emailFrom",[R.computed],Object.getOwnPropertyDescriptor(O.prototype,"emailFrom"),O.prototype),_=b(O.prototype,"onClose",[R.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){e.anchor=null}}}),v=O))||v)||v)},3756:function(e,t,n){"use strict";function r(e){"@babel/helpers - typeof";return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function c(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),e}function s(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?l(e):t}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function l(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function p(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function d(e,t,n,r){E||(E="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=r;else if(i>1){for(var a=new Array(i),c=0;c<i;c++)a[c]=arguments[c+3];t.children=a}if(t&&o)for(var s in o)void 0===t[s]&&(t[s]=o[s]);else t||(t=o||{});return{$$typeof:E,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function y(e,t,n,r){n&&Object.defineProperty(e,t,{enumerable:n.enumerable,configurable:n.configurable,writable:n.writable,value:n.initializer?n.initializer.call(r):void 0})}function b(e,t,n,r,o){var i={};return Object.keys(r).forEach((function(e){i[e]=r[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce((function(n,r){return r(e,t,n)||n}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}n.d(t,"a",(function(){return G}));var m,h,v,O,g,_,S,E,P=n(137),C=n.n(P),w=n(348),T=n.n(w),k=n(351),R=n(353),A=n(350),j=n.n(A),M=n(372),I=n(365),D=n(1309),N=n(380),L=n(382),x=n(1838),z=n(3760),B=n(3782),F=n(360),U=(n.n(F),n(3783)),K=n(3784),H=(n.n(K),"ComposeRecipients"),W={Block:H,TopRow:"".concat(H,"-TopRow"),ToField:"".concat(H,"-ToField"),Expander:"".concat(H,"-Expander"),MultipleAddressField:"".concat(H,"-MultipleAddressField"),AdditionalAddresses:"".concat(H,"-AdditionalAddresses"),AdditionalAddresses_hidden:"".concat(H,"-AdditionalAddresses_hidden")},G=(m=Object(R.inject)("controllers","services","stores","visual"))(h=Object(R.observer)((S=_=(function(e){function t(e){var n;return i(this,t),n=s(this,u(t).call(this,e)),n._disposer=new L.a,n._afterUpdateQueue=[],y(l(n),"onToggleAdditionalAddresses",O,l(n)),y(l(n),"onModeChanged",g,l(n)),n.onFieldFocus=function(e,t){var r=e.fullName,o=e.metrika,i=e.ref;n.props.onFieldFocus&&n.props.onFieldFocus(r,i,t),o&&n.metrikaService.sendHeaderMetrika(o)},n.onFieldDragStart=function(e){n.props.onFieldDragStart&&n.props.onFieldDragStart(e)},n._fields=["to","cc","bcc","from"].reduce((function(e,t){return e[t]={field:t,fullName:"addresses.".concat(t),ref:C.a.createRef(),title:U.a[t],metrika:F.COMPOSE_HEADER_FIELDS_METRIKA[t]},e}),{}),n}return p(t,e),c(t,[{key:"componentDidMount",value:function(){var e=this;this._disposer.add(this,[Object(k.reaction)((function(){return e.props.isShowAdditionalAddresses}),this.onToggleAdditionalAddresses),Object(k.reaction)((function(){return e.props.isAddressesCollapsed}),this.onModeChanged)])}},{key:"componentDidUpdate",value:function(){this._afterUpdateQueue.forEach((function(e){return e()})),this._afterUpdateQueue=[]}},{key:"_afterUpdate",value:function(e){this._afterUpdateQueue.push(e)}},{key:"componentWillUnmount",value:function(){this._disposer.dispose(this)}},{key:"collapseField",value:function(e){this.props.visual.expandedFields[e]=!1}},{key:"render",value:function(){var e,t=this.props.isShowAdditionalAddresses,n=j()((e={},o(e,W.AdditionalAddresses,!0),o(e,W.AdditionalAddresses_hidden,!t),e));return d("div",{className:W.Block},void 0,this.renderTopRow(),d("div",{className:n},void 0,this.renderMultipleAddressField(this._fields.cc),this.renderMultipleAddressField(this._fields.bcc),this.renderFromField(this._fields.from)),this.props.children)}},{key:"renderTopRow",value:function(){return d("div",{className:W.TopRow},void 0,this.renderMultipleAddressField(this._fields.to,W.ToField),this.isMobile&&this.renderExpander())}},{key:"renderMultipleAddressField",value:function(e,t){var n=e.ref,r=e.field,o=e.title,i=e.fullName,a=e.isYabblesExpanded,c=this.onFieldFocus,s=this.onFieldDragStart;return d(z.a,{innerRef:n,cls:j()(W.MultipleAddressField,t),title:o,field:r,onDragStart:function(){return s(i)},onFocus:function(t){return c(e,t)},isYabblesExpanded:a},r)}},{key:"renderFromField",value:function(e){var t=e.ref,n=e.field,r=e.title,o=this.onFieldFocus;return d(B.a,{innerRef:t,title:r,onShow:function(){return o(e)}},n)}},{key:"renderExpander",value:function(){var e=this.props,t=e.isShowAdditionalAddresses,n=e.onToggleExpandedState;return d(x.a,{cls:W.Expander,isExpanded:t,onToggleExpanded:n})}},{key:"metrikaService",get:function(){return this.props.services.metrika}},{key:"contactsController",get:function(){return this.props.controllers.contacts}},{key:"composeParamsService",get:function(){return this.props.services.composeParams}},{key:"isMobile",get:function(){return this.props.services.settings.isMobile}},{key:"contactsStore",get:function(){return this.props.stores.contacts}}]),t})(C.a.Component),_.propTypes={isShowAdditionalAddresses:T.a.bool,isAddressesCollapsed:T.a.bool,controllers:M.a.isRequired,services:I.a.isRequired,stores:D.a.isRequired,visual:N.a.isRequired,onToggleExpandedState:T.a.func,onFieldFocus:T.a.func,onFieldDragStart:T.a.func},_.defaultProps={isShowAdditionalAddresses:!1,onToggleExpandedState:function(){return null}},v=S,b(v.prototype,"metrikaService",[k.computed],Object.getOwnPropertyDescriptor(v.prototype,"metrikaService"),v.prototype),b(v.prototype,"contactsController",[k.computed],Object.getOwnPropertyDescriptor(v.prototype,"contactsController"),v.prototype),b(v.prototype,"composeParamsService",[k.computed],Object.getOwnPropertyDescriptor(v.prototype,"composeParamsService"),v.prototype),b(v.prototype,"isMobile",[k.computed],Object.getOwnPropertyDescriptor(v.prototype,"isMobile"),v.prototype),O=b(v.prototype,"onToggleAdditionalAddresses",[k.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){var t=!e.props.isShowAdditionalAddresses;e._afterUpdate(Object(k.action)((function(){t?e.collapseField("to"):(e.collapseField("cc"),e.collapseField("bcc"))})))}}}),b(v.prototype,"collapseField",[k.action],Object.getOwnPropertyDescriptor(v.prototype,"collapseField"),v.prototype),g=b(v.prototype,"onModeChanged",[k.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){var t=e.props.isAddressesCollapsed;e._afterUpdate(Object(k.action)((function(){t&&e.collapseField("to")})))}}}),b(v.prototype,"contactsStore",[k.computed],Object.getOwnPropertyDescriptor(v.prototype,"contactsStore"),v.prototype),h=v))||h)||h},3757:function(e,t,n){"use strict";function r(e){"@babel/helpers - typeof";return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}function c(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?s(e):t}function s(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function f(e,t,n,r){v||(v="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=r;else if(i>1){for(var a=new Array(i),c=0;c<i;c++)a[c]=arguments[c+3];t.children=a}if(t&&o)for(var s in o)void 0===t[s]&&(t[s]=o[s]);else t||(t=o||{});return{$$typeof:v,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}n.d(t,"a",(function(){return N}));var d,y,b,m,h,v,O=n(137),g=n.n(O),_=n(348),S=n.n(_),E=n(350),P=n.n(E),C=n(353),w=n(351),T=n(365),k=n(1839),R=n.n(k),A=n(352),j=n(3759),M=(n.n(j),"ComposeRecipientsExpander"),I={Block:M,Block_mobile:"".concat(M,"_mobile"),Block_desktop:"".concat(M,"_desktop")},D=f(A.default,{loc:"compose-react/Header_Extra_Fields"}),N=(d=Object(C.inject)("services"))(y=Object(C.observer)((h=m=(function(e){function t(){return o(this,t),c(this,u(t).apply(this,arguments))}return l(t,e),a(t,[{key:"render",value:function(){var e=this.props,t=e.cls,n=e.isExpanded,r=e.onToggleExpanded,o=P()(t,I.Block,this.isMobile?I.Block_mobile:I.Block_desktop);return f(R.a,{cls:o,isExpanded:n,onClick:r},void 0,!this.isMobile&&D)}},{key:"isMobile",get:function(){return this.props.services.settings.isMobile}}]),t})(g.a.Component),m.propTypes={cls:S.a.string,isExpanded:S.a.bool,onToggleExpanded:S.a.func.isRequired,services:T.a.isRequired},b=h,(function(e,t,n,r,o){var i={};return Object.keys(r).forEach((function(e){i[e]=r[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce((function(n,r){return r(e,t,n)||n}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i})(b.prototype,"isMobile",[w.computed],Object.getOwnPropertyDescriptor(b.prototype,"isMobile"),b.prototype),y=b))||y)||y},3758:function(e,t){e.exports={icon:"components__icon--kVzwQ",expanded:"components__expanded--WwTIC"}},3759:function(e,t){},376:function(e,t,n){"use strict";var r=n(3541);n.d(t,"a",(function(){return r.a}))},3760:function(e,t,n){"use strict";function r(){return r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},r.apply(this,arguments)}function o(e){"@babel/helpers - typeof";return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function c(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),e}function s(e,t){return!t||"object"!==o(t)&&"function"!=typeof t?u(e):t}function u(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function p(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function d(e,t,n,r,o){var i={};return Object.keys(r).forEach((function(e){i[e]=r[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce((function(n,r){return r(e,t,n)||n}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}n.d(t,"a",(function(){return A}));var y,b,m,h,v,O=n(137),g=n.n(O),_=n(351),S=n(353),E=n(138),P=n.n(E),C=n(1310),w=n(3761),T=n(3780),k=n(433),R=Object(k.a)(w.a,T.a),A=(y=Object(S.inject)("data","visual","services"))(b=Object(S.observer)((v=h=(function(e){function t(){var e,n;i(this,t);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return n=s(this,(e=l(t)).call.apply(e,[this].concat(o))),n.onSelectSuggestContact=function(e){var t=n.props.field,r=n.suggestState,o=(r.contacts||[]).indexOf(e)+1||0;n.logSuggestService.logSuggestUsage({field:t,usedPosition:o,usedText:e.email},r)},n.onYabblesChanged=function(e){var t=n.props.field,r=(e||[]).map((function(e){return e.email})),o=(n.addresses||[]).map((function(e){return e.email})),i=P.a.difference(r,o);if(i.length){var a=i.join(",");n.logSuggestService.logSuggestUsage({field:t,usedText:a},n.suggestState)}},n}return p(t,e),c(t,[{key:"render",value:function(){var e=this.props,t=this.onSelectSuggestContact,n=this.onYabblesChanged;return g.a.createElement(R,r({},e,{onYabblesChanged:n,onSelectSuggestContact:t}))}},{key:"addresses",get:function(){var e=this.props,t=e.data,n=e.field;return t.addresses[n]}},{key:"logSuggestService",get:function(){return this.props.services.logSuggest}},{key:"suggestState",get:function(){return this.props.visual.contactsSuggest}}]),t})(g.a.Component),h.propTypes=C.b,m=v,d(m.prototype,"addresses",[_.computed],Object.getOwnPropertyDescriptor(m.prototype,"addresses"),m.prototype),d(m.prototype,"logSuggestService",[_.computed],Object.getOwnPropertyDescriptor(m.prototype,"logSuggestService"),m.prototype),d(m.prototype,"suggestState",[_.computed],Object.getOwnPropertyDescriptor(m.prototype,"suggestState"),m.prototype),b=m))||b)||b},3761:function(e,t,n){"use strict";function r(e){"@babel/helpers - typeof";return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t,n){return t&&c(e.prototype,t),n&&c(e,n),e}function u(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?p(e):t}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function p(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function f(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&d(e,t)}function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function y(e,t,n,r){N||(N="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=r;else if(i>1){for(var a=new Array(i),c=0;c<i;c++)a[c]=arguments[c+3];t.children=a}if(t&&o)for(var s in o)void 0===t[s]&&(t[s]=o[s]);else t||(t=o||{});return{$$typeof:N,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function b(e,t,n,r){n&&Object.defineProperty(e,t,{enumerable:n.enumerable,configurable:n.configurable,writable:n.writable,value:n.initializer?n.initializer.call(r):void 0})}function m(e,t,n,r,o){var i={};return Object.keys(r).forEach((function(e){i[e]=r[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce((function(n,r){return r(e,t,n)||n}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}n.d(t,"a",(function(){return oe}));var h,v,O,g,_,S,E,P,C,w,T,k,R,A,j,M,I,D,N,L=n(137),x=n.n(L),z=n(350),B=n.n(z),F=n(623),U=n.n(F),K=n(351),H=n(353),W=n(1310),G=n(444),Y=n(1309),q=n(1802),V=n(794),$=n.n(V),Q=n(1801),J=n(1840),X=n(1846),Z=n(367),ee=n(360),te=(n.n(ee),n(382)),ne=n(3779),re=(n.n(ne),{Block:"MultipleAddressesDesktop",Field:"".concat("MultipleAddressesDesktop","-Field")}),oe=(h=Object(H.inject)("data","visual","stores","services","controllers"))(v=Object(H.observer)((D=I=(function(e){function t(){var e,n;a(this,t);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return n=u(this,(e=l(t)).call.apply(e,[this].concat(o))),n._disposer=new te.a,n.fieldRef=x.a.createRef(),n.fieldControlRef=x.a.createRef(),n.fieldId=U()("compose-field-"),b(p(n),"suggestPosition",g,p(n)),b(p(n),"selectedYabbleRef",_,p(n)),b(p(n),"selectedContact",S,p(n)),b(p(n),"changeContactEmail",E,p(n)),n.onYabblesChanged=function(){var e;n.props.onYabblesChanged&&(e=n.props).onYabblesChanged.apply(e,arguments),n.closeSuggest(),n.closeYabblePopup()},b(p(n),"closeSuggest",P,p(n)),b(p(n),"closeYabblePopup",C,p(n)),n.convertContactToText=function(e){return{text:n.contactsFormatterService.contactToString(e),startOffset:1,endOffset:(e.name?e.name.length:e.email.length)+1}},b(p(n),"onClick",w,p(n)),b(p(n),"onInput",T,p(n)),b(p(n),"onSelectSuggestContact",k,p(n)),n.onSelectYabbleAddress=function(e,t){t.isGroup()||n.changeContactEmail(e,t.email),n.closeYabblePopup()},n.onTitleClick=function(){n.abookSource=ee.ABOOK_POPUP_SHOW_FIELD_TITLE,n.showAbookPopup()},n.showAbookPopup=function(){n.composeController.showAbookPopup({field:n.props.field,contacts:n.addresses,onAction:n.onAbookContactsSelected,onCancel:n.onAbookPopupClosed}),n.sendAbookMetrika(ee.ABOOK_POPUP_SHOW)},n.showAllContacts=function(){n.abookSource=ee.ABOOK_POPUP_SHOW_SUGGEST,n.closeSuggest(),n.showAbookPopup()},b(p(n),"onAbookContactsSelected",R,p(n)),n.onAbookPopupClosed=function(){n.focus()},b(p(n),"onYabbleClick",A,p(n)),n.onYabbleCopy=function(){n.closeYabblePopup(),n.metrikaService.sendHeaderMetrika(ee.COMPOSE_METRIKA_HEADER_YABBLE_POPUP,ee.COMPOSE_METRIKA_HEADER_YABBLE_POPUP_COPY)},n.onYabbleEdit=function(e){n.fieldControlRef.current&&n.fieldControlRef.current.editBubble({field:n.props.field,event:e,yabble:n.selectedYabbleRef}),n.closeYabblePopup(),n.metrikaService.sendHeaderMetrika(ee.COMPOSE_METRIKA_HEADER_YABBLE_POPUP,ee.COMPOSE_METRIKA_HEADER_YABBLE_POPUP_EDIT)},b(p(n),"onYabbleWriteOnly",j,p(n)),b(p(n),"onTopContentInFixedModeChanged",M,p(n)),n}return f(t,e),s(t,[{key:"focus",value:function(){this.composeController.focusComposeField(this.props.field)}},{key:"sendAbookMetrika",value:function(e){this.metrikaService.sendMetrika(ee.COMPOSE_METRIKA,ee.ABOOK_POPUP,e,this.abookSource,this.props.field)}},{key:"componentDidMount",value:function(){var e=this;this._disposer.add(this,[Object(K.reaction)((function(){return e.props.visual.topContentInFixedMode}),this.onTopContentInFixedModeChanged),Object(K.reaction)((function(){return e.selectedYabbleRef}),(function(t){e.props.visual.yabbleMenuPopup.field=t?e.props.field:""}))])}},{key:"componentWillUnmount",value:function(){this._disposer.dispose(this)}},{key:"render",value:function(){var e=B()(re.Block,this.props.cls,"tst-field-".concat(this.props.field));return x.a.createElement("div",{className:e,ref:this.props.innerRef},y($.a,{title:this.props.title,onTitleClick:this.onTitleClick,fieldId:this.fieldId},void 0,this.renderField()),this.renderYabblePopup())}},{key:"renderField",value:function(){var e=this;return x.a.createElement(X.a,{ref:this.fieldControlRef,cls:re.Field,convertContactToText:this.convertContactToText,field:this.props.field,fieldId:this.fieldId,innerRef:this.fieldRef,onClick:this.onClick,onFocus:this.props.onFocus,onInput:this.onInput,onYabbleClick:this.onYabbleClick,onDragStart:this.props.onDragStart,isDraggable:!0,onYabblesChanged:this.onYabblesChanged,onYabbleRemove:function(){return e.closeYabblePopup()},title:Object(Z.default)(this.props.title)},y(J.a,{field:this.props.field,anchor:this.fieldRef.current,position:this.suggestPosition,onClose:this.closeSuggest,onSelectContact:this.onSelectSuggestContact,onShowAllContacts:this.showAllContacts}))}},{key:"renderYabblePopup",value:function(){return this.selectedYabbleRef?y(q.a,{anchor:this.selectedYabbleRef,onClose:this.closeYabblePopup},void 0,y(Q.a,{contact:this.selectedContact,availableAddresses:this.availableAddresses,onSelectAddress:this.onSelectYabbleAddress,onCopy:this.onYabbleCopy,onEdit:this.onYabbleEdit,onWriteOnly:this.onYabbleWriteOnly})):null}},{key:"contactsFormatterService",get:function(){return this.props.services.contactsFormatter}},{key:"contactsController",get:function(){return this.props.controllers.contacts}},{key:"abookPopupController",get:function(){return this.props.controllers.abookPopup}},{key:"contactsStore",get:function(){return this.props.stores.contacts}},{key:"metrikaService",get:function(){return this.props.services.metrika}},{key:"suggestController",get:function(){return this.props.controllers.contactsSuggest}},{key:"composeController",get:function(){return this.props.controllers.compose}},{key:"composeContainerRef",get:function(){return this.props.visual.refs.composeContainer}},{key:"addresses",get:function(){var e=this.props,t=e.data,n=e.field;return t.addresses[n]}},{key:"allAddresses",get:function(){return this.props.data.addresses}},{key:"availableAddresses",get:function(){var e=this.selectedContact;return e?e.isLocal()?e.isValid()?[e]:[]:G.b.isGroupContact(e)?e.group.map((function(e){return{email:e.email,name:e.name}})):e.emailList?e.emailList.map((function(t){return{email:t,name:e.name}})):[e]:[]}}]),t})(x.a.Component),I.propTypes=(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e})({},W.a,{stores:Y.a.isRequired}),O=D,g=m(O.prototype,"suggestPosition",[K.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),_=m(O.prototype,"selectedYabbleRef",[K.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),S=m(O.prototype,"selectedContact",[K.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),m(O.prototype,"contactsFormatterService",[K.computed],Object.getOwnPropertyDescriptor(O.prototype,"contactsFormatterService"),O.prototype),m(O.prototype,"contactsController",[K.computed],Object.getOwnPropertyDescriptor(O.prototype,"contactsController"),O.prototype),m(O.prototype,"abookPopupController",[K.computed],Object.getOwnPropertyDescriptor(O.prototype,"abookPopupController"),O.prototype),m(O.prototype,"contactsStore",[K.computed],Object.getOwnPropertyDescriptor(O.prototype,"contactsStore"),O.prototype),m(O.prototype,"metrikaService",[K.computed],Object.getOwnPropertyDescriptor(O.prototype,"metrikaService"),O.prototype),m(O.prototype,"suggestController",[K.computed],Object.getOwnPropertyDescriptor(O.prototype,"suggestController"),O.prototype),m(O.prototype,"composeController",[K.computed],Object.getOwnPropertyDescriptor(O.prototype,"composeController"),O.prototype),m(O.prototype,"composeContainerRef",[K.computed],Object.getOwnPropertyDescriptor(O.prototype,"composeContainerRef"),O.prototype),m(O.prototype,"addresses",[K.computed],Object.getOwnPropertyDescriptor(O.prototype,"addresses"),O.prototype),m(O.prototype,"allAddresses",[K.computed],Object.getOwnPropertyDescriptor(O.prototype,"allAddresses"),O.prototype),m(O.prototype,"availableAddresses",[K.computed],Object.getOwnPropertyDescriptor(O.prototype,"availableAddresses"),O.prototype),E=m(O.prototype,"changeContactEmail",[K.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t,n){if(t!==n){var r=null,o=!1;e.addresses.forEach(Object(K.action)((function(e,i){e.email===n?r=i:e.email===t&&(o=!0)}))),o?e.addresses.splice(r,1):e.addresses[r]=e.contactsStore.findContactByEmail(t),e.metrikaService.sendHeaderMetrika(ee.COMPOSE_METRIKA_HEADER_YABBLE_POPUP,ee.COMPOSE_METRIKA_HEADER_YABBLE_POPUP_EMAIL)}}}}),P=m(O.prototype,"closeSuggest",[K.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){e.suggestController.closeSuggest(e.props.field)}}}),C=m(O.prototype,"closeYabblePopup",[K.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){e.selectedYabbleRef=null,e.composeContainerRef.contains(document.activeElement)||e.composeContainerRef.focus()}}}),w=m(O.prototype,"onClick",[K.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){e.suggestPosition=t,e.suggestController.searchPopular(e.props.field)}}}),T=m(O.prototype,"onInput",[K.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t,n){e.suggestPosition=n,e.suggestController.searchContacts(t,e.props.field)}}}),k=m(O.prototype,"onSelectSuggestContact",[K.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){e.props.onSelectSuggestContact&&e.props.onSelectSuggestContact(t),e.fieldControlRef.current&&e.fieldControlRef.current.addYabble({field:e.props.field,contact:t}),e.closeSuggest()}}}),R=m(O.prototype,"onAbookContactsSelected",[K.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){e.props.data.addresses[e.props.field]=t.map(Object(K.action)((function(e){return G.b.of(e)}))),e.focus()}}}),A=m(O.prototype,"onYabbleClick",[K.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t,n,r){e.selectedYabbleRef&&e.selectedYabbleRef.current===n.current?e.closeYabblePopup():(e.selectedYabbleRef=n,e.selectedContact=r)}}}),j=m(O.prototype,"onYabbleWriteOnly",[K.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){e.contactsController.setSingleRecipient({email:e.selectedContact.email}),e.closeYabblePopup(),e.metrikaService.sendHeaderMetrika(ee.COMPOSE_METRIKA_HEADER_YABBLE_POPUP,ee.COMPOSE_METRIKA_HEADER_YABBLE_POPUP_WRITE_ONLY)}}}),M=m(O.prototype,"onTopContentInFixedModeChanged",[K.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){t&&(e.selectedYabbleRef=null,e.closeSuggest())}}}),v=O))||v)||v},3762:function(e,t,n){"use strict";function r(e){"@babel/helpers - typeof";return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}function c(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?u(e):t}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function u(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function f(e,t,n,r){P||(P="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=r;else if(i>1){for(var a=new Array(i),c=0;c<i;c++)a[c]=arguments[c+3];t.children=a}if(t&&o)for(var s in o)void 0===t[s]&&(t[s]=o[s]);else t||(t=o||{});return{$$typeof:P,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function d(e,t,n,r){n&&Object.defineProperty(e,t,{enumerable:n.enumerable,configurable:n.configurable,writable:n.writable,value:n.initializer?n.initializer.call(r):void 0})}function y(e,t,n,r,o){var i={};return Object.keys(r).forEach((function(e){i[e]=r[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce((function(n,r){return r(e,t,n)||n}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}n.d(t,"a",(function(){return W}));var b,m,h,v,O,g,_,S,E,P,C=n(137),w=n.n(C),T=n(353),k=n(351),R=n(1841),A=n.n(R),j=n(505),M=(n.n(j),n(397)),I=n.n(M),D=n(1843),N=n(621),L=n(1844),x=n(427),z=n(352),B=n(140),F=(n.n(B),n(3770)),U=(n.n(F),"ComposeContactsSuggestDesktop"),K={Block:U,Content:"".concat(U,"-Content"),List:"".concat(U,"-List"),Separator:"".concat(U,"-Separator"),Action:"".concat(U,"-Action"),IconMore:"".concat(U,"-IconMore")},H=f(z.default,{loc:"compose-react/Show_All_Contacts"}),W=(b=Object(T.inject)("controllers","visual"))(m=Object(T.observer)((E=S=(function(e){function t(){var e,n;o(this,t);for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return n=c(this,(e=s(t)).call.apply(e,[this].concat(i))),n._popupDirections=["bottom-start","bottom","bottom-end"],n._disposer=new j.Disposer,d(u(n),"position",v,u(n)),d(u(n),"selectedContactIndex",O,u(n)),d(u(n),"onHoverContact",g,u(n)),n.onKeyDown=function(e){if(n.visible)switch(e.keyCode){case I.a.UP:n.switchSelectedContactIndex(-1,e);break;case I.a.DOWN:n.switchSelectedContactIndex(1,e);break;case I.a.ENTER:case I.a.TAB:n.selectCurrentContact()}},n.onVisibilityChanged=function(){n.visible?n._disposer.add("active",[Object(j.addEventListener)({eventName:"keydown",listener:n.onKeyDown,isCapture:!0}),Object(j.addEventListener)({eventName:"resize",listener:n.onResize})]):n._disposer.dispose("active")},n.onResize=A()((function(){return n.updateSuggestPosition()}),200),d(u(n),"updateSuggestPosition",_,u(n)),n}return l(t,e),a(t,[{key:"selectCurrentContact",value:function(){var e=this.props.onSelectContact;e&&this.selectedContact&&e(this.selectedContact)}},{key:"switchSelectedContactIndex",value:function(e,t){t.preventDefault(),t.stopPropagation(),this.selectedContactIndex=(this.selectedContactIndex+e+this.suggestContacts.length)%this.suggestContacts.length}},{key:"componentDidMount",value:function(){var e=this;this._disposer.add(this,[Object(k.reaction)((function(){return e.visible}),this.onVisibilityChanged),Object(k.reaction)((function(){return e.props.position}),this.updateSuggestPosition,{fireImmediately:!0,equals:k.comparer.structural})])}},{key:"componentWillUnmount",value:function(){this._disposer.dispose(this)}},{key:"getSuggestPosition",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{left:0},t=e.left,n=this.props.anchor.getBoundingClientRect();return{top:n.bottom,left:t+n.left}}},{key:"render",value:function(){var e=this;return this.visible&&this.position?f(N.a,{scope:this.composeContainerRef,className:K.Block,direction:this._popupDirections,onClose:this.props.onClose,position:this.position,visible:!0,enableFocusTrap:!1},void 0,f("div",{className:K.Content},void 0,f(L.a,{cls:K.List,query:this.suggest.query,selectedContactIndex:this.selectedContactIndex,contacts:this.suggestContacts,onSelectContact:this.props.onSelectContact,onHoverContact:this.onHoverContact}),!this.props.visual.isInIframe&&w.a.createElement(w.a.Fragment,null,f("div",{className:K.Separator}),f(B.Text,{typography:"body-long-m",className:K.Action,onMouseDown:function(e){return e.preventDefault()},onMouseEnter:function(){return e.onHoverContact(null)},onClick:this.props.onShowAllContacts},void 0,f(x.a,{cls:K.IconMore,id:"mail--Compose-MoreContacts"}),H)))):null}},{key:"suggestController",get:function(){return this.props.controllers.contactsSuggest}},{key:"suggest",get:function(){return this.props.visual.contactsSuggest}},{key:"suggestContacts",get:function(){var e=this.props.field;return this.suggestController.getSuggestContacts(e)}},{key:"visible",get:function(){return Boolean(this.suggestContacts.length)}},{key:"composeContainerRef",get:function(){return this.props.visual.composeContainerRef}},{key:"selectedContact",get:function(){return this.selectedContactIndex>=0&&this.selectedContactIndex<this.suggestContacts.length?this.suggestContacts[this.selectedContactIndex]:null}}]),t})(w.a.Component),S.propTypes=D.a,h=E,v=y(h.prototype,"position",[k.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),O=y(h.prototype,"selectedContactIndex",[k.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),y(h.prototype,"suggestController",[k.computed],Object.getOwnPropertyDescriptor(h.prototype,"suggestController"),h.prototype),y(h.prototype,"suggest",[k.computed],Object.getOwnPropertyDescriptor(h.prototype,"suggest"),h.prototype),y(h.prototype,"suggestContacts",[k.computed],Object.getOwnPropertyDescriptor(h.prototype,"suggestContacts"),h.prototype),y(h.prototype,"visible",[k.computed],Object.getOwnPropertyDescriptor(h.prototype,"visible"),h.prototype),y(h.prototype,"composeContainerRef",[k.computed],Object.getOwnPropertyDescriptor(h.prototype,"composeContainerRef"),h.prototype),y(h.prototype,"selectedContact",[k.computed],Object.getOwnPropertyDescriptor(h.prototype,"selectedContact"),h.prototype),g=y(h.prototype,"onHoverContact",[k.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){e.selectedContactIndex=e.suggestContacts.indexOf(t)}}}),y(h.prototype,"switchSelectedContactIndex",[k.action],Object.getOwnPropertyDescriptor(h.prototype,"switchSelectedContactIndex"),h.prototype),_=y(h.prototype,"updateSuggestPosition",[k.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){e.props.position&&e.props.anchor&&(e.position=e.getSuggestPosition(e.props.position))}}}),m=h))||m)||m},3764:function(e,t,n){"use strict";var r=n(3765),o=n(3767),i=n(433);t.a=Object(i.a)(r.a,o.a)},3765:function(e,t,n){"use strict";function r(e){"@babel/helpers - typeof";return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function c(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),e}function s(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?u(e):t}function u(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function p(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function d(e,t,n,r){y||(y="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=r;else if(i>1){for(var a=new Array(i),c=0;c<i;c++)a[c]=arguments[c+3];t.children=a}if(t&&o)for(var s in o)void 0===t[s]&&(t[s]=o[s]);else t||(t=o||{});return{$$typeof:y,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}n.d(t,"a",(function(){return C}));var y,b=n(137),m=n.n(b),h=n(350),v=n.n(h),O=n(618),g=n(1845),_=n(140),S=(n.n(_),n(3766)),E=(n.n(S),"ContactsSuggestItemDesktop"),P={Block:E,Block_active:"".concat(E,"_active"),Avatar:"".concat(E,"-Avatar"),Name:"".concat(E,"-Name"),Email:"".concat(E,"-Email")},C=(function(e){function t(){return i(this,t),s(this,l(t).apply(this,arguments))}return p(t,e),c(t,[{key:"render",value:function(){var e=this.props,t=e.cls,n=e.contact,r=e.isActive,i=this.props.formatContact(n),a=i.email,c=i.name;return d("div",{className:v()(t,P.Block,o({},P.Block_active,r)),onMouseDown:function(e){return e.preventDefault()},onClick:this.props.onClick,onMouseEnter:this.props.onMouseEnter},void 0,d(O.a,{cls:P.Avatar,contact:n}),d(_.Text,{typography:"body-long-m",className:P.Name},void 0,c),d(_.Text,{typography:"body-long-m",color:"secondary",className:P.Email},void 0,a))}}]),t})(m.a.PureComponent);C.propTypes=g.a},3766:function(e,t){},3767:function(e,t,n){"use strict";function r(e){"@babel/helpers - typeof";return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function c(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),e}function s(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?u(e):t}function u(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function p(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function d(e,t,n,r){y||(y="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=r;else if(i>1){for(var a=new Array(i),c=0;c<i;c++)a[c]=arguments[c+3];t.children=a}if(t&&o)for(var s in o)void 0===t[s]&&(t[s]=o[s]);else t||(t=o||{});return{$$typeof:y,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}n.d(t,"a",(function(){return P}));var y,b=n(137),m=n.n(b),h=n(350),v=n.n(h),O=n(618),g=n(1845),_=n(3768),S=(n.n(_),"ContactsSuggestItemMobile"),E={Block:S,Block_active:"".concat(S,"_active"),Avatar:"".concat(S,"-Avatar"),Content:"".concat(S,"-Content"),Name:"".concat(S,"-Name"),Email:"".concat(S,"-Email")},P=(function(e){function t(){return i(this,t),s(this,l(t).apply(this,arguments))}return p(t,e),c(t,[{key:"render",value:function(){var e,t=this.props,n=t.cls,r=t.contact,i=t.isActive,a=this.props.formatContact(r),c=a.email,s=a.name;return d("div",{className:v()((e={},o(e,n,!0),o(e,E.Block,!0),o(e,E.Block_active,i),e)),onMouseDown:function(e){return e.preventDefault()},onClick:this.props.onClick},void 0,d(O.a,{cls:E.Avatar,contact:r}),d("div",{className:E.Content},void 0,d("div",{className:E.Name},void 0,s),d("div",{className:E.Email},void 0,c)))}}]),t})(m.a.PureComponent);P.propTypes=g.a},3768:function(e,t){},3769:function(e,t){},3770:function(e,t){},3771:function(e,t,n){"use strict";function r(e){"@babel/helpers - typeof";return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}function c(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?s(e):t}function s(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function f(e,t,n,r){O||(O="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=r;else if(i>1){for(var a=new Array(i),c=0;c<i;c++)a[c]=arguments[c+3];t.children=a}if(t&&o)for(var s in o)void 0===t[s]&&(t[s]=o[s]);else t||(t=o||{});return{$$typeof:O,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function d(e,t,n,r,o){var i={};return Object.keys(r).forEach((function(e){i[e]=r[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce((function(n,r){return r(e,t,n)||n}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var y,b,m,h,v,O,g=n(137),_=n.n(g),S=n(141),E=n.n(S),P=n(353),C=n(351),w=n(1843),T=n(1844),k=n(1300),R=n(3772),A=(n.n(R),{Block:"ComposeContactsSuggestMobile"}),j=(y=Object(P.inject)("controllers","visual"))(b=Object(P.observer)((v=h=(function(e){function t(){var e,n;o(this,t);for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return n=c(this,(e=u(t)).call.apply(e,[this].concat(i))),n.containerRef=_.a.createRef(),n}return l(t,e),a(t,[{key:"render",value:function(){if(!this.visible)return null;var e=this.props,t=e.scope,n=e.position,r=n&&n.top,o=r?{top:r}:null;return E.a.createPortal(_.a.createElement("div",{ref:this.containerRef,className:A.Block,style:o},f(T.a,{query:this.suggest.query,contacts:this.suggestContacts,onSelectContact:this.props.onSelectContact,onClose:this.props.onClose})),t)}},{key:"suggestController",get:function(){return this.props.controllers.contactsSuggest}},{key:"suggest",get:function(){return this.props.visual.contactsSuggest}},{key:"suggestContacts",get:function(){var e=this.props.field;return this.suggestController.getSuggestContacts(e)}},{key:"visible",get:function(){return this.suggestContacts.length}}]),t})(_.a.Component),h.propTypes=w.a,m=v,d(m.prototype,"suggestController",[C.computed],Object.getOwnPropertyDescriptor(m.prototype,"suggestController"),m.prototype),d(m.prototype,"suggest",[C.computed],Object.getOwnPropertyDescriptor(m.prototype,"suggest"),m.prototype),d(m.prototype,"suggestContacts",[C.computed],Object.getOwnPropertyDescriptor(m.prototype,"suggestContacts"),m.prototype),d(m.prototype,"visible",[C.computed],Object.getOwnPropertyDescriptor(m.prototype,"visible"),m.prototype),b=m))||b)||b;t.a=Object(k.a)(j)},3772:function(e,t){},3773:function(e,t,n){"use strict";function r(e){return a(e)||i(e)||o()}function o(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function i(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function a(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e,t,n){return t&&s(e.prototype,t),n&&s(e,n),e}n.d(t,"a",(function(){return C}));var l=n(138),p=n.n(l),f=n(141),d=n.n(f),y=n(397),b=n.n(y),m=n(382),h=n(444),v=n(3774),O=n(87),g=(n.n(O),n(1827)),_=n(440),S=(n.n(_),n(381)),E="yabble-removed",P=Object(S.cnTheme)(_.PS_LIGHT).split(" "),C=(function(){function e(t){var n=this;c(this,e),this.onYabbleEdit=function(e,t){n.element.focus(),setTimeout((function(){n.element.editBubble(t.current.parentNode),Object(v.a)(n.element)}),0)},this.onYabbleRemove=function(e){var t=n._getParentBubble(e.target);n.element.removeBubble(t)},this.onWindowResize=function(){n.previousWidth&&n.node.clientWidth!==n.previousWidth&&(n.node.clientWidth>n.previousWidth&&n.showYabbles(!0),n.hideYabbles())},this.initializeBubbles=function(){var e=n.element=document.createElement("div",{is:"x-bubbles"});n.node.firstElementChild?n.node.insertBefore(e,n.node.firstElementChild):n.node.appendChild(e),e.className="composeYabbles",e.options("bubbleCopy",n.onBubbleCopy),e.options("bubbleFormation",n.onBubbleFormation),e.options("bubbleDeformation",n.onBubbleDeformation),e.options("checkBubblePaste",(function(){return!1})),e.options("lineBreakReplacer","; "),e.setAttribute("is","x-bubbles"),e.setAttribute("data-selection","true"),e.setAttribute("data-class-bubble","yabble-compose js-yabble"),e.setAttribute("data-separator",""),e.setAttribute("contenteditable","true"),e.setAttribute("id",n.id),e.setAttribute("title",n.title),e.setAttribute("aria-label",n.title),n.addNodeEvent(e,"focus",n.onFocus),n.addNodeEvent(e,"blur",n.onBlur),n.addNodeEvent(e,"keyup",n.onKeyUp),n.addNodeEvent(e,"change",n.onBubblesChanged),n.addNodeEvent(e,"before-remove",n.onBubbleRemove),n.addNodeEvent(e,"mousedown",n.onMouseDownCapture,!0),n.addNodeEvent(e,"click",n.onClick),n.draggable&&(n.addNodeEvent(e,"dragstart",n.onDragStart),n.addNodeEvent(e,"dragend",n.onDragEnd)),n.addNodeEvent(window,"resize",n.onWindowResize)},this.addNodeEvent=function(e,t,r){for(var o=arguments.length,i=new Array(o>3?o-3:0),a=3;a<o;a++)i[a-3]=arguments[a];e.addEventListener.apply(e,[t,r].concat(i)),n.disposer.add(n,[function(){return e.removeEventListener.apply(e,[t,r].concat(i))}])},this.onDragStart=function(e){if(1===n.getBubbles().filter((function(e){return e.hasAttribute("selected")})).length&&e.dataTransfer&&e.dataTransfer.setDragImage){if(n.dragElement=e.target.cloneNode(!0),n.dragElement.classList.add("compose-yabble-drag-image"),!Object(O.hasFeature)(O.Features.WEB_DARK_COMPOSE)){var t;(t=n.dragElement.classList).add.apply(t,r(P))}document.body.appendChild(n.dragElement),e.dataTransfer.setDragImage(n.dragElement,20,20)}n.events.onDragStart&&n.events.onDragStart()},this.onDragEnd=function(){n.dragElement&&(document.body.removeChild(n.dragElement),n.dragElement=null)},this.moveCursorToEnd=function(){var e=document.createRange();e.selectNodeContents(n.element),e.collapse(!1);var t=window.getSelection();t.removeAllRanges(),t.addRange(e)},this.onMoreYabbleClick=function(){n.element.bubbling(),n.element.blur(),setTimeout((function(){return n.element.focus()}))},this.onBubbleCopy=function(e){return e.map((function(e){var t=n.contactsStore.findContactByEmail(e.getAttribute("data-email"));return n.formatterService.contactToString(t)})).join(", ")},this.onBubbleFormation=function(e){n.isEditing=!1,n.formatterService.parseContacts(e.textContent.trim()).forEach((function(t,r){var o=0===r?e:document.createElement("span");0!==r&&(o.setAttribute("bubble",""),o.setAttribute("contenteditable",!1),o.className="js-yabble yabble-compose",n.element.appendChild(o)),n._processUserInput(t,o)}))},this.onYabbleMounted=function(){n.yabblesToMount-=1,n.isYabblesExpanded||0!==n.yabblesToMount||n.hideYabbles()},this.onBubbleDeformation=function(e){n.isEditing=!0,d.a.unmountComponentAtNode(e);var t=e.getAttribute("data-email"),r=n.contactsStore.findContactByEmail(t),o=n.convertContactToText(r);return r.isLocal()&&n.contactsStore.deleteContactByEmail(t),n.element.focus(),o},this.onBubbleRemove=function(e){e.detail.data.forEach((function(e){d.a.unmountComponentAtNode(e);var t=n.contactsStore.findContactByEmail(e.getAttribute("data-email"));e.innerText=n.formatterService.contactToString(t),e.classList.add(E,"is-hidden"),t&&t.isLocal()&&n.contactsStore.deleteContactByEmail(t.email)})),document.activeElement===n.element&&setTimeout((function(){return n.reFocus()})),n.refreshHiddenYabbles(),n.clearDrag(),n.events.onInternalYabbleRemove&&n.events.onInternalYabbleRemove()},this.onBlur=function(e){n.events.onBlur&&n.events.onBlur(e)},this.onFocus=function(e){n.yabbleClicked||(n.showYabbles(),n.events.onFocus(e))},this.onMouseDownCapture=function(e){document.activeElement!==n.element&&(e.target===n.element||n.showMoreYabblesNode&&n.showMoreYabblesNode.contains(e.target)||(n.yabbleClicked=!0))},this.onClick=function(e){if(e.target===n.element){var t=n.element.editor.inputValue().trim();t?n.events.onInput(t):n.events.onClick()}n.yabbleClicked&&(n.element.blur(),n.yabbleClicked=!1)},this.onBubblesChanged=function(){n.isEditing=!1;var e=n.getBubbles();e.filter((function(e){return e.classList.contains(E)})).forEach((function(e){n.onBubbleFormation(e),e.classList.remove(E,"is-hidden")}));for(var t=n.getContacts(),r=e.length-1;r>=0;r--)for(var o=t[r],i=0;i<r;i++){var a=t[i];if(a.email===o.email){var c=e[r];d.a.unmountComponentAtNode(c),c.parentNode===n.element&&n.element.removeChild(c)}}n.events.onBubblesChanged(n.getContacts()),n.clearDrag()},this.onKeyUp=function(e){[b.a.UP,b.a.DOWN,b.a.TAB,b.a.SHIFT,b.a.ESC,b.a.ENTER,b.a.CTRL].concat(r(b.a.META)).indexOf(e.keyCode)>=0||n.events.onInput(n.element.editor.inputValue().trim())},this.node=t.node,this.name=t.name,this.canHideYabbles=t.canHideYabbles,this.contactsStore=t.contactsStore,this.convertContactToText=t.convertContactToText,this.formatterService=t.formatterService,this.renderYabble=t.renderYabble,this.renderShowMoreYabble=t.renderShowMoreYabble,this.isEditing=!1,this.disposer=new m.a,this.isYabblesExpanded=t.isYabblesExpanded||!1,this.draggable=t.draggable||!1,this.id=t.id,this.title=t.title,this.events={onFocus:t.onFocus,onBlur:t.onBlur,onClick:t.onClick,onInput:t.onInput,onBubblesChanged:t.onBubblesChanged,onDragStart:t.onDragStart,onInternalYabbleRemove:t.onInternalYabbleRemove,onBubblesExpanded:t.onBubblesExpanded},this.initializeBubbles()}return u(e,[{key:"destroyBubbles",value:function(){var e=this.element;this.disposer.dispose(this),this._cleanupBubbles(this.getBubbles()),this.node.removeChild(e)}},{key:"syncYabbles",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=this.getBubbles();if(this._haveBubblesChanges(n,t)){this.destroyShowMoreYabbles(),this.yabblesToMount=t.length;var r=this._createBubblesHash(n);t.forEach((function(t){return e._tryAttachBubbleFromHash(t,r)})),this._cleanupBubbles(p.a.values(r)),this.refreshHiddenYabbles()}}},{key:"_haveBubblesChanges",value:function(e,t){var n=e.map((function(e){return e.getAttribute("data-email")})),r=t.map((function(e){return e.email}));return!p.a.isEqual(n,r)}},{key:"_createBubblesHash",value:function(e){var t={};return e.forEach((function(e){t[e.getAttribute("data-email")]=e})),t}},{key:"_tryAttachBubbleFromHash",value:function(e,t){var n=e.email,r=t[n];r?(this.element.appendChild(r),delete t[n],this.yabblesToMount-=1):this.addYabbleSilently(e)}},{key:"_cleanupBubbles",value:function(e){var t=this;e.forEach((function(e){d.a.unmountComponentAtNode(e),t.element.removeChild(e)}))}},{key:"createShowMoreYabbles",value:function(e,t){var n=this.getBubbles().filter((function(e){return e.classList.contains("is-hidden")})),r=!n.find((function(e){return e.children[0]&&e.children[0].classList.contains("ComposeYabble_invalid")})),o=this.showMoreYabblesNode=document.createElement("span");o.setAttribute("bubble",""),o.setAttribute("contenteditable","false"),o.className="yabble-compose yabble-compose_more js-yabble-more",this.changeShowMoreYabblesVisibility(!1),this.element.appendChild(o),d.a.render(this.renderShowMoreYabble({count:e,onClick:this.onMoreYabbleClick,setTargetRef:this.setTargetRef,isValid:r}),o,t)}},{key:"changeShowMoreYabblesVisibility",value:function(e){this.showMoreYabblesNode&&(this.showMoreYabblesNode.style.opacity=e?"1":"0")}},{key:"destroyShowMoreYabbles",value:function(){this.showMoreYabblesNode&&(d.a.unmountComponentAtNode(this.showMoreYabblesNode),this.element.removeChild(this.showMoreYabblesNode),this.showMoreYabblesNode=null)}},{key:"calculateAndAddShowMoreYabblesCount",value:function(e){var t=this,n=this.getActualBubbles().reduce((function(e,t){return t.classList.contains("is-hidden")?++e:e}),0);this.destroyShowMoreYabbles(),n>0&&this.createShowMoreYabbles(n,(function(){t.changeShowMoreYabblesVisibility(!0),e&&e()}))}},{key:"showYabbles",value:function(e){var t=this.getActualBubbles();this.destroyShowMoreYabbles(),this.clearYabbleOverflow(),t.length>0&&(t.forEach((function(e){return e.classList.remove("is-hidden")})),t[0].removeAttribute("style")),e||this.moveCursorToEnd(),this.isYabblesExpanded=!0,e||this.events.onBubblesExpanded&&this.events.onBubblesExpanded()}},{key:"reFocus",value:function(){document.activeElement===this.element&&this.element.blur(),this.element.focus()}},{key:"hideYabbles",value:function(){var e=this;!(function t(){var n=e.getActualBubbles();if(n.length){var r=n[0],o=Object(g.a)({elements:n,hiddenClass:"is-hidden",summary:e.showMoreYabblesNode});if(-1!==o.indexOf(r)&&(o.splice(0,1),e.hasYabbleOverflow=!0),o.length)o.forEach((function(e){return e.classList.add("is-hidden")})),e.calculateAndAddShowMoreYabblesCount(t);else if(e.previousWidth=e.node.clientWidth,e.isYabblesExpanded=!1,document.activeElement===e.element&&document.activeElement.blur(),e.hasYabbleOverflow){var i=e.showMoreYabblesNode.offsetWidth;r.classList.add("js-yabble-overflow");var a=r.firstChild;a&&(a.style.maxWidth="calc(100% - ".concat(16,"px - ").concat(i,"px)")),e.hasYabbleOverflow=!1}}})()}},{key:"clearYabbleOverflow",value:function(){var e=this.getActualBubbles();if(e.length){var t=e[0];t.classList.contains("js-yabble-overflow")&&(t.classList.remove("js-yabble-overflow"),t.firstChild&&(t.firstChild.style.maxWidth=null))}}},{key:"addYabble",value:function(e){this.element.addBubble(this.formatterService.contactToString(e),{email:e.email})}},{key:"addYabbleSilently",value:function(e){var t=document.createElement("span");this.contactsStore.writeContact(e),t.setAttribute("data-email",e.email),t.setAttribute("bubble",""),t.setAttribute("contenteditable",!1),t.setAttribute("draggable",this.draggable),t.className="js-yabble yabble-compose",t.innerText=this.formatterService.contactToString(e),this.element.appendChild(t),this.onBubbleFormation(t)}},{key:"_updateContactForEmail",value:function(e){var t=e.email,n=this.contactsStore.findContactByEmail(t);return n||(n=h.b.of(e),this.contactsStore.writeContact(n)),e.name&&e.name!==n.name&&(n.name=e.name),n}},{key:"_processUserInput",value:function(e,t){var n=this._updateContactForEmail(e);return t.setAttribute("data-email",n.email),d.a.render(this.renderYabble({contact:n}),t,this.onYabbleMounted),t}},{key:"_getParentBubble",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5,n=0,r=e;++n<=t;){if(r.hasAttribute("bubble"))return r;r=r.parentNode}return null}},{key:"refreshHiddenYabbles",value:function(){this.isYabblesExpanded||(this.showYabbles(!0),this.hideYabbles())}},{key:"clearDrag",value:function(){this.element.classList.remove("dropzone"),this.element.classList.remove("drag"),this.yabbleClicked=!1,this.onDragEnd()}},{key:"getBubbles",value:function(){return Array.prototype.slice.call(this.element.childNodes).filter((function(e){return e.nodeType===Node.ELEMENT_NODE&&!e.classList.contains("js-yabble-more")}))}},{key:"getActualBubbles",value:function(){return this.getBubbles().filter((function(e){return!e.classList.contains(E)}))}},{key:"getContacts",value:function(){var e=this;return this.getBubbles().map((function(t){return e._updateContactForEmail({email:t.getAttribute("data-email")})}))}},{key:"getText",value:function(){return this.element.textContent.trim().replace(/\u200B/g,"")}},{key:"isEmpty",value:function(){return 0===this.getText().length}}]),e})()},3774:function(e,t,n){"use strict";t.a=function(e){var t=e.firstChild;t&&t.nodeType===Node.TEXT_NODE&&8203===t.data.charCodeAt(0)&&t.remove()}},3775:function(e,t,n){"use strict";function r(e){"@babel/helpers - typeof";return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}function c(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?s(e):t}function s(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function f(e,t,n,r){d||(d="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=r;else if(i>1){for(var a=new Array(i),c=0;c<i;c++)a[c]=arguments[c+3];t.children=a}if(t&&o)for(var s in o)void 0===t[s]&&(t[s]=o[s]);else t||(t=o||{});return{$$typeof:d,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}n.d(t,"a",(function(){return C}));var d,y=n(137),b=n.n(y),m=n(348),h=n.n(m),v=n(353),O=n(386),g=n(618),_=n(1847),S=n(368),E=n(795),P=f(S.default,{id:"mail--Compose-RemoveYabble",focusable:!1}),C=(function(e){function t(){return o(this,t),c(this,u(t).apply(this,arguments))}return l(t,e),a(t,[{key:"render",value:function(){var e=this.props,t=e.avatars,n=e.contact,r=e.lang,o=e.onClick,i=e.onRemove;return f(v.Provider,{controllers:{avatars:t}},void 0,f(O.default,{lang:r},void 0,f(E.a,{nodeRef:this.props.innerRef,AvatarComponent:g.a,ContentComponent:_.a,getContact:function(){return n},removeIcon:P,isEditable:!0,onClick:o,onRemove:i})))}}]),t})(b.a.PureComponent);C.propTypes={avatars:h.a.object,contact:h.a.object,innerRef:h.a.object,lang:h.a.string,onClick:h.a.func,onRemove:h.a.func}},3776:function(e,t,n){"use strict";function r(){return r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},r.apply(this,arguments)}function o(e){"@babel/helpers - typeof";return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){if(null==e)return{};var n,r,o=a(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function a(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e,t,n){return t&&s(e.prototype,t),n&&s(e,n),e}function l(e,t){return!t||"object"!==o(t)&&"function"!=typeof t?p(e):t}function p(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function d(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&y(e,t)}function y(e,t){return(y=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function b(e,t,n,r){m||(m="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=r;else if(i>1){for(var a=new Array(i),c=0;c<i;c++)a[c]=arguments[c+3];t.children=a}if(t&&o)for(var s in o)void 0===t[s]&&(t[s]=o[s]);else t||(t=o||{});return{$$typeof:m,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}n.d(t,"a",(function(){return T}));var m,h=n(137),v=n.n(h),O=n(348),g=n.n(O),_=n(386),S=n(795),E=n(352),P=n(427),C=n(3777),w=(n.n(C),{Block:"ComposeShowMoreYabble",Icon:"".concat("ComposeShowMoreYabble","-Icon")}),T=(function(e){function t(){return c(this,t),l(this,f(t).apply(this,arguments))}return d(t,e),u(t,[{key:"render",value:function(){var e=this.props,t=e.count,n=e.lang,o=i(e,["count","lang"]),a=function(){return b("div",{className:w.Block},void 0,b(E.default,{loc:"compose-react/More_N",params:{count:t}}),b(P.a,{cls:w.Icon,id:"mail--ComposeReact-Expand"}))};return b(_.default,{lang:n},void 0,v.a.createElement(S.a,r({ContentComponent:a,isEditable:!1},o)))}}]),t})(v.a.PureComponent);T.propTypes={count:g.a.number,lang:g.a.string}},3777:function(e,t){},3778:function(e,t){},3779:function(e,t){},3780:function(e,t,n){"use strict";function r(e){"@babel/helpers - typeof";return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}function c(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?u(e):t}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function u(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function f(e,t,n,r){w||(w="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=r;else if(i>1){for(var a=new Array(i),c=0;c<i;c++)a[c]=arguments[c+3];t.children=a}if(t&&o)for(var s in o)void 0===t[s]&&(t[s]=o[s]);else t||(t=o||{});return{$$typeof:w,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function d(e,t,n,r){n&&Object.defineProperty(e,t,{enumerable:n.enumerable,configurable:n.configurable,writable:n.writable,value:n.initializer?n.initializer.call(r):void 0})}function y(e,t,n,r,o){var i={};return Object.keys(r).forEach((function(e){i[e]=r[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce((function(n,r){return r(e,t,n)||n}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}n.d(t,"a",(function(){return K}));var b,m,h,v,O,g,_,S,E,P,C,w,T=n(137),k=n.n(T),R=n(350),A=n.n(R),j=n(351),M=n(353),I=n(1310),D=n(794),N=n.n(D),L=n(1840),x=n(1846),z=n(360),B=(n.n(z),n(3781)),F=(n.n(B),"MultipleAddressesMobile"),U={Block:F,Field:"".concat(F,"-Field"),SuggestContainer:"".concat(F,"-SuggestContainer")},K=(b=Object(M.inject)("data","services","controllers","visual"))(m=Object(M.observer)((C=P=(function(e){function t(){var e,n;o(this,t);for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return n=c(this,(e=s(t)).call.apply(e,[this].concat(i))),n.fieldRef=k.a.createRef(),d(u(n),"suggestPosition",v,u(n)),d(u(n),"closeSuggest",O,u(n)),n.onYabblesChanged=function(){var e;n.suggestPosition=n.getSuggestPosition(),n.props.onYabblesChanged&&(e=n.props).onYabblesChanged.apply(e,arguments),n.closeSuggest()},n.convertContactToText=function(e){var t=e.email;return{text:t,startOffset:t.length,endOffset:t.length}},d(u(n),"onClick",g,u(n)),d(u(n),"onInput",_,u(n)),d(u(n),"onSelectSuggestContact",S,u(n)),n.onTitleClick=function(){n.composeController.focusComposeField(n.props.field)},d(u(n),"onYabbleClick",E,u(n)),n.getSuggestPosition=function(){var e=n.props.innerRef.current;return e?{top:e.offsetTop+e.clientHeight}:null},n}return l(t,e),a(t,[{key:"render",value:function(){var e=A()(U.Block,this.props.cls);return k.a.createElement("div",{className:e,ref:this.props.innerRef},f(N.a,{title:this.props.title,onTitleClick:this.onTitleClick},void 0,k.a.createElement(x.a,{ref:this.fieldRef,cls:U.Field,convertContactToText:this.convertContactToText,field:this.props.field,onClick:this.onClick,onFocus:this.props.onFocus,onInput:this.onInput,onYabbleClick:this.onYabbleClick,onYabblesChanged:this.onYabblesChanged})),f(L.a,{field:this.props.field,onClose:this.closeSuggest,onSelectContact:this.onSelectSuggestContact,scope:this.props.visual.refs.topContent,position:this.suggestPosition}))}},{key:"contactsController",get:function(){return this.props.controllers.contacts}},{key:"metrikaService",get:function(){return this.props.services.metrika}},{key:"suggestController",get:function(){return this.props.controllers.contactsSuggest}},{key:"composeController",get:function(){return this.props.controllers.compose}},{key:"addresses",get:function(){var e=this.props,t=e.data,n=e.field;return t.addresses[n]}},{key:"allAddresses",get:function(){return this.props.data.addresses}},{key:"contacts",get:function(){var e=this;return this.addresses.map((function(t){return e.contactsController.replaceLoadedContact(t)}))}}]),t})(k.a.Component),P.propTypes=I.a,h=C,v=y(h.prototype,"suggestPosition",[j.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),y(h.prototype,"contactsController",[j.computed],Object.getOwnPropertyDescriptor(h.prototype,"contactsController"),h.prototype),y(h.prototype,"metrikaService",[j.computed],Object.getOwnPropertyDescriptor(h.prototype,"metrikaService"),h.prototype),y(h.prototype,"suggestController",[j.computed],Object.getOwnPropertyDescriptor(h.prototype,"suggestController"),h.prototype),y(h.prototype,"composeController",[j.computed],Object.getOwnPropertyDescriptor(h.prototype,"composeController"),h.prototype),y(h.prototype,"addresses",[j.computed],Object.getOwnPropertyDescriptor(h.prototype,"addresses"),h.prototype),y(h.prototype,"allAddresses",[j.computed],Object.getOwnPropertyDescriptor(h.prototype,"allAddresses"),h.prototype),y(h.prototype,"contacts",[j.computed],Object.getOwnPropertyDescriptor(h.prototype,"contacts"),h.prototype),O=y(h.prototype,"closeSuggest",[j.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){e.suggestController.closeSuggest(e.props.field)}}}),g=y(h.prototype,"onClick",[j.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){setTimeout(Object(j.action)((function(){e.suggestPosition=e.getSuggestPosition(),e.suggestController.searchPopular(e.props.field)})),0)}}}),_=y(h.prototype,"onInput",[j.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){e.suggestPosition=e.getSuggestPosition(),e.suggestController.searchContacts(t,e.props.field)}}}),S=y(h.prototype,"onSelectSuggestContact",[j.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){e.props.onSelectSuggestContact&&e.props.onSelectSuggestContact(t),e.fieldRef.current&&e.fieldRef.current.addYabble({field:e.props.field,contact:t}),e.closeSuggest()}}}),E=y(h.prototype,"onYabbleClick",[j.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t,n){e.fieldRef.current&&e.fieldRef.current.editBubble({field:e.props.field,event:t,yabble:n}),e.metrikaService.sendHeaderMetrika(z.COMPOSE_METRIKA_HEADER_YABBLE_POPUP,z.COMPOSE_METRIKA_HEADER_YABBLE_POPUP_EDIT)}}}),m=h))||m)||m},3781:function(e,t){},3782:function(e,t,n){"use strict";var r=n(1798);n.d(t,"a",(function(){return r.a}))},3783:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r={to:"compose-react/Header_Addresses_To",cc:"compose-react/Header_Addresses_Cc",bcc:"compose-react/Header_Addresses_Bcc",from:"compose-react/Header_Addresses_From"}},3784:function(e,t){},3785:function(e,t,n){"use strict";var r=n(3786);t.a=r.a},3786:function(e,t,n){"use strict";function r(e){"@babel/helpers - typeof";return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}function c(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?u(e):t}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function u(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function f(e,t,n,r){P||(P="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=r;else if(i>1){for(var a=new Array(i),c=0;c<i;c++)a[c]=arguments[c+3];t.children=a}if(t&&o)for(var s in o)void 0===t[s]&&(t[s]=o[s]);else t||(t=o||{});return{$$typeof:P,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function d(e,t,n,r){n&&Object.defineProperty(e,t,{enumerable:n.enumerable,configurable:n.configurable,writable:n.writable,value:n.initializer?n.initializer.call(r):void 0})}function y(e,t,n,r,o){var i={};return Object.keys(r).forEach((function(e){i[e]=r[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce((function(n,r){return r(e,t,n)||n}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}n.d(t,"a",(function(){return B}));var b,m,h,v,O,g,_,S,E,P,C=n(137),w=n.n(C),T=n(353),k=n(351),R=n(382),A=n(397),j=n.n(A),M=n(3787),I=n(621),D=n(3788),N=n(366),L=(n.n(N),n(3790)),x=(n.n(L),"ComposeSmartSubjectSuggestDesktop"),z={Block:x,Content:"".concat(x,"-Content"),List:"".concat(x,"-List"),Separator:"".concat(x,"-Separator"),Action:"".concat(x,"-Action"),IconMore:"".concat(x,"-IconMore")},B=(b=Object(T.inject)("controllers","data","visual"))(m=Object(T.observer)((E=S=(function(e){function t(){var e,n;o(this,t);for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return n=c(this,(e=s(t)).call.apply(e,[this].concat(i))),n._disposer=new R.a,n.direction=["bottom-start","bottom","bottom-end"],d(u(n),"selectedIndex",v,u(n)),n.onClickItem=function(e){n.selectItem(e),n.focusComposeBody()},d(u(n),"onHoverItem",O,u(n)),n.onKeyDown=function(e){if(n.visible)switch(e.keyCode){case j.a.UP:n.switchSelectedIndex(-1===n.selectedIndex?0:-1,e);break;case j.a.DOWN:n.switchSelectedIndex(1,e);break;case j.a.ENTER:n.selectCurrent(),n.focusComposeBody();break;case j.a.TAB:n.selectCurrent()}},d(u(n),"selectItem",g,u(n)),n.focusComposeBody=function(){n.props.controllers.compose.focusComposeField("body")},n._onOutsideClick=function(e,t){"click"===t&&e.target===n.props.anchor||n.closeSuggest()},d(u(n),"closeSuggest",_,u(n)),n}return l(t,e),a(t,[{key:"selectCurrent",value:function(){this.selectItem(this.selectedItem)}},{key:"switchSelectedIndex",value:function(e,t){t.preventDefault(),t.stopPropagation(),this.selectedIndex=(this.selectedIndex+e+this.items.length)%this.items.length}},{key:"resetSelectedIndex",value:function(){this.selectedIndex=-1}},{key:"componentDidMount",value:function(){var e=this;this._disposer.addEventListener(this,{element:document,eventName:"keydown",listener:this.onKeyDown,isCapture:!0}),this._disposer.add(this,[Object(k.reaction)((function(){return e.subject}),(function(t){e.props.anchor!==document.activeElement||t||e.props.controllers.smartSubject.getSmartSubjectsForInput()})),Object(k.reaction)((function(){return e.visible}),(function(t){t&&e.resetSelectedIndex()}))])}},{key:"componentWillUnmount",value:function(){this._disposer.dispose(this)}},{key:"_getSuggestPosition",value:function(){var e=this.props.anchor.getBoundingClientRect();return{top:e.bottom,left:e.left}}},{key:"render",value:function(){var e=this.props,t=e.scope,n=e.anchor;if(!t||!this.visible)return null;var r=n?this._getSuggestPosition():{};return f(I.a,{className:z.Block,direction:this.direction,onClose:this._onOutsideClick,position:r,visible:!0},void 0,f("div",{className:z.Content},void 0,f(D.a,{cls:z.List,highlight:this.subject,selectedIndex:this.selectedIndex,items:this.items,onClickItem:this.onClickItem,onHoverItem:this.onHoverItem})))}},{key:"subject",get:function(){return this.props.data.subject}},{key:"suggest",get:function(){return this.props.visual.subjectsSuggest}},{key:"items",get:function(){var e=this;return this.subject?this.suggest.suggestItems.filter((function(t){return(t.text||"").indexOf(e.subject)>=0})):this.suggest.suggestItems}},{key:"visible",get:function(){return Boolean(this.suggest.suggestType===N.SmartSubjectType.INPUT&&this.items.length)}},{key:"composeContainerRef",get:function(){return this.props.visual.refs.composeContainer}},{key:"selectedItem",get:function(){return this.selectedIndex>=0&&this.selectedIndex<this.items.length?this.items[this.selectedIndex]:null}}]),t})(w.a.Component),S.propTypes=M.a,h=E,v=y(h.prototype,"selectedIndex",[k.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return-1}}),y(h.prototype,"subject",[k.computed],Object.getOwnPropertyDescriptor(h.prototype,"subject"),h.prototype),y(h.prototype,"suggest",[k.computed],Object.getOwnPropertyDescriptor(h.prototype,"suggest"),h.prototype),y(h.prototype,"items",[k.computed],Object.getOwnPropertyDescriptor(h.prototype,"items"),h.prototype),y(h.prototype,"visible",[k.computed],Object.getOwnPropertyDescriptor(h.prototype,"visible"),h.prototype),y(h.prototype,"composeContainerRef",[k.computed],Object.getOwnPropertyDescriptor(h.prototype,"composeContainerRef"),h.prototype),y(h.prototype,"selectedItem",[k.computed],Object.getOwnPropertyDescriptor(h.prototype,"selectedItem"),h.prototype),O=y(h.prototype,"onHoverItem",[k.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){e.selectedIndex=e.items.indexOf(t)}}}),g=y(h.prototype,"selectItem",[k.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){t&&(e.props.data.subject=t.text,e.props.anchor.value=t.text,e.props.controllers.smartSubject.logSuggestSelect(t)),e.closeSuggest()}}}),_=y(h.prototype,"closeSuggest",[k.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){e.props.visual.subjectsSuggest.suggestType=""}}}),y(h.prototype,"switchSelectedIndex",[k.action],Object.getOwnPropertyDescriptor(h.prototype,"switchSelectedIndex"),h.prototype),y(h.prototype,"resetSelectedIndex",[k.action],Object.getOwnPropertyDescriptor(h.prototype,"resetSelectedIndex"),h.prototype),m=h))||m)||m},3787:function(e,t,n){"use strict";var r=n(348),o=n.n(r),i=n(372),a=n(376),c=n(380);t.a={scope:o.a.object,anchor:o.a.object,controllers:i.a.isRequired,data:a.a.isRequired,visual:c.a.isRequired}},3788:function(e,t,n){"use strict";function r(e){"@babel/helpers - typeof";return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function c(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),e}function s(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?l(e):t}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function l(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function p(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function d(e,t,n,r){O||(O="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=r;else if(i>1){for(var a=new Array(i),c=0;c<i;c++)a[c]=arguments[c+3];t.children=a}if(t&&o)for(var s in o)void 0===t[s]&&(t[s]=o[s]);else t||(t=o||{});return{$$typeof:O,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function y(e,t,n,r){n&&Object.defineProperty(e,t,{enumerable:n.enumerable,configurable:n.configurable,writable:n.writable,value:n.initializer?n.initializer.call(r):void 0})}n.d(t,"a",(function(){return B}));var b,m,h,v,O,g=n(137),_=n.n(g),S=n(348),E=n.n(S),P=n(138),C=n.n(P),w=n(350),T=n.n(w),k=n(351),R=n(530),A=n(382),j=n(688),M=n(1799),I=n(433),D=n(140),N=(n.n(D),n(3789)),L=(n.n(N),Object(I.a)(j.c,"div")),x="ComposeSmartSubjectsList",z={Block:x,Item:"".concat(x,"-Item"),ItemActive:"".concat(x,"-Item_active"),Text:"".concat(x,"-Text"),HighlightedText:"".concat(x,"-HighlightedText")},B=(v=h=(function(e){function t(){var e,n;i(this,t);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return n=s(this,(e=u(t)).call.apply(e,[this].concat(o))),n._disposer=new A.a,y(l(n),"onClickItem",m,l(n)),n}return p(t,e),c(t,[{key:"render",value:function(){var e=this;return d(L,{className:T()(z.Block,this.props.cls),cls:T()(z.Block,this.props.cls),selectedIndex:this.props.selectedIndex,itemHeight:40},void 0,this.props.items.map((function(t,n){return e.renderItem(t,n)})))}},{key:"renderItem",value:function(e,t){var n=this,r=this.props,i=r.onHoverItem,a=r.selectedIndex,c=t===a;return d("div",{className:T()(z.Item,o({},z.ItemActive,c)),onClick:function(){return n.onClickItem(e)},onMouseEnter:function(){return i(e)}},"SuggestItem-".concat(t),d(D.Text,{typography:"body-long-m",className:z.Text},void 0,this._applyHighlight(e.text)))}},{key:"_applyHighlight",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=this.props.highlight;if(!t)return e;var n=new RegExp(C.a.escapeRegExp(t),"gi"),r=e.split(n),o=[];e.replace(n,(function(e){return o.push(e)}));var i=[r[0]];return r.slice(1).forEach((function(e,t){var n=o[t];i.push(d("span",{className:z.HighlightedText},t,n)),i.push(e)})),_.a.createElement(_.a.Fragment,null,i)}}]),t})(_.a.Component),h.propTypes={cls:E.a.string,highlight:E.a.string,selectedIndex:E.a.number,items:R.a.arrayOf(M.a),onClickItem:E.a.func,onHoverItem:E.a.func},b=v,m=(function(e,t,n,r,o){var i={};return Object.keys(r).forEach((function(e){i[e]=r[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce((function(n,r){return r(e,t,n)||n}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i})(b.prototype,"onClickItem",[k.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){e.props.onClickItem&&e.props.onClickItem(t)}}}),b)},3789:function(e,t){},3790:function(e,t){},3791:function(e,t){},3792:function(e,t,n){"use strict";function r(e){"@babel/helpers - typeof";return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}function c(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?u(e):t}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function u(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function f(e,t,n,r){T||(T="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=r;else if(i>1){for(var a=new Array(i),c=0;c<i;c++)a[c]=arguments[c+3];t.children=a}if(t&&o)for(var s in o)void 0===t[s]&&(t[s]=o[s]);else t||(t=o||{});return{$$typeof:T,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function d(e,t,n,r){n&&Object.defineProperty(e,t,{enumerable:n.enumerable,configurable:n.configurable,writable:n.writable,value:n.initializer?n.initializer.call(r):void 0})}function y(e,t,n,r,o){var i={};return Object.keys(r).forEach((function(e){i[e]=r[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce((function(n,r){return r(e,t,n)||n}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}n.d(t,"a",(function(){return q}));var b,m,h,v,O,g,_,S,E,P,C,w,T,k=n(137),R=n.n(k),A=n(351),j=n(353),M=n(372),I=n(376),D=n(365),N=n(502),L=n(352),x=n(149),z=(n.n(x),n(140)),B=(n.n(z),n(367)),F=n(621),U=n(3793),K=n(360),H=(n.n(K),n(3795)),W=(n.n(H),"ComposeReact-TranslateLanguagesPanel"),G={Container:W,Block:"".concat(W,"-Block"),LanguageBubble:"".concat(W,"-LanguageBubble"),LanguagePrefix:"".concat(W,"-LanguagePrefix"),Popup:"".concat(W,"-Popup"),HelpButton:"".concat(W,"-HelpButton"),EditButton:"".concat(W,"-EditButton")},Y=f(z.Text,{typography:"body-short-m"},void 0,f(L.default,{loc:"compose-react/Translate_Edit_Button"})),q=(b=Object(j.inject)("data","visual","services","controllers"))(m=Object(j.observer)((w=C=(function(e){function t(){var e,n;o(this,t);for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return n=c(this,(e=s(t)).call.apply(e,[this].concat(i))),d(u(n),"langFromDefinition",v,u(n)),d(u(n),"langToDefinition",O,u(n)),d(u(n),"updateRef",g,u(n)),d(u(n),"togglePopupVisibility",_,u(n)),d(u(n),"setLangFrom",S,u(n)),d(u(n),"setLangTo",E,u(n)),n.editTranslation=function(){n.props.controllers.translate.doAfterTranslate(n.props.visual,(function(e){n.props.controllers.messageBody.replaceText(e),n.props.visual.translate.isEnabled=!1,n._sendMetrika(K.COMPOSE_METRIKA_TRANSLATION_EDIT_BUTTON)}))},d(u(n),"onOutsideClick",P,u(n)),n}return l(t,e),a(t,[{key:"_sendMetrika",value:function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];(e=this.props.services.metrika).sendMetrika.apply(e,[K.COMPOSE_METRIKA,K.COMPOSE_METRIKA_TRANSLATION_PANE].concat(n))}},{key:"closePopups",value:function(){this.langFromDefinition.popupIsVisible=!1,this.langToDefinition.popupIsVisible=!1}},{key:"render",value:function(){var e=this.isEnabled,t=this.langFromDefinition,n=this.langToDefinition;return e?f("div",{className:G.Container},void 0,f("div",{className:G.Block},void 0,this._renderLanguage(t)),f("div",{className:G.Block},void 0,this._renderLanguage(n),this._renderEditButton(),this._renderHelpButton()),this._renderPopup(t),this._renderPopup(n)):null}},{key:"_renderEditButton",value:function(){var e=this.editTranslation;return f("div",{className:G.EditButton,onClick:e},void 0,Y)}},{key:"_renderHelpButton",value:function(){var e=this.service.getHelpUrl();return f(x.Link,{className:G.HelpButton,view:"default",href:e,target:"_blank;",rel:"noopener noreferer"},void 0,"?")}},{key:"_renderLanguage",value:function(e){var t=this.service,n=this.updateRef,r=this.togglePopupVisibility,o=e.langCode,i=e.prefixKey,a=i&&Object(B.default)(i).trim();return R.a.createElement("div",{ref:function(t){return n(t,e)},className:G.LanguageBubble,onClick:function(){return r(e)}},a&&f(z.Text,{color:"secondary",typography:"body-short-m",className:G.LanguagePrefix},void 0,a),f(z.Text,{typography:"body-short-m"},void 0,t.getLanguageName(o())))}},{key:"_renderPopup",value:function(e){var t=e.popupIsVisible,n=e.ref,r=e.langCode,o=e.directions,i=e.updateLang;return n&&f(F.a,{className:G.Popup,anchor:{current:n},onClose:this.onOutsideClick,visible:t,direction:Object(A.toJS)(o),hasTail:!0},void 0,f(U.a,{lang:r(),onSelect:i}))}},{key:"service",get:function(){return this.props.services.translate}},{key:"isEnabled",get:function(){return this.props.visual.translate.isEnabled}},{key:"langFrom",get:function(){return this.props.visual.translate.translateFrom}},{key:"langTo",get:function(){return this.props.visual.translate.translateTo}},{key:"containerRef",get:function(){return{current:this.props.visual.refs.composeScrollableContainer}}}]),t})(R.a.Component),C.propTypes={data:I.a.isRequired,services:D.a.isRequired,visual:N.a.isRequired,controllers:M.a.isRequired},h=w,v=y(h.prototype,"langFromDefinition",[A.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return{langCode:function(){return e.langFrom},prefixKey:null,ref:null,popupIsVisible:!1,directions:["bottom-start"],offset:0,updateLang:this.setLangFrom,metrika:K.COMPOSE_METRIKA_TRANSLATION_FROM}}}),O=y(h.prototype,"langToDefinition",[A.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return{langCode:function(){return e.langTo},prefixKey:"compose-react/Translator_TranslateTo_Prefix",ref:null,popupIsVisible:!1,directions:["bottom"],offset:35,updateLang:this.setLangTo,metrika:K.COMPOSE_METRIKA_TRANSLATION_TO}}}),y(h.prototype,"service",[A.computed],Object.getOwnPropertyDescriptor(h.prototype,"service"),h.prototype),y(h.prototype,"isEnabled",[A.computed],Object.getOwnPropertyDescriptor(h.prototype,"isEnabled"),h.prototype),y(h.prototype,"langFrom",[A.computed],Object.getOwnPropertyDescriptor(h.prototype,"langFrom"),h.prototype),y(h.prototype,"langTo",[A.computed],Object.getOwnPropertyDescriptor(h.prototype,"langTo"),h.prototype),y(h.prototype,"containerRef",[A.computed],Object.getOwnPropertyDescriptor(h.prototype,"containerRef"),h.prototype),g=y(h.prototype,"updateRef",[A.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return function(e,t){t.ref=e||t.ref}}}),_=y(h.prototype,"togglePopupVisibility",[A.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){var n=!t.popupIsVisible;e.closePopups(),t.popupIsVisible=n,e._sendMetrika(t.metrika,K.COMPOSE_METRIKA_TRANSLATION_OPEN_LANGUAGE_SELECTOR)}}}),S=y(h.prototype,"setLangFrom",[A.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){e.closePopups(),e.props.visual.translate.translateFrom=t,e._sendMetrika(K.COMPOSE_METRIKA_TRANSLATION_FROM,K.COMPOSE_METRIKA_TRANSLATION_CHOOSE_LANGUAGE)}}}),E=y(h.prototype,"setLangTo",[A.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){e.closePopups(),e.props.visual.translate.translateTo=t,e._sendMetrika(K.COMPOSE_METRIKA_TRANSLATION_TO,K.COMPOSE_METRIKA_TRANSLATION_CHOOSE_LANGUAGE)}}}),P=y(h.prototype,"onOutsideClick",[A.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){t.target!==e.langFromDefinition.ref&&t.target!==e.langToDefinition.ref&&e.closePopups()}}}),m=h))||m)||m},3793:function(e,t,n){"use strict";function r(e){"@babel/helpers - typeof";return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function c(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),e}function s(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?l(e):t}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function l(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function p(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function d(e,t,n,r){O||(O="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=r;else if(i>1){for(var a=new Array(i),c=0;c<i;c++)a[c]=arguments[c+3];t.children=a}if(t&&o)for(var s in o)void 0===t[s]&&(t[s]=o[s]);else t||(t=o||{});return{$$typeof:O,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}n.d(t,"a",(function(){return N}));var y,b,m,h,v,O,g=n(137),_=n.n(g),S=n(348),E=n.n(S),P=n(350),C=n.n(P),w=n(351),T=n(353),k=n(365),R=n(352),A=n(140),j=(n.n(A),n(3794)),M=(n.n(j),"ComposeReact-ChooseLanguage"),I={Container:M,Recents:"".concat(M,"-Recents"),RecentsHeader:"".concat(M,"-RecentsHeader"),Languages:"".concat(M,"-Languages"),Item:"".concat(M,"-Item"),SelectedItem:"".concat(M,"_selected")},D=d(R.default,{loc:"compose-react/Translator_LanguagesRecent"}),N=(y=Object(T.inject)("services"))(b=Object(T.observer)((v=h=(function(e){function t(){var e,n;i(this,t);for(var r=arguments.length,a=new Array(r),c=0;c<r;c++)a[c]=arguments[c];return n=s(this,(e=u(t)).call.apply(e,[this].concat(a))),n._renderLang=function(e){var t=e.name,r=e.lang,i=l(n),a=i._onSelect,c=r===n.props.lang,s=C()(I.Item,o({},I.SelectedItem,c));return d(A.Text,{typography:"body-long-m",as:"div",className:s,onClick:function(){return a(r)},color:c?"disable":"primary"},r,t)},n._onSelect=function(e){n.service.setRecent(e),n.props.onSelect&&n.props.onSelect(e)},n}return p(t,e),c(t,[{key:"render",value:function(){return d("div",{className:I.Container},void 0,this._renderRecents(),this._renderLanguages())}},{key:"_renderRecents",value:function(){var e=this.service.getRecents();return e&&e.length?d("div",{className:I.Recents},void 0,d(A.Text,{as:"div",typography:"body-long-m",className:I.RecentsHeader,color:"secondary"},void 0,D),e.map(this._renderLang)):null}},{key:"_renderLanguages",value:function(){var e=this.service.getLangs();return e&&e.length?d("div",{className:I.Languages},void 0,e.map(this._renderLang)):null}},{key:"service",get:function(){return this.props.services.translate}}]),t})(_.a.Component),h.propTypes={lang:E.a.string,onSelect:E.a.func.isRequired,services:k.a.isRequired},m=v,(function(e,t,n,r,o){var i={};return Object.keys(r).forEach((function(e){i[e]=r[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce((function(n,r){return r(e,t,n)||n}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i})(m.prototype,"service",[w.computed],Object.getOwnPropertyDescriptor(m.prototype,"service"),m.prototype),b=m))||b)||b},3794:function(e,t){},3795:function(e,t){},3796:function(e,t,n){"use strict";function r(e){"@babel/helpers - typeof";return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}function c(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?s(e):t}function s(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function f(e,t,n,r){O||(O="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=r;else if(i>1){for(var a=new Array(i),c=0;c<i;c++)a[c]=arguments[c+3];t.children=a}if(t&&o)for(var s in o)void 0===t[s]&&(t[s]=o[s]);else t||(t=o||{});return{$$typeof:O,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function d(e,t,n,r,o){var i={};return Object.keys(r).forEach((function(e){i[e]=r[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce((function(n,r){return r(e,t,n)||n}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}n.d(t,"a",(function(){return k}));var y,b,m,h,v,O,g=n(137),_=n.n(g),S=n(351),E=n(353),P=n(502),C=n(487),w=n(3797),T=(n.n(w),{Block:"ComposeReact-TranslationLoader",Spin:"".concat("ComposeReact-TranslationLoader","-Spin")}),k=(y=Object(E.inject)("visual"))(b=Object(E.observer)((v=h=(function(e){function t(){return o(this,t),c(this,u(t).apply(this,arguments))}return l(t,e),a(t,[{key:"render",value:function(){var e=this.isEnabled,t=this.isLoaderVisible;return e&&t?f("div",{className:T.Block},void 0,f(C.default,{cls:T.Spin,size:"l"})):null}},{key:"isLoaderVisible",get:function(){return this.props.visual.translate.translationsInProgress>0}},{key:"isEnabled",get:function(){return this.props.visual.translate.isEnabled}}]),t})(_.a.Component),h.propTypes={visual:P.a.isRequired},m=v,d(m.prototype,"isLoaderVisible",[S.computed],Object.getOwnPropertyDescriptor(m.prototype,"isLoaderVisible"),m.prototype),d(m.prototype,"isEnabled",[S.computed],Object.getOwnPropertyDescriptor(m.prototype,"isEnabled"),m.prototype),b=m))||b)||b},3797:function(e,t){},3798:function(e,t,n){"use strict";function r(e){"@babel/helpers - typeof";return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t,n,r,o,i,a){try{var c=e[i](a),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,o)}function i(e){return function(){var t=this,n=arguments;return new Promise(function(r,i){function a(e){o(s,r,i,a,c,"next",e)}function c(e){o(s,r,i,a,c,"throw",e)}var s=e.apply(t,n);a(void 0)})}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t,n){return t&&c(e.prototype,t),n&&c(e,n),e}function u(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?p(e):t}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function p(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function f(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&d(e,t)}function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function y(e,t,n,r){P||(P="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=r;else if(i>1){for(var a=new Array(i),c=0;c<i;c++)a[c]=arguments[c+3];t.children=a}if(t&&o)for(var s in o)void 0===t[s]&&(t[s]=o[s]);else t||(t=o||{});return{$$typeof:P,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function b(e,t,n,r){n&&Object.defineProperty(e,t,{enumerable:n.enumerable,configurable:n.configurable,writable:n.writable,value:n.initializer?n.initializer.call(r):void 0})}function m(e,t,n,r,o){var i={};return Object.keys(r).forEach((function(e){i[e]=r[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce((function(n,r){return r(e,t,n)||n}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}n.d(t,"a",(function(){return B}));var h,v,O,g,_,S,E,P,C=n(137),w=n.n(C),T=n(138),k=n.n(T),R=n(351),A=n(353),j=n(382),M=n(376),I=n(365),D=n(372),N=n(502),L=n(3799),x=(n.n(L),{Block:"ComposeReact-TranslationPanel",Container:"mail-Editor",TranslationWrapper:"cke_editable"}),z=500,B=(h=Object(A.inject)("data","services","controllers","visual"))(v=Object(A.observer)((E=S=(function(e){function t(){var e,n;a(this,t);for(var r=arguments.length,o=new Array(r),c=0;c<r;c++)o[c]=arguments[c];return n=u(this,(e=l(t)).call.apply(e,[this].concat(o))),n.disposer=new j.a,n.translate=k.a.debounce(i(regeneratorRuntime.mark((function e(){var t,r,o,i,a,c,s,u,l,f;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=p(n),r=t.isEnabled,o=t.langFrom,i=t.langTo,a=t.messageBody,c=t.service,s=t._startTranslating,u=t._applyTranslation,r){e.next=3;break}return e.abrupt("return");case 3:return s(),e.next=6,c.translate(a,o,i);case 6:l=e.sent,f=l.translation,u(f);case 9:case"end":return e.stop()}}),e)}))),z),b(p(n),"_startTranslating",g,p(n)),b(p(n),"_applyTranslation",_,p(n)),n}return f(t,e),s(t,[{key:"componentDidMount",value:function(){var e=this;this.disposer.add(this,[Object(R.reaction)((function(){return{isEnabled:e.isEnabled,langFrom:e.langFrom,langTo:e.langTo,messageBody:e.messageBody}}),this.translate)])}},{key:"componentWillUnmount",value:function(){this.disposer.dispose(this)}},{key:"render",value:function(){var e=this.isEnabled,t=this.translation;return e?y("div",{className:x.Block},void 0,y("div",{className:x.Container},void 0,y("div",{className:x.TranslationWrapper,dangerouslySetInnerHTML:{__html:t}}))):null}},{key:"messageBody",get:function(){return this.props.controllers.messageBody.rawText||this.props.controllers.messageBody.text}},{key:"isEnabled",get:function(){return this.props.visual.translate.isEnabled}},{key:"langFrom",get:function(){return this.props.visual.translate.translateFrom}},{key:"langTo",get:function(){return this.props.visual.translate.translateTo}},{key:"translation",get:function(){return this.props.visual.translate.translation}},{key:"service",get:function(){return this.props.services.translate}}]),t})(w.a.Component),S.propTypes={data:M.a.isRequired,services:I.a.isRequired,controllers:D.a.isRequired,visual:N.a.isRequired},O=E,m(O.prototype,"messageBody",[R.computed],Object.getOwnPropertyDescriptor(O.prototype,"messageBody"),O.prototype),m(O.prototype,"isEnabled",[R.computed],Object.getOwnPropertyDescriptor(O.prototype,"isEnabled"),O.prototype),m(O.prototype,"langFrom",[R.computed],Object.getOwnPropertyDescriptor(O.prototype,"langFrom"),O.prototype),m(O.prototype,"langTo",[R.computed],Object.getOwnPropertyDescriptor(O.prototype,"langTo"),O.prototype),m(O.prototype,"translation",[R.computed],Object.getOwnPropertyDescriptor(O.prototype,"translation"),O.prototype),m(O.prototype,"service",[R.computed],Object.getOwnPropertyDescriptor(O.prototype,"service"),O.prototype),g=m(O.prototype,"_startTranslating",[R.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){e.props.visual.translate.translationsInProgress++}}}),_=m(O.prototype,"_applyTranslation",[R.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){e.props.visual.translate.translationsInProgress--,e.props.visual.translate.translation=t}}}),v=O))||v)||v},3799:function(e,t){},380:function(e,t,n){"use strict";function r(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function o(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function i(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}var a=n(138),c=(n.n(a),n(348)),s=n.n(c),u=n(3548),l=n(3550),p=n(366),f=(n.n(p),n(1799));t.a=s.a.shape({isLocked:s.a.bool.isRequired,additionalAddressesAreExpanded:s.a.bool,contactsSuggest:u.a,currentPopup:s.a.oneOf([""].concat(function(e){return i(e)||o(e)||r()}(Object(a.values)(p.Popups)))),diskResourcesPath:s.a.string,isDiskAvailable:s.a.bool,subjectsSuggest:f.b,translate:l.a,workMode:s.a.oneOf(Object(a.values)(p.WorkModes))})},3800:function(e,t,n){"use strict";function r(e){"@babel/helpers - typeof";return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function c(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),e}function s(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?u(e):t}function u(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function p(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function d(e,t,n,r){O||(O="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=r;else if(i>1){for(var a=new Array(i),c=0;c<i;c++)a[c]=arguments[c+3];t.children=a}if(t&&o)for(var s in o)void 0===t[s]&&(t[s]=o[s]);else t||(t=o||{});return{$$typeof:O,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}n.d(t,"a",(function(){return D}));var y,b,m,h,v,O,g=n(137),_=n.n(g),S=n(348),E=n.n(S),P=n(350),C=n.n(P),w=n(353),T=n(351),k=n(3801),R=n(3806),A=n(502),j=n(3811),M=(n.n(j),"ComposeBodyHeader"),I={Block:M,withTranslate:"".concat(M,"_withTranslate"),ForwardPanel:"".concat(M,"-ForwardPanel")},D=(y=Object(w.inject)("visual"))(b=Object(w.observer)((v=h=(function(e){function t(){return i(this,t),s(this,l(t).apply(this,arguments))}return p(t,e),c(t,[{key:"render",value:function(){return _.a.createElement("div",{className:C()(I.Block,o({},I.withTranslate,this.hasTranslation)),ref:this.props.innerRef},d(k.a,{containerRef:this.props.containerRef}),d(R.a,{cls:I.ForwardPanel}))}},{key:"hasTranslation",get:function(){return this.props.visual.translate.isEnabled}}]),t})(_.a.PureComponent),h.propTypes={innerRef:E.a.shape({current:E.a.object}),containerRef:E.a.object,visual:A.a.isRequired},m=v,(function(e,t,n,r,o){var i={};return Object.keys(r).forEach((function(e){i[e]=r[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce((function(n,r){return r(e,t,n)||n}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i})(m.prototype,"hasTranslation",[T.computed],Object.getOwnPropertyDescriptor(m.prototype,"hasTranslation"),m.prototype),b=m))||b)||b},3801:function(e,t,n){"use strict";var r=n(3802);n.d(t,"a",(function(){return r.a}))},3802:function(e,t,n){"use strict";function r(e){"@babel/helpers - typeof";return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function c(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),e}function s(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?l(e):t}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function l(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function p(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function d(e,t,n,r){S||(S="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=r;else if(i>1){for(var a=new Array(i),c=0;c<i;c++)a[c]=arguments[c+3];t.children=a}if(t&&o)for(var s in o)void 0===t[s]&&(t[s]=o[s]);else t||(t=o||{});return{$$typeof:S,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function y(e,t,n,r){n&&Object.defineProperty(e,t,{enumerable:n.enumerable,configurable:n.configurable,writable:n.writable,value:n.initializer?n.initializer.call(r):void 0})}function b(e,t,n,r,o){var i={};return Object.keys(r).forEach((function(e){i[e]=r[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce((function(n,r){return r(e,t,n)||n}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}n.d(t,"a",(function(){return G}));var m,h,v,O,g,_,S,E=n(137),P=n.n(E),C=n(348),w=n.n(C),T=n(351),k=n(353),R=n(350),A=n.n(R),j=n(352),M=n(367),I=n(372),D=n(376),N=n(365),L=n(502),x=n(360),z=(n.n(x),n(3803)),B=n(140),F=(n.n(B),n(3805)),U=(n.n(F),"ComposeRecipientsDiff"),K={Panes:"".concat(U,"-Panes"),Container:U,Wrapper:"".concat(U,"-Wrapper"),Main:"".concat(U,"-Main"),Shadow:"".concat(U,"-Shadow"),SectionsContainer:"".concat(U,"-SectionsContainer"),CollapseControl:"".concat(U,"-CollapseControl"),Section:"".concat(U,"-Section"),CollapsedSection:"".concat(U,"-CollapsedSection"),SectionPrefix:"".concat(U,"-SectionPrefix"),SectionItems:"".concat(U,"-SectionItems"),Login:"".concat(U,"-Login"),ExpandSign:"".concat(U,"-ExpandSign")},H=d(j.default,{loc:"compose-react/RecipientsDiff_Hide"}),W=d(j.default,{loc:"compose-react/RecipientsDiff_Show"}),G=(m=Object(k.inject)("data","visual","services","controllers"))(h=Object(k.observer)((_=g=(function(e){function t(){var e,n;i(this,t);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return n=s(this,(e=u(t)).call.apply(e,[this].concat(o))),y(l(n),"nodeRef",O,l(n)),n}return p(t,e),c(t,[{key:"setNodeRef",value:function(e){this.nodeRef=e||this.nodeRef}},{key:"setCollapsed",value:function(e){this.controller.setIsRecipientsDiffEnabled(!e),this.metrika.sendRecipientsDiffMetrika(e?x.COMPOSE_METRIKA_RECIPIENTS_DIFF_COLLAPSED:x.COMPOSE_METRIKA_RECIPIENTS_DIFF_EXPANDED)}},{key:"render",value:function(){var e=this;if(!this.controller.isRecipientsDiffAvailable)return null;var t=this.recipientsDiff,n=this.hasTranslation;return this.controller.isEmptyDiff(t)?null:(this._notifyRender(),d("div",{className:K.Panes},void 0,this._renderDiffPane(t,n&&K.Main,(function(t){return e.setNodeRef(t)})),n&&this._renderDiffPane(t,K.Shadow)))}},{key:"_renderDiffPane",value:function(e,t,n){var r=A()(K.Container,o({},t,Boolean(t))),i=this.isCollapsed;return d("div",{className:r},void 0,P.a.createElement("div",{className:K.Wrapper,ref:n},d("div",{className:K.SectionsContainer},void 0,i?this._renderCollapsedState():this._renderExpandedState(e)),!i&&this._renderCollapseControl()))}},{key:"_notifyRender",value:function(){this.wasRendered||this.metrika.sendRecipientsDiffMetrika(x.COMPOSE_METRIKA_RECIPIENTS_DIFF_SHOWN),this.wasRendered=!0}},{key:"_renderCollapseControl",value:function(){var e=this;return d(B.Text,{color:"secondary",typography:"body-long-m",className:K.CollapseControl,onClick:function(){return e.setCollapsed(!0)}},void 0,H)}},{key:"_renderExpandedState",value:function(e){var t=this.nodeRef,n=this.props.containerRef;return P.a.createElement(P.a.Fragment,null,this._maybeRenderAddedSection(e),this._maybeRenderRemovedSection(e),this._maybeRenderRemovedAllSection(e),t&&d(z.a,{nodeRef:t,containerRef:n}))}},{key:"_renderCollapsedState",value:function(){var e=this;return d(B.Text,{color:"secondary",typography:"body-long-m",className:K.CollapsedSection,onClick:function(){return e.setCollapsed(!1)}},void 0,d("span",{className:K.ExpandSign},void 0,"+"),W)}},{key:"_maybeRenderAddedSection",value:function(e){return this._maybeRenderRecipients(e.added,"+")}},{key:"_maybeRenderRemovedSection",value:function(e){return!e.removeAll&&this._maybeRenderRecipients(e.removed,"-")}},{key:"_maybeRenderRemovedAllSection",value:function(e){return e.removeAll&&this._maybeRenderRecipients([{login:Object(M.default)("compose-react/RecipientsAll")}],"-")}},{key:"_maybeRenderRecipients",value:function(e,t){return e.length?d(B.Text,{typography:"body-long-m",as:"div",color:"secondary",className:K.Section},void 0,d("div",{className:K.SectionPrefix},void 0,t),d("div",{className:K.SectionItems},void 0,e.map((function(e,t){var n=e.login;return d("div",{},t,d("div",{className:K.Login},void 0,n))})))):null}},{key:"addresses",get:function(){return this.props.data.addresses}},{key:"controller",get:function(){return this.props.controllers.recipientsDiff}},{key:"recipientsDiff",get:function(){return this.controller.getRecipientsDiff()}},{key:"isCollapsed",get:function(){return!this.controller.isRecipientsDiffEnabled}},{key:"metrika",get:function(){return this.props.services.metrika}},{key:"hasTranslation",get:function(){return this.props.visual.translate.isEnabled}}]),t})(P.a.Component),g.propTypes={containerRef:w.a.object,data:D.a.isRequired,visual:L.a.isRequired,services:N.a.isRequired,controllers:I.a.isRequired},v=_,O=b(v.prototype,"nodeRef",[T.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),b(v.prototype,"setNodeRef",[T.action],Object.getOwnPropertyDescriptor(v.prototype,"setNodeRef"),v.prototype),b(v.prototype,"addresses",[T.computed],Object.getOwnPropertyDescriptor(v.prototype,"addresses"),v.prototype),b(v.prototype,"controller",[T.computed],Object.getOwnPropertyDescriptor(v.prototype,"controller"),v.prototype),b(v.prototype,"recipientsDiff",[T.computed],Object.getOwnPropertyDescriptor(v.prototype,"recipientsDiff"),v.prototype),b(v.prototype,"isCollapsed",[T.computed],Object.getOwnPropertyDescriptor(v.prototype,"isCollapsed"),v.prototype),b(v.prototype,"metrika",[T.computed],Object.getOwnPropertyDescriptor(v.prototype,"metrika"),v.prototype),b(v.prototype,"hasTranslation",[T.computed],Object.getOwnPropertyDescriptor(v.prototype,"hasTranslation"),v.prototype),h=v))||h)||h},3803:function(e,t,n){"use strict";function r(e){"@babel/helpers - typeof";return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}function c(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?s(e):t}function s(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function f(e,t,n,r){v||(v="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=r;else if(i>1){for(var a=new Array(i),c=0;c<i;c++)a[c]=arguments[c+3];t.children=a}if(t&&o)for(var s in o)void 0===t[s]&&(t[s]=o[s]);else t||(t=o||{});return{$$typeof:v,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}n.d(t,"a",(function(){return I}));var d,y,b,m,h,v,O=n(137),g=n.n(O),_=n(348),S=n.n(_),E=n(351),P=n(353),C=n(370),w=n(352),T=n(365),k=n(360),R=(n.n(k),n(3804)),A=(n.n(R),"ComposeRecipientsDiffPromo"),j={Block:A,Description:"".concat(A,"-Description"),Close:"".concat(A,"-Close")},M=f(w.default,{loc:"compose-react/RecipientsDiff_Description"}),I=(d=Object(P.inject)("services"))(y=Object(P.observer)((h=m=(function(e){function t(){var e,n;o(this,t);for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return n=c(this,(e=u(t)).call.apply(e,[this].concat(i))),n.close=function(){n.props.services.settings.isRecipientsDiffPromoClosed=!0,n.forceUpdate(),n.metrika.sendRecipientsDiffMetrika(k.COMPOSE_METRIKA_RECIPIENTS_DIFF_PROMO_CLOSED)},n}return l(t,e),a(t,[{key:"_notifyRender",value:function(){this.wasRendered||this.metrika.sendRecipientsDiffMetrika(k.COMPOSE_METRIKA_RECIPIENTS_DIFF_PROMO_SHOWN),this.wasRendered=!0}},{key:"render",value:function(){var e=this.props,t=e.containerRef,n=e.nodeRef,r=this.isVisible,o=this.close;if(!this.wasRendered&&!r)return null;this._notifyRender();var i={hiding:!0,mainOffset:-5,secondaryOffset:25,style:{position:"absolute"},tailOffset:-100};return n&&r&&f(C.default,{cls:j.Block,anchor:n,scope:t,theme:"promo",tone:"default",size:"m",visible:r,to:["bottom-left"],popupProps:i},void 0,f(C.default.Close,{cls:j.Close,onClick:o}),f(C.default.Description,{},void 0,f("div",{className:j.Description},void 0,M)))}},{key:"isVisible",get:function(){return!this.props.services.settings.isRecipientsDiffPromoClosed}},{key:"metrika",get:function(){return this.props.services.metrika}}]),t})(g.a.PureComponent),m.propTypes={nodeRef:S.a.object,containerRef:S.a.object,services:T.a.isRequired},b=h,(function(e,t,n,r,o){var i={};return Object.keys(r).forEach((function(e){i[e]=r[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce((function(n,r){return r(e,t,n)||n}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i})(b.prototype,"metrika",[E.computed],Object.getOwnPropertyDescriptor(b.prototype,"metrika"),b.prototype),y=b))||y)||y},3804:function(e,t){},3805:function(e,t){},3806:function(e,t,n){"use strict";var r=n(3807);n.d(t,"a",(function(){return r.a}))},3807:function(e,t,n){"use strict";function r(e){"@babel/helpers - typeof";return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t,n,r,o,i,a){try{var c=e[i](a),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,o)}function i(e){return function(){var t=this,n=arguments;return new Promise(function(r,i){function a(e){o(s,r,i,a,c,"next",e)}function c(e){o(s,r,i,a,c,"throw",e)}var s=e.apply(t,n);a(void 0)})}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t,n){return t&&c(e.prototype,t),n&&c(e,n),e}function u(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?p(e):t}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function p(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function f(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&d(e,t)}function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function y(e,t,n,r){P||(P="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=r;else if(i>1){for(var a=new Array(i),c=0;c<i;c++)a[c]=arguments[c+3];t.children=a}if(t&&o)for(var s in o)void 0===t[s]&&(t[s]=o[s]);else t||(t=o||{});return{$$typeof:P,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function b(e,t,n,r){n&&Object.defineProperty(e,t,{enumerable:n.enumerable,configurable:n.configurable,writable:n.writable,value:n.initializer?n.initializer.call(r):void 0})}function m(e,t,n,r,o){var i={};return Object.keys(r).forEach((function(e){i[e]=r[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce((function(n,r){return r(e,t,n)||n}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}n.d(t,"a",(function(){return F}));var h,v,O,g,_,S,E,P,C=n(137),w=n.n(C),T=n(348),k=n.n(T),R=n(350),A=n.n(R),j=n(353),M=n(351),I=n(372),D=n(365),N=n(3808),L=(n.n(N),n(352)),x=n(3810),z=(n.n(x),"ComposeForwardPanel"),B={Block:z,Message:"".concat(z,"-Message"),Subject:"".concat(z,"-Subject")},F=(h=Object(j.inject)("controllers","services"))(v=Object(j.observer)((E=S=(function(e){function t(){var e,n;a(this,t);for(var r=arguments.length,o=new Array(r),c=0;c<r;c++)o[c]=arguments[c];return n=u(this,(e=l(t)).call.apply(e,[this].concat(o))),b(p(n),"isClosed",g,p(n)),b(p(n),"close",_,p(n)),n.attach=i(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.props.controllers.attachments.addForwardAsAttachment();case 2:case"end":return e.stop()}}),e)}))),n}return f(t,e),s(t,[{key:"render",value:function(){return this.isVisible?y(N.NotificationPanel,{className:A()(B.Block,this.props.cls),actionLocKey:"compose-react/Body_Header_Forward_Action",onAction:this.attach,onClose:this.close},void 0,y(L.default,{className:B.Message,loc:"compose-react/Body_Header_Forward_Message"},void 0,y("span",{"data-ref":"name",className:B.Subject},void 0,this.subject))):null}},{key:"isForward",get:function(){return this.props.services.composeParams.isForward()}},{key:"forwardedMessages",get:function(){return this.props.controllers.attachments.forwardedMessages}},{key:"forwardMailAttachments",get:function(){return this.props.controllers.attachments.forwardMailAttachments}},{key:"isVisible",get:function(){return!this.isClosed&&this.isForward&&1===this.forwardedMessages.length&&!this.forwardMailAttachments.length}},{key:"subject",get:function(){return this.props.services.composeParams.messageSubject}}]),t})(w.a.Component),S.propTypes={cls:k.a.string,controllers:I.a.isRequired,services:D.a.isRequired},O=E,g=m(O.prototype,"isClosed",[M.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),m(O.prototype,"isForward",[M.computed],Object.getOwnPropertyDescriptor(O.prototype,"isForward"),O.prototype),m(O.prototype,"forwardedMessages",[M.computed],Object.getOwnPropertyDescriptor(O.prototype,"forwardedMessages"),O.prototype),m(O.prototype,"forwardMailAttachments",[M.computed],Object.getOwnPropertyDescriptor(O.prototype,"forwardMailAttachments"),O.prototype),m(O.prototype,"isVisible",[M.computed],Object.getOwnPropertyDescriptor(O.prototype,"isVisible"),O.prototype),m(O.prototype,"subject",[M.computed],Object.getOwnPropertyDescriptor(O.prototype,"subject"),O.prototype),_=m(O.prototype,"close",[M.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){e.isClosed=!0}}}),v=O))||v)||v},3808:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.NotificationPanel=void 0;var o=r(n(137)),i=r(n(350)),a=r(n(352)),c=n(142),s=n(140),u=r(n(417)),l=r(n(3809)),p=function(e){return o.default.createElement("span",{className:i.default(e,l.default.icon)},o.default.createElement(u.default,null))},f=function(e){var t=e.className,n=e.onAction,r=e.children,u=e.actionLocKey,f=e.onClose;return o.default.createElement("div",{className:i.default("ComposeNotification",l.default.root,t)},o.default.createElement(s.Text,{typography:"body-long-m",as:"div",className:i.default("ComposeNotification-Content",l.default.content)},r),n&&o.default.createElement(c.Button,{view:"default",size:"s",className:i.default("ComposeNotification-Action",l.default.action),onClick:n},o.default.createElement(a.default,{loc:u})),f&&o.default.createElement(c.Button,{view:"clear",size:"s",className:i.default("ComposeNotification-Close",l.default.close),onClick:f,icon:p}))};t.NotificationPanel=f},3809:function(e,t){e.exports={root:"BodyHeader__root--12lgF",content:"BodyHeader__content--3RN-4",action:"BodyHeader__action--1mEK-",close:"BodyHeader__close--2SH6T",icon:"BodyHeader__icon--DdBfd"}},3810:function(e,t){},3811:function(e,t){},3812:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HeaderButtons=void 0;var r=n(3813);Object.defineProperty(t,"HeaderButtons",{enumerable:!0,get:function(){return r.HeaderButtons}})},3813:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},r.apply(this,arguments)},o=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&o(t,e,n);return i(t,e),t},c=this&&this.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var o=0,r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]]);return n},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.HeaderButtons=void 0;var u=a(n(137)),l=s(n(350)),p=n(353),f=n(399),d=n(1848),y=n(143),b=s(n(417)),m=s(n(1849)),h=s(n(1850)),v=s(n(1851)),O=a(n(557)),g=n(360),_=n(620),S=s(n(367)),E=s(n(3816));t.HeaderButtons=p.observer((function(){var e=_.useStores(),t=e.controllers.compose,n=e.visual.size,o=e.services.metrika,i=u.useCallback((function(e){e.stopPropagation(),t.closeCompose({leaveType:O.COLLAPSE}),o.sendHeaderMetrika(g.COMPOSE_METRIKA_HEADER_COLLAPSE)}),[t,o]),a=u.useCallback((function(e){e.stopPropagation();var r=n===f.ComposeSizes.SMALL?f.ComposeSizes.LARGE:f.ComposeSizes.SMALL;t.changeSize(r,!0),o.sendHeaderMetrika(g.COMPOSE_METRIKA_HEADER_EXPAND)}),[t,o,n]),s=u.useCallback((function(e){e.stopPropagation(),t.closeCompose({leaveType:O.CLOSE}),o.sendHeaderMetrika(g.COMPOSE_METRIKA_HEADER_CLOSE)}),[t,o]),p=u.useMemo((function(){return[{name:f.HeaderButtons.MINIMIZE,svg:m.default,onClick:i,tooltipLocKey:"compose-react/PopupActions_MinimizeWindow"},{name:n===f.ComposeSizes.SMALL?f.HeaderButtons.MAXIMIZE:f.HeaderButtons.MAXIMIZE_SMALL,svg:n===f.ComposeSizes.SMALL?h.default:v.default,onClick:a,tooltipLocKey:n===f.ComposeSizes.SMALL?"compose-react/PopupActions_EnlargeWindowSize":"compose-react/PopupActions_ReduceWindowSize"},{name:f.HeaderButtons.CLOSE,svg:b.default,onClick:s,tooltipLocKey:"compose-react/PopupActions_CloseWindow"}]}),[a,s,i,n]);return u.default.createElement("div",{className:E.default.root},p.map((function(e){var t=e.tooltipLocKey,n=e.name,o=c(e,["tooltipLocKey","name"]);return u.default.createElement(y.TooltipStateful,{key:n,size:"s",view:"default",state:"warning",content:S.default(t)},u.default.createElement(d.ButtonWithIcon,r({view:"clear",size:"s"},o,{className:l.default("qa-ControlButton","qa-ControlButton_button_"+n),"aria-label":S.default(t)})))})))}))},3814:function(e,t,n){"use strict";function r(e,t,n){var r=y[e||"m"],o=l.useCallback((function(e){return l.default.createElement("div",{className:p.default(d.default.iconWrap,e,n)},t&&l.default.createElement(t,{width:r,height:r}))}),[t,r,n]);if(t)return o}var o=this&&this.__assign||function(){return o=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},o.apply(this,arguments)},i=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),c=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&i(t,e,n);return a(t,e),t},s=this&&this.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var o=0,r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]]);return n},u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.ButtonWithIcon=void 0;var l=c(n(137)),p=u(n(350)),f=n(142),d=u(n(3815)),y={xs:"16px",s:"16px",m:"16px",l:"24px"},b=function(e){var t=e.size,n=e.svg,i=e.iconSize,a=e.iconClass,c=s(e,["size","svg","iconSize","iconClass"]),u=r(i||t,n,a);return l.default.createElement(f.Button,o({},c,{size:t,icon:u}))};t.ButtonWithIcon=b},3815:function(e,t){e.exports={iconWrap:"ButtonWithIcon__iconWrap--2QE4l"}},3816:function(e,t){e.exports={root:"HeaderButtons__root--WwDCZ"}},3817:function(e,t){},3818:function(e,t,n){"use strict";function r(e){"@babel/helpers - typeof";return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function c(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),e}function s(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?l(e):t}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function l(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function p(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function d(e,t,n,r){T||(T="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=r;else if(i>1){for(var a=new Array(i),c=0;c<i;c++)a[c]=arguments[c+3];t.children=a}if(t&&o)for(var s in o)void 0===t[s]&&(t[s]=o[s]);else t||(t=o||{});return{$$typeof:T,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function y(e,t,n,r){n&&Object.defineProperty(e,t,{enumerable:n.enumerable,configurable:n.configurable,writable:n.writable,value:n.initializer?n.initializer.call(r):void 0})}function b(e,t,n,r,o){var i={};return Object.keys(r).forEach((function(e){i[e]=r[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce((function(n,r){return r(e,t,n)||n}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}n.d(t,"a",(function(){return Z}));var m,h,v,O,g,_,S,E,P,C,w,T,k=n(138),R=n.n(k),A=n(137),j=n.n(A),M=n(351),I=n(353),D=n(350),N=n.n(D),L=n(367),x=n(799),z=n(382),B=n(1301),F=(n.n(B),n(3819)),U=n(1302),K=n(917),H=n(921),W=n(1837),G=n(1311),Y=n(360),q=(n.n(Y),n(3839)),V=(n.n(q),n(1826)),$="composeReact",Q={Block:$,Block_mobile:"".concat($,"_mobile"),Content:"".concat($,"-Content"),ScrollableContainer:"".concat($,"-ScrollableContainer"),ScrollableContent:"".concat($,"-ScrollableContent"),TopContent:"".concat($,"-TopContent"),Toolbar:"".concat($,"-Toolbar"),MainContent:"".concat($,"-MainContent"),BottomContent:"".concat($,"-BottomContent"),Header:"".concat($,"-Header"),ControlPanel:"".concat($,"-ControlPanel")},J=d(V.a,{}),X=d(K.a,{}),Z=(m=Object(I.inject)("data","visual","services","controllers"))(h=Object(I.observer)((w=C=(function(e){function t(){var e,n;i(this,t);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return n=s(this,(e=u(t)).call.apply(e,[this].concat(o))),n.domNode=null,n.toolbarNodeId=R.a.uniqueId("ComposeReact-Toolbar"),n.disposer=new z.a,n.messageBodyRef=j.a.createRef(),n.subjectFieldRef=j.a.createRef(),n.focusBody=function(){var e=n.messageBodyRef.current;e&&e.focus()},n.focus=function(){n.domNode&&(n.domNode.focus(),n.domNode.tabIndex=-1)},y(l(n),"focusField",O,l(n)),y(l(n),"saveComposeContainerRef",g,l(n)),y(l(n),"saveScrollableContainerRef",_,l(n)),y(l(n),"saveTopContentRef",S,l(n)),y(l(n),"onToggleRecipients",E,l(n)),y(l(n),"onRecipientsFieldFocus",P,l(n)),n}return p(t,e),c(t,[{key:"componentDidMount",value:function(){var e=this;this.disposer.add(this,[Object(M.reaction)((function(){return e.props.visual.focusedField}),this.focusField)])}},{key:"componentWillUnmount",value:function(){this.disposer.dispose(this)}},{key:"render",value:function(){var e,t=this,n=this.areAdditionalAddressesExpanded,r=this.isShowingAttachmentsOverflowButton,i=this.toolbarNodeId,a=this.onToggleRecipients,c=this.onRecipientsFieldFocus,s=N()((e={},o(e,Q.Block,!0),o(e,Q.Block_mobile,!0),e));return j.a.createElement("div",{className:s,ref:this.saveComposeContainerRef,tabIndex:"0"},d("div",{className:Q.Content},void 0,d("div",{className:Q.Header},void 0,d(U.b,{cls:Q.ControlPanel})),d("div",{className:Q.ScrollableContainer},void 0,j.a.createElement("div",{className:Q.ScrollableContent,ref:this.saveScrollableContainerRef},j.a.createElement("div",{className:Q.TopContent,ref:this.saveTopContentRef},d(W.a,{isShowAdditionalAddresses:n,onToggleExpandedState:a,onFieldFocus:c},void 0,d(G.a,{innerRef:this.subjectFieldRef,onFocus:function(){return c("subject",t.subjectFieldRef)},title:"compose-react/Header_Subject"}),J),d("div",{id:i,className:Q.Toolbar})),d("div",{className:Q.MainContent},void 0,j.a.createElement(H.a,{ref:this.messageBodyRef,placeholder:Object(L.default)("compose-react/Editor_Placeholder"),toolbarNodeId:i})),d("div",{className:Q.BottomContent},void 0,d(F.a,{isShowingOverflowButton:r})))),X))}},{key:"composeController",get:function(){return this.props.controllers.compose}},{key:"contactsController",get:function(){return this.props.controllers.contacts}},{key:"metrikaService",get:function(){return this.props.services.metrika}},{key:"data",get:function(){return this.props.data}},{key:"areAdditionalAddressesExpanded",get:function(){return this.props.visual.additionalAddressesAreExpanded}}]),t})(j.a.Component),C.propTypes=x.a,v=w,b(v.prototype,"composeController",[M.computed],Object.getOwnPropertyDescriptor(v.prototype,"composeController"),v.prototype),b(v.prototype,"contactsController",[M.computed],Object.getOwnPropertyDescriptor(v.prototype,"contactsController"),v.prototype),b(v.prototype,"metrikaService",[M.computed],Object.getOwnPropertyDescriptor(v.prototype,"metrikaService"),v.prototype),b(v.prototype,"data",[M.computed],Object.getOwnPropertyDescriptor(v.prototype,"data"),v.prototype),b(v.prototype,"areAdditionalAddressesExpanded",[M.computed],Object.getOwnPropertyDescriptor(v.prototype,"areAdditionalAddressesExpanded"),v.prototype),O=b(v.prototype,"focusField",[M.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){if(e.props.visual.focusedField="","compose"===t&&e.focus(),"body"!==t){-1!==["addresses.cc","addresses.bcc"].indexOf(t)&&!e.areAdditionalAddressesExpanded&&(e.props.visual.additionalAddressesAreExpanded=!0)}}}}),g=b(v.prototype,"saveComposeContainerRef",[M.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){e.domNode=t,e.props.visual.refs.composeContainer=t}}}),_=b(v.prototype,"saveScrollableContainerRef",[M.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){e.scrollableContainer=t,e.props.visual.refs.composeScrollableContainer=t}}}),S=b(v.prototype,"saveTopContentRef",[M.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){e.props.visual.refs.topContent=t}}}),E=b(v.prototype,"onToggleRecipients",[M.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){e.props.visual.additionalAddressesAreExpanded=!e.props.visual.additionalAddressesAreExpanded,e.metrikaService.sendHeaderMetrika(Y.COMPOSE_METRIKA_HEADER_TOGGLE_ADDRESSES)}}}),P=b(v.prototype,"onRecipientsFieldFocus",[M.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t,n){"addresses.to"===t&&(e.data.addresses.cc.length||e.data.addresses.bcc.length)&&(e.props.visual.additionalAddressesAreExpanded=!0),n.current&&Object(B.scrollTo)(e.scrollableContainer,{top:n.current.offsetTop})}}}),h=v))||h)||h},3819:function(e,t,n){"use strict";function r(e){"@babel/helpers - typeof";return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function c(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),e}function s(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?l(e):t}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function l(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function p(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function d(e,t,n,r){w||(w="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=r;else if(i>1){for(var a=new Array(i),c=0;c<i;c++)a[c]=arguments[c+3];t.children=a}if(t&&o)for(var s in o)void 0===t[s]&&(t[s]=o[s]);else t||(t=o||{});return{$$typeof:w,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function y(e,t,n,r){n&&Object.defineProperty(e,t,{enumerable:n.enumerable,configurable:n.configurable,writable:n.writable,value:n.initializer?n.initializer.call(r):void 0})}function b(e,t,n,r,o){var i={};return Object.keys(r).forEach((function(e){i[e]=r[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce((function(n,r){return r(e,t,n)||n}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}n.d(t,"a",(function(){return J}));var m,h,v,O,g,S,E,P,C,w,T=n(137),k=n.n(T),R=n(348),A=n.n(R),j=n(351),M=n(353),I=n(350),D=n.n(I),N=n(3820),L=n(3823),x=n(3836),z=n(372),B=n(376),F=n(365),U=n(502),K=n(369),H=n(529),W=n(360),G=(n.n(W),n(366)),Y=(n.n(G),n(395)),q=n.n(Y),V=n(3838),$=(n.n(V),"ComposeAttachments"),Q={Block:$,Header:"".concat($,"-Header"),Body:"".concat($,"-Body"),Item:"".concat($,"-Item"),Item_collapsed:"".concat($,"-Item_collapsed"),Progress:"".concat($,"-Progress")},J=(m=Object(M.inject)("controllers","data","services","visual"))(h=Object(M.observer)((C=P=(function(e){function t(){var e,n;i(this,t);for(var r=arguments.length,a=new Array(r),c=0;c<r;c++)a[c]=arguments[c];return n=s(this,(e=u(t)).call.apply(e,[this].concat(a))),n.disposer=new q.a,y(l(n),"itemsPerRow",O,l(n)),y(l(n),"onItemRemoveOrCancel",g,l(n)),y(l(n),"onDeleteAll",S,l(n)),y(l(n),"setItemsPerRow",E,l(n)),n.onContainerRef=function(e){n.containerRef=e,n.updateWidth()},n.updateWidth=function(){if(n.containerRef&&!n.isBackground){var e=n.containerRef.getBoundingClientRect().width+t.ITEM_X_MARGIN,r=t.ITEM_WIDTH+t.ITEM_X_MARGIN,o=Math.floor(e/r);n.itemsPerRow!==o&&n.setItemsPerRow(o)}},n.toggleHiddenItems=function(){var e=n.props,t=e.isExpanded,r=e.onExpand,o=e.onCollapse;t?o&&o():r&&r(),n.metrikaService.sendAttachmentsMetrika(W.COMPOSE_METRIKA_ATTACHMENTS_TOGGLE)},n.renderAttachmentItem=function(e,t){var r,i=l(n),a=i.visibleAttachmentsCount;return d("div",{className:D()((r={},o(r,Q.Item,!0),o(r,Q.Item_collapsed,t>=a),r))},e.info.id,d(L.a,{onClose:n.onItemRemoveOrCancel,onCancelLoading:n.onItemRemoveOrCancel,item:e}))},n}return p(t,e),c(t,[{key:"componentDidMount",value:function(){this.disposer.add(this,[Object(Y.addEventListener)({element:window,eventName:"resize",listener:this.updateWidth})]),this.updateWidth()}},{key:"componentWillUnmount",value:function(){this.disposer.dispose(this)}},{key:"render",value:function(){return 0===this.validAttachments.length?null:k.a.createElement("div",{ref:this.onContainerRef,className:Q.Block},d(N.a,{cls:Q.Header,count:this.validAttachments.length,hiddenCount:this.hiddenAttachments.length,isExpanded:this.props.isExpanded,onDeleteAll:this.onDeleteAll,onToggle:this.toggleHiddenItems,size:this.totalSize,uploadedCount:this.uploadedCount}),d(x.a,{cls:Q.Progress}),this.renderBody())}},{key:"renderBody",value:function(){return 0===this.visibleAttachmentsCount?null:d("div",{className:Q.Body},void 0,this.validAttachments.map(this.renderAttachmentItem))}},{key:"attachmentsController",get:function(){return this.props.controllers.attachments}},{key:"attachments",get:function(){return this.props.data.attachments||[]}},{key:"validAttachments",get:function(){return this.attachmentsController.validAttachments||[]}},{key:"metrikaService",get:function(){return this.props.services.metrika}},{key:"isBackground",get:function(){return this.props.visual.workMode===G.WorkModes.BACKGROUND}},{key:"hiddenAttachments",get:function(){return this.props.fixedMode===G.FixedModes.SMALL?this.validAttachments:this.validAttachments.slice(this.itemsPerRow)}},{key:"visibleAttachmentsCount",get:function(){var e=this.props,t=e.isExpanded,n=e.fixedMode;return t?this.validAttachments.length:n===G.FixedModes.SMALL?0:this.itemsPerRow}},{key:"totalSize",get:function(){return this.validAttachments.map((function(e){return Object(H.a)(e.info)||0})).reduce((function(e,t){return e+t}),0)}},{key:"uploadedCount",get:function(){return this.validAttachments.filter((function(e){return e.status===K.c.COMPLETED})).length}}]),t})(k.a.Component),P.propTypes={controllers:z.a.isRequired,data:B.a.isRequired,services:F.a.isRequired,visual:U.a.isRequired,fixedMode:A.a.oneOf(_.values(G.FixedModes)),isExpanded:A.a.bool,onExpand:A.a.func,onCollapse:A.a.func,onItemsPerRowChanged:A.a.func},P.defaultProps={isExpanded:!0,onItemsPerRowChanged:function(){return null}},P.ITEM_WIDTH=102,P.ITEM_X_MARGIN=12,v=C,O=b(v.prototype,"itemsPerRow",[j.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),b(v.prototype,"attachmentsController",[j.computed],Object.getOwnPropertyDescriptor(v.prototype,"attachmentsController"),v.prototype),b(v.prototype,"attachments",[j.computed],Object.getOwnPropertyDescriptor(v.prototype,"attachments"),v.prototype),b(v.prototype,"validAttachments",[j.computed],Object.getOwnPropertyDescriptor(v.prototype,"validAttachments"),v.prototype),b(v.prototype,"metrikaService",[j.computed],Object.getOwnPropertyDescriptor(v.prototype,"metrikaService"),v.prototype),b(v.prototype,"isBackground",[j.computed],Object.getOwnPropertyDescriptor(v.prototype,"isBackground"),v.prototype),b(v.prototype,"hiddenAttachments",[j.computed],Object.getOwnPropertyDescriptor(v.prototype,"hiddenAttachments"),v.prototype),b(v.prototype,"visibleAttachmentsCount",[j.computed],Object.getOwnPropertyDescriptor(v.prototype,"visibleAttachmentsCount"),v.prototype),b(v.prototype,"totalSize",[j.computed],Object.getOwnPropertyDescriptor(v.prototype,"totalSize"),v.prototype),b(v.prototype,"uploadedCount",[j.computed],Object.getOwnPropertyDescriptor(v.prototype,"uploadedCount"),v.prototype),g=b(v.prototype,"onItemRemoveOrCancel",[j.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){t.status=K.c.ABORTED,e.attachments.remove(t)}}}),S=b(v.prototype,"onDeleteAll",[j.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){e.props.data.attachments=[],e.metrikaService.sendAttachmentsMetrika(W.COMPOSE_METRIKA_ATTACHMENTS_REMOVE_ALL)}}}),E=b(v.prototype,"setItemsPerRow",[j.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){e.itemsPerRow=t,e.props.onItemsPerRowChanged(t)}}}),h=v))||h)||h},382:function(e,t,n){"use strict";var r=n(395),o=n.n(r);n.d(t,"a",(function(){return o.a}))},3820:function(e,t,n){"use strict";function r(e){"@babel/helpers - typeof";return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}function c(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?s(e):t}function s(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function f(e,t,n,r){v||(v="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=r;else if(i>1){for(var a=new Array(i),c=0;c<i;c++)a[c]=arguments[c+3];t.children=a}if(t&&o)for(var s in o)void 0===t[s]&&(t[s]=o[s]);else t||(t=o||{});return{$$typeof:v,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}n.d(t,"a",(function(){return F}));var d,y,b,m,h,v,O=n(137),g=n.n(O),_=n(348),S=n.n(_),E=n(350),P=n.n(E),C=n(353),w=n(351),T=n(352),k=n(402),R=n(1839),A=n.n(R),j=n(479),M=(n.n(j),n(3821)),I=n(365),D=n(3822),N=(n.n(D),Object(M.a)(k.a)),L=Object(M.a)(A.a),x="ComposeAttachmentsHeader",z={Block:x,Progress:"".concat(x,"-Progress"),Message:"".concat(x,"-Message"),Count:"".concat(x,"-Count"),Size:"".concat(x,"-Size"),Actions:"".concat(x,"-Actions"),Button:"".concat(x,"-Button"),DeleteAllButton:"".concat(x,"-DeleteAllButton"),ToggleButton:"".concat(x,"-ToggleButton"),ExpandIcon:"".concat(x,"-ExpandIcon"),CollapseIcon:"".concat(x,"-CollapseIcon"),Space:"".concat(x,"-Space")},B=f(T.default,{loc:"compose-react/Attachments_WasAttached"}),F=(d=Object(C.inject)("services"))(y=Object(C.observer)((h=m=(function(e){function t(){return o(this,t),c(this,u(t).apply(this,arguments))}return l(t,e),a(t,[{key:"render",value:function(){var e=this.props,t=e.cls,n=e.size;return f("div",{className:P()(z.Block,t)},void 0,!this.isMobile&&f("div",{className:z.Message},void 0,B),this.renderCount(),f("div",{className:z.Size},void 0,f(j.HumanFileSize,{bytes:n})),this.maybeRenderActions())}},{key:"renderCount",value:function(){var e=this.props,t=e.count,n=e.uploadedCount,r=n<t?"compose-react/Attachments_UnloadedN":"compose-react/Attachments_Count";return f("div",{className:z.Count},void 0,f(T.default,{loc:r,params:{count:t,uploaded:n}}))}},{key:"maybeRenderActions",value:function(){return f("div",{className:z.Actions},void 0,this.renderDeleteAllButton(),!this.isMobile&&this.renderToggleButton())}},{key:"renderDeleteAllButton",value:function(){var e=this.props,t=e.count,n=e.onDeleteAll;return t<=1?f("div",{className:z.Space}):f(N,{onClick:n,containerCls:z.DeleteAllButton,cls:z.Button,theme:"normal",view:"default",tone:"default"},void 0,f(T.default,{loc:"compose-react/Attachments_Delete_All",params:{count:t}}))}},{key:"renderToggleButton",value:function(){var e=this.props,t=e.count,n=e.hiddenCount,r=e.isExpanded,o=e.onToggle;if(!n)return null;var i=r?"compose-react/Attachments_Collapse":n<t?"compose-react/Attachments_ShowMoreN":"compose-react/Attachments_Show",a={count:n};return f(L,{cls:z.Button,containerCls:z.ToggleButton,isExpanded:r,onClick:o},"toggle",f(T.default,{loc:i,params:a}))}},{key:"isMobile",get:function(){return this.props.services.settings.isMobile}}]),t})(g.a.PureComponent),m.propTypes={cls:S.a.string,count:S.a.number,hiddenCount:S.a.number,isExpanded:S.a.bool,onDeleteAll:S.a.func,onToggle:S.a.func,services:I.a.isRequired,size:S.a.number,uploadedCount:S.a.number},b=h,(function(e,t,n,r,o){var i={};return Object.keys(r).forEach((function(e){i[e]=r[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce((function(n,r){return r(e,t,n)||n}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i})(b.prototype,"isMobile",[w.computed],Object.getOwnPropertyDescriptor(b.prototype,"isMobile"),b.prototype),y=b))||y)||y},3821:function(e,t,n){"use strict";function r(){return r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},r.apply(this,arguments)}function o(e,t){if(null==e)return{};var n,r,o=i(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function i(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}function a(e){var t=Object(c.forwardRef)((function(t,n){var i=t.containerCls,a=t.innerRef,c=t.children,u=o(t,["containerCls","innerRef","children"]);return s.a.createElement("div",{className:i,ref:a},s.a.createElement(e,r({ref:n},u),c))})),n=e.displayName||e.name;return t.displayName=n?"withTooltipAdapter(".concat(n,")"):"withTooltipAdapter",t.propTypes={containerCls:l.a.string,innerRef:l.a.oneOfType([l.a.object,l.a.func])},t}t.a=a;var c=n(137),s=n.n(c),u=n(348),l=n.n(u)},3822:function(e,t){},3823:function(e,t,n){"use strict";function r(e){"@babel/helpers - typeof";return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}function c(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?u(e):t}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function u(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function f(e,t,n,r){v||(v="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=r;else if(i>1){for(var a=new Array(i),c=0;c<i;c++)a[c]=arguments[c+3];t.children=a}if(t&&o)for(var s in o)void 0===t[s]&&(t[s]=o[s]);else t||(t=o||{});return{$$typeof:v,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}n.d(t,"a",(function(){return I}));var d,y,b,m,h,v,O=n(137),g=n.n(O),_=n(348),S=n.n(_),E=n(351),P=n(353),C=n(3824),w=n(3830),T=n(682),k=n(365),R=n(369),A=n(529),j=n(360),M=(n.n(j),Object(w.a)(C.a)),I=(d=Object(P.inject)("services"))(y=Object(P.observer)((h=m=(function(e){function t(){var e,n;o(this,t);for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return n=c(this,(e=s(t)).call.apply(e,[this].concat(i))),n.state={isUsingThumbnail:!1},n.onCloseClick=function(){var e=n.props,t=e.item,r=e.onClose;n.metrikaService.sendAttachmentsMetrika(j.COMPOSE_METRIKA_ATTACHMENTS_REMOVE),r&&r(t)},n.onCancelClick=function(){var e=n.props,t=e.item,r=e.onCancelLoading;n.metrikaService.sendAttachmentsMetrika(j.COMPOSE_METRIKA_ATTACHMENTS_CANCEL_UPLOAD),r&&r(t)},n.onPreviewClick=function(e){var t=n.props.item;if(t.info.type===R.d.YADISK)return void n.metrikaService.sendAttachmentsMetrika(j.COMPOSE_METRIKA_ATTACHMENTS_PREVIEW);if(!t.previewSupported)return void n.metrikaService.sendAttachmentsMetrika(j.COMPOSE_METRIKA_ATTACHMENTS_DOWNLOAD);var r={mid:t.visual.mid,hid:t.visual.hid};(r.mid||r.hid)&&(n.props.services.attachments.showImagePreview("attachments.image-preview",r,u(n),e),n.metrikaService.sendAttachmentsMetrika(j.COMPOSE_METRIKA_ATTACHMENTS_PREVIEW))},n}return l(t,e),a(t,[{key:"componentDidMount",value:function(){this.loadPreview()}},{key:"componentWillUnmount",value:function(){this.image&&(this.image.onload=null)}},{key:"loadPreview",value:function(){var e=this,t=this.props.item.info,n=t.previewSrc;n&&this.previousPreviewSrc!==n&&(this.image=new Image,this.image.onload=function(){return e.setState({isUsingThumbnail:!0})},this.image.src=n,this.previousPreviewSrc=n)}},{key:"componentDidUpdate",value:function(){this.loadPreview()}},{key:"render",value:function(){var e=this.props.services,t=this.props.item,n=t.info,r=t.status,o=t.progress,i=t.visual,a=n.previewHref||i.narodUrl||i.url,c=this.state.isUsingThumbnail,s=Boolean(n.folder),u=s?"folder":i.icon||i.class;return f(M,{onPreviewClick:this.onPreviewClick,fileType:u,extension:i.fileext,name:i.name,sourceType:n.type,previewSrc:c?n.previewSrc:null,sourceHref:a,onClose:this.onCloseClick,isMobile:e.settings.isMobile,progress:o,onCancelLoading:this.onCancelClick,size:Object(A.a)(n),status:r})}},{key:"metrikaService",get:function(){return this.props.services.metrika}}]),t})(g.a.Component),m.propTypes={item:T.a,onClose:S.a.func,onCancelLoading:S.a.func,services:k.a},b=h,(function(e,t,n,r,o){var i={};return Object.keys(r).forEach((function(e){i[e]=r[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce((function(n,r){return r(e,t,n)||n}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i})(b.prototype,"metrikaService",[E.computed],Object.getOwnPropertyDescriptor(b.prototype,"metrikaService"),b.prototype),y=b))||y)||y},3830:function(e,t,n){"use strict";function r(e){"@babel/helpers - typeof";return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function c(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),e}function s(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?u(e):t}function u(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function p(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function d(e,t,n,r){b||(b="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=r;else if(i>1){for(var a=new Array(i),c=0;c<i;c++)a[c]=arguments[c+3];t.children=a}if(t&&o)for(var s in o)void 0===t[s]&&(t[s]=o[s]);else t||(t=o||{});return{$$typeof:b,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function y(e){var t,n;return n=t=(function(t){function n(){var e,t;i(this,n);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return t=s(this,(e=l(n)).call.apply(e,[this].concat(o))),t.state={containerHovered:!1,cancelButtonHovered:!1},t.onCancelLoadingClick=function(e){e.preventDefault(),e.stopPropagation();var n=t.props.onCancelLoading;"function"==typeof n&&n()},t.onCloseClicked=function(e){e.preventDefault(),e.stopPropagation();var n=t.props.onClose;n&&n()},t}return p(n,t),c(n,[{key:"maybeRenderCloseButton",value:function(){return this.props.onClose?d(w.a,{onClick:this.onCloseClicked,pin:"circle-circle",theme:"normal",cls:M.Close}):null}},{key:"maybeRenderProgress",value:function(){var e=this,t=this.props,n=t.status,r=t.progress;if(n===R.c.COMPLETED)return null;var o=n===R.c.UPLOADING;return d("div",{className:M.Loader},void 0,o?d(C.a,{cls:M.ProgressIndicator,progress:r}):d(T.default,{cls:M.Spin,size:"m"}),d(w.a,{cls:M.CancelLoading,pin:"circle-circle",theme:"normal",onClick:this.onCancelLoadingClick,innerRef:function(t){return e.cancelButtonRef=t},onMouseEnter:function(){return e.setState({cancelButtonHovered:!0})},onMouseLeave:function(){return e.setState({cancelButtonHovered:!1})}}))}},{key:"maybeRenderSize",value:function(){var e=this.props.size;return e?d("span",{className:M.TooltipSize},void 0,d(E.HumanFileSize,{bytes:e})):null}},{key:"render",value:function(){var t,n=this,r=this.props,i=r.previewSrc,a=r.sourceHref,c=r.status,s=r.onPreviewClick,u=r.sourceType,l=r.isMobile,p=Boolean(i),f=u!==R.d.YADISK&&!p,d=_()(M.Block,(t={},o(t,M.loading,c===R.c.UPLOADING),o(t,M.new,c!==R.c.COMPLETED),o(t,M.with_thumbnail,p),t));return O.a.createElement("a",{onClick:s,download:f,href:a,target:"_blank",rel:"noopener noreferrer",onMouseEnter:function(){return n.setState({containerHovered:!0})},onMouseLeave:function(){return n.setState({containerHovered:!1})},ref:function(e){return n.containerRef=e},className:d},O.a.createElement(e,this.props),this.maybeRenderCloseButton(),this.maybeRenderProgress(),!l&&this.renderTooltip())}},{key:"renderTooltip",value:function(){var e=this.state,t=e.containerHovered,n=e.cancelButtonHovered,r=n?this.cancelButtonRef:this.containerRef;return d(P.a,{visible:t||n,to:"top-left",anchor:r},void 0,n?this.renderCancelButtonTooltip():this.renderContainerTooltip())}},{key:"renderContainerTooltip",value:function(){var e=this.props.name;return O.a.createElement(O.a.Fragment,null,e,this.maybeRenderSize())}},{key:"renderCancelButtonTooltip",value:function(){return I}}]),n})(O.a.Component),t.propTypes={isMobile:h.a.bool,status:h.a.oneOf(Object(S.values)(R.c)),progress:h.a.number,onClose:h.a.func,onCancelLoading:h.a.func,previewSrc:h.a.string,size:h.a.number,name:h.a.string,sourceHref:h.a.string,onPreviewClick:h.a.func,sourceType:h.a.oneOf(Object(S.values)(R.d))},n}t.a=y;var b,m=n(348),h=n.n(m),v=n(137),O=n.n(v),g=n(350),_=n.n(g),S=n(138),E=(n.n(S),n(479)),P=(n.n(E),n(1835)),C=n(3831),w=n(3833),T=n(487),k=n(352),R=n(369),A=n(3835),j=(n.n(A),"compose-AttachmentItem"),M={Block:j,loading:"".concat(j,"_loading"),new:"".concat(j,"_new"),with_thumbnail:"".concat(j,"_with_thumbnail"),Loader:"".concat(j,"-Loader"),CancelLoading:"".concat(j,"-CancelLoading"),Close:"".concat(j,"-Close"),TooltipSize:"".concat(j,"-TooltipSize"),Spin:"".concat(j,"-Spin"),ProgressIndicator:"".concat(j,"-ProgressIndicator")},I=d(k.default,{loc:"compose-react/Attachments_CancelLoading_Tooltip"})},3831:function(e,t,n){"use strict";function r(e){"@babel/helpers - typeof";return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}function c(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?s(e):t}function s(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function f(e,t,n,r){d||(d="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=r;else if(i>1){for(var a=new Array(i),c=0;c<i;c++)a[c]=arguments[c+3];t.children=a}if(t&&o)for(var s in o)void 0===t[s]&&(t[s]=o[s]);else t||(t=o||{});return{$$typeof:d,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}n.d(t,"a",(function(){return P}));var d,y=n(137),b=n.n(y),m=n(348),h=n.n(m),v=n(350),O=n.n(v),g=n(3832),_=(n.n(g),{m:{side:34,strokeWidth:2}}),S="compose-ProgressIndicator",E={Block:S,indeterminate:"".concat(S,"_indeterminate"),Background:"".concat(S,"-Background"),Progress:"".concat(S,"-Progress")},P=(function(e){function t(){return o(this,t),c(this,u(t).apply(this,arguments))}return l(t,e),a(t,[{key:"render",value:function(){var e=this.props,t=e.progress,n=e.size,r=e.cls,o=_[n],i=o.side,a=o.strokeWidth,c=i/2,s=c-a,u=s*Math.PI*2,l=u-u*(t/100);return f("svg",{width:i,height:i,className:O()(E.Block,r),viewBox:"0 0 ".concat(i," ").concat(i)},void 0,f("circle",{className:E.Background,cx:c,cy:c,r:s,strokeWidth:a}),f("circle",{className:E.Progress,cx:c,cy:c,r:s,transform:"rotate(-90 ".concat(c," ").concat(c,")"),strokeWidth:a,style:{strokeDasharray:u,strokeDashoffset:l}}))}}]),t})(b.a.PureComponent);P.propTypes={progress:h.a.number,size:h.a.oneOf(["m"]),cls:h.a.string},P.defaultProps={size:"m"}},3832:function(e,t){},3833:function(e,t,n){"use strict";function r(){return r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},r.apply(this,arguments)}function o(e,t){if(null==e)return{};var n,r,o=i(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function i(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}var a,c=n(137),s=n.n(c),u=n(348),l=n.n(u),p=n(350),f=n.n(p),d=n(402),y=n(368),b=n(3834),m=(n.n(b),(function(e,t,n,r){a||(a="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=r;else if(i>1){for(var c=new Array(i),s=0;s<i;s++)c[s]=arguments[s+3];t.children=c}if(t&&o)for(var u in o)void 0===t[u]&&(t[u]=o[u]);else t||(t=o||{});return{$$typeof:a,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}})(y.default,{id:"mail--Compose-Cross"})),h=function(e){var t=e.cls,n=o(e,["cls"]);return s.a.createElement(d.a,r({cls:f()(t,"ComposeClearButton"),theme:"clear",view:"default",tone:"default"},n),m)};t.a=h,h.propTypes={cls:l.a.string}},3834:function(e,t){},3835:function(e,t){},3836:function(e,t,n){"use strict";function r(e){"@babel/helpers - typeof";return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}function c(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?s(e):t}function s(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function f(e,t,n,r){O||(O="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=r;else if(i>1){for(var a=new Array(i),c=0;c<i;c++)a[c]=arguments[c+3];t.children=a}if(t&&o)for(var s in o)void 0===t[s]&&(t[s]=o[s]);else t||(t=o||{});return{$$typeof:O,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function d(e,t,n,r,o){var i={};return Object.keys(r).forEach((function(e){i[e]=r[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce((function(n,r){return r(e,t,n)||n}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}n.d(t,"a",(function(){return D}));var y,b,m,h,v,O,g=n(137),_=n.n(g),S=n(348),E=n.n(S),P=n(350),C=n.n(P),w=n(351),T=n(353),k=n(560),R=n(372),A=n(369),j=n(3837),M=(n.n(j),"ComposeAttachmentsLoadingProgress"),I={Block:M,Progress:"".concat(M,"-Progress")},D=(y=Object(T.inject)("controllers"))(b=Object(T.observer)((v=h=(function(e){function t(){return o(this,t),c(this,u(t).apply(this,arguments))}return l(t,e),a(t,[{key:"render",value:function(){var e=this.props.cls;return 1===this.progress?null:f("div",{className:C()(I.Block,e)},void 0,f(k.d,{timing:"linear",value:this.progress}))}},{key:"validAttachments",get:function(){return this.props.controllers.attachments.validAttachments||[]}},{key:"progress",get:function(){return this.validAttachments.map((function(e){return e.status===A.c.COMPLETED?100:e.progress})).reduce((function(e,t){return t+e}),0)/this.validAttachments.length/100}}]),t})(_.a.PureComponent),h.propTypes={cls:E.a.string,controllers:R.a.isRequired},m=v,d(m.prototype,"validAttachments",[w.computed],Object.getOwnPropertyDescriptor(m.prototype,"validAttachments"),m.prototype),d(m.prototype,"progress",[w.computed],Object.getOwnPropertyDescriptor(m.prototype,"progress"),m.prototype),b=m))||b)||b},3837:function(e,t){},3838:function(e,t){},3839:function(e,t){},3840:function(e,t){},3841:function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var r,o,i,a,c=n(137),s=n.n(c),u=n(353),l=n(799),p=n(3842),f=function(e){return s.a.createElement(p.a,e)},f=(r=Object(u.inject)("controllers","data","services","visual"))(o=Object(u.observer)((a=i=f,i.propTypes=l.a,o=a))||o)||o},3842:function(e,t,n){"use strict";function r(e){"@babel/helpers - typeof";return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}function c(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?u(e):t}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function u(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function f(e,t,n,r){_||(_="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=r;else if(i>1){for(var a=new Array(i),c=0;c<i;c++)a[c]=arguments[c+3];t.children=a}if(t&&o)for(var s in o)void 0===t[s]&&(t[s]=o[s]);else t||(t=o||{});return{$$typeof:_,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function d(e,t,n,r){n&&Object.defineProperty(e,t,{enumerable:n.enumerable,configurable:n.configurable,writable:n.writable,value:n.initializer?n.initializer.call(r):void 0})}function y(e,t,n,r,o){var i={};return Object.keys(r).forEach((function(e){i[e]=r[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce((function(n,r){return r(e,t,n)||n}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}n.d(t,"a",(function(){return z}));var b,m,h,v,O,g,_,S=n(137),E=n.n(S),P=n(351),C=n(353),w=n(367),T=n(799),k=n(356),R=n(1302),A=n(917),j=n(921),M=n(3843),I=(n.n(M),n(3855)),D=n.n(I),N=n(360),L=(n.n(N),f(R.a,{})),x=f(A.a,{}),z=(b=Object(C.inject)("data","visual","services","controllers"))(m=Object(C.observer)((g=O=(function(e){function t(){var e,n;o(this,t);for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return n=c(this,(e=s(t)).call.apply(e,[this].concat(i))),n._messageBodyRef=E.a.createRef(),d(u(n),"saveComposeContainerRef",v,u(n)),n._focusBody=function(){var e=n._messageBodyRef.current;e&&e.focus()},n._onRecipientsClick=function(){n.props.controllers.quickReply.goToFullCompose(),n.metrikaService.sendMetrika(N.QUICK_REPLY_CLICK_ON_RECIPIENTS)},n._onFullComposeClick=function(){n.props.controllers.quickReply.goToFullCompose(),n.metrikaService.sendMetrika(N.QUICK_REPLY_CLICK_ON_COMPOSE)},n._onCloseClick=function(){n.props.controllers.compose.closeCompose(),n.metrikaService.sendMetrika(N.QUICK_REPLY_CLICK_ON_CLOSE)},n}return l(t,e),a(t,[{key:"componentDidMount",value:function(){this.hotkeysController.attachNode(this.composeContainerRef),this._placeInViewport()}},{key:"_placeInViewport",value:function(){var e=ns.Model.get(Object(k.is3Pane)()?"scroller-message":"scroller-messages"),t=Object(k.is3Pane)()?0:-ns.Model.get("app-state").get(".timelineHeight");e.init(),e.scrollIntoView(this.composeContainerRef,{alignToTop:!1,relative:e.isRelativeOffset(),viewBottomOffset:t}),Object(k.changeRightColumSize)()}},{key:"render",value:function(){return E.a.createElement("div",{className:D.a.container,ref:this.saveComposeContainerRef},f("div",{className:D.a.content},void 0,f(M.Header,{onRecipientsClick:this._onRecipientsClick,onFullComposeClick:this._onFullComposeClick,onCloseClick:this._onCloseClick}),E.a.createElement(j.a,{cls:D.a.editor,placeholder:Object(w.default)("compose-react/Editor_Placeholder"),onEditorInit:this._focusBody,ref:this._messageBodyRef}),f("div",{className:D.a.footer},void 0,L)),x)}},{key:"metrikaService",get:function(){return this.props.services.metrika}},{key:"hotkeysController",get:function(){return this.props.controllers.hotkeys}},{key:"composeContainerRef",get:function(){return this.props.visual.refs.composeContainer}}]),t})(E.a.Component),O.propTypes=T.a,h=g,y(h.prototype,"metrikaService",[P.computed],Object.getOwnPropertyDescriptor(h.prototype,"metrikaService"),h.prototype),y(h.prototype,"hotkeysController",[P.computed],Object.getOwnPropertyDescriptor(h.prototype,"hotkeysController"),h.prototype),y(h.prototype,"composeContainerRef",[P.computed],Object.getOwnPropertyDescriptor(h.prototype,"composeContainerRef"),h.prototype),v=y(h.prototype,"saveComposeContainerRef",[P.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){e.props.visual.refs.composeContainer=t}}}),m=h))||m)||m},3843:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Header=void 0;var r=n(3844);Object.defineProperty(t,"Header",{enumerable:!0,get:function(){return r.Header}})},3844:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Header=void 0;var o=r(n(137)),i=r(n(350)),a=n(3845),c=n(3848),s=n(3851),u=r(n(3854)),l=function(e){var t=e.onRecipientsClick,n=e.onFullComposeClick,r=e.onCloseClick;return o.default.createElement("div",{className:u.default.container},o.default.createElement("div",{className:i.default("qa-QuickReply-Recipients",u.default.recipients)},o.default.createElement(s.Recipients,{onClick:t})),o.default.createElement("div",{className:u.default.buttons},o.default.createElement(a.FullComposeButton,{className:i.default("qa-QuickReply-FullComposeButton",u.default.icon),onClick:n}),o.default.createElement(c.CloseButton,{className:i.default("qa-QuickReply-CloseButton",u.default.icon),onClick:r})))};t.Header=l},3845:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FullComposeButton=void 0;var r=n(3846);Object.defineProperty(t,"FullComposeButton",{enumerable:!0,get:function(){return r.FullComposeButton}})},3846:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.FullComposeButton=void 0;var o=r(n(137)),i=r(n(352)),a=n(143),c=n(142),s=r(n(3847)),u=function(e){var t=e.className,n=e.onClick;return o.default.createElement(a.TooltipStateful,{view:"default",state:"warning",size:"s",direction:"top",content:o.default.createElement(i.default,{loc:"compose-react/QuickReply_FullCompose"})},o.default.createElement(c.Button,{view:"clear",size:"s",className:t,icon:function(e){return o.default.createElement(s.default,{className:e})},onClick:n}))};t.FullComposeButton=u},3847:function(e,t,n){"use strict";function r(){return r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},r.apply(this,arguments)}function o(e){return a.createElement("svg",r({width:32,height:32,viewBox:"0 0 32 32",fill:"none",xmlns:"http://www.w3.org/2000/svg"},e),c)}Object.defineProperty(t,"__esModule",{value:!0});var i,a=n(137),c=(n.n(a),(function(e,t,n,r){i||(i="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,a=arguments.length-3;if(t||0===a||(t={children:void 0}),1===a)t.children=r;else if(a>1){for(var c=new Array(a),s=0;s<a;s++)c[s]=arguments[s+3];t.children=c}if(t&&o)for(var u in o)void 0===t[u]&&(t[u]=o[u]);else t||(t=o||{});return{$$typeof:i,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}})("path",{d:"M20.3 10.786v-.323l-1.15.314a6.26 6.26 0 01-1.65.221c-.6 0-1-.447-1-1a1 1 0 011-1H22a1 1 0 011 1v4.504a1 1 0 01-1 1c-.552 0-1-.403-1-1 0-.56.075-1.116.222-1.656l.313-1.147h-.32l-1.078 1.437a9.996 9.996 0 01-.93 1.072l-1.003 1.002a1 1 0 11-1.414-1.414l1.004-1.004a9.997 9.997 0 011.064-.923l1.442-1.083zm-8.6 10.418v.324l1.15-.314a6.26 6.26 0 011.65-.222c.6 0 1 .448 1 1.001a1 1 0 01-1 1H10a1 1 0 01-1-1V17.49a1 1 0 011-1c.552 0 1 .402 1 1 0 .559-.075 1.116-.222 1.655l-.313 1.147h.32l1.078-1.437c.285-.379.596-.737.93-1.072l1.003-1.002a1 1 0 111.414 1.415l-1.004 1.003a9.997 9.997 0 01-1.064.924L11.7 21.204z",fill:"currentColor"}));t.default=o},3848:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CloseButton=void 0;var r=n(3849);Object.defineProperty(t,"CloseButton",{enumerable:!0,get:function(){return r.CloseButton}})},3849:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.CloseButton=void 0;var o=r(n(137)),i=r(n(352)),a=n(143),c=n(142),s=r(n(3850)),u=function(e){var t=e.className,n=e.onClick;return o.default.createElement(a.TooltipStateful,{view:"default",state:"warning",size:"s",direction:"top",content:o.default.createElement(i.default,{loc:"compose-react/QuickReply_Close"})},o.default.createElement(c.Button,{view:"clear",size:"s",className:t,icon:function(e){return o.default.createElement(s.default,{className:e})},onClick:n}))};t.CloseButton=u},3850:function(e,t,n){"use strict";function r(){return r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},r.apply(this,arguments)}function o(e){return a.createElement("svg",r({width:32,height:32,viewBox:"0 0 32 32",fill:"none",xmlns:"http://www.w3.org/2000/svg"},e),c)}Object.defineProperty(t,"__esModule",{value:!0});var i,a=n(137),c=(n.n(a),(function(e,t,n,r){i||(i="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,a=arguments.length-3;if(t||0===a||(t={children:void 0}),1===a)t.children=r;else if(a>1){for(var c=new Array(a),s=0;s<a;s++)c[s]=arguments[s+3];t.children=c}if(t&&o)for(var u in o)void 0===t[u]&&(t[u]=o[u]);else t||(t=o||{});return{$$typeof:i,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}})("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M9.793 9.793a1 1 0 000 1.414L14.586 16l-4.793 4.793a1 1 0 101.414 1.414L16 17.414l4.793 4.793a1 1 0 001.414-1.414L17.414 16l4.793-4.793a1 1 0 00-1.414-1.414L16 14.586l-4.793-4.793a1 1 0 00-1.414 0z",fill:"currentColor"}));t.default=o},3851:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Recipients=void 0;var r=n(3852);Object.defineProperty(t,"Recipients",{enumerable:!0,get:function(){return r.Recipients}})},3852:function(e,t,n){"use strict";function r(e){"@babel/helpers - typeof";return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e){return c(e)||a(e)||i()}function i(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function a(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function c(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function l(e,t,n){return t&&u(e.prototype,t),n&&u(e,n),e}function p(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?f(e):t}function f(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function d(e){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function y(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&b(e,t)}function b(e,t){return(b=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function m(e,t,n,r){S||(S="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=r;else if(i>1){for(var a=new Array(i),c=0;c<i;c++)a[c]=arguments[c+3];t.children=a}if(t&&o)for(var s in o)void 0===t[s]&&(t[s]=o[s]);else t||(t=o||{});return{$$typeof:S,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}Object.defineProperty(t,"__esModule",{value:!0}),n.d(t,"Recipients",(function(){return B}));var h,v,O,g,_,S,E=n(137),P=n.n(E),C=n(348),w=n.n(C),T=n(350),k=n.n(T),R=n(351),A=n(353),j=n(352),M=n(795),I=n(444),D=n(618),N=n(1847),L=n(1811),x=n(3853),z=n.n(x),B=(h=Object(A.inject)("data"))(v=Object(A.observer)((_=g=(function(e){function t(){return s(this,t),p(this,d(t).apply(this,arguments))}return y(t,e),l(t,[{key:"render",value:function(){var e=this,t=this.props.onClick;return P.a.createElement(P.a.Fragment,null,m(M.a,{className:k()("qa-QuickReply-Recipients-Main",z.a.yabble),AvatarComponent:D.a,ContentComponent:N.a,getContact:function(){return I.b.of(e._recipients[0])},onClick:t}),this._maybeRenderMoreRecipients())}},{key:"_maybeRenderMoreRecipients",value:function(){if(1===this._recipients.length)return null;var e=this.props.onClick,t={count:this._recipients.length-1},n=m(j.default,{loc:"compose-react/QuickReply_RecipientCount",params:t});return m(M.a,{className:k()("qa-QuickReply-Recipients-More",z.a.yabble),ContentComponent:function(){return n},onClick:e,isValid:!0})}},{key:"_recipients",get:function(){var e=this.props.data.addresses,t=e.to,n=e.cc,r=e.bcc;return[].concat(o(t),o(n),o(r))}}]),t})(P.a.PureComponent),g.propTypes={onClick:w.a.func.isRequired,data:L.b.isRequired},O=_,(function(e,t,n,r,o){var i={};return Object.keys(r).forEach((function(e){i[e]=r[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce((function(n,r){return r(e,t,n)||n}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i})(O.prototype,"_recipients",[R.computed],Object.getOwnPropertyDescriptor(O.prototype,"_recipients"),O.prototype),v=O))||v)||v},3853:function(e,t){e.exports={yabble:"Recipients__yabble--29-sN"}},3854:function(e,t){e.exports={container:"Header__container--Lwu6N",recipients:"Header__recipients--1DrTI",buttons:"Header__buttons--2t96j",icon:"Header__icon--1GQbI"}},3855:function(e,t){e.exports={container:"Compose__container--35cdD",content:"Compose__content--2unBB",editor:"Compose__editor--2D5Y-",footer:"Compose__footer--353NM"}},3856:function(e,t,n){"use strict";var r=n(3857);n.d(t,"a",(function(){return r.a}));var o=n(3860);n.d(t,"b",(function(){return o.a}));var i=n(3862);n.d(t,"c",(function(){return i.a}));var a=n(3863);n.d(t,"d",(function(){return a.a}));var c=n(3864);n.n(c);n.o(c,"EmptySubject")&&n.d(t,"e",(function(){return c.EmptySubject}));var s=n(3872);n.d(t,"f",(function(){return s.a}));var u=n(3874);n.d(t,"g",(function(){return u.a}));var l=n(3875);n.d(t,"h",(function(){return l.a}));var p=n(3876);n.d(t,"i",(function(){return p.a}))},3857:function(e,t,n){"use strict";function r(e){"@babel/helpers - typeof";return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}function c(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?u(e):t}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function u(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function f(e,t,n,r){_||(_="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=r;else if(i>1){for(var a=new Array(i),c=0;c<i;c++)a[c]=arguments[c+3];t.children=a}if(t&&o)for(var s in o)void 0===t[s]&&(t[s]=o[s]);else t||(t=o||{});return{$$typeof:_,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function d(e,t,n,r){n&&Object.defineProperty(e,t,{enumerable:n.enumerable,configurable:n.configurable,writable:n.writable,value:n.initializer?n.initializer.call(r):void 0})}function y(e,t,n,r,o){var i={};return Object.keys(r).forEach((function(e){i[e]=r[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce((function(n,r){return r(e,t,n)||n}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}n.d(t,"a",(function(){return H}));var b,m,h,v,O,g,_,S=n(137),E=n.n(S),P=n(351),C=n(353),w=n(496),T=(n.n(w),n(1778)),k=(n.n(T),n(369)),R=n(1792),A=n(372),j=n(365),M=n(380),I=n(688),D=n(1312),N=n(624),L=n(352),x=n(560),z=n(360),B=(n.n(z),n(3859)),F=(n.n(B),Object(D.a)(I.b)),U=f(L.default,{loc:"compose-react/AttachmentsErrors_Dialog_Title"}),K=f(L.default,{loc:"compose-react/AttachmentsErrors_Confirm_Button_Title"}),H=(b=Object(C.inject)("controllers","services","visual"))(m=Object(C.observer)((g=O=(function(e){function t(){var e,n;o(this,t);for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return n=c(this,(e=s(t)).call.apply(e,[this].concat(i))),d(u(n),"closePopup",v,u(n)),n.onActionClick=function(){n.closePopup(),n.metrikaService.sendPopupsMetrika(z.COMPOSE_METRIKA_POPUPS_ATTACHMENTS_ERRORS,z.COMPOSE_METRIKA_POPUPS_ATTACHMENTS_ERRORS_ACTION)},n.onCloseClick=function(){n.closePopup(),n.metrikaService.sendPopupsMetrika(z.COMPOSE_METRIKA_POPUPS_ATTACHMENTS_ERRORS,z.COMPOSE_METRIKA_POPUPS_ATTACHMENTS_ERRORS_CLOSE)},n}return l(t,e),a(t,[{key:"groupAttachmentsByErrorCodes",value:function(){var e=this,t=this.notValidAttachments.reduce((function(e,t){var n=t.errorCode===k.e.YADISK_ERROR?k.e.UNKNOWN:t.errorCode;return e[n]?e[n].items.push(t):e[n]={errorCode:n,items:[t]},e}),{});return Object.keys(t).map((function(n){var r=t[n],o=r.errorCode,i=r.items,a=R.b[o].key,c=e.getDescriptionForErrorCode(o);return{errorCode:o,title:f(L.default,{loc:a}),description:c,items:i}}))}},{key:"getDescriptionForErrorCode",value:function(e){var t=R.a[e],n=t.key;return e===k.e.FILE_LIMIT||e===k.e.TOTAL_LIMIT?this.renderSizeLimitDescription(t):e===k.e.DISK_FULL?this.renderDiskFullDescription(n):e===k.e.DISK_TRAFFIC_LIMIT?(this.metrikaService.sendPopupsMetrika(z.COMPOSE_METRIKA_POPUPS_ATTACHMENTS_ERRORS,z.COMPOSE_METRIKA_POPUPS_ATTACHMENTS_ERRORS_SHOW,z.COMPOSE_METRIKA_POPUPS_ATTACHMENTS_ERRORS_DISK_TRAFFIC_LIMIT),this.renderDiskTrafficLimitDescription(n)):(e===k.e.DISK_TECHNICAL_WORK&&this.metrikaService.sendPopupsMetrika(z.COMPOSE_METRIKA_POPUPS_ATTACHMENTS_ERRORS,z.COMPOSE_METRIKA_POPUPS_ATTACHMENTS_ERRORS_SHOW,z.COMPOSE_METRIKA_POPUPS_ATTACHMENTS_ERRORS_DISK_TECHNICAL_WORK),f(L.default,{loc:n}))}},{key:"renderSizeLimitDescription",value:function(e){var t=e.key,n=e.extraKeyCorp,r=e.extraKeyProd;if(this.attachmentsService.hasDisk)return f(L.default,{loc:t});var o=this.attachmentsService.limits.maxSizeForSingleFile/T.MB_SIZE;return this.attachmentsService.isCorp?f(L.default,{loc:n,params:{size:o}}):f(L.default,{loc:r,params:{size:o}},void 0,f(x.c,{"data-ref":"disk",theme:"normal",url:this.attachmentsService.signUpDiskUrl(),target:"_blank",rel:"noopener",cls:"compose-AttachmentsErrors-Link"}))}},{key:"renderDiskTrafficLimitDescription",value:function(e){return f(L.default,{loc:e},void 0,f(x.c,{"data-ref":"help-link",theme:"normal",url:"".concat(this.attachmentsService.diskHelpUrl()),target:"_blank",rel:"noopener"}))}},{key:"renderDiskFullDescription",value:function(e){return f(L.default,{loc:e},void 0,f(x.c,{"data-ref":"clean",theme:"normal",url:this.attachmentsService.cleanUpYaDiskUrl(),target:"_blank",rel:"noopener",cls:"compose-AttachmentsErrors-Link"}),f(x.c,{"data-ref":"buy",theme:"normal",url:this.attachmentsService.increaseYaDiskSizeUrl(),target:"_blank",rel:"noopener",cls:"compose-AttachmentsErrors-Link"}))}},{key:"render",value:function(){var e=1===this.errorGroups.length,t=e&&this.errorGroups[0],n=e?t.title:U;return f(N.a,{cls:"ComposeAttachmentsErrors",visible:this.currentPopup===w.ATTACHMENTS_ERROR,Title:n,Description:f(F,{errorGroups:this.errorGroups}),ActionText:K,onAction:this.onActionClick,onClose:this.onCloseClick})}},{key:"attachmentsController",get:function(){return this.props.controllers.attachments}},{key:"attachmentsService",get:function(){return this.props.services.attachments}},{key:"metrikaService",get:function(){return this.props.services.metrika}},{key:"isDiskAvailable",get:function(){return this.attachmentsService.hasDisk}},{key:"currentPopup",get:function(){return this.props.visual.currentPopup}},{key:"notValidAttachments",get:function(){return this.attachmentsController.notValidAttachments||[]}},{key:"errorGroups",get:function(){return this.groupAttachmentsByErrorCodes()}}]),t})(E.a.Component),O.propTypes={controllers:A.a.isRequired,services:j.a.isRequired,visual:M.a.isRequired},h=g,y(h.prototype,"attachmentsController",[P.computed],Object.getOwnPropertyDescriptor(h.prototype,"attachmentsController"),h.prototype),y(h.prototype,"attachmentsService",[P.computed],Object.getOwnPropertyDescriptor(h.prototype,"attachmentsService"),h.prototype),y(h.prototype,"metrikaService",[P.computed],Object.getOwnPropertyDescriptor(h.prototype,"metrikaService"),h.prototype),y(h.prototype,"isDiskAvailable",[P.computed],Object.getOwnPropertyDescriptor(h.prototype,"isDiskAvailable"),h.prototype),y(h.prototype,"currentPopup",[P.computed],Object.getOwnPropertyDescriptor(h.prototype,"currentPopup"),h.prototype),y(h.prototype,"notValidAttachments",[P.computed],Object.getOwnPropertyDescriptor(h.prototype,"notValidAttachments"),h.prototype),v=y(h.prototype,"closePopup",[P.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){e.props.visual.currentPopup="",setTimeout(Object(P.action)((function(){e.attachmentsController.removeNotValidAttachments()})),200)}}}),y(h.prototype,"errorGroups",[P.computed],Object.getOwnPropertyDescriptor(h.prototype,"errorGroups"),h.prototype),m=h))||m)||m},3858:function(e,t){},3859:function(e,t){},3860:function(e,t,n){"use strict";function r(e){"@babel/helpers - typeof";return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t,n,r,o,i,a){try{var c=e[i](a),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,o)}function i(e){return function(){var t=this,n=arguments;return new Promise(function(r,i){function a(e){o(s,r,i,a,c,"next",e)}function c(e){o(s,r,i,a,c,"throw",e)}var s=e.apply(t,n);a(void 0)})}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t,n){return t&&c(e.prototype,t),n&&c(e,n),e}function u(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?p(e):t}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function p(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function f(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&d(e,t)}function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function y(e,t,n,r){C||(C="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=r;else if(i>1){for(var a=new Array(i),c=0;c<i;c++)a[c]=arguments[c+3];t.children=a}if(t&&o)for(var s in o)void 0===t[s]&&(t[s]=o[s]);else t||(t=o||{});return{$$typeof:C,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function b(e,t,n,r){n&&Object.defineProperty(e,t,{enumerable:n.enumerable,configurable:n.configurable,writable:n.writable,value:n.initializer?n.initializer.call(r):void 0})}function m(e,t,n,r,o){var i={};return Object.keys(r).forEach((function(e){i[e]=r[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce((function(n,r){return r(e,t,n)||n}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}n.d(t,"a",(function(){return J}));var h,v,O,g,_,S,E,P,C,w=n(137),T=n.n(w),k=n(353),R=n(351),A=n(376),j=n(372),M=n(365),I=n(800),D=n(380),N=n(352),L=n(488),x=n(360),z=(n.n(x),n(382)),B=n(366),F=(n.n(B),n(624)),U=n(360),K=(n.n(U),n(3861)),H=(n.n(K),"ComposeReactCaptcha"),W={Block:H,Captcha:"".concat(H,"-Captcha"),Section:"".concat(H,"-Section"),ImageContainer:"".concat(H,"-ImageContainer"),Image:"".concat(H,"-Image"),Link:"".concat(H,"-Link"),Label:"".concat(H,"-Label"),Input:"".concat(H,"-Input")},G=y(N.default,{loc:"compose-react/Captcha_Title"}),Y=y(N.default,{loc:"compose-react/Send"}),q=y(N.default,{loc:"compose-react/Captcha_Message"}),V=y("br",{}),$=y("br",{}),Q=y(N.default,{loc:"compose-react/Captcha_Refresh"}),J=(h=Object(k.inject)("data","services","controllers","visual","validation"))(v=Object(k.observer)((P=E=(function(e){function t(){var e,n;a(this,t);for(var r=arguments.length,o=new Array(r),c=0;c<r;c++)o[c]=arguments[c];return n=u(this,(e=l(t)).call.apply(e,[this].concat(o))),n._afterUpdateQueue=[],n._disposer=new z.a,n._inputRef=T.a.createRef(),n.showPopup=function(e){var t=e.error,r=e.captchaKey,o=e.captchaUrl;t===B.SendError.CAPTCHA&&(n.updateCaptcha({captchaKey:r,captchaUrl:o}),n.metrikaService.sendPopupsMetrika(x.COMPOSE_METRIKA_POPUPS_CAPTCHA,x.COMPOSE_METRIKA_POPUPS_CAPTCHA_SHOW))},b(p(n),"closePopup",g,p(n)),b(p(n),"onActionClick",_,p(n)),n.onCloseClick=function(){n.closePopup(),n.metrikaService.sendPopupsMetrika(x.COMPOSE_METRIKA_POPUPS_CAPTCHA,U.COMPOSE_METRIKA_POPUPS_CAPTCHA_CANCEL),n.composeController.focusComposeField("body")},n._onRefreshCaptchaClick=(function(){var e=i(regeneratorRuntime.mark((function e(t){var r,o,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),n.metrikaService.sendPopupsMetrika(x.COMPOSE_METRIKA_POPUPS_CAPTCHA,x.COMPOSE_METRIKA_POPUPS_CAPTCHA_REFRESH),e.next=4,n.captchaService.refreshCaptcha();case 4:r=e.sent,o=r.captchaKey,i=r.captchaUrl,n.updateCaptcha({captchaKey:o,captchaUrl:i});case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}})(),n.afterUpdate=function(e){n._afterUpdateQueue.push(e)},b(p(n),"_onChangeCaptchaValue",S,p(n)),n}return f(t,e),s(t,[{key:"updateCaptcha",value:function(e){var t=e.captchaKey,n=e.captchaUrl;this.props.visual.currentPopup=B.Popups.CAPTCHA,this.captcha.key=t,this.captcha.imgUrl=n,this.captcha.value=""}},{key:"componentDidMount",value:function(){var e=this;this._disposer.add(this,[Object(R.reaction)((function(){return e.props.validation.sendError}),(function(t){return t&&e.showPopup(t)})),Object(R.reaction)((function(){return e.isVisible}),(function(t){var n=e._inputRef.current;t&&n&&e.afterUpdate((function(){return n.focus()}))}))])}},{key:"componentDidUpdate",value:function(){this._afterUpdateQueue.forEach((function(e){return e()})),this._afterUpdateQueue=[]}},{key:"componentWillUnmount",value:function(){this._disposer.dispose(this)}},{key:"render",value:function(){return y(F.a,{visible:this.isVisible,Title:G,Description:this._renderContent(),ActionText:Y,onAction:this.onActionClick,onClose:this.onCloseClick})}},{key:"_renderContent",value:function(){var e=this.captcha,t=e.imgUrl,n=e.value;return y("div",{className:W.Block},void 0,q,V,$,y(N.default,{loc:"compose-react/Captcha_Description"},void 0,y(L.a,{cls:W.Link,"data-ref":"help-link",rel:"noreferrer noopener",url:"https://yandex.".concat(this.topLevelDomain,"/support/mail/web/spam.html#sending-limits"),target:"_blank"})),y("div",{className:W.Captcha},void 0,y("div",{className:W.Section},void 0,y("div",{className:W.ImageContainer},void 0,y("img",{className:W.Image,src:t})),y(L.a,{cls:W.Link,onClick:this._onRefreshCaptchaClick},void 0,Q)),y("div",{className:W.Section},void 0,y(N.default,{className:W.Label,loc:"compose-react/Captcha_AnswerLabel"}),T.a.createElement("input",{autoFocus:!0,ref:this._inputRef,className:W.Input,onChange:this._onChangeCaptchaValue,value:n}))))}},{key:"composeController",get:function(){return this.props.controllers.compose}},{key:"captchaService",get:function(){return this.props.services.captcha}},{key:"captcha",get:function(){return this.props.data.captcha}},{key:"isVisible",get:function(){return this.props.visual.currentPopup===B.Popups.CAPTCHA}},{key:"metrikaService",get:function(){return this.props.services.metrika}},{key:"topLevelDomain",get:function(){return this.props.services.settings.topLevelDomain}}]),t})(T.a.Component),E.propTypes={data:A.a.isRequired,controllers:j.a.isRequired,services:M.a.isRequired,validation:I.a.isRequired,visual:D.a.isRequired},O=P,m(O.prototype,"composeController",[R.computed],Object.getOwnPropertyDescriptor(O.prototype,"composeController"),O.prototype),m(O.prototype,"captchaService",[R.computed],Object.getOwnPropertyDescriptor(O.prototype,"captchaService"),O.prototype),m(O.prototype,"captcha",[R.computed],Object.getOwnPropertyDescriptor(O.prototype,"captcha"),O.prototype),m(O.prototype,"isVisible",[R.computed],Object.getOwnPropertyDescriptor(O.prototype,"isVisible"),O.prototype),m(O.prototype,"metrikaService",[R.computed],Object.getOwnPropertyDescriptor(O.prototype,"metrikaService"),O.prototype),m(O.prototype,"topLevelDomain",[R.computed],Object.getOwnPropertyDescriptor(O.prototype,"topLevelDomain"),O.prototype),m(O.prototype,"updateCaptcha",[R.action],Object.getOwnPropertyDescriptor(O.prototype,"updateCaptcha"),O.prototype),g=m(O.prototype,"closePopup",[R.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){e.props.visual.currentPopup="",e.props.visual.isLocked=!1,e.props.validation.sendError=null}}}),_=m(O.prototype,"onActionClick",[R.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){e.props.controllers.saveSend.sendMessage(),e.metrikaService.sendPopupsMetrika(x.COMPOSE_METRIKA_POPUPS_CAPTCHA,x.COMPOSE_METRIKA_POPUPS_CAPTCHA_SEND)}}}),S=m(O.prototype,"_onChangeCaptchaValue",[R.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){e.captcha.value=t.target.value}}}),v=O))||v)||v},3861:function(e,t){},3862:function(e,t,n){"use strict";function r(e){"@babel/helpers - typeof";return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}function c(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?u(e):t}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function u(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function f(e,t,n,r){P||(P="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=r;else if(i>1){for(var a=new Array(i),c=0;c<i;c++)a[c]=arguments[c+3];t.children=a}if(t&&o)for(var s in o)void 0===t[s]&&(t[s]=o[s]);else t||(t=o||{});return{$$typeof:P,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function d(e,t,n,r){n&&Object.defineProperty(e,t,{enumerable:n.enumerable,configurable:n.configurable,writable:n.writable,value:n.initializer?n.initializer.call(r):void 0})}function y(e,t,n,r,o){var i={};return Object.keys(r).forEach((function(e){i[e]=r[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce((function(n,r){return r(e,t,n)||n}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}n.d(t,"a",(function(){return B}));var b,m,h,v,O,g,_,S,E,P,C=n(137),w=n.n(C),T=n(353),k=n(351),R=n(352),A=n(624),j=n(372),M=n(380),I=n(366),D=(n.n(I),I.Popups.CONFIRM_REMOVE),N=f(R.default,{loc:"compose-react/Confirm_remove_title"}),L=f(R.default,{loc:"compose-react/Confirm_remove_desc"}),x=f(R.default,{loc:"compose-react/Confirm_remove_action"}),z=f(R.default,{loc:"compose-react/Confirm_remove_cancel"}),B=(b=Object(T.inject)("controllers"),m=Object(T.inject)("visual"),b(h=m(h=Object(T.observer)((E=S=(function(e){function t(){var e,n;o(this,t);for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return n=c(this,(e=s(t)).call.apply(e,[this].concat(i))),d(u(n),"closePopup",O,u(n)),d(u(n),"removeAndClose",g,u(n)),d(u(n),"closeWithoutSaving",_,u(n)),n}return l(t,e),a(t,[{key:"render",value:function(){return f(A.a,{visible:this.currentPopup===D,Title:N,Description:L,ActionText:x,CancelText:z,onAction:this.removeAndClose,onCancel:this.closeWithoutSaving,onClose:this.closePopup})}},{key:"checkUnsavedChangesController",get:function(){return this.props.controllers.checkUnsavedChanges}},{key:"currentPopup",get:function(){return this.props.visual.currentPopup}}]),t})(w.a.Component),S.propTypes={controllers:j.a.isRequired,visual:M.a.isRequired},v=E,y(v.prototype,"checkUnsavedChangesController",[k.computed],Object.getOwnPropertyDescriptor(v.prototype,"checkUnsavedChangesController"),v.prototype),y(v.prototype,"currentPopup",[k.computed],Object.getOwnPropertyDescriptor(v.prototype,"currentPopup"),v.prototype),O=y(v.prototype,"closePopup",[k.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){e.checkUnsavedChangesController.cancelRemoveDraft()}}}),g=y(v.prototype,"removeAndClose",[k.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){e.checkUnsavedChangesController.confirmRemoveDraft()}}}),_=y(v.prototype,"closeWithoutSaving",[k.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){e.checkUnsavedChangesController.rejectRemoveDraft()}}}),h=v))||h)||h)||h)},3863:function(e,t,n){"use strict";function r(e){"@babel/helpers - typeof";return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}function c(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?u(e):t}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function u(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function f(e,t,n,r){E||(E="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=r;else if(i>1){for(var a=new Array(i),c=0;c<i;c++)a[c]=arguments[c+3];t.children=a}if(t&&o)for(var s in o)void 0===t[s]&&(t[s]=o[s]);else t||(t=o||{});return{$$typeof:E,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function d(e,t,n,r){n&&Object.defineProperty(e,t,{enumerable:n.enumerable,configurable:n.configurable,writable:n.writable,value:n.initializer?n.initializer.call(r):void 0})}function y(e,t,n,r,o){var i={};return Object.keys(r).forEach((function(e){i[e]=r[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce((function(n,r){return r(e,t,n)||n}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}n.d(t,"a",(function(){return I}));var b,m,h,v,O,g,_,S,E,P=n(137),C=n.n(P),w=n(351),T=n(353),k=n(1314),R=n(372),A=n(376),j=n(380),M=n(366),I=(n.n(M),(b=Object(T.inject)("controllers","data","visual"))(m=Object(T.observer)((S=_=(function(e){function t(){var e,n;o(this,t);for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return n=c(this,(e=s(t)).call.apply(e,[this].concat(i))),d(u(n),"onCancelDiskResources",v,u(n)),d(u(n),"onAttachDiskResources",O,u(n)),d(u(n),"onClose",g,u(n)),n}return l(t,e),a(t,[{key:"render",value:function(){var e=this.props.visual.currentPopup,t=e===M.Popups.DISK_RESOURCES;return this.diskResourcesPopup||t?(this.diskResourcesPopup||(this.diskResourcesPopup=!0),f(k.a,{onClose:this.onClose,isVisible:t,path:this.props.visual.diskResourcesPath,onCancel:this.onCancelDiskResources,onAttach:this.onAttachDiskResources})):null}}]),t})(C.a.Component),_.propTypes={controllers:R.a.isRequired,data:A.a.isRequired,visual:j.a.isRequired},h=S,v=y(h.prototype,"onCancelDiskResources",[w.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){e.props.visual.currentPopup=""}}}),O=y(h.prototype,"onAttachDiskResources",[w.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){var n=t.selectedItems;e.props.visual.currentPopup="",e.props.controllers.attachments.attachFilesFromDisk(n)}}}),g=y(h.prototype,"onClose",[w.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t,n){"esc"===n&&(e.props.visual.currentPopup="")}}}),m=h))||m)||m)},3864:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EmptySubject=void 0;var r=n(3865);Object.defineProperty(t,"EmptySubject",{enumerable:!0,get:function(){return r.EmptySubject}})},3865:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return o(t,e),t},a=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a},c=this&&this.__spread||function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(a(arguments[t]));return e},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.EmptySubject=void 0;var u=i(n(137)),l=n(353),p=n(351),f=s(n(468)),d=n(366),y=n(620),b=n(3866);t.EmptySubject=l.observer((function(){var e=y.useStores(),t=e.visual,n=t.currentPopup,r=t.subjectsSuggest.suggestItems,o=e.data,i=e.validation.sendError,a=e.controllers,s=a.visual,l=a.compose,m=a.smartSubject,h=a.saveSend,v=e.services,O=v.settings,g=v.metrika,_=n===d.Popups.EMPTY_SUBJECT,S=u.useCallback((function(e){e&&(O.isSmartSubjectEnabled=!1)}),[O]),E=u.useCallback((function(e){s.closeCurrentPopup(),S(e),l.focusComposeField("subject")}),[l,S,s]),P=u.useCallback((function(e){p.runInAction((function(){return o.allowEmptySubject=!0})),h.sendMessage(),S(e)}),[o,S,h]),C=u.useCallback((function(){s.closeCurrentPopup(),l.focusComposeField("subject")}),[l,s]),w=u.useCallback((function(e){p.runInAction((function(){o.subject=e.text})),m.logSuggestSelect(e)}),[o,m]),T=u.useCallback((function(e){p.runInAction((function(){o.subject=e.target.value}))}),[o]),k=u.useCallback((function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return g.sendPopupsMetrika.apply(g,c(e))}),[g]);return u.useEffect((function(){(null===i||void 0===i?void 0:i.error)===d.SendError.EMPTY_SUBJECT&&m.getSmartSubjectForPopup().catch(f.default).then((function(){return s.openPopup(d.Popups.EMPTY_SUBJECT)}))}),[m,s,i]),u.default.createElement(b.EmptySubjectContent,{subject:o.subject,onChangeSubject:T,suggestItems:r||[],visible:_,onClose:E,onAction:P,onCancel:C,onSelectSubject:w,onSendMetric:k})}))},3866:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return o(t,e),t},a=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a},c=this&&this.__spread||function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(a(arguments[t]));return e},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.SuggestItem=t.EmptySubjectContent=void 0;var u=i(n(137)),l=s(n(350)),p=n(558),f=n(140),d=n(142),y=n(156),b=s(n(367)),m=n(3867),h=s(n(352)),v=n(360),O=n(87),g=n(389),_=n(381),S=s(n(3871)),E="ComposeReactEmptySubjectPopup",P={Block:E,Section:E+"-Section",Label:E+"-Label",Input:E+"-Input",WithEmptySubject:E+"_withEmptySubject",SuggestSection:E+"-SuggestSection",SuggestContainer:E+"-SuggestContainer",SuggestItem:E+"-SuggestItem",SuggestItemHighlighted:E+"-SuggestItem_highlighted"},C=function(e){var n,r=e.subject,o=e.onAction,i=e.onCancel,s=e.onChangeSubject,d=e.onClose,E=e.onSelectSubject,C=e.onSendMetric,w=e.suggestItems,T=e.visible,k=Boolean(r),R=l.default(P.Block,S.default.root,(n={},n[P.WithEmptySubject]=!k,n[S.default.withEmptySubject]=!k,n),O.hasFeature(O.Features.WEB_DARK_COMPOSE)?"":_.cnTheme(g.PS_LIGHT)),A=k?"compose-react/EmptySubjectPopup_Send":"compose-react/EmptySubjectPopup_SendEmpty",j=w.length?"compose-react/EmptySuggestPopup_SmartSubjectDescription":"compose-react/EmptySuggestPopup_NoSuggestDescription",M=u.useCallback((function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];C.apply(void 0,c([v.COMPOSE_METRIKA_POPUPS_SMART_SUBJECT],e))}),[C]),I=a(u.useState(!1),2),D=I[0],N=I[1],L=u.useCallback((function(e){N(e.target.checked),M(v.COMPOSE_METRIKA_POPUPS_EMPTY_SUBJECT_CLICK_DO_NOT_SHOW)}),[M,N]),x=u.useCallback((function(){o(D),M(r?v.COMPOSE_METRIKA_POPUPS_EMPTY_SUBJECT_SEND:v.COMPOSE_METRIKA_POPUPS_EMPTY_SUBJECT_SEND_EMPTY)}),[D,o,M,r]),z=u.useCallback((function(){d(D),M(v.COMPOSE_METRIKA_POPUPS_EMPTY_SUBJECT_CLOSE)}),[D,d,M]),B=u.useCallback((function(){i(),M(v.COMPOSE_METRIKA_POPUPS_EMPTY_SUBJECT_CANCEL)}),[i,M]),F=u.useMemo((function(){return w.slice(0,p.MAX_SUGGEST_ITEMS_FOR_POPUP)}),[w]);return u.useEffect((function(){T&&M(v.COMPOSE_METRIKA_POPUPS_EMPTY_SUBJECT_SHOW)}),[M,T]),u.default.createElement(m.ConfirmPopup,{className:R,visible:T,onClose:z},u.default.createElement(m.PopupTitle,null,u.default.createElement(h.default,{loc:"compose-react/EmptySubjectPopup_Title"})),u.default.createElement(m.PopupBody,null,u.default.createElement(f.Text,{as:"div",typography:"body-long-m"},u.default.createElement(h.default,{loc:j})),u.default.createElement("div",{className:S.default.suggest},F.map((function(e,n){return u.default.createElement(t.SuggestItem,{key:"SuggestItem-"+n,onSelectSubject:E,item:e,subject:r,onSendMetric:M})}))),u.default.createElement(y.Textinput,{view:"default",size:"l",autoFocus:!0,className:l.default(P.Input,S.default.input),placeholder:b.default("compose-react/EmptySuggestPopup_SubjectPlaceholder"),value:r,onChange:s})),u.default.createElement(m.PopupButtons,null,u.default.createElement(m.PopupConfirmButton,{view:"default",onClick:x},u.default.createElement(h.default,{loc:A})),u.default.createElement(m.PopupCancelButton,{view:"clear",onClick:B},u.default.createElement(h.default,{loc:"compose-react/EmptySubjectPopup_Return"}))),u.default.createElement(m.PopupCheckbox,{checked:D,onChange:L,label:u.default.createElement(h.default,{loc:"compose-react/EmptySuggestPopup_DontShow"})}))};t.EmptySubjectContent=C;var w=function(e){var t,n=e.item,r=e.subject,o=e.onSelectSubject,i=e.onSendMetric,a=u.useCallback((function(){o(n),i(v.COMPOSE_METRIKA_POPUPS_SMART_SUBJECT_SELECT_FROM_SUGGEST)}),[n,o,i]);return u.default.createElement(d.Button,{className:l.default(P.SuggestItem,S.default.suggestItem,(t={},t[P.SuggestItemHighlighted]=n.text===r,t[S.default.highlighted]=n.text===r,t)),view:"default",size:"l",onClick:a},n.text)};t.SuggestItem=w},3867:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),o(n(3868),t)},3868:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},r.apply(this,arguments)},o=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&o(t,e,n);return i(t,e),t},c=this&&this.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var o=0,r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]]);return n},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.PopupCheckbox=t.PopupCancelButton=t.PopupConfirmButton=t.PopupButtons=t.PopupDescription=t.PopupBody=t.PopupTitle=t.ConfirmPopup=t.PopupCloseButton=void 0;var u=a(n(137)),l=s(n(350)),p=s(n(801)),f=n(142),d=n(140),y=n(148),b=s(n(3869)),m=s(n(3870)),h=n(620),v="qa-ComposeConfirmPopup",O={Block:v,Content:v+"-Content",Title:v+"-Title",Description:v+"-Description",Toolbar:v+"-Toolbar",Button:v+"-Button",Button_action:v+"-Button_action",Button_cancel:v+"-Button_cancel",Close:v+"-Close",CheckmarkSection:v+"-CheckmarkSection"},g=function(e){return u.default.createElement("span",{className:l.default(e,b.default.icon)},u.default.createElement(m.default,null))},_=function(e){return u.default.createElement("div",{className:b.default.close},u.default.createElement(f.Button,r({className:O.Close,view:"clear",size:"l",icon:g},e)))};t.PopupCloseButton=_;var S=function(e){var n,o=e.className,i=e.children,a=e.onClose,s=c(e,["className","children","onClose"]),f=h.useStores().services.settings,d=f.isMobile,y=f.isTablet,m=l.default(o,b.default.root,O.Block,d?b.default.mobile:b.default.desktop,(n={},n[b.default.tablet]=y,n)),v=u.useCallback((function(e){return null===a||void 0===a?void 0:a(e,"click")}),[a]);return u.default.createElement(p.default,r({},s,{className:m}),u.default.createElement("div",{className:l.default(b.default.content,O.Content)},a&&u.default.createElement(t.PopupCloseButton,{onClick:v}),i))};t.ConfirmPopup=S;var E=function(e){var t=e.className,n=c(e,["className"]);return u.default.createElement(d.Text,r({typography:"subheader-m",as:"h2",className:l.default(O.Title,b.default.title,t),weight:"bold"},n))};t.PopupTitle=E;var P=function(e){var t=e.className,n=c(e,["className"]);return u.default.createElement("div",r({className:l.default(b.default.body,t)},n))};t.PopupBody=P;var C=function(e){var t=e.className,n=c(e,["className"]);return u.default.createElement(d.Text,r({as:"div",typography:"body-long-m",className:l.default(O.Description,b.default.description,t)},n))};t.PopupDescription=C;var w=function(e){var t=e.className,n=c(e,["className"]);return u.default.createElement("div",r({className:l.default(O.Toolbar,b.default.toolbar,t)},n))};t.PopupButtons=w;var T=function(e){var t=e.className,n=c(e,["className"]);return u.default.createElement(f.Button,r({className:l.default(O.Button,O.Button_action,b.default.button,t),view:"action",size:"m"},n))};t.PopupConfirmButton=T;var k=function(e){var t=e.className,n=c(e,["className"]);return u.default.createElement(f.Button,r({className:l.default(O.Button,O.Button_action,b.default.button,t),view:"default",size:"m"},n))};t.PopupCancelButton=k;var R=function(e){var t=e.className,n=c(e,["className"]);return u.default.createElement("div",{className:b.default.checkmarkSection},u.default.createElement(y.Checkbox,r({className:l.default(O.CheckmarkSection,t),size:"s",view:"default"},n)))};t.PopupCheckbox=R},3869:function(e,t){e.exports={root:"ConfirmPopup__root--2EoZ0",desktop:"ConfirmPopup__desktop--37vMZ",content:"ConfirmPopup__content--2n4Zq",title:"ConfirmPopup__title--3XU8M",description:"ConfirmPopup__description--1hcEN",body:"ConfirmPopup__body--24NZg",toolbar:"ConfirmPopup__toolbar--2DMIe",button:"ConfirmPopup__button--_Z6O_",mobile:"ConfirmPopup__mobile--Idpr8",tablet:"ConfirmPopup__tablet--1AFyC",close:"ConfirmPopup__close--KEuX_",checkmarkSection:"ConfirmPopup__checkmarkSection--PWus-",icon:"ConfirmPopup__icon--3jv9V"}},3870:function(e,t,n){"use strict";function r(){return r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},r.apply(this,arguments)}function o(e){return a.createElement("svg",r({width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},e),c)}Object.defineProperty(t,"__esModule",{value:!0});var i,a=n(137),c=(n.n(a),(function(e,t,n,r){i||(i="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,a=arguments.length-3;if(t||0===a||(t={children:void 0}),1===a)t.children=r;else if(a>1){for(var c=new Array(a),s=0;s<a;s++)c[s]=arguments[s+3];t.children=c}if(t&&o)for(var u in o)void 0===t[u]&&(t[u]=o[u]);else t||(t=o||{});return{$$typeof:i,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}})("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M19.207 6.207a1 1 0 00-1.414-1.414L12 10.586 6.207 4.793a1 1 0 00-1.414 1.414L10.586 12l-5.793 5.793a1 1 0 101.414 1.414L12 13.414l5.793 5.793a1 1 0 001.414-1.414L13.414 12l5.793-5.793z",fill:"currentColor"}));t.default=o},3871:function(e,t){e.exports={root:"EmptySubject__root--2oSpR",suggest:"EmptySubject__suggest--x4PpG",suggestItem:"EmptySubject__suggestItem--2hCGL",input:"EmptySubject__input--102Gc"}},3872:function(e,t,n){"use strict";function r(e){"@babel/helpers - typeof";return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}function c(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?u(e):t}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function u(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function f(e,t,n,r){S||(S="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=r;else if(i>1){for(var a=new Array(i),c=0;c<i;c++)a[c]=arguments[c+3];t.children=a}if(t&&o)for(var s in o)void 0===t[s]&&(t[s]=o[s]);else t||(t=o||{});return{$$typeof:S,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function d(e,t,n,r){n&&Object.defineProperty(e,t,{enumerable:n.enumerable,configurable:n.configurable,writable:n.writable,value:n.initializer?n.initializer.call(r):void 0})}function y(e,t,n,r,o){var i={};return Object.keys(r).forEach((function(e){i[e]=r[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce((function(n,r){return r(e,t,n)||n}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}n.d(t,"a",(function(){return U}));var b,m,h,v,O,g,_,S,E=n(137),P=n.n(E),C=n(353),w=n(351),T=n(352),k=n(372),R=n(365),A=n(800),j=n(380),M=n(360),I=(n.n(M),n(382)),D=n(366),N=(n.n(D),n(624)),L=n(3873),x=(n.n(L),n(366)),z=(n.n(x),D.Popups.LIMITED_RECIPIENTS),B=f(T.default,{loc:"compose-react/LimitedRecipients_Title"}),F=f(T.default,{loc:"compose-react/LimitedRecipients_ConfirmButton"}),U=(b=Object(C.inject)("services","controllers","validation","visual"))(m=Object(C.observer)((_=g=(function(e){function t(){var e,n;o(this,t);for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return n=c(this,(e=s(t)).call.apply(e,[this].concat(i))),n._disposer=new I.a,d(u(n),"showPopup",v,u(n)),d(u(n),"closePopup",O,u(n)),n.onCloseClick=function(){n.closePopup(),n.metrikaService.sendPopupsMetrika(M.COMPOSE_METRIKA_POPUPS_LIMITED_RECIPIENTS,M.COMPOSE_METRIKA_POPUPS_LIMITED_RECIPIENTS_CLOSE)},n}return l(t,e),a(t,[{key:"componentDidMount",value:function(){var e=this;this._disposer.add(this,[Object(w.reaction)((function(){return e.props.validation.limitedRecipients}),this.showPopup)])}},{key:"componentWillUnmount",value:function(){this._disposer.dispose(this)}},{key:"render",value:function(){return f(N.a,{cls:"ComposeLimitedRecipientsPopup",visible:this.currentPopup===z,Title:B,Description:f("div",{},void 0,this._renderErrorMessage()),ActionText:F,onAction:this.onCloseClick,onClose:this.onCloseClick})}},{key:"_renderErrorMessage",value:function(){return f(T.default,{loc:"compose-react/LimitedRecipients_Message",params:{emails:(this.limitedEmails||[]).join(", ")}})}},{key:"limitedEmails",get:function(){return this.props.validation.limitedRecipients}},{key:"composeController",get:function(){return this.props.controllers.compose}},{key:"currentPopup",get:function(){return this.props.visual.currentPopup}},{key:"metrikaService",get:function(){return this.props.services.metrika}}]),t})(P.a.Component),g.propTypes={controllers:k.a.isRequired,services:R.a.isRequired,validation:A.a.isRequired,visual:j.a.isRequired},h=_,y(h.prototype,"limitedEmails",[w.computed],Object.getOwnPropertyDescriptor(h.prototype,"limitedEmails"),h.prototype),y(h.prototype,"composeController",[w.computed],Object.getOwnPropertyDescriptor(h.prototype,"composeController"),h.prototype),y(h.prototype,"currentPopup",[w.computed],Object.getOwnPropertyDescriptor(h.prototype,"currentPopup"),h.prototype),y(h.prototype,"metrikaService",[w.computed],Object.getOwnPropertyDescriptor(h.prototype,"metrikaService"),h.prototype),v=y(h.prototype,"showPopup",[w.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){t.length&&(e.props.visual.currentPopup=z,e.metrikaService.sendPopupsMetrika(M.COMPOSE_METRIKA_POPUPS_LIMITED_RECIPIENTS,M.COMPOSE_METRIKA_POPUPS_LIMITED_RECIPIENTS_SHOW))}}}),O=y(h.prototype,"closePopup",[w.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){e.props.visual.currentPopup="",e.props.visual.isLocked=!1,e.props.validation.limitedRecipients=[],e.composeController.closeCompose({leaveType:x.LeaveTypes.SENT})}}}),m=h))||m)||m},3873:function(e,t){},3874:function(e,t,n){"use strict";function r(e){"@babel/helpers - typeof";return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}function c(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?u(e):t}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function u(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function f(e,t,n,r){P||(P="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=r;else if(i>1){for(var a=new Array(i),c=0;c<i;c++)a[c]=arguments[c+3];t.children=a}if(t&&o)for(var s in o)void 0===t[s]&&(t[s]=o[s]);else t||(t=o||{});return{$$typeof:P,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function d(e,t,n,r){n&&Object.defineProperty(e,t,{enumerable:n.enumerable,configurable:n.configurable,writable:n.writable,value:n.initializer?n.initializer.call(r):void 0})}function y(e,t,n,r,o){var i={};return Object.keys(r).forEach((function(e){i[e]=r[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce((function(n,r){return r(e,t,n)||n}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}n.d(t,"a",(function(){return z}));var b,m,h,v,O,g,_,S,E,P,C=n(137),w=n.n(C),T=n(353),k=n(351),R=n(352),A=n(624),j=n(372),M=n(380),I=n(366),D=(n.n(I),I.Popups.REMOVE_DRAFT),N=f(R.default,{loc:"compose-react/DeleteDraft_Popup_Content"}),L=f(R.default,{loc:"compose-react/DeleteDraft_Popup_ConfirmButton"}),x=f(R.default,{loc:"compose-react/Confirm_remove_cancel"}),z=(b=Object(T.inject)("controllers"),m=Object(T.inject)("visual"),b(h=m(h=Object(T.observer)((E=S=(function(e){function t(){var e,n;o(this,t);for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return n=c(this,(e=s(t)).call.apply(e,[this].concat(i))),d(u(n),"closePopup",O,u(n)),d(u(n),"removeAndClose",g,u(n)),d(u(n),"cancel",_,u(n)),n}return l(t,e),a(t,[{key:"render",value:function(){return f(A.a,{visible:this.currentPopup===D,Description:N,ActionText:L,CancelText:x,onAction:this.removeAndClose,onCancel:this.cancel,onClose:this.closePopup})}},{key:"currentPopup",get:function(){return this.props.visual.currentPopup}}]),t})(w.a.Component),S.propTypes={controllers:j.a.isRequired,visual:M.a.isRequired},v=E,y(v.prototype,"currentPopup",[k.computed],Object.getOwnPropertyDescriptor(v.prototype,"currentPopup"),v.prototype),O=y(v.prototype,"closePopup",[k.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){e.props.controllers.deleteDraft.cancelRemoveDraft({isClose:!0})}}}),g=y(v.prototype,"removeAndClose",[k.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){e.props.controllers.deleteDraft.removeDraftAndClose()}}}),_=y(v.prototype,"cancel",[k.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){e.props.controllers.deleteDraft.cancelRemoveDraft()}}}),h=v))||h)||h)||h)},3875:function(e,t,n){"use strict";function r(e){"@babel/helpers - typeof";return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}function c(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?u(e):t}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function u(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function f(e,t,n,r){E||(E="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=r;else if(i>1){for(var a=new Array(i),c=0;c<i;c++)a[c]=arguments[c+3];t.children=a}if(t&&o)for(var s in o)void 0===t[s]&&(t[s]=o[s]);else t||(t=o||{});return{$$typeof:E,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function d(e,t,n,r){n&&Object.defineProperty(e,t,{enumerable:n.enumerable,configurable:n.configurable,writable:n.writable,value:n.initializer?n.initializer.call(r):void 0})}function y(e,t,n,r,o){var i={};return Object.keys(r).forEach((function(e){i[e]=r[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce((function(n,r){return r(e,t,n)||n}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}n.d(t,"a",(function(){return ye}));var b,m,h,v,O,g,_,S,E,P=n(138),C=n.n(P),w=n(137),T=n.n(w),k=n(353),R=n(351),A=n(352),j=n(372),M=n(376),I=n(365),D=n(800),N=n(380),L=n(1258),x=(n.n(L),n(360)),z=(n.n(x),n(382)),B=n(366),F=(n.n(B),n(624)),U=B.Popups.SEND_FAILED,K=f(A.default,{loc:"compose-react/SendFailed_Title"}),H=f(A.default,{loc:"compose-react/SendFailed_ConfirmButton_Title"}),W=f(A.default,{loc:"compose-react/SendFailed_RetryNowButton_Title"}),G=f(A.default,{loc:"compose-react/SendFailed_RetryButton_Title"}),Y=f(A.default,{loc:"compose-react/SendFailed_ConfirmButton"}),q=f(A.default,{loc:"compose-react/SendFailed_Spam_UrlRbl"}),V=f(A.default,{loc:"compose-react/SendFailed_Spam_BadKarma"}),$=f(A.default,{loc:"compose-react/SendFailed_Spam_Bounces"}),Q=f(A.default,{loc:"compose-react/SendFailed_Spam_SpamCompl"}),J=f(A.default,{loc:"compose-react/SendFailed_Virus"}),X=f(A.default,{loc:"compose-react/SendFailed_IncorrectTo"}),Z=f(A.default,{loc:"compose-react/SendFailed_IncorrectCc"}),ee=f(A.default,{loc:"compose-react/SendFailed_IncorrectBcc"}),te=f(A.default,{loc:"compose-react/SendFailed_MsgTooBig"}),ne=f(A.default,{loc:"compose-react/SendFailed_NoRecipients"}),re=f(A.default,{loc:"compose-react/SendFailed_FailLimit"}),oe=f(A.default,{loc:"compose-react/SendFailed_TooManyEmails"}),ie=f(A.default,{loc:"compose-react/SendFailed_NoData"}),ae=f(A.default,{loc:"compose-react/SendFailed_NoNetwork"}),ce=f(A.default,{loc:"compose-react/SendFailed_NoAccess"}),se=f(A.default,{loc:"compose-react/SendFailed_IllegalParams"}),ue=f(A.default,{loc:"compose-react/SendFailed_UndoCannotSave"}),le=f(A.default,{loc:"compose-react/SendFailed_UndoMessageSaved"}),pe=f(A.default,{loc:"compose-react/SendFailed_DelayedCannotSave"}),fe=f(A.default,{loc:"compose-react/SendFailed_DelayedMessageSaved"}),de=f(A.default,{loc:"compose-react/SendFailed_InternalError"}),ye=(b=Object(k.inject)("services","controllers","data","validation","visual"))(m=Object(k.observer)((S=_=(function(e){function t(){var e,n;o(this,t);for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return n=c(this,(e=s(t)).call.apply(e,[this].concat(i))),n._disposer=new z.a,d(u(n),"retryToSend",v,u(n)),d(u(n),"showPopup",O,u(n)),d(u(n),"closePopup",g,u(n)),n.onRetry=function(){n.retryToSend(),n.closePopup(),n.metrikaService.sendPopupsMetrika(x.COMPOSE_METRIKA_POPUPS_SEND_FAILED,x.COMPOSE_METRIKA_POPUPS_SEND_FAILED_RETRY)},n.onCancel=function(){n.closePopup(),n.metrikaService.sendPopupsMetrika(x.COMPOSE_METRIKA_POPUPS_SEND_FAILED,x.COMPOSE_METRIKA_POPUPS_SEND_FAILED_CANCEL)},n.onClose=function(){n.closePopup(),n.metrikaService.sendPopupsMetrika(x.COMPOSE_METRIKA_POPUPS_SEND_FAILED,x.COMPOSE_METRIKA_POPUPS_SEND_FAILED_CLOSE)},n}return l(t,e),a(t,[{key:"openPhoneConfirm",value:function(){this.props.controllers.compose.checkAuthConfirmed(!0)}},{key:"componentDidMount",value:function(){var e=this;this._disposer.add(this,[Object(R.reaction)((function(){return e.props.validation.sendError}),(function(t){return t&&e.showPopup(t)}))])}},{key:"componentWillUnmount",value:function(){this._disposer.dispose(this)}},{key:"render",value:function(){var e=this.currentPopup===U,t=K,n=f("div",{},void 0,this._renderErrorMessage()),r=H;if(this.isRetryable){var o=this.isDelayed?W:G;return f(F.a,{visible:e,Title:t,Description:n,ActionText:o,CancelText:r,onAction:this.onRetry,onCancel:this.onCancel,onClose:this.onClose})}var i=this.banReason===B.BanReason.BadKarma?Y:r,a=this.banReason===B.BanReason.BadKarma?this.openPhoneConfirm:this.onCancel;return f(F.a,{visible:e,Title:t,Description:n,ActionText:i,onAction:a.bind(this),onClose:this.onClose})}},{key:"_renderBanReason",value:function(){var e="https://yandex.".concat(this.topLevelDomain,"/support/mail/web");switch(this.banReason){case B.BanReason.UrlRbl:return q;case B.BanReason.BadKarma:return V;case B.BanReason.MailLimits:return f(A.default,{loc:"compose-react/SendFailed_Spam_MailLimits"},void 0,f("a",{"data-ref":"help-link",rel:"noreferrer noopener",href:"".concat(e,"/spam.html#sending-limits"),target:"_blank"}));case B.BanReason.PddAdminKarma:return f(A.default,{loc:"compose-react/SendFailed_Spam_PddAdminKarma"},void 0,f("a",{"data-ref":"help-link",rel:"noreferrer noopener",href:"".concat(e,"/letter/create/troubleshooting.html#account-suspicious"),target:"_blank"}));case B.BanReason.Bounces:return $;case B.BanReason.SpamCompl:return Q;default:return f(A.default,{loc:"compose-react/SendFailed_Spam_Default"},void 0,f("a",{"data-ref":"help-link",rel:"noreferrer noopener",href:"".concat(e,"/letter/create/troubleshooting.html#troubleshooting__sending-limits"),target:"_blank"}))}}},{key:"_renderErrorMessage",value:function(){switch(this.sendError){case B.SendError.VIRUS:return J;case B.SendError.SPAM:return this._renderBanReason();case B.SendError.INCORRECT_TO:return X;case B.SendError.INCORRECT_CC:return Z;case B.SendError.INCORRECT_BCC:return ee;case B.SendError.TOO_BIG:return te;case B.SendError.NO_RECIPIENTS:return ne;case B.SendError.LIMIT_FAIL:return re;case B.SendError.TOO_MANY_EMAILS:return oe;case B.SendError.MAX_EMAIL_ADDRESS_REACHED:return f(A.default,{loc:"compose-react/SendFailed_TooManyRecipients",params:{count:L.MAX_MESSAGES_TO_SEND}});case B.SendError.NO_DATA:return ie;case B.SendError.NO_NETWORK:return ae;case B.SendError.TOO_BIG_ATTACHMENTS:return f(A.default,{loc:"compose-react/SendFailed_TooManyAttachments",params:{forwardedCount:L.MAX_MESSAGES_TO_FORWARD,capacity:L.MAX_TOTAL_SIZE_OF_ATTACHMENTS}});case B.SendError.ACCESS_DENIED:return ce;case B.SendError.ILLEGAL_PARAMS:return se;case B.SendError.UNDO_CANNOT_SAVE:return ue;case B.SendError.UNDO_MESSAGE_SAVED:return le;case B.SendError.DELAYED_CANNOT_SAVE:return pe;case B.SendError.DELAYED_MESSAGE_SAVED:return fe;case B.SendError.INTERNAL_ERROR:return de;default:return null}}},{key:"sendError",get:function(){return this.props.validation.sendError&&this.props.validation.sendError.error}},{key:"banReason",get:function(){return this.props.validation.sendError&&this.props.validation.sendError.banReason}},{key:"composeController",get:function(){return this.props.controllers.compose}},{key:"currentPopup",get:function(){return this.props.visual.currentPopup}},{key:"metrikaService",get:function(){return this.props.services.metrika}},{key:"topLevelDomain",get:function(){return this.props.services.settings.topLevelDomain}},{key:"isRetryable",get:function(){return B.SendError.RETRYABLE_ERRORS.includes(this.sendError)}},{key:"isDelayed",get:function(){return[B.SendError.DELAYED_CANNOT_SAVE,B.SendError.DELAYED_MESSAGE_SAVED].includes(this.sendError)}}]),t})(T.a.Component),_.propTypes={controllers:j.a.isRequired,data:M.a.isRequired,services:I.a.isRequired,validation:D.a.isRequired,visual:N.a.isRequired},h=S,y(h.prototype,"sendError",[R.computed],Object.getOwnPropertyDescriptor(h.prototype,"sendError"),h.prototype),y(h.prototype,"banReason",[R.computed],Object.getOwnPropertyDescriptor(h.prototype,"banReason"),h.prototype),y(h.prototype,"composeController",[R.computed],Object.getOwnPropertyDescriptor(h.prototype,"composeController"),h.prototype),y(h.prototype,"currentPopup",[R.computed],Object.getOwnPropertyDescriptor(h.prototype,"currentPopup"),h.prototype),y(h.prototype,"metrikaService",[R.computed],Object.getOwnPropertyDescriptor(h.prototype,"metrikaService"),h.prototype),y(h.prototype,"topLevelDomain",[R.computed],Object.getOwnPropertyDescriptor(h.prototype,"topLevelDomain"),h.prototype),y(h.prototype,"isRetryable",[R.computed],Object.getOwnPropertyDescriptor(h.prototype,"isRetryable"),h.prototype),y(h.prototype,"isDelayed",[R.computed],Object.getOwnPropertyDescriptor(h.prototype,"isDelayed"),h.prototype),v=y(h.prototype,"retryToSend",[R.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){e.props.controllers.saveSend.retryToSendMessageWithoutUndoAndDelayed(e.props.data,e.props.validation)}}}),O=y(h.prototype,"showPopup",[R.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){var n=t.error;if(!C.a.includes([B.SendError.CAPTCHA,B.SendError.EMPTY_SUBJECT],n)){if(C.a.includes([B.SendError.INCORRECT_BCC,B.SendError.INCORRECT_CC,B.SendError.INCORRECT_TO],n))return void e.props.controllers.validation.validateData(!0);e.props.visual.currentPopup=U,e.metrikaService.sendPopupsMetrika(x.COMPOSE_METRIKA_POPUPS_SEND_FAILED,x.COMPOSE_METRIKA_POPUPS_SEND_FAILED_SHOW)}}}}),g=y(h.prototype,"closePopup",[R.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){e.props.visual.currentPopup="",e.props.visual.isLocked=!1,e.props.validation.sendError=null}}}),m=h))||m)||m},3876:function(e,t,n){"use strict";function r(e){"@babel/helpers - typeof";return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}function c(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?u(e):t}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function u(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function f(e,t,n,r){w||(w="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=r;else if(i>1){for(var a=new Array(i),c=0;c<i;c++)a[c]=arguments[c+3];t.children=a}if(t&&o)for(var s in o)void 0===t[s]&&(t[s]=o[s]);else t||(t=o||{});return{$$typeof:w,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function d(e,t,n,r){n&&Object.defineProperty(e,t,{enumerable:n.enumerable,configurable:n.configurable,writable:n.writable,value:n.initializer?n.initializer.call(r):void 0})}function y(e,t,n,r,o){var i={};return Object.keys(r).forEach((function(e){i[e]=r[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce((function(n,r){return r(e,t,n)||n}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}n.d(t,"a",(function(){return H}));var b,m,h,v,O,g,_,S,E,P,C,w,T=n(137),k=n.n(T),R=n(353),A=n(351),j=n(352),M=n(624),I=n(372),D=n(376),N=n(365),L=n(800),x=n(380),z=n(360),B=(n.n(z),n(382)),F=n(366),U=(n.n(F),F.Popups.VALIDATION_ERROR),K=f(j.default,{loc:"compose-react/Validation_errors_ConfirmButton_Title"}),H=(b=Object(R.inject)("controllers"),m=Object(R.inject)("data"),h=Object(R.inject)("services"),v=Object(R.inject)("validation"),O=Object(R.inject)("visual"),b(g=m(g=h(g=v(g=O(g=Object(R.observer)((C=P=(function(e){function t(){var e,n;o(this,t);for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return n=c(this,(e=s(t)).call.apply(e,[this].concat(i))),n._disposer=new B.a,d(u(n),"showPopup",S,u(n)),d(u(n),"closePopup",E,u(n)),n._focusOnErrorField=function(){var e=u(n),t=e.errors,r=e.composeData;if(t.length){n.validationController.processValidationErrors(t,r);var o=n._getFocusFieldName(t[0]);n.composeController.focusComposeField(o)}},n.onActionClick=function(){n.closePopup(),n.metrikaService.sendPopupsMetrika(z.COMPOSE_METRIKA_POPUPS_VALIDATION_ERRORS,z.COMPOSE_METRIKA_POPUPS_VALIDATION_ERRORS_ACTION)},n.onCloseClick=function(){n.closePopup(),n.metrikaService.sendPopupsMetrika(z.COMPOSE_METRIKA_POPUPS_VALIDATION_ERRORS,z.COMPOSE_METRIKA_POPUPS_VALIDATION_ERRORS_CLOSE)},n}return l(t,e),a(t,[{key:"_getFocusFieldName",value:function(e){return e.additionalFieldNames&&e.additionalFieldNames.length?"".concat(e.fieldName,".").concat(e.additionalFieldNames[0]):e.fieldName}},{key:"componentDidMount",value:function(){var e=this;this._disposer.add(this,[Object(A.reaction)((function(){return e.props.validation.errors}),(function(){return e.showPopup()}))])}},{key:"componentWillUnmount",value:function(){this._disposer.dispose(this)}},{key:"render",value:function(){var e=this.errors.length?this.errors[0]:{},t=e.errorTitleKey||"compose-react/Validation_errors_title",n=e.errorTitleKeyParams||{};return f(M.a,{visible:this.currentPopup===U,Title:f(j.default,{loc:t,params:n}),Description:f("div",{},void 0,this.errors.map((function(e,t){var n=e.errorKey,r=e.errorKeyParams;return f("div",{},"validationError_".concat(t),f(j.default,{loc:n,params:r}))}))),ActionText:K,onAction:this.onActionClick,onClose:this.onCloseClick})}},{key:"composeController",get:function(){return this.props.controllers.compose}},{key:"validationController",get:function(){return this.props.controllers.validation}},{key:"currentPopup",get:function(){return this.props.visual.currentPopup}},{key:"errors",get:function(){return this.props.validation.errors}},{key:"metrikaService",get:function(){return this.props.services.metrika}},{key:"composeData",get:function(){return this.props.data}}]),t})(k.a.Component),P.propTypes={controllers:I.a.isRequired,data:D.a.isRequired,services:N.a.isRequired,visual:x.a.isRequired,validation:L.a.isRequired},_=C,y(_.prototype,"composeController",[A.computed],Object.getOwnPropertyDescriptor(_.prototype,"composeController"),_.prototype),y(_.prototype,"validationController",[A.computed],Object.getOwnPropertyDescriptor(_.prototype,"validationController"),_.prototype),y(_.prototype,"currentPopup",[A.computed],Object.getOwnPropertyDescriptor(_.prototype,"currentPopup"),_.prototype),y(_.prototype,"errors",[A.computed],Object.getOwnPropertyDescriptor(_.prototype,"errors"),_.prototype),y(_.prototype,"metrikaService",[A.computed],Object.getOwnPropertyDescriptor(_.prototype,"metrikaService"),_.prototype),y(_.prototype,"composeData",[A.computed],Object.getOwnPropertyDescriptor(_.prototype,"composeData"),_.prototype),S=y(_.prototype,"showPopup",[A.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){e.errors.length&&(e.props.visual.currentPopup=U,e._focusOnErrorField(),setTimeout(Object(A.action)((function(){return e.props.visual.refs.composeContainer.focus()}))),e.metrikaService.sendPopupsMetrika(z.COMPOSE_METRIKA_POPUPS_VALIDATION_ERRORS,z.COMPOSE_METRIKA_POPUPS_VALIDATION_ERRORS_SHOW))}}}),E=y(_.prototype,"closePopup",[A.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){e.props.visual.currentPopup="",e.props.visual.isLocked=!1,e._focusOnErrorField()}}}),g=_))||g)||g)||g)||g)||g)||g)},3877:function(e,t,n){"use strict";function r(e){"@babel/helpers - typeof";return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t,n,r,o,i,a){try{var c=e[i](a),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,o)}function i(e){return function(){var t=this,n=arguments;return new Promise(function(r,i){function a(e){o(s,r,i,a,c,"next",e)}function c(e){o(s,r,i,a,c,"throw",e)}var s=e.apply(t,n);a(void 0)})}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t,n){return t&&c(e.prototype,t),n&&c(e,n),e}function u(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?l(e):t}function l(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function f(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&d(e,t)}function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}n.d(t,"a",(function(){return b}));var y=n(1794),b=(function(e){function t(){return a(this,t),u(this,p(t).apply(this,arguments))}return f(t,e),s(t,[{key:"onSending",value:(function(){function e(){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Daria.SendMail.showSendingMessage();case 1:case"end":return e.stop()}}),e)})));return e})()},{key:"onSendSuccess",value:(function(){function e(){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:ns.events.trigger("daria:reactQuickReply:close"),Daria.SendMail.showMessageSent();case 2:case"end":return e.stop()}}),e)})));return e})()},{key:"onSendFailed",value:(function(){function e(){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Daria.Statusline.hide();case 1:case"end":return e.stop()}}),e)})));return e})()},{key:"goToFullCompose",value:function(e){return Daria.React.QuickReply.saveDraft().then((function(){return Daria.composeGo(e).then((function(){ns.events.trigger("daria:reactQuickReply:close",{shouldSaveDraft:!1})}))}))}},{key:"onClose",value:(function(){function e(){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:ns.events.trigger("daria:reactQuickReply:close",{shouldSaveDraft:!0});case 1:case"end":return e.stop()}}),e)})));return e})()}]),t})(y.a)},3878:function(e,t,n){"use strict";function r(e){return a(e)||i(e)||o()}function o(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function i(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function a(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}function c(e,t,n,r,o,i,a){try{var c=e[i](a),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,o)}function s(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){function i(e){c(s,r,o,i,a,"next",e)}function a(e){c(s,r,o,i,a,"throw",e)}var s=e.apply(t,n);i(void 0)})}}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function p(e,t,n){return t&&l(e.prototype,t),n&&l(e,n),e}function f(e,t,n,r){n&&Object.defineProperty(e,t,{enumerable:n.enumerable,configurable:n.configurable,writable:n.writable,value:n.initializer?n.initializer.call(r):void 0})}function d(e,t,n,r,o){var i={};return Object.keys(r).forEach((function(e){i[e]=r[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce((function(n,r){return r(e,t,n)||n}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}n.d(t,"a",(function(){return E}));var y,b,m,h,v,O,g=n(351),_=n(1791),S=_.b.avatars,E=(y=O=(function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.subject,r=void 0===n?"":n,o=t.avatar,i=void 0===o?{}:o,a=t.lastSaved,c=void 0===a?0:a,s=t.recipients,l=void 0===s?0:s;u(this,e),f(this,"subject",b,this),f(this,"avatar",m,this),f(this,"lastSaved",h,this),f(this,"recipients",v,this),this.subject=r,this.avatar=i,this.lastSaved=Number(c),this.recipients=Number(l)}return p(e,[{key:"update",value:(function(){function e(e){return t.apply(this,arguments)}var t=s(regeneratorRuntime.mark((function e(t){var n,r,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.subject?t.subject.substring(0,150):"",e.next=3,this._getAvatar(t);case 3:r=e.sent,o=(t.addresses&&t.addresses.to||[]).length,this._update(n,r,t.lastSaved||0,o);case 6:case"end":return e.stop()}}),e,this)})));return e})()},{key:"_getAvatar",value:(function(){function e(e){return t.apply(this,arguments)}var t=s(regeneratorRuntime.mark((function e(t){var n,o,i,a,c,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.addresses){e.next=2;break}return e.abrupt("return",null);case 2:if(n=t.addresses,o=n.to,i=n.cc,a=n.bcc,c=[].concat(r(o),r(i),r(a)),s=c[0],!s){e.next=10;break}return e.next=7,S.getAvatarForContact(s);case 7:e.t0=e.sent,e.next=11;break;case 10:e.t0=null;case 11:return e.abrupt("return",e.t0);case 12:case"end":return e.stop()}}),e)})));return e})()},{key:"_update",value:function(e,t,n,r){this.subject=e,this.avatar=t,this.lastSaved=Number(n),this.recipients=r}}]),e})(),b=d(y.prototype,"subject",[g.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),m=d(y.prototype,"avatar",[g.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),h=d(y.prototype,"lastSaved",[g.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),v=d(y.prototype,"recipients",[g.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),d(y.prototype,"_update",[g.action],Object.getOwnPropertyDescriptor(y.prototype,"_update"),y.prototype),y)},3879:function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e}n.d(t,"a",(function(){return a}));var a=(function(){function e(t){r(this,e),this.logger=Daria.SendMail.getUndoSendLogger(t.ids)}return i(e,[{key:"logSendMail",value:function(){this.logger.logActionOnceAfterCancel("Клик в Отправить"),this.logger.cancelled=!1,this.logger.resetStartTime()}},{key:"_logAddressFieldChanged",value:function(e){this.logger.logActionOnceAfterCancel("редактирование письма/получатель (".concat(e,":)"))}},{key:"logRecipientsChanged",value:function(e){var t={to:"To",cc:"Cc",bcc:"Bcc"},n=t[e]||t.to;this._logAddressFieldChanged(n)}},{key:"logSubjectChanged",value:function(){this.logger.logActionOnceAfterCancel("редактирование письма/тема")}},{key:"logBodyChanged",value:function(){this.logger.logActionOnceAfterCancel("редактирование письма/текст")}},{key:"logAttachesChanged",value:function(){this.logger.logActionOnceAfterCancel("редактирование письма/аттачи")}},{key:"composeLoaded",get:function(){return this.logger.composeLoaded},set:function(e){this.logger.composeLoaded=e}},{key:"hasUndo",get:function(){return Daria.SendMail.shouldShowUndoSend()}},{key:"undoTime",get:function(){return Daria.SendMail.getUndoSendTime()}}]),e})()},3880:function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e}n.d(t,"a",(function(){return s}));var a=n(138),c=n.n(a),s=(function(){function e(){r(this,e),this._current=null,this.notify=c.a.debounce((function(e){ns.events.trigger(e)}),300)}return i(e,[{key:"reportExpand",value:function(e){this._current=e,Daria.reactiveComposeExpanded=!0,this.notify("daria:composeReact:expanded")}},{key:"reportCollapse",value:function(e){this._current===e&&(this._current=null,Daria.reactiveComposeExpanded=!1,this.notify("daria:composeReact:collapsed"))}},{key:"reportDoneScreenShow",value:function(){Daria.reactiveDoneScreenVisible=!0,this.notify("daria:composeReact:done:show")}},{key:"reportDoneScreenClose",value:function(){Daria.reactiveDoneScreenVisible=!1,this.notify("daria:composeReact:done:hide")}}]),e})()},3881:function(e,t,n){"use strict";function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t,n){return t&&c(e.prototype,t),n&&c(e,n),e}function u(e,t,n,r){n&&Object.defineProperty(e,t,{enumerable:n.enumerable,configurable:n.configurable,writable:n.writable,value:n.initializer?n.initializer.call(r):void 0})}function l(e,t,n,r,o){var i={};return Object.keys(r).forEach((function(e){i[e]=r[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce((function(n,r){return r(e,t,n)||n}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}function p(e){return{params:Object(O.pick)(e.params,["ids","tids","oper"]),miniData:Object(O.pick)(e.miniData,["avatar","subject","lastSaved","recipients"])}}function f(e){return!e.hasEmptyParams}function d(e,t){var n=e.params.ids&&e.miniData?e.miniData.lastSaved:1/0;return(t.params.ids&&e.miniData?t.miniData.lastSaved:1/0)-n}function y(e){return e.miniData.lastSaved}n.d(t,"a",(function(){return P}));var b,m,h,v,O=n(138),g=(n.n(O),n(351)),_=n(1275),S=n(399),E=(n.n(S),20),P=(b=v=(function(){function e(t){var n=this,r=t.services,i=t.controllers;a(this,e),u(this,"composeMetaStates",m,this),u(this,"onDraftRemoved",h,this),this.services=r,this.controllers=i,this.composeMetaStates=r.settings.storedComposeStates.sort(d).slice(0,E).map((function(e){return new _.a(o({},e,{services:r,controllers:i}),n.metaStateOptions)}))}return s(e,[{key:"connect",value:function(){var e=this;Object(g.reaction)((function(){var t=e.composeMetaStates.filter(f).sort(d).map(p);return t.length?JSON.stringify(t):""}),(function(t){e.services.settings.storedComposeStates=t})),Object(g.reaction)((function(){return JSON.stringify(e.composeMetaStates.sort(d).map(y))}),(function(){e.composeMetaStates=e.composeMetaStates.sort(d)})),ns.events.on("daria:MOPS:action-complete",this.onDraftRemoved)}},{key:"get",value:function(e,t,n){var r=new _.a({params:e,predefinedData:t,services:this.services,controllers:this.controllers},this.metaStateOptions);return t&&!Object(O.isEqual)(t,{})?r:this.composeMetaStates.find((function(e){return r.isEqual(e)&&(!n||e.isEmpty)}))||r}},{key:"add",value:function(e){this.composeMetaStates.indexOf(e)>-1||(this.composeMetaStates.unshift(e),this.composeMetaStates.length=Math.min(this.composeMetaStates.length,E))}},{key:"remove",value:function(e){-1!==this.composeMetaStates.indexOf(e)&&(e.disconnect(),this.composeMetaStates.remove(e))}},{key:"metaStateOptions",get:function(){return{size:this.services.settings.lastUsedComposeSize||S.ComposeSizes.LARGE}}}]),e})(),m=l(b.prototype,"composeMetaStates",[g.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),l(b.prototype,"add",[g.action],Object.getOwnPropertyDescriptor(b.prototype,"add"),b.prototype),l(b.prototype,"remove",[g.action],Object.getOwnPropertyDescriptor(b.prototype,"remove"),b.prototype),h=l(b.prototype,"onDraftRemoved",[g.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t,n){"delete"===n.action&&e.composeMetaStates.filter(Object(g.action)((function(e){return n.ids.ids.indexOf(e.params.ids)>-1}))).forEach(Object(g.action)((function(t){return e.remove(t)})))}}}),b)},3882:function(e,t,n){"use strict";function r(e){"@babel/helpers - typeof";return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function c(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),e}function s(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?l(e):t}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function l(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function p(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function d(e,t,n,r){C||(C="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=r;else if(i>1){for(var a=new Array(i),c=0;c<i;c++)a[c]=arguments[c+3];t.children=a}if(t&&o)for(var s in o)void 0===t[s]&&(t[s]=o[s]);else t||(t=o||{});return{$$typeof:C,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function y(e,t,n,r){n&&Object.defineProperty(e,t,{enumerable:n.enumerable,configurable:n.configurable,writable:n.writable,value:n.initializer?n.initializer.call(r):void 0})}function b(e,t,n,r,o){var i={};return Object.keys(r).forEach((function(e){i[e]=r[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce((function(n,r){return r(e,t,n)||n}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}n.d(t,"a",(function(){return W}));var m,h,v,O,g,_,S,E,P,C,w=n(137),T=n.n(w),k=n(348),R=n.n(k),A=n(138),j=(n.n(A),n(353)),M=n(351),I=n(352),D=n(154),N=(n.n(D),n(3883)),L=n(399),x=(n.n(L),n(1275)),z=n(3885),B=n(360),F=(n.n(B),n(1855)),U=n(421),K=function(e){return function(t){t.stopPropagation(),e&&e()}},H=d(I.default,{loc:"compose-react/Без_темы"}),W=(m=Object(j.inject)("controllers","services","state"))(h=Object(j.observer)((P=E=(function(e){function t(){var e,n;i(this,t);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return n=s(this,(e=u(t)).call.apply(e,[this].concat(o))),n._containerNode=T.a.createRef(),n._boundary=T.a.createRef(),y(l(n),"controlButtonsTooltipIsShowing",O,l(n)),y(l(n),"isHovered",g,l(n)),n.onMaximiseLarge=function(){n.expandCompose(L.ComposeSizes.LARGE),n.metrikaService.sendHeaderMetrika(B.COMPOSE_METRIKA_HEADER_EXPAND)},n.onMaximiseSmall=function(){n.expandCompose(L.ComposeSizes.SMALL),n.metrikaService.sendHeaderMetrika(B.COMPOSE_METRIKA_HEADER_EXPAND)},n.onHeaderClick=function(){n.setIsHovered(!1),n.expandCompose(n.defaultSize),n.metrikaService.sendHeaderMetrika(B.COMPOSE_METRIKA_HEADER_THUMB_CLICK)},n.onHide=function(){(0,n.props.collapseCompose)(),n.metrikaService.sendHeaderMetrika(B.COMPOSE_METRIKA_HEADER_COLLAPSE)},n.onClose=function(){(0,n.props.closeCompose)(),n.metrikaService.sendHeaderMetrika(B.COMPOSE_METRIKA_HEADER_CLOSE)},n.onChangeSize=function(){var e=n.props.metaState,t=e.size===L.ComposeSizes.SMALL?L.ComposeSizes.LARGE:L.ComposeSizes.SMALL;e.changeSize(t,!0)},y(l(n),"setIsHovered",_,l(n)),y(l(n),"onControlButtonsTooltipVisibilityChanged",S,l(n)),n}return p(t,e),c(t,[{key:"expandCompose",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:L.ComposeSizes.LARGE,t=this.props,n=t.expandCompose;t.metaState.changeSize(e,!0),Object(F.a)(U.f,{usedSmall:e===L.ComposeSizes.SMALL}),n()}},{key:"render",value:function(){return this.props.mode===L.ComposeMode.COLLAPSED?this._renderCollapsedState():this._renderExpandedState()}},{key:"_renderCollapsedState",value:function(){var e=this.props,t=e.className,n=e.metaState,r=n.miniData,o=this.isTooltipShowing,i=this.onControlButtonsTooltipVisibilityChanged,a=this.setIsHovered,c=r.subject?d("span",{},void 0,r.subject):H,s=r.recipients>1?d("span",{},void 0,"+",r.recipients-1):null,u=this.collapsedStateButtons;return T.a.createElement(T.a.Fragment,null,d(z.a,{innerRef:this._containerNode,mode:L.ComposeMode.COLLAPSED,className:t,onClick:this.onHeaderClick,onMouseEnter:function(){return a(!0)},onMouseLeave:function(){return a(!1)},AvatarComponent:T.a.createElement(N.a,this.avatar),TitleComponent:c,RecipientsComponent:s,ButtonsComponent:d(z.b,{defaultExpandSize:this.defaultSize,onTooltipVisibilityChange:i,buttons:u,boundary:this._boundary})}),d(D.Tooltip,{visible:o,direction:"top",anchor:this._containerNode,view:"default",size:"s",state:"warning",boundary:this._boundary},void 0,c))}},{key:"_renderExpandedState",value:function(){var e=this.props,t=e.metaState,n=e.className,r=t.miniData,o=t.isDraft,i=t.isTemplate,a=t.isNewTemplate,c=t.size,s=o||i&&!a?"compose-react/Без_темы":"compose-react/PopupTitle_New",u=r.subject,l=u?d("span",{},void 0,u):d(I.default,{loc:s}),p=r&&r.lastSaved,f=p?d(z.c,{timestamp:p}):null;return d(z.a,{mode:L.ComposeMode.EXPANDED,className:n,onClick:this.onHide,ButtonsComponent:d(z.b,{tooltipPosition:"bottom",currentSize:c,buttons:this.expandedStateButtons[c]}),TitleComponent:l,SavedAtComponent:f})}},{key:"componentDidMount",value:function(){this._boundary.current=document.querySelector(".js-mail-App")||document.documentElement}},{key:"componentWillUnmount",value:function(){this.setIsHovered(!1)}},{key:"data",get:function(){return this.props.metaState.miniData}},{key:"avatar",get:function(){return this.data&&this.data.avatar}},{key:"metrikaService",get:function(){return this.props.services.metrika}},{key:"settingsController",get:function(){return this.props.controllers.settings}},{key:"isTooltipShowing",get:function(){var e=this.isHovered;return!this.controlButtonsTooltipIsShowing&&e}},{key:"defaultSize",get:function(){return this.settingsController.lastUsedComposeSize||L.ComposeSizes.LARGE}},{key:"expandedStateButtons",get:function(){var e,t={buttonName:L.HeaderButtons.MINIMIZE,handler:K(this.onHide),tooltipLocKey:"compose-react/PopupActions_MinimizeWindow"},n={buttonName:L.HeaderButtons.MAXIMIZE,handler:K(this.onChangeSize),tooltipLocKey:"compose-react/PopupActions_EnlargeWindowSize"},r={buttonName:L.HeaderButtons.MAXIMIZE_SMALL,handler:K(this.onChangeSize),tooltipLocKey:"compose-react/PopupActions_ReduceWindowSize"},i={buttonName:L.HeaderButtons.CLOSE,handler:K(this.onClose),tooltipLocKey:"compose-react/PopupActions_CloseWindow"};return e={},o(e,L.ComposeSizes.SMALL,[t,n,i]),o(e,L.ComposeSizes.LARGE,[t,r,i]),e}},{key:"collapsedStateButtons",get:function(){return[{buttonName:L.HeaderButtons.MAXIMIZE_SMALL,handler:K(this.onMaximiseSmall),tooltipLocKey:"compose-react/PopupActions_ExpandSmallWindow"},{buttonName:L.HeaderButtons.MAXIMIZE,handler:K(this.onMaximiseLarge),tooltipLocKey:"compose-react/PopupActions_ExpandLargeWindow"},{buttonName:L.HeaderButtons.CLOSE,handler:K(this.onClose),tooltipLocKey:"compose-react/PopupActions_CloseWindow"}]}}]),t})(T.a.Component),E.propTypes={controllers:R.a.object.isRequired,mode:R.a.oneOf(Object(A.values)(L.ComposeMode)),services:R.a.object.isRequired,metaState:R.a.instanceOf(x.a).isRequired,expandCompose:R.a.func.isRequired,collapseCompose:R.a.func.isRequired,closeCompose:R.a.func.isRequired,className:R.a.string},v=P,O=b(v.prototype,"controlButtonsTooltipIsShowing",[M.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),g=b(v.prototype,"isHovered",[M.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),b(v.prototype,"data",[M.computed],Object.getOwnPropertyDescriptor(v.prototype,"data"),v.prototype),b(v.prototype,"avatar",[M.computed],Object.getOwnPropertyDescriptor(v.prototype,"avatar"),v.prototype),b(v.prototype,"metrikaService",[M.computed],Object.getOwnPropertyDescriptor(v.prototype,"metrikaService"),v.prototype),b(v.prototype,"settingsController",[M.computed],Object.getOwnPropertyDescriptor(v.prototype,"settingsController"),v.prototype),b(v.prototype,"isTooltipShowing",[M.computed],Object.getOwnPropertyDescriptor(v.prototype,"isTooltipShowing"),v.prototype),_=b(v.prototype,"setIsHovered",[M.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){e.isHovered=t}}}),S=b(v.prototype,"onControlButtonsTooltipVisibilityChanged",[M.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){e.controlButtonsTooltipIsShowing=t}}}),b(v.prototype,"expandedStateButtons",[M.computed],Object.getOwnPropertyDescriptor(v.prototype,"expandedStateButtons"),v.prototype),b(v.prototype,"collapsedStateButtons",[M.computed],Object.getOwnPropertyDescriptor(v.prototype,"collapsedStateButtons"),v.prototype),h=v))||h)||h},3883:function(e,t,n){"use strict";function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t,n,r){i||(i="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,a=arguments.length-3;if(t||0===a||(t={children:void 0}),1===a)t.children=r;else if(a>1){for(var c=new Array(a),s=0;s<a;s++)c[s]=arguments[s+3];t.children=c}if(t&&o)for(var u in o)void 0===t[u]&&(t[u]=o[u]);else t||(t=o||{});return{$$typeof:i,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}var i,a=n(137),c=n.n(a),s=n(348),u=(n.n(s),n(350)),l=n.n(u),p=n(745),f=n.n(p),d=n(3884),y=(n.n(d),"ComposeMetaAvatar"),b={Block:y,Block_monogram:"".concat(y,"_monogram")},m=function(e){var t=e.url;return o("div",{className:l()(b.Block,r({},b.Block_monogram,!t))},void 0,c.a.createElement(f.a,e))};t.a=m,m.propTypes={url:s.PropTypes.string}},3884:function(e,t){},3885:function(e,t,n){"use strict";var r=n(1854),o=(n.n(r),n(3888));n.d(t,"a",(function(){return o.a}));var i=n(3890);n.n(i);n.o(i,"ControlButtons")&&n.d(t,"b",(function(){return i.ControlButtons}));var a=n(1853);n.d(t,"c",(function(){return a.a}))},3886:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return o(t,e),t},a=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a},c=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.ComposePopup=void 0;var s=i(n(137)),u=c(n(350)),l=n(147),p=n(399),f=n(550);n(3887);var d={Block:"ComposePopup",Wrapper:"ComposePopup-Wrapper",WindowWrapper:"ComposePopup-WindowWrapper",Content:"ComposePopup-Content",Body:"ComposePopup-Body",BodyContent:"ComposePopup-BodyContent"},y=function(e){var t=e.cls,n=e.Body,r=e.right,o=e.size,i=e.width,c=e.onClose,y=e.enableFocusTrap,b=e.visible,m=a(s.useState(!0),2),h=m[0],v=m[1],O=s.useRef(null),g=s.useCallback((function(e,t){"click"===t&&o!==p.ComposeSizes.SMALL?c(e):"esc"===t&&c(e)}),[c,o]),_=s.useMemo((function(){return i&&f.isDefined(r)?{width:i+"px",right:r+"px"}:void 0}),[i,r]),S=s.useCallback((function(e){var t;v(!(null===(t=O.current)||void 0===t||!t.contains(e.target)))}),[]);s.useEffect((function(){return document.addEventListener("mousedown",S,{capture:!0}),function(){return document.removeEventListener("mousedown",S,{capture:!0})}}),[S]);var E=o===p.ComposeSizes.SMALL?h&&y:y;return s.default.createElement(l.Popup,{innerRef:O,className:u.default(d.Block,t,d.Block+"_size_"+o),view:"default",style:_,direction:"top",scope:"inplace",onClose:g,visible:b,enableFocusTrap:E,role:"dialog"},s.default.createElement("div",{className:d.Content},s.default.createElement("div",{className:d.Body},s.default.createElement("div",{className:d.BodyContent},n()))))};t.ComposePopup=y},3887:function(e,t){},3888:function(e,t,n){"use strict";function r(e){"@babel/helpers - typeof";return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function c(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),e}function s(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?u(e):t}function u(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function p(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function d(e,t,n,r){y||(y="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=r;else if(i>1){for(var a=new Array(i),c=0;c<i;c++)a[c]=arguments[c+3];t.children=a}if(t&&o)for(var s in o)void 0===t[s]&&(t[s]=o[s]);else t||(t=o||{});return{$$typeof:y,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}n.d(t,"a",(function(){return T}));var y,b=n(137),m=n.n(b),h=n(348),v=n.n(h),O=n(350),g=n.n(O),_=n(138),S=n.n(_),E=n(399),P=(n.n(E),n(3889)),C=(n.n(P),"composeHeader"),w={Block:C,Block_collapsed:"".concat(C,"_collapsed"),Block_expanded:"".concat(C,"_expanded"),Block_activable:"".concat(C,"_activable"),Avatar:"".concat(C,"-Avatar"),Text:"".concat(C,"-Text"),Title:"".concat(C,"-Title"),SavedAt:"".concat(C,"-SavedAt"),Buttons:"".concat(C,"-Buttons"),Recipients:"".concat(C,"-Recipients")},T=(function(e){function t(){return i(this,t),s(this,l(t).apply(this,arguments))}return p(t,e),c(t,[{key:"render",value:function(){var e=this.props,t=e.innerRef,n=e.mode,r=e.className,i=e.onClick,a=e.onMouseEnter,c=e.onMouseLeave,s=this.props,u=s.AvatarComponent,l=s.TitleComponent,p=s.SavedAtComponent,f=s.ButtonsComponent,y=s.RecipientsComponent,b=g()(w.Block,r,"".concat(C,"_").concat(n),o({},w.Block_activable,"function"==typeof i));return m.a.createElement("div",{ref:t,className:b,onClick:i,onMouseEnter:a,onMouseLeave:c},u&&d("div",{className:w.Avatar},void 0,u),y&&d("div",{className:w.Recipients},void 0,y),d("div",{className:w.Text},void 0,l&&d("span",{className:w.Title},void 0,l),p&&this.renderSavedAt()),f&&d("div",{className:w.Buttons},void 0,f))}},{key:"renderSavedAt",value:function(){var e=this.props.SavedAtComponent;return d("span",{className:w.SavedAt},void 0,e)}}]),t})(m.a.PureComponent);T.propTypes={innerRef:v.a.shape({current:v.a.instanceOf(Element)}),mode:v.a.oneOf(S.a.values(E.ComposeMode)).isRequired,className:v.a.string,onClick:v.a.func,onMouseEnter:v.a.func,onMouseLeave:v.a.func,AvatarComponent:v.a.element,TitleComponent:v.a.element,ButtonsComponent:v.a.element,SavedAtComponent:v.a.element,RecipientsComponent:v.a.element},T.defaultProps={mode:E.ComposeMode.EXPANDED}},3889:function(e,t){},3890:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},r.apply(this,arguments)},o=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&o(t,e,n);return i(t,e),t},c=this&&this.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var o=0,r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]]);return n},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.ControlButtons=void 0;var u=a(n(137)),l=s(n(350)),p=n(399),f=n(3891),d=s(n(3893)),y=function(e){var t=e.defaultExpandSize,n=e.tooltipPosition,o=void 0===n?"top":n,i=e.buttons,a=e.className,s=e.onTooltipVisibilityChange,y=e.boundary,b=u.useRef({}),m=t===p.ComposeSizes.SMALL?p.HeaderButtons.MAXIMIZE_SMALL:p.HeaderButtons.MAXIMIZE,h=u.useCallback((function(e,t){b.current[e]=t;var n=Object.values(b.current).filter((function(e){return e})).length;t&&1===n?null===s||void 0===s||s(!0):t||0!==n||null===s||void 0===s||s(!1)}),[s]);return u.default.createElement("div",{className:l.default(a,d.default.root,"ControlButtons")},i.map((function(e){var t=e.buttonName,n=c(e,["buttonName"]);return u.default.createElement(f.ControlButton,r({key:"button-"+t,buttonName:t},n,{isDefault:t===m,tooltipPosition:o,onTooltipVisibilityChanged:h,boundary:y}))})))};t.ControlButtons=y},3891:function(e,t,n){"use strict";var r,o=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&o(t,e,n);return i(t,e),t},c=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.ControlButton=void 0;var s=a(n(137)),u=c(n(350)),l=n(1848),p=n(143),f=c(n(367)),d=n(399),y=c(n(417)),b=c(n(1849)),m=c(n(1850)),h=c(n(1851)),v=c(n(3892)),O=(r={},r[d.HeaderButtons.CLOSE]=y.default,r[d.HeaderButtons.MINIMIZE]=b.default,r[d.HeaderButtons.MAXIMIZE_SMALL]=h.default,r[d.HeaderButtons.MAXIMIZE]=m.default,r),g=function(e){var t,n=e.handler,r=e.buttonName,o=e.isDefault,i=e.tooltipLocKey,a=e.tooltipPosition,c=e.onTooltipVisibilityChanged,d=e.boundary,y=s.useCallback((function(){null===c||void 0===c||c(r,!0)}),[r,c]),b=s.useCallback((function(){null===c||void 0===c||c(r,!1)}),[r,c]);if(!n)return null;var m=u.default(v.default.root,"qa-ControlButton","qa-ControlButton_button_"+r,(t={},t[v.default.default]=o,t));return s.default.createElement(p.TooltipStateful,{view:"default",size:"s",state:"warning",direction:[a+"-end",a,a+"-start"],content:f.default(i),boundary:d},s.default.createElement(l.ButtonWithIcon,{className:m,key:"button-"+r,onMouseEnter:y,onMouseLeave:b,onClick:n,view:"clear",size:"s",svg:O[r],"aria-label":f.default(i),iconClass:v.default.icon}))};t.ControlButton=g},3892:function(e,t){e.exports={root:"ControlButtons__root--3tqjs",default:"ControlButtons__default--Rt9m7",icon:"ControlButtons__icon--z6gpV"}},3893:function(e,t){e.exports={root:"ControlButtons__root--3Bvny"}},3894:function(e,t,n){"use strict";var r=n(3895);n.d(t,"a",(function(){return r.a}))},3895:function(e,t,n){"use strict";function r(e){"@babel/helpers - typeof";return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?c(e):t}function a(e){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function c(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e,t,n){return t&&s(e.prototype,t),n&&s(e,n),e}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function f(e,t,n,r){v||(v="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=r;else if(i>1){for(var a=new Array(i),c=0;c<i;c++)a[c]=arguments[c+3];t.children=a}if(t&&o)for(var s in o)void 0===t[s]&&(t[s]=o[s]);else t||(t=o||{});return{$$typeof:v,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}n.d(t,"a",(function(){return $}));var d,y,b,m,h,v,O=n(137),g=n.n(O),_=n(348),S=n.n(_),E=n(350),P=n.n(E),C=n(351),w=n(353),T=n(138),k=(n.n(T),n(87)),R=(n.n(k),n(3896)),A=n(3897),j=n(3899),M=n(3900),I=n(3903),D=n.n(I),N=n(3905),L=(n.n(N),n(658)),x=n(3907),z=n(397),B=n.n(z),F=n(426),U=n(382),K=n(508),H=n.n(K),W=n(360),G=(n.n(W),n(3908)),Y=(n.n(G),"ComposeDoneScreen"),q={Block:Y,Wrapper:"".concat(Y,"-Wrapper"),Promo:"".concat(Y,"-Promo"),Ads:"".concat(Y,"-Ads"),WithOffset:"".concat(Y,"-WithOffset")},V=15e3,$=(d=Object(w.inject)("services"))(y=Object(w.observer)((h=m=(function(e){function t(e){var n;return o(this,t),n=i(this,a(t).call(this,e)),n.themeStore=F.ThemesStore.instance(),n.isInteractive=!1,n._disposer=new U.a,n.onVisibleChanged=function(e){e?(n.timer.start(),n.beautifulEmail?n.metrikaService.sendMetrika(W.PROMO_ON_DONE,W.DONE_SCREEN_PROMO_BEAUTIFUL_EMAIL,W.DONE_SCREEN_PROMO_BEAUTIFUL_EMAIL_SHOW):n.metrikaService.sendMetrika(W.PROMO_ON_DONE,W.DONE_SCREEN_PROMO_HOTKEYS,W.DONE_SCREEN_PROMO_HOTKEYS_SHOW),n.metrikaService.sendMetrika(W.PROMO_ON_DONE,W.DONE_SCREEN,W.DONE_SCREEN_SHOW)):n.timer.stop()},n.redirect=function(){n.onClose(W.DONE_SCREEN_CLOSE_ON_TIMER)},n.suspendTimer=function(){n.props.visible&&(n.timer.stop(),n.isInteractive=!0)},n.resumeTimer=function(){n.props.visible&&(n.timer.restart(),n.isInteractive=!1)},n.onClose=function(e){n.props.onClose&&n.props.onClose(),n.metrikaService.sendMetrika(W.PROMO_ON_DONE,W.DONE_SCREEN,e),n._disposer.dispose("shortcut")},n.onOutsideClick=function(){n.isInteractive||n.onClose(W.DONE_SCREEN_CLOSE_ON_CLICK)},n.onKeyDown=function(e){e.keyCode===B.a.ESC&&n.onClose(W.DONE_SCREEN_CLOSE_ON_KEY)},n.onShortcut=function(){n.onClose(W.DONE_SCREEN_CLOSE_ON_KEY)},n.onSuggestOpen=function(e,t){n.onClose(t===H.a.HOTKEY?W.DONE_SCREEN_CLOSE_ON_KEY:W.DONE_SCREEN_CLOSE_ON_CLICK)},n.beautifulEmail=e.beautifulEmail,n.timer=new x.a(V,n.redirect),n._visibleChangedReaction=new L.a(function(){return n.props.visible},n.onVisibleChanged,{fireImmediately:!0}),n._disposer.add(c(n),[function(){return n.timer.stop()},function(){return n._visibleChangedReaction.cancel()}]),ns.events.on("daria:shortcuts:beforeShortcut",n.onShortcut),ns.events.on("daria:suggest:open",n.onSuggestOpen),n._disposer.add("shortcut",[function(){return ns.events.off("daria:shortcuts:beforeShortcut",n.onShortcut)},function(){return ns.events.off("daria:suggest:open",n.onSuggestOpen)}]),n}return l(t,e),u(t,[{key:"metrikaService",get:function(){return this.props.services.metrika}},{key:"isAlternativeHeader",get:function(){return Object(k.hasFeature)(k.Features.WEB_DONE_REACT_ALTERNATIVE_HEADER)}},{key:"isDirectHidden",get:function(){return Boolean(!Daria.yabs||!Jane.HAS_AD||!Daria.AdvPresenter.shouldShowDone())}}]),u(t,[{key:"componentWillUnmount",value:function(){this._disposer.dispose(this),this._disposer.dispose("shortcut")}},{key:"render",value:function(){var e=P()(q.Block,{BeautifulEmail:this.beautifulEmail,SendDate:this.props.sendTime,DarkTheme:this.themeStore.isContentDark,NoDirect:this.isDirectHidden}),t={cls:e,autoclosable:!0,motionless:!0,onClose:T.noop,onOutsideClick:this.onOutsideClick,onOutsideKeyDown:this.onKeyDown,position:{top:0,left:0},target:"position",visible:this.props.visible};return g.a.createElement(R.a,t,f("div",{className:q.Wrapper},void 0,f("div",{className:"a11y-hidden",role:"alert"},void 0,f(N.Title,{sendTime:this.props.sendTime})),f(A.a,{beautifulEmail:this.beautifulEmail,sendTime:this.props.sendTime,isAlternative:this.isAlternativeHeader,onClose:this.onClose}),this.renderPromo(),this.isDirectHidden?null:f(j.a,{cls:q.Ads})))}},{key:"renderPromo",value:function(){var e=this;return this.beautifulEmail?f(D.a,{className:this.isDirectHidden?void 0:q.WithOffset,onAction:function(){return e.onClose(W.DONE_SCREEN_CLOSE_ON_BEAUTIFUL_EMAIL)},email:this.beautifulEmail}):f(M.a,{cls:q.Promo,onInteractiveStarted:this.suspendTimer,onInteractiveEnded:this.resumeTimer})}}]),t})(g.a.PureComponent),m.propTypes={beautifulEmail:S.a.string,sendTime:S.a.instanceOf(Date),visible:S.a.bool,onClose:S.a.func,services:S.a.object.isRequired},b=h,(function(e,t,n,r,o){var i={};return Object.keys(r).forEach((function(e){i[e]=r[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce((function(n,r){return r(e,t,n)||n}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i})(b.prototype,"metrikaService",[C.computed],Object.getOwnPropertyDescriptor(b.prototype,"metrikaService"),b.prototype),y=b))||y)||y},3896:function(e,t,n){"use strict";var r=n(657),o=n(1300),i=Object(o.a)(r.a);t.a=i},3897:function(e,t,n){"use strict";function r(e){"@babel/helpers - typeof";return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}function c(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?s(e):t}function s(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function f(e,t,n,r){d||(d="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=r;else if(i>1){for(var a=new Array(i),c=0;c<i;c++)a[c]=arguments[c+3];t.children=a}if(t&&o)for(var s in o)void 0===t[s]&&(t[s]=o[s]);else t||(t=o||{});return{$$typeof:d,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}n.d(t,"a",(function(){return M}));var d,y=n(137),b=n.n(y),m=n(348),h=n.n(m),v=n(352),O=n(402),g=n(488),_=n(368),S=n(1012),E=n(3898),P=n(1013),C=n(350),w=n.n(C),T=n(1319),k=n(360),R=(n.n(k),{beautifulEmail:h.a.string,sendTime:h.a.instanceOf(Date),isAlternative:h.a.bool.isRequired,onClose:h.a.func.isRequired}),A="ComposeDoneScreen",j={Header:"".concat(A,"-Header"),Title:"".concat(A,"-Title"),TitleWrapper:"".concat(A,"-TitleWrapper"),Actions:"".concat(A,"-Actions"),Icon:"".concat(A,"-Icon"),StatusIconWrapper:"".concat(A,"-StatusIconWrapper"),StatusIcon:"".concat(A,"-StatusIcon"),Link:"".concat(A,"-Link"),Settings:"".concat(A,"-Settings"),Close:"".concat(A,"-Close")},M=(function(e){function t(){return o(this,t),c(this,u(t).apply(this,arguments))}return l(t,e),a(t,[{key:"render",value:function(){return this.props.beautifulEmail?b.a.createElement(I,this.props):b.a.createElement(D,this.props)}}]),t})(y.PureComponent);M.propTypes=R;var I=(function(e){function t(){return o(this,t),c(this,u(t).apply(this,arguments))}return l(t,e),a(t,[{key:"render",value:function(){var e=this.props,t=e.isAlternative,n=e.beautifulEmail,r=e.sendTime,o=e.onClose;return b.a.createElement(b.a.Fragment,null,f("div",{className:w()(j.Header,{AlternativeHeader:t})},void 0,t?f(L,{onClose:o}):b.a.createElement(b.a.Fragment,null,f(z,{beautifulEmail:n,onClose:o}),f(B,{onClose:o}),f(L,{onClose:o}))),f("div",{className:j.TitleWrapper},void 0,f("div",{className:j.StatusIconWrapper},void 0,r?f(P.default,{className:j.StatusIcon}):f(S.default,{className:j.StatusIcon})),f(U,{sendTime:r,onClose:o})))}}]),t})(y.PureComponent);I.propTypes=R;var D=(function(e){function t(){return o(this,t),c(this,u(t).apply(this,arguments))}return l(t,e),a(t,[{key:"render",value:function(){var e=this.props,t=e.sendTime,n=e.isAlternative,r=e.beautifulEmail,o=e.onClose;return f("div",{className:j.Header},void 0,f(U,{sendTime:t,onClose:o}),n?f(L,{onClose:o}):b.a.createElement(b.a.Fragment,null,f(B,{onClose:o}),f(z,{beautifulEmail:r,onClose:o})))}}]),t})(y.PureComponent);D.propTypes=R;var N=f(_.default,{id:"mail--Compose-Cross"}),L=(function(e){function t(){return o(this,t),c(this,u(t).apply(this,arguments))}return l(t,e),a(t,[{key:"render",value:function(){var e=this;return f(O.a,{onClick:function(){return e.props.onClose(k.DONE_SCREEN_CLOSE_ON_CROSS)},cls:j.Close,theme:"normal",view:"default"},void 0,N)}}]),t})(y.PureComponent);L.propTypes={onClose:h.a.func.isRequired};var x=f(_.default,{id:"mail--Compose-Done-Settings"}),z=(function(e){function t(){return o(this,t),c(this,u(t).apply(this,arguments))}return l(t,e),a(t,[{key:"render",value:function(){var e=this,t=this.props.beautifulEmail?f(E.a,{className:j.Icon}):x;return f("div",{className:j.Settings},void 0,f(g.a,{cls:j.Link,theme:"normal",url:"#setup/other",onClick:function(){return e.props.onClose(k.DONE_SCREEN_CLOSE_ON_SETTINGS_CLICK)}},void 0,t))}}]),t})(y.PureComponent);z.propTypes={beautifulEmail:h.a.string,onClose:h.a.func.isRequired};var B=(function(e){function t(){return o(this,t),c(this,u(t).apply(this,arguments))}return l(t,e),a(t,[{key:"render",value:function(){var e=this;return f("div",{className:j.Actions},void 0,f(v.default,{loc:"compose-react/Done_Link"},void 0,f(g.a,{cls:j.Link,"data-ref":"link",theme:"normal",url:"#inbox",onClick:function(){return e.props.onClose(k.DONE_SCREEN_CLOSE_ON_INBOX_CLICK)}})))}}]),t})(y.PureComponent);B.propTypes={onClose:h.a.func.isRequired};var F=f(v.default,{loc:"compose-react/Done_Title"}),U=(function(e){function t(){return o(this,t),c(this,u(t).apply(this,arguments))}return l(t,e),a(t,[{key:"render",value:function(){var e=this,t=this.props.sendTime;if(t){var n={date:Object(T.default)(t,"%Date_dBY_year_in_HM")};return f("div",{className:j.Title},void 0,f(v.default,{loc:"compose-react/Done_Title_Delayed_Alt",params:n},void 0,f(g.a,{cls:j.Link,"data-ref":"link",theme:"normal",url:"#outbox",onClick:function(){return e.props.onClose(k.DONE_SCREEN_CLOSE_ON_OUTBOX_CLICK)}})))}return f("div",{className:j.Title},void 0,F)}}]),t})(y.PureComponent);U.propTypes={sendTime:h.a.instanceOf(Date),onClose:h.a.func.isRequired}},3898:function(e,t,n){"use strict";function r(){return r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},r.apply(this,arguments)}function o(e){return a.createElement("svg",r({viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},e),c)}var i,a=n(137),c=(n.n(a),(function(e,t,n,r){i||(i="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,a=arguments.length-3;if(t||0===a||(t={children:void 0}),1===a)t.children=r;else if(a>1){for(var c=new Array(a),s=0;s<a;s++)c[s]=arguments[s+3];t.children=c}if(t&&o)for(var u in o)void 0===t[u]&&(t[u]=o[u]);else t||(t=o||{});return{$$typeof:i,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}})("path",{d:"M11.967 12.675l.626 1.389a.5.5 0 01-.205.638l-.775.448a.5.5 0 01-.656-.141l-.895-1.244a1.433 1.433 0 00-2.565.345l-.538 1.425a.5.5 0 01-.597.306l-.865-.231a.5.5 0 01-.364-.564l.248-1.512a1.433 1.433 0 00-2.058-1.57l-1.389.627a.5.5 0 01-.638-.205l-.448-.776a.5.5 0 01.141-.656l1.244-.894a1.433 1.433 0 00-.345-2.565L.463 6.957a.5.5 0 01-.306-.597l.232-.865a.5.5 0 01.563-.364l1.512.247a1.433 1.433 0 001.57-2.058l-.627-1.388a.5.5 0 01.206-.639l.775-.447a.5.5 0 01.656.141l.894 1.244a1.433 1.433 0 002.565-.345L9.04.46a.5.5 0 01.597-.306l.865.231a.5.5 0 01.364.564l-.247 1.512a1.433 1.433 0 002.058 1.57l1.388-.627a.5.5 0 01.639.205l.447.775a.5.5 0 01-.141.656l-1.244.895a1.432 1.432 0 00.345 2.565l1.425.538a.5.5 0 01.306.597l-.231.865a.5.5 0 01-.564.364l-1.512-.248a1.433 1.433 0 00-1.57 2.058zM7.172 11.09a3.2 3.2 0 101.656-6.182 3.2 3.2 0 00-1.656 6.182z",fill:"currentColor"}));t.a=o},3899:function(e,t,n){"use strict";function r(e){"@babel/helpers - typeof";return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}function c(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?s(e):t}function s(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function f(e,t,n,r){d||(d="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=r;else if(i>1){for(var a=new Array(i),c=0;c<i;c++)a[c]=arguments[c+3];t.children=a}if(t&&o)for(var s in o)void 0===t[s]&&(t[s]=o[s]);else t||(t=o||{});return{$$typeof:d,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}n.d(t,"a",(function(){return _}));var d,y=n(137),b=n.n(y),m=n(350),h=n.n(m),v=n(348),O=n.n(v),g=f("div",{id:"js-direct-done"}),_=(function(e){function t(){return o(this,t),c(this,u(t).apply(this,arguments))}return l(t,e),a(t,[{key:"render",value:function(){return f("div",{className:h()("ComposeDoneDirect",this.props.cls)},void 0,g)}},{key:"componentDidMount",value:function(){this.showDirect(),ns.events.on("yabs:ready",this.showDirect)}},{key:"componentWillUnmount",value:function(){ns.events.off("yabs:ready",this.showDirect)}},{key:"showDirect",value:function(){Daria.yabs&&Jane.HAS_AD&&Daria.AdvPresenter.shouldShowDone()&&Daria.yabs.showDoneDirect("js-direct-done")}}]),t})(b.a.PureComponent);_.propTypes={cls:O.a.string}},3900:function(e,t,n){"use strict";function r(e){"@babel/helpers - typeof";return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}function c(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?s(e):t}function s(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function f(e,t,n,r){d||(d="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=r;else if(i>1){for(var a=new Array(i),c=0;c<i;c++)a[c]=arguments[c+3];t.children=a}if(t&&o)for(var s in o)void 0===t[s]&&(t[s]=o[s]);else t||(t=o||{});return{$$typeof:d,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}n.d(t,"a",(function(){return _}));var d,y=n(137),b=n.n(y),m=n(348),h=n.n(m),v=n(350),O=n.n(v),g=n(3901),_=(function(e){function t(){var e,n;o(this,t);for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return n=c(this,(e=u(t)).call.apply(e,[this].concat(i))),n.interactiveMode=0,n}return l(t,e),a(t,[{key:"setInteractiveMode",value:function(e){this.interactiveMode+=e,e>0&&1===this.interactiveMode?this.props.onInteractiveStarted&&this.props.onInteractiveStarted():0===this.interactiveMode&&this.props.onInteractiveEnded&&this.props.onInteractiveEnded()}},{key:"render",value:function(){var e=this;return f("div",{className:O()("ComposeDonePromo",this.props.cls)},void 0,f(g.a,{onMouseEnter:function(){return e.setInteractiveMode(1)},onMouseLeave:function(){return e.setInteractiveMode(-1)}}))}}]),t})(b.a.PureComponent);_.propTypes={cls:h.a.string,onInteractiveStarted:h.a.func,onInteractiveEnded:h.a.func}},3901:function(e,t,n){"use strict";function r(e){"@babel/helpers - typeof";return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}function c(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?s(e):t}function s(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function f(e,t,n,r){v||(v="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=r;else if(i>1){for(var a=new Array(i),c=0;c<i;c++)a[c]=arguments[c+3];t.children=a}if(t&&o)for(var s in o)void 0===t[s]&&(t[s]=o[s]);else t||(t=o||{});return{$$typeof:v,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}n.d(t,"a",(function(){return L}));var d,y,b,m,h,v,O=n(137),g=n.n(O),_=n(348),S=n.n(_),E=n(350),P=n.n(E),C=n(353),w=n(351),T=n(368),k=n(352),R=n(360),A=(n.n(R),n(3902)),j=(n.n(A),"ComposeHotkeysPromo"),M={Block:j,Image:"".concat(j,"-Image"),Content:"".concat(j,"-Content"),Shortcut:"".concat(j,"-Shortcut"),ShortcutKey:"".concat(j,"-ShortcutKey"),Description:"".concat(j,"-Description"),Action:"".concat(j,"-Action")},I=f(T.default,{id:"mail--Compose-Promo-Hotkeys"}),D=f(k.default,{loc:"compose-react/Done_Hotkeys_Promo_Text"}),N=f(k.default,{loc:"compose-react/Done_Hotkeys_Promo_Action"}),L=(d=Object(C.inject)("services"))(y=Object(C.observer)((h=m=(function(e){function t(){var e,n;o(this,t);for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return n=c(this,(e=u(t)).call.apply(e,[this].concat(i))),n.showHotkeys=function(){Daria.Shortcuts.showShortcutsHelp(),n.metrikaService.sendMetrika(R.PROMO_ON_DONE,R.DONE_SCREEN_PROMO_HOTKEYS,R.DONE_SCREEN_PROMO_HOTKEYS_ACTION)},n}return l(t,e),a(t,[{key:"render",value:function(){return f("div",{className:P()(M.Block,this.props.cls),onMouseEnter:this.props.onMouseEnter,onMouseLeave:this.props.onMouseLeave},void 0,this.renderImage(),this.renderContent())}},{key:"renderImage",value:function(){return f("div",{className:M.Image},void 0,I)}},{key:"renderContent",value:function(){return f("div",{className:M.Content},void 0,f("div",{className:M.Shortcut},void 0,f("span",{className:M.ShortcutKey},void 0,"Ctrl"),f("span",{className:M.ShortcutKey},void 0,"+"),f("span",{className:M.ShortcutKey},void 0,"Enter")),f("div",{className:M.Description},void 0,D),f("div",{className:M.Action,onClick:this.showHotkeys},void 0,N))}},{key:"metrikaService",get:function(){return this.props.services.metrika}}]),t})(g.a.PureComponent),m.propTypes={cls:S.a.string,onHelpOpened:S.a.func,onHelpClosed:S.a.func,onMouseEnter:S.a.func,onMouseLeave:S.a.func,services:S.a.object.isRequired},b=h,(function(e,t,n,r,o){var i={};return Object.keys(r).forEach((function(e){i[e]=r[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce((function(n,r){return r(e,t,n)||n}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i})(b.prototype,"metrikaService",[w.computed],Object.getOwnPropertyDescriptor(b.prototype,"metrikaService"),b.prototype),y=b))||y)||y},3902:function(e,t){},3903:function(e,t,n){"use strict";var r=this&&this.__extends||(function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}})(),o=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__decorate||function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},c=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&o(t,e,n);return i(t,e),t},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var u=c(n(137)),l=s(n(350)),p=s(n(352)),f=n(381),d=n(142),y=n(140),b=n(353),m=n(389),h=n(360),v=s(n(3904)),O=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onAction=function(){t.props.services.metrika.sendMetrika(h.PROMO_ON_DONE,h.DONE_SCREEN_PROMO_BEAUTIFUL_EMAIL,h.DONE_SCREEN_PROMO_BEAUTIFUL_EMAIL_ACTION),t.props.onAction()},t}return r(t,e),t.prototype.render=function(){var e=this.props,t=e.email,n=e.className,r=f.cnTheme(m.PS_LIGHT);return u.default.createElement("div",{className:l.default(v.default.Container,n,r)},u.default.createElement(y.Text,{className:v.default.Text,as:"header",typography:"subheader-s",color:"primary"},u.default.createElement(p.default,{loc:"compose-react/Done_Beautiful_Email_Promo_Header"})," ",t),u.default.createElement(y.Text,{className:v.default.Text,as:"p",typography:"body-short-m",color:"primary"},u.default.createElement(p.default,{loc:"compose-react/Done_Beautiful_Email_Promo_Text"})),u.default.createElement(d.Button,{className:v.default.Button,onClick:this.onAction,view:"raised",type:"link",size:"m",url:"#setup/beautiful-email"},u.default.createElement(p.default,{loc:"compose-react/Done_Beautiful_Email_Promo_Button"})))},t=a([b.inject("services"),b.observer],t)})(u.PureComponent);t.default=O},3904:function(e,t){e.exports={Container:"DoneScreen__Container--uh6nf",Text:"DoneScreen__Text--1g5LI",Button:"DoneScreen__Button--1Dh1U"}},3905:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Title=void 0;var o=r(n(137)),i=r(n(350)),a=r(n(1319)),c=r(n(352)),s=n(149),u=n(140),l=r(n(3906)),p=function(e){var t=e.sendTime,n=e.onClick,r=i.default(l.default.root,"qa-ComposeDoneScreen-Title");if(t){var p={date:a.default(t,"%Date_dBY_year_in_HM")};return o.default.createElement(u.Text,{typography:"subheader-m",weight:"medium",className:r},o.default.createElement(c.default,{loc:"compose-react/Done_Title_Delayed_Alt",params:p},o.default.createElement(s.Link,{className:i.default(l.default.link,"qa-ComposeDoneScreen-Link"),"data-ref":"link",view:"default",href:"#outbox",onClick:n})))}return o.default.createElement(u.Text,{typography:"subheader-m",weight:"medium",className:r},o.default.createElement(c.default,{loc:"compose-react/Done_Title"}))};t.Title=p},3906:function(e,t){},3907:function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e}n.d(t,"a",(function(){return a}));var a=(function(){function e(t,n){r(this,e),this._timerId=null,this._delay=t,this._handler=n}return i(e,[{key:"start",value:function(){var e=this;return this._timerId||(this._timerId=setTimeout((function(){e._handler()}),this._delay)),this._timerId}},{key:"stop",value:function(){clearTimeout(this._timerId),this._timerId=null}},{key:"restart",value:function(){this.stop(),this.start()}}]),e})()},3908:function(e,t){},3909:function(e,t){},3910:function(e,t,n){"use strict";function r(e,t){if(null==e)return{};var n,r,i=o(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function o(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function c(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),e}function s(e,t,n,r){n&&Object.defineProperty(e,t,{enumerable:n.enumerable,configurable:n.configurable,writable:n.writable,value:n.initializer?n.initializer.call(r):void 0})}function u(e,t,n,r,o){var i={};return Object.keys(r).forEach((function(e){i[e]=r[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce((function(n,r){return r(e,t,n)||n}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}n.d(t,"a",(function(){return b}));var l,p,f,d,y=n(351),b=(l=d=(function(){function e(t){i(this,e),s(this,"isAbookPopupOpened",p,this),s(this,"onClosePopup",f,this),this.abookPopupService=t}return c(e,[{key:"showAbookPopup",value:function(e){var t=e.onAction,n=e.onCancel,o=r(e,["onAction","onCancel"]);return this.isAbookPopupOpened=!0,this.abookPopupService.showAbookPopup(o).then(t,n).then(this.onClosePopup)}}]),e})(),p=u(l.prototype,"isAbookPopupOpened",[y.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),f=u(l.prototype,"onClosePopup",[y.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){e.isAbookPopupOpened=!1}}}),u(l.prototype,"showAbookPopup",[y.action],Object.getOwnPropertyDescriptor(l.prototype,"showAbookPopup"),l.prototype),l)},3911:function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e}function a(e,t,n,r){n&&Object.defineProperty(e,t,{enumerable:n.enumerable,configurable:n.configurable,writable:n.writable,value:n.initializer?n.initializer.call(r):void 0})}function c(e,t,n,r,o){var i={};return Object.keys(r).forEach((function(e){i[e]=r[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce((function(n,r){return r(e,t,n)||n}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}n.d(t,"a",(function(){return d}));var s,u,l,p,f=n(351),d=(s=p=(function(){function e(t){r(this,e),a(this,"_settings",u,this),a(this,"_update",l,this),this._service=t,this._update()}return i(e,[{key:"subscribe",value:function(){this._service.data.on("ns-model-changed",this._update)}},{key:"unsubscribe",value:function(){this._service.data.off("ns-model-changed",this._update)}},{key:"registerChangeSettingsHandler",value:function(e,t){return this._service.registerChangeSettingsHandler(e,t)}},{key:"unregisterChangeSettingsHandler",value:function(e,t){this._service.unregisterChangeSettingsHandler(e,t)}},{key:"timelineEnabled",get:function(){return Boolean(this._settings.timelineEnabled)}},{key:"timelineExpanded",get:function(){return Boolean(this._settings.timelineExpanded)}},{key:"todoEnabled",get:function(){return Boolean(this._settings.todoEnabled)}},{key:"lastUsedComposeSize",get:function(){return this._settings.lastUsedComposeSize},set:function(e){this._service.lastUsedComposeSize=e}}]),e})(),u=c(s.prototype,"_settings",[f.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{timelineEnabled:!1,timelineExpanded:!1,todoEnabled:!1,lastUsedComposeSize:!1}}}),l=c(s.prototype,"_update",[f.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){Object.keys(e._settings).forEach(Object(f.action)((function(t){e._settings[t]=e._service[t]})))}}}),c(s.prototype,"timelineEnabled",[f.computed],Object.getOwnPropertyDescriptor(s.prototype,"timelineEnabled"),s.prototype),c(s.prototype,"timelineExpanded",[f.computed],Object.getOwnPropertyDescriptor(s.prototype,"timelineExpanded"),s.prototype),c(s.prototype,"todoEnabled",[f.computed],Object.getOwnPropertyDescriptor(s.prototype,"todoEnabled"),s.prototype),c(s.prototype,"lastUsedComposeSize",[f.computed],Object.getOwnPropertyDescriptor(s.prototype,"lastUsedComposeSize"),s.prototype),s)},3912:function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e}function a(e,t,n,r){n&&Object.defineProperty(e,t,{enumerable:n.enumerable,configurable:n.configurable,writable:n.writable,value:n.initializer?n.initializer.call(r):void 0})}function c(e,t,n,r,o){var i={};return Object.keys(r).forEach((function(e){i[e]=r[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce((function(n,r){return r(e,t,n)||n}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}n.d(t,"a",(function(){return C}));var s,u,l,p,f,d,y,b,m,h,v=n(351),O=n(138),g=(n.n(O),n(395)),_=n.n(g),S=50,E=Daria.is3pane()?20:14,P=20+E,C=(s=h=(function(){function e(t){r(this,e),this.disposer=new _.a,a(this,"windowWidth",u,this),a(this,"windowHeight",l,this),a(this,"_layoutWidth",p,this),a(this,"_layoutLeftPad",f,this),a(this,"_layoutRightPad",d,this),a(this,"_layoutRight",y,this),a(this,"_layoutLeftWidth",b,this),a(this,"recalcDimensions",m,this),this._settings=t,this._onResize=Object(O.throttle)(this.recalcDimensions,S),this.recalcDimensions()}return i(e,[{key:"layoutWidth",get:function(){return this._layoutWidth||Math.min(this.windowWidth-P,this._settings.sizeLayout)}},{key:"layoutLeftPad",get:function(){return this._layoutLeftPad||20}},{key:"layoutRightPad",get:function(){return this._layoutRightPad||E}},{key:"layoutRight",get:function(){return this._layoutRight||this.layoutLeftPad+this.layoutWidth}},{key:"layoutLeftWidth",get:function(){return this._layoutLeftWidth||this._settings.sizeLayoutLeft||300}},{key:"rightSpace",get:function(){return Math.ceil(this.windowWidth-this.layoutLeftPad-this.layoutLeftWidth)}},{key:"rightContentWidth",get:function(){return this.layoutRight-this.layoutLeftPad-this.layoutLeftWidth}},{key:"composeWidth",get:function(){var e=Math.max(this.rightContentWidth+8,912);return Math.min(e,this.windowWidth-this.composeRight)}},{key:"composeRight",get:function(){var e=this.layoutRight&&this.windowWidth-this.layoutRight-4;return Math.max(e,0)}}]),i(e,[{key:"subscribe",value:function(){var e=this;this.disposer.addEventListener(this,{element:window,eventName:"resize",listener:this._onResize}),ns.events.on("react:dimensions:changeLayout",this._onResize),ns.events.on("react:dimensions:changeLayoutLeft",this._onResize),this.disposer.add(this,[function(){return ns.events.off("react:dimensions:changeLayout",e._onResize)},function(){return ns.events.off("react:dimensions:changeLayoutLeft",e._onResize)},this._settings.registerChangeSettingsHandler(this._onResize,"liza_minified_header")])}},{key:"unsubscribe",value:function(){this.disposer.dispose(this)}}]),e})(),u=c(s.prototype,"windowWidth",[v.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),l=c(s.prototype,"windowHeight",[v.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),p=c(s.prototype,"_layoutWidth",[v.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),f=c(s.prototype,"_layoutLeftPad",[v.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),d=c(s.prototype,"_layoutRightPad",[v.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),y=c(s.prototype,"_layoutRight",[v.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),b=c(s.prototype,"_layoutLeftWidth",[v.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),c(s.prototype,"layoutWidth",[v.computed],Object.getOwnPropertyDescriptor(s.prototype,"layoutWidth"),s.prototype),c(s.prototype,"layoutLeftPad",[v.computed],Object.getOwnPropertyDescriptor(s.prototype,"layoutLeftPad"),s.prototype),c(s.prototype,"layoutRightPad",[v.computed],Object.getOwnPropertyDescriptor(s.prototype,"layoutRightPad"),s.prototype),c(s.prototype,"layoutRight",[v.computed],Object.getOwnPropertyDescriptor(s.prototype,"layoutRight"),s.prototype),c(s.prototype,"layoutLeftWidth",[v.computed],Object.getOwnPropertyDescriptor(s.prototype,"layoutLeftWidth"),s.prototype),c(s.prototype,"rightSpace",[v.computed],Object.getOwnPropertyDescriptor(s.prototype,"rightSpace"),s.prototype),c(s.prototype,"rightContentWidth",[v.computed],Object.getOwnPropertyDescriptor(s.prototype,"rightContentWidth"),s.prototype),c(s.prototype,"composeWidth",[v.computed],Object.getOwnPropertyDescriptor(s.prototype,"composeWidth"),s.prototype),c(s.prototype,"composeRight",[v.computed],Object.getOwnPropertyDescriptor(s.prototype,"composeRight"),s.prototype),m=c(s.prototype,"recalcDimensions",[v.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){e.windowWidth=document.documentElement.clientWidth,e.windowHeight=document.documentElement.clientHeight;var t=Daria.resize.$layout&&Daria.resize.$layout[0],n=t&&t.getBoundingClientRect();e._layoutWidth=n&&n.width,e._layoutLeftPad=n&&n.left,e._layoutRightPad=n&&e.windowWidth-n.right,e._layoutRight=n&&n.right;var r=Daria.resize.$layoutLeft&&Daria.resize.$layoutLeft[0];e._layoutLeftWidth=r&&r.clientWidth}}}),s)},3913:function(e,t,n){"use strict";function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t,n,r,o,i,a){try{var c=e[i](a),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,o)}function c(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){function i(e){a(s,r,o,i,c,"next",e)}function c(e){a(s,r,o,i,c,"throw",e)}var s=e.apply(t,n);i(void 0)})}}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}n.d(t,"a",(function(){return d}));var u=n(1276),l=n(1796),p=n(1788),f=n(3914),d=function e(){var t=this;s(this,e),this._composeState=null,this._destroyer=null,this._node=null,this.render=(function(){var e=c(regeneratorRuntime.mark((function e(n,r){var i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t._node=n.quickReplyNode,t._composeState=new p.a(new u.c),i=new l.a(t._composeState,{onDataLoaded:t._onDataLoaded}),e.next=5,i.loadWithParams({initParams:{params:o({},n,{isQuickReply:!0}),predefinedData:r}});case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}})(),this._onDataLoaded=function(){t._destroyer=Object(f.a)({composeState:t._composeState,node:t._node})},this.saveDraft=c(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t._composeState&&t._composeState.controllers&&t._composeState.controllers.saveSend)){e.next=3;break}return e.next=3,t._composeState.controllers.saveSend.saveMessage();case 3:case"end":return e.stop()}}),e)}))),this.saveDraftAndUnmount=function(){t.saveDraft(),t.unmount()},this.unmount=function(){t._destroyer&&t._destroyer(),t._composeState&&t._composeState.disconnect(),t._composeState=null,t._node=null}}},3914:function(e,t,n){"use strict";function r(e,t,n,r){o||(o="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,a=arguments.length-3;if(t||0===a||(t={children:void 0}),1===a)t.children=r;else if(a>1){for(var c=new Array(a),s=0;s<a;s++)c[s]=arguments[s+3];t.children=c}if(t&&i)for(var u in i)void 0===t[u]&&(t[u]=i[u]);else t||(t=i||{});return{$$typeof:o,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}var o,i=n(137),a=n.n(i),c=n(141),s=n.n(c),u=n(353),l=n(386),p=n(1797),f=n(381),d=n(389),y=(n.n(d),r(p.c,{})),b=r(p.b,{});t.a=function(e){var t=e.composeState,n=e.onRender,o=e.node,i=Daria.Config.locale;return Object(f.configureRootTheme)({theme:d.PS_LIGHT,root:o}),s.a.render(r(l.default,{lang:i},void 0,a.a.createElement(u.Provider,t.providedState,y,b)),o,n),function(){s.a.unmountComponentAtNode(o)}}},393:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=r(n(395)),i=(function(){function e(e){var t=e.services,n=e.controllers,r=e.stores,i=e.environmentAdapter,a=e.visualState,c=e.data,s=e.validation;this.services=t,this.controllers=n,this.stores=r,this.environmentAdapter=i,this.visualState=a,this.data=c,this.validation=s,this._disposer=new o.default}return e.prototype.destroy=function(){this._disposer.disposeAll()},e})();t.default=i},399:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return o(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.HeaderButtons=t.ComposeSizes=t.ComposeMode=void 0;var a=i(n(3495));t.ComposeMode=a;var c=i(n(3496));t.ComposeSizes=c;var s=i(n(3497));t.HeaderButtons=s},417:function(e,t,n){"use strict";function r(){return r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},r.apply(this,arguments)}function o(e){return a.createElement("svg",r({width:16,height:16,viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},e),c)}Object.defineProperty(t,"__esModule",{value:!0});var i,a=n(137),c=(n.n(a),(function(e,t,n,r){i||(i="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,a=arguments.length-3;if(t||0===a||(t={children:void 0}),1===a)t.children=r;else if(a>1){for(var c=new Array(a),s=0;s<a;s++)c[s]=arguments[s+3];t.children=c}if(t&&o)for(var u in o)void 0===t[u]&&(t[u]=o[u]);else t||(t=o||{});return{$$typeof:i,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}})("path",{fill:"currentColor",fillRule:"evenodd",clipRule:"evenodd",d:"M1.793 1.793a1 1 0 000 1.414L6.586 8l-4.793 4.793a1 1 0 101.414 1.414L8 9.414l4.793 4.793a1 1 0 001.414-1.414L9.414 8l4.793-4.793a1 1 0 00-1.414-1.414L8 6.586 3.207 1.793a1 1 0 00-1.414 0z"}));t.default=o},432:function(e,t,n){"use strict";n.d(t,"h",(function(){return r})),n.d(t,"a",(function(){return o})),n.d(t,"f",(function(){return i})),n.d(t,"g",(function(){return a})),n.d(t,"c",(function(){return c})),n.d(t,"b",(function(){return s})),n.d(t,"d",(function(){return u})),n.d(t,"e",(function(){return l}));var r="blockquote",o="data-cke-role",i="placeholder",a="js-compose-Quote-Container",c="js-expand-quote",s="js-expand-all-quotes",u=10,l=1e4},433:function(e,t,n){"use strict";function r(){return r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},r.apply(this,arguments)}function o(e,t){if(null==e)return{};var n,r,o=i(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function i(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}function a(e,t){var n,i,a,c,l=function(n){var i=n.services,a=n.forwardedRef,c=o(n,["services","forwardedRef"]),u=i.settings.isMobile?t:e;return s.a.createElement(u,r({ref:a},c))},l=(n=Object(u.inject)("services"))(i=Object(u.observer)((c=a=l,a.propTypes={forwardedRef:p.a.object,services:f.a.isRequired},i=c))||i)||i;return s.a.forwardRef((function(e,t){return s.a.createElement(l,r({},e,{forwardedRef:t}))}))}t.a=a;var c=n(137),s=n.n(c),u=n(353),l=n(348),p=n.n(l),f=n(365)},444:function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e}function a(){return"".concat(p).concat(++l)}function c(e){return e&&e.email}n.d(t,"a",(function(){return p})),n.d(t,"b",(function(){return f}));var s=n(138),u=(n.n(s),n(3445)),l=0,p="contact",f=(function(){function e(t){var n=t.avatar,o=t.count,i=t.email,a=t.emailList,c=t.group,s=t.id,u=t.monogram,l=t.name,p=t.refer;r(this,e),this.avatar=n,this.count=o,this.email=i,this.emailList=a,this.group=c,this.id=s,this.monogram=u,this.name=l,this.refer=p}return i(e,null,[{key:"of",value:function(t){var n=e.generateId(t),r=t.emailList||null,o=t.refer||t.ref||"",i=t.avatar||{},a=1,c=[],s=t.email||"",l=t.name||s,p=Boolean(t.contacts&&t.contacts.length);p&&(c=(t.contacts||[]).map(e.of),a=t.count||c.length,l=t.title,s=t.title);var f,d=t.monogram||Object(u.a)(l||s,p)||null;return i.valid?f=i:i.color?f={color:i.color,valid:!0,monogram:d}:p&&(f={color:"#f39718",valid:!0,monogram:d}),new e({avatar:f,count:a,email:s,emailList:r,group:c,id:n,monogram:d,name:l,refer:o})}},{key:"generateId",value:function(e){return e.id&&"string"==typeof e.id?e.id:e.cid?"cid"+e.cid:e.id&&e.id>0?"id"+e.id:e.tid?"tid"+e.tid:e.mcid?"mcid"+e.mcid:a()}},{key:"isGroupContact",value:function(e){return Boolean(e&&e.isGroup&&e.isGroup())}},{key:"flattenContacts",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:c;return Object(s.flatten)(t.map((function(t){return e.isGroupContact(t)?e.flattenContacts(t.group,n):n(t)})))}}]),i(e,[{key:"normalizeContact",value:function(){return this.isGroup()?this.group:[this]}},{key:"getId",value:function(){return this.id}},{key:"getSendInfo",value:function(){return this.normalizeContact().map((function(e){return e.name?'"'.concat(e.getSendName(),'" <').concat(e.email,">"):e.email})).join(", ")}},{key:"getSendName",value:function(){return this.name.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}},{key:"isGroup",value:function(){return(this.group||[]).length>0}},{key:"isLocal",value:function(){return/contact/.test(this.getId())}},{key:"isExternal",value:function(){return Jane.FormValidation.checkExternalEmail(this.email)}},{key:"isValid",value:function(){return this.isGroup()||Jane.FormValidation.checkEmail(this.email||"")}},{key:"toJSON",value:function(){return{avatar:this.avatar,count:this.count,email:this.email,emailList:this.emailList,group:this.group,id:this.id,monogram:this.monogram,name:this.name,refer:this.refer}}}]),e})()},455:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(433),o=n(3610),i=n(3612),a=(n.n(i),Object(r.a)(i.ControlPanelButton,o.a))},466:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PROMO_COMPOSE_SUGGEST_BEAUTIFUL_EMAIL=t.PROMO_COMPOSE_BEAUTIFUL_EMAIL=t.PROMO_REPLY_LATER=t.PROMO_ONBOARDING_BEAUTIFUL_EMAIL=t.PROMO_MAIL360_DISCOUNT=t.PROMO_OPT_IN_SUBS_POPUP=t.PROMO_GREETINGS_ONBOARDING=t.PROMO_BEAUTIFUL_EMAIL_CONNECTED=t.PROMO_AUTO_TOOLTIP=t.PROMO_AUTO_ONBOARDING=void 0,t.PROMO_AUTO_ONBOARDING="promo-auto-onboarding",t.PROMO_AUTO_TOOLTIP="promo-auto-tooltip",t.PROMO_BEAUTIFUL_EMAIL_CONNECTED="promo-domain-connected",t.PROMO_GREETINGS_ONBOARDING="promo-onboard-greet",t.PROMO_OPT_IN_SUBS_POPUP="promo-opt-in-popup",t.PROMO_MAIL360_DISCOUNT="promo-mail-360-discount",t.PROMO_ONBOARDING_BEAUTIFUL_EMAIL="promo-onboard-email",t.PROMO_REPLY_LATER="promo-reply-later",t.PROMO_COMPOSE_BEAUTIFUL_EMAIL="promo-compose-beautiful-email",t.PROMO_COMPOSE_SUGGEST_BEAUTIFUL_EMAIL="promo-compose-suggest-beautiful-email"},479:function(e,t,n){"use strict";var r=this&&this.__extends||(function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}})(),o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.HumanFileSize=void 0;var i=o(n(137)),a=n(687),c=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.render=function(){var e=a.getSizeAndUnit(this.props.bytes);return a.getLocString(e)},t})(i.default.PureComponent);t.HumanFileSize=c},496:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.VALIDATION_ERROR=t.SEND_RETRYABLE_FAILED=t.SEND_FAILED=t.REMOVE_DRAFT=t.LIMITED_RECIPIENTS=t.EMPTY_SUBJECT=t.DISK_RESOURCES=t.CONTACTS_SUGGEST=t.CONFIRM_REMOVE=t.CHECKBOX_CAPTCHA=t.CAPTCHA=t.ATTACHMENTS_ERROR=void 0,t.ATTACHMENTS_ERROR="AttachmentsError",t.CAPTCHA="Captcha",t.CHECKBOX_CAPTCHA="CheckboxCaptcha",t.CONFIRM_REMOVE="ConfirmRemove",t.CONTACTS_SUGGEST="ContactsSuggest",t.DISK_RESOURCES="DiskResources",t.EMPTY_SUBJECT="EmptySubject",t.LIMITED_RECIPIENTS="LimitedRecipients",t.REMOVE_DRAFT="RemoveDraft",t.SEND_FAILED="SendFailed",t.SEND_RETRYABLE_FAILED="SendRetryableFailed",t.VALIDATION_ERROR="ValidationError"},499:function(e,t,n){"use strict";function r(e){return(e.innerText||"").replace(/[\n\r]/g,"")}t.a=r},500:function(e,t,n){"use strict";n.d(t,"c",(function(){return r})),n.d(t,"d",(function(){return o})),n.d(t,"b",(function(){return i})),n.d(t,"e",(function(){return a})),n.d(t,"a",(function(){return c}));var r=40,o="dir",i=60,a=200,c=200},501:function(e,t,n){"use strict";var r=n(3530);n.d(t,"a",(function(){return r}))},502:function(e,t,n){"use strict";var r=n(380);n.d(t,"a",(function(){return r.a}))},503:function(e,t,n){"use strict";var r=n(348),o=n.n(r);t.a={cls:o.a.string,innerRef:o.a.object,isMobile:o.a.bool,isPopupVisible:o.a.bool,onMouseEnter:o.a.func,onMouseLeave:o.a.func,onClick:o.a.func,upload:o.a.func}},518:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NEXT_WEEK=t.WEEKEND=t.TOMORROW=t.TODAY=void 0,t.TODAY="today",t.TOMORROW="tomorrow",t.WEEKEND="weekend",t.NEXT_WEEK="next week"},519:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return o(t,e),t},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Popups=t.ToolbarCommandsList=t.ToolbarCommands=t.ImageSources=t.HIGHEST_EVENT_PRIORITY=void 0;var c=a(n(763)),s=i(n(1226));t.ImageSources=s;var u=i(n(886));t.ToolbarCommands=u;var l=i(n(1227));t.Popups=l;var p=c.default(u);t.ToolbarCommandsList=p,t.HIGHEST_EVENT_PRIORITY=-100},529:function(e,t,n){"use strict";t.a=function(e){if("number"!=typeof e.size&&e.file){var t=e.file;e.size="number"==typeof t.size?t.size:t.fileSize}return Number(e.size)}},530:function(e,t,n){"use strict";var r=n(348),o=n.n(r);t.a={arrayOf:o.a.arrayOf}},531:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o}));var r="/disk/",o="/mail/"},532:function(e,t,n){"use strict";function r(){return r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},r.apply(this,arguments)}function o(e){"@babel/helpers - typeof";return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){if(null==e)return{};var n,r,o=a(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function a(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}function c(e){return l(e)||u(e)||s()}function s(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function u(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function l(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}function p(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function f(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function d(e,t,n){return t&&f(e.prototype,t),n&&f(e,n),e}function y(e,t){return!t||"object"!==o(t)&&"function"!=typeof t?m(e):t}function b(e){return(b=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function m(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function h(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&v(e,t)}function v(e,t){return(v=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function O(e,t,n,r){n&&Object.defineProperty(e,t,{enumerable:n.enumerable,configurable:n.configurable,writable:n.writable,value:n.initializer?n.initializer.call(r):void 0})}function g(e,t,n,r,o){var i={};return Object.keys(r).forEach((function(e){i[e]=r[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce((function(n,r){return r(e,t,n)||n}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}function _(e,t){function n(e,t){return E.a.createElement(F,r({},e,{forwardedRef:t}))}var o,a,s,u,l,f,v,_,S=e.PopupContent,P=e.cls,w=e.metrikaArgs,D=void 0===w?[]:w,N=e.directions,L=void 0===N?["top"]:N,x=e.title,z=e.options,B=void 0===z?{}:z,F=(o=Object(R.inject)("services","visual"))(a=Object(R.observer)((_=v=(function(e){function n(e){var t;return p(this,n),t=y(this,b(n).call(this,e)),t.popupContentRef=E.a.createRef(),t.contentKey=Date.now(),O(m(t),"isPopupVisible",u,m(t)),O(m(t),"closePopup",l,m(t)),O(m(t),"onClick",f,m(t)),t.onOutsideClick=function(e){!t.isPopupVisible||t.isMobile&&t.nodeRef.current.contains(e.target)||t.closePopup()},t._onAction=function(){t.props.onAction&&t.props.onAction(),t.closePopup()},t.nodeRef=e.innerRef||E.a.createRef(),t}return h(n,e),d(n,[{key:"notifyPopupVisibilityChanged",value:function(){var e=this.props.onPopupVisibilityChanged;if(e&&e(this.isPopupVisible),this.isPopupVisible){var t;(t=this.metrikaService).sendFooterMetrika.apply(t,c(D))}}},{key:"render",value:function(){var e=this.props,n=e.forwardedRef,o=i(e,["forwardedRef"]);return E.a.createElement(E.a.Fragment,null,E.a.createElement(t,r({ref:n},o,{innerRef:this.nodeRef,onClick:this.onClick,isPopupVisible:this.isPopupVisible})),this.renderPopup())}},{key:"renderPopup",value:function(){return E.a.createElement(M.a,r({className:T()(P,this.isMobile?"".concat(P,"_mobile"):"".concat(P,"_desktop")),anchor:this.nodeRef,onClose:this.onOutsideClick,scope:this.isMobile?this.containerRef:"inplace",visible:this.isPopupVisible,direction:L,title:x&&Object(I.default)(x),hasTail:!0},B,this.props.popupProps),this.renderPopupContent())}},{key:"renderPopupContent",value:function(){var e=this.props.contentOptions;return E.a.createElement(S,r({},e,{key:this.contentKey,ref:this.popupContentRef,onChange:this.updatePopupPosition,onAction:this._onAction,anchor:this.nodeRef,scope:this.nodeRef}))}},{key:"metrikaService",get:function(){return this.props.services.metrika}},{key:"containerRef",get:function(){return this.props.visual.refs.composeContainer}},{key:"isMobile",get:function(){return this.props.services.settings.isMobile}}]),n})(E.a.Component),v.propTypes={contentOptions:C.a.object,forwardedRef:C.a.object,innerRef:C.a.object,onClick:C.a.func,onPopupVisibilityChanged:C.a.func,popupProps:C.a.object,services:A.a.isRequired,visual:j.a.isRequired,onAction:C.a.func},s=_,u=g(s.prototype,"isPopupVisible",[k.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),g(s.prototype,"metrikaService",[k.computed],Object.getOwnPropertyDescriptor(s.prototype,"metrikaService"),s.prototype),g(s.prototype,"containerRef",[k.computed],Object.getOwnPropertyDescriptor(s.prototype,"containerRef"),s.prototype),g(s.prototype,"isMobile",[k.computed],Object.getOwnPropertyDescriptor(s.prototype,"isMobile"),s.prototype),l=g(s.prototype,"closePopup",[k.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){e.isPopupVisible=!1,e.notifyPopupVisibilityChanged(),e.isMobile||e.containerRef.focus()}}}),f=g(s.prototype,"onClick",[k.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){e.isPopupVisible||(e.contentKey=Date.now()),e.isPopupVisible=!e.isPopupVisible,e.notifyPopupVisibilityChanged(),e.props.onClick&&e.props.onClick(t)}}}),a=s))||a)||a,U=t.displayName||t.name;return n.displayName=U?"withPopup(".concat(U,")"):"withPopup",E.a.forwardRef(n)}t.a=_;var S=n(137),E=n.n(S),P=n(348),C=n.n(P),w=n(350),T=n.n(w),k=n(351),R=n(353),A=n(365),j=n(380),M=n(621),I=n(367)},557:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SENT=t.DELETE=t.CLOSE=t.COLLAPSE=void 0,t.COLLAPSE="collapse",t.CLOSE="close",t.DELETE="delete",t.SENT="sent"},558:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MAX_SUGGEST_ITEMS_FOR_POPUP=void 0,t.MAX_SUGGEST_ITEMS_FOR_POPUP=3},559:function(e,t,n){"use strict";var r=n(762);n.d(t,"a",(function(){return r}))},563:function(e,t,n){"use strict";function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var o,i=n(501);t.a=(o={},r(o,i.a.DELAYED_SENDING,(function(e){var t=e.data;return Boolean(t.sendTime)})),r(o,i.a.NOTIFICATIONS,(function(e){return e.data.hasNotifications})),r(o,i.a.TEMPLATES,(function(e){var t=e.data,n=e.visual;return t.isTemplate&&n.hasChanges})),o)},597:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NONE=t.SMALL=t.NORMAL=void 0,t.NORMAL="normal",t.SMALL="small",t.NONE="none"},598:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.INSERT_MULTIPLE=t.INSERT_TEXT=t.INSERT_LINE_BREAK=t.INSERT_FROM_PASTE=t.DELETE_CONTENT_BACKWARD=t.DELETE_BY_CUT=void 0,t.DELETE_BY_CUT="deleteByCut",t.DELETE_CONTENT_BACKWARD="deleteContentBackward",t.INSERT_FROM_PASTE="insertFromPaste",t.INSERT_LINE_BREAK="insertLineBreak",t.INSERT_TEXT="insertText",t.INSERT_MULTIPLE="insertMultiple"},599:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NONE=t.NS_COMPOSE=t.AUTOCOMPLETE=void 0,t.AUTOCOMPLETE="Autocomplete",t.NS_COMPOSE="NsCompose",t.NONE="None"},600:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DRAFT_NOT_SAVED=t.DRAFT_REMOVED=t.DRAFT_SAVED=t.NO_CHANGES=void 0,t.NO_CHANGES="no changes",t.DRAFT_SAVED="draft saved",t.DRAFT_REMOVED="draft removed",t.DRAFT_NOT_SAVED="draft not saved"},601:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n.d(t,"MUTE_AUTOSAVE_PROMO_UNTIL",(function(){return r})),n.d(t,"BEAUTIFUL_EMAIL_PROMO_CLOSED",(function(){return o})),n.d(t,"SUGGEST_BEAUTIFUL_EMAIL_PROMO_CLOSED",(function(){return i})),n.d(t,"DISABLE_AUTOCOMPLETE_REACT",(function(){return a})),n.d(t,"EMPTY_SUBJECT_POPUP_DISABLED",(function(){return c})),n.d(t,"ENABLE_AUTOSAVE",(function(){return s})),n.d(t,"ENABLE_HOTKEYS",(function(){return u})),n.d(t,"FROM_NAME",(function(){return l})),n.d(t,"LAST_USED_COMPOSE_SIZE",(function(){return p})),n.d(t,"NUMBER_OF_AUTOSAVE_PROMO_SHOW",(function(){return f})),n.d(t,"NS_COMPOSE_PROMO_CLOSED",(function(){return d})),n.d(t,"RECIPIENTS_DIFF_PROMO_CLOSED",(function(){return y})),n.d(t,"SIGNATURE_TOP",(function(){return b})),n.d(t,"SIZE_LAYOUT",(function(){return m})),n.d(t,"SIZE_LAYOUT_LEFT",(function(){return h})),n.d(t,"STORED_COMPOSE_STATES",(function(){return v})),n.d(t,"TIMELINE_EXPANDED",(function(){return O})),n.d(t,"TODO_ENABLED",(function(){return g})),n.d(t,"TWO_SIZES_HEADER_PROMO",(function(){return _})),n.d(t,"CAN_WRITE_LETTERS",(function(){return S}));var r="mute_autosave_promo_until",o="beautiful_email_compose_promo",i="beautiful_email_compose_promo",a="disable_autocomplete_react",c="empty_subject_popup_disabled",s="enable_autosave",u="enable_hotkeys",l="from_name",p="last_used_compose_size",f="number_of_autosave_promo_show",d="ns_compose_promo_closed",y="kukutz-promo-closed",b="signature_top",m="size-view-app",h="size-layout-left",v="storedComposeStates",O="timeline-is-open",g="show_todo",_="two_sizes_header_promo",S="can_write_letters"},602:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.POPUP=t.INPUT=void 0,t.INPUT="line",t.POPUP="popup"},603:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.QUERY=t.POPULAR=void 0,t.POPULAR="popular",t.QUERY="query"},604:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BACKGROUND=t.FOREGROUND=void 0,t.FOREGROUND="foreground",t.BACKGROUND="background"},605:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BanReason=void 0;!(function(e){e.RfcFail="RfcFail",e.UrlRbl="UrlRbl",e.BadKarma="BadKarma",e.MailLimits="MailLimits",e.PddAdminKarma="PddAdminKarma",e.Bounces="Bounces",e.SpamCompl="SpamCompl"})(t.BanReason||(t.BanReason={}))},606:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return c}));var r=n(559),o=function(){return!Daria.isReactiveCompose()},i=function(){var e=a();return ns.Model.get("settings").isSet(e)?r.a.NONE:Daria.isReactiveCompose()?r.a.REACT:r.a.NOSCRIPT},a=function(){return Daria.isReactiveCompose()?"disable_autocomplete_react":"disable_compose_autocomplete"},c=function(){var e=i();return Daria.isReactiveCompose()?e===r.a.REACT:Daria.isReactiveCompose()?null:e===r.a.NOSCRIPT}},609:function(e,t,n){"use strict";function r(e,t){e&&e.parentNode&&t&&e.parentNode.replaceChild(t,e)}t.a=r},618:function(e,t,n){"use strict";function r(){return r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},r.apply(this,arguments)}function o(e){"@babel/helpers - typeof";return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function c(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),e}function s(e,t){return!t||"object"!==o(t)&&"function"!=typeof t?l(e):t}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function l(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function p(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function d(e,t,n,r){n&&Object.defineProperty(e,t,{enumerable:n.enumerable,configurable:n.configurable,writable:n.writable,value:n.initializer?n.initializer.call(r):void 0})}function y(e,t,n,r,o){var i={};return Object.keys(r).forEach((function(e){i[e]=r[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce((function(n,r){return r(e,t,n)||n}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}n.d(t,"a",(function(){return M}));var b,m,h,v,O,g,_,S=n(137),E=n.n(S),P=n(348),C=n.n(P),w=n(351),T=n(353),k=n(745),R=n.n(k),A=n(372),j=n(793),M=(b=Object(T.inject)("controllers"))(m=Object(T.observer)((_=g=(function(e){function t(){var e,n;i(this,t);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return n=s(this,(e=u(t)).call.apply(e,[this].concat(o))),d(l(n),"avatar",v,l(n)),d(l(n),"refreshAvatar",O,l(n)),n}return p(t,e),c(t,[{key:"componentDidMount",value:function(){var e=this;this.disposer=Object(w.reaction)((function(){return e.contact}),(function(){return e.updateAvatar()}),{fireImmediately:!0,equals:w.comparer.structural})}},{key:"componentWillUnmount",value:function(){this.disposer()}},{key:"updateAvatar",value:function(){var e=this.contact,t=this.refreshAvatar;this.avatarsController.getAvatarForContact(e).then(t)}},{key:"render",value:function(){var e=this.props.cls;return E.a.createElement(R.a,r({className:e},this.avatar))}},{key:"contact",get:function(){return this.props.contact}},{key:"avatarsController",get:function(){return this.props.controllers.avatars}}]),t})(E.a.Component),g.propTypes={cls:C.a.string,contact:j.a.isRequired,controllers:A.a.isRequired},h=_,v=y(h.prototype,"avatar",[w.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),y(h.prototype,"contact",[w.computed],Object.getOwnPropertyDescriptor(h.prototype,"contact"),h.prototype),y(h.prototype,"avatarsController",[w.computed],Object.getOwnPropertyDescriptor(h.prototype,"avatarsController"),h.prototype),O=y(h.prototype,"refreshAvatar",[w.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){e.avatar=t}}}),m=h))||m)||m},620:function(e,t,n){"use strict";function r(){return i.default.useContext(a.MobXProviderContext)}var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.useStores=void 0;var i=o(n(137)),a=n(353);t.useStores=r},621:function(e,t,n){"use strict";var r=n(433),o=n(1803),i=(n.n(o),n(3624));t.a=Object(r.a)(o.Popup,i.a)},622:function(e,t,n){"use strict";function r(){return r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},r.apply(this,arguments)}function o(e){"@babel/helpers - typeof";return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){if(null==e)return{};var n,r,o=a(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function a(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e,t,n){return t&&s(e.prototype,t),n&&s(e,n),e}function l(e,t){return!t||"object"!==o(t)&&"function"!=typeof t?f(e):t}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function f(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function d(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&y(e,t)}function y(e,t){return(y=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function b(e,t,n,r){O||(O="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=r;else if(i>1){for(var a=new Array(i),c=0;c<i;c++)a[c]=arguments[c+3];t.children=a}if(t&&o)for(var s in o)void 0===t[s]&&(t[s]=o[s]);else t||(t=o||{});return{$$typeof:O,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function m(e,t,n,r){n&&Object.defineProperty(e,t,{enumerable:n.enumerable,configurable:n.configurable,writable:n.writable,value:n.initializer?n.initializer.call(r):void 0})}function h(e,t,n,r,o){var i={};return Object.keys(r).forEach((function(e){i[e]=r[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce((function(n,r){return r(e,t,n)||n}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}function v(e,t){function n(e,t){return _.a.createElement(k,r({},e,{forwardedRef:t}))}var o,a,s,y,v,O,g,S,k=Object(C.observer)((S=g=(function(e){function n(e){var t;return c(this,n),t=l(this,p(n).call(this,e)),m(f(t),"isHovered",s,f(t)),m(f(t),"isPopupVisible",y,f(t)),m(f(t),"setIsHovered",v,f(t)),m(f(t),"onPopupVisibilityChanged",O,f(t)),t.nodeRef=e.innerRef||_.a.createRef(),t}return d(n,e),u(n,[{key:"render",value:function(){var e=this,n=this.props,o=n.forwardedRef,a=i(n,["forwardedRef"]);return _.a.createElement(_.a.Fragment,null,_.a.createElement(t,r({ref:o,innerRef:this.nodeRef,onMouseEnter:function(){return e.setIsHovered(!0)},onMouseLeave:function(){return e.setIsHovered(!1)},onPopupVisibilityChanged:this.onPopupVisibilityChanged},a)),this.renderTooltip())}},{key:"renderTooltip",value:function(){return b(w.Tooltip,{direction:"top",view:"default",size:"s",state:"warning",anchor:this.nodeRef,visible:this.isTooltipVisible},void 0,b(T.default,{loc:this.props.tooltipKey}))}},{key:"isTooltipVisible",get:function(){return this.isHovered&&!this.isPopupVisible}}]),n})(_.a.Component),g.propTypes={forwardedRef:E.a.object,innerRef:E.a.oneOfType([E.a.object,E.a.func]),tooltipKey:E.a.string},g.defaultProps={tooltipKey:e},a=S,s=h(a.prototype,"isHovered",[P.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),y=h(a.prototype,"isPopupVisible",[P.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),h(a.prototype,"isTooltipVisible",[P.computed],Object.getOwnPropertyDescriptor(a.prototype,"isTooltipVisible"),a.prototype),v=h(a.prototype,"setIsHovered",[P.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){e.isHovered=t}}}),O=h(a.prototype,"onPopupVisibilityChanged",[P.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){e.isPopupVisible=t}}}),o=a))||o,R=t.displayName||t.name;return n.displayName=R?"withTooltip(".concat(R,")"):"withTooltip",_.a.forwardRef(n)}t.a=v;var O,g=n(137),_=n.n(g),S=n(348),E=n.n(S),P=n(351),C=n(353),w=n(887),T=(n.n(w),n(352))},624:function(e,t,n){"use strict";function r(e){"@babel/helpers - typeof";return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function c(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),e}function s(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?u(e):t}function u(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function p(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function d(e,t,n,r){O||(O="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=r;else if(i>1){for(var a=new Array(i),c=0;c<i;c++)a[c]=arguments[c+3];t.children=a}if(t&&o)for(var s in o)void 0===t[s]&&(t[s]=o[s]);else t||(t=o||{});return{$$typeof:O,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}n.d(t,"a",(function(){return U}));var y,b,m,h,v,O,g=n(137),_=n.n(g),S=n(348),E=n.n(S),P=n(350),C=n.n(P),w=n(351),T=n(353),k=n(365),R=n(380),A=n(801),j=n.n(A),M=n(402),I=n(368),D=n(397),N=n.n(D),L=n(3858),x=(n.n(L),E.a.oneOfType([E.a.element,E.a.string])),z="ComposeConfirmPopup",B={Block:z,Block_mobile:"".concat(z,"_mobile"),Block_tablet:"".concat(z,"_tablet"),Block_desktop:"".concat(z,"_desktop"),Content:"".concat(z,"-Content"),Title:"".concat(z,"-Title"),Description:"".concat(z,"-Description"),Toolbar:"".concat(z,"-Toolbar"),Button:"".concat(z,"-Button"),Button_action:"".concat(z,"-Button_action"),Button_cancel:"".concat(z,"-Button_cancel"),Close:"".concat(z,"-Close"),CheckmarkSection:"".concat(z,"-CheckmarkSection")},F=d(I.default,{id:"mail--Compose-ClosePopup"}),U=(y=Object(T.inject)("services","visual"))(b=Object(T.observer)((v=h=(function(e){function t(){var e,n;i(this,t);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return n=s(this,(e=l(t)).call.apply(e,[this].concat(o))),n._onKeyDown=function(e){if(n.props.visible){var t=!1;switch(e.keyCode){case N.a.ENTER:n.props.onAction&&(n.props.onAction(),t=!0)}t&&e.stopPropagation&&e.stopPropagation()}},n.onClose=function(e,t){"esc"===t&&n.props.onClose&&n.props.onClose(e)},n._onCheckmarkChange=function(e){n.props.onCheckmarkChange(e.target.checked)},n}return p(t,e),c(t,[{key:"componentDidMount",value:function(){document.addEventListener("keydown",this._onKeyDown,!0),window.oneOf=E.a.oneOf}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this._onKeyDown,!0)}},{key:"render",value:function(){var e=this.props,t=e.services,n=e.visible,r=e.Title,i=e.Description,a=e.cls;if(!this.shouldRender&&!n)return!1;this.shouldRender=!0;var c=C()(B.Block,t.settings.isMobile?B.Block_mobile:B.Block_desktop,a,o({},B.Block_tablet,t.settings.isTablet));return d(j.a,{cls:c,visible:n,onClose:this.onClose},void 0,d("div",{className:B.Content},void 0,this.maybeRenderCloseButton(),d("div",{className:B.Title},void 0,r),d("div",{className:B.Description},void 0,i),d("div",{className:B.Toolbar},void 0,this.maybeRenderConfirmButton(),this.maybeRenderCancelButton()),this.maybeRenderCheckmark()))}},{key:"maybeRenderCloseButton",value:function(){var e=this.props.onClose;return e?d(M.a,{cls:B.Close,theme:"clear",view:"default",tone:"default",size:"xs",onClick:e},void 0,F):null}},{key:"maybeRenderConfirmButton",value:function(){var e=this.props,t=e.onAction,n=e.ActionText;return t?d(M.a,{cls:C()(B.Button,B.Button_action),theme:"action",size:"m",onClick:t},void 0,n):null}},{key:"maybeRenderCancelButton",value:function(){var e=this.props,t=e.onCancel,n=e.CancelText;return t?d(M.a,{cls:C()(B.Button,B.Button_cancel),theme:"normal",tone:"default",view:"default",size:"m",onClick:t},void 0,n):null}},{key:"maybeRenderCheckmark",value:function(){var e=this.props,t=e.onCheckmarkChange,n=e.CheckmarkText,r=e.checkmarkValue;return t?d("div",{className:B.CheckmarkSection},void 0,d("label",{},void 0,d("input",{type:"checkbox",checked:r,onChange:this._onCheckmarkChange}),d("span",{},void 0,n))):null}},{key:"composeContainerRef",get:function(){return this.props.visual.refs.composeContainer}}]),t})(_.a.Component),h.propTypes={cls:E.a.string,ActionText:x.isRequired,CancelText:x,Description:x.isRequired,Title:x,onAction:E.a.func.isRequired,onCancel:E.a.func,onClose:E.a.func,visible:E.a.bool,onCheckmarkChange:E.a.func,CheckmarkText:x,checkmarkValue:E.a.bool,services:k.a.isRequired,visual:R.a.isRequired},m=v,(function(e,t,n,r,o){var i={};return Object.keys(r).forEach((function(e){i[e]=r[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce((function(n,r){return r(e,t,n)||n}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i})(m.prototype,"composeContainerRef",[w.computed],Object.getOwnPropertyDescriptor(m.prototype,"composeContainerRef"),m.prototype),b=m))||b)||b},666:function(e,t,n){"use strict";function r(e,t){if(o(e))return{isMatch:!1,targetMatch:null};var n=Daria.Html2Text.html2text(e.innerHTML),r=!0,i=!1,a=void 0;try{for(var c,s=t[Symbol.iterator]();!(r=(c=s.next()).done);r=!0){var u=c.value;if(u.match&&new RegExp("^"+u.match).test(n))return{isMatch:!0,targetMatch:u}}}catch(e){i=!0,a=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}return m.test(n)?{isMatch:!0,targetMatch:null}:{isMatch:!1,targetMatch:null}}function o(e){return(e.tagName||"").toUpperCase()===d.h.toUpperCase()}function i(e){var t=Object(f.a)(e);return b.test(t)}function a(e){return!(Object(f.a)(e).trim()||(e.tagName||"").toUpperCase()===y||e.getElementsByTagName&&0!==e.getElementsByTagName(y).length)}function c(e,t){for(var n=!1,o=0;o<e.childNodes.length;o++){var a=e.childNodes[o],c=i(a);if(c&&(n=!n),!n&&!c){var s=r(a,t),u=s.isMatch,l=s.targetMatch;if(u)return{idx:o,targetMatch:l}}}return{idx:-1,targetMatch:null}}function s(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=c(e,t),r=n.idx,s=n.targetMatch;if(r<0)return null;for(var l={current:r,prev:r},p=!1,f=!1,d=r+1;d<e.childNodes.length;d++){var y=e.childNodes[d];if(o(y)){p=!0;break}if(i(y))break;f=a(y),f||(l.prev=l.current,l.current=d)}return f&&l.prev++,s&&s.leadingLineBreaks>0&&u(e.childNodes[r],s.leadingLineBreaks)&&(r-=s.leadingLineBreaks),{node:e,start:r,finish:p?l.prev:l.current,targetMatch:s}}function u(e,t){for(;t--;)if(!(e=e.previousElementSibling)||!a(e))return!1;return!0}function l(e){for(;e.childNodes.length;){var t=e.childNodes[e.childNodes.length-1];if(!a(t))break;e.removeChild(t)}}function p(e){for(var t=-1,n=-1,r=0;r<e.childNodes.length;r++){if(i(e.childNodes[r])){if(-1===t){t=r;continue}n=r;break}}return-1===t||-1===n?null:{node:e,start:t,finish:n}}t.b=s,t.c=l,t.a=p;var f=n(499),d=n(432),y="IMG",b=/^--------[^\-]+.*--------$/,m=/^--\s?$|^--\s/},667:function(e,t,n){"use strict";function r(e){if(!e)return 0;var t=Array.prototype.slice.call(e.getElementsByTagName(o.h)),n=t.map((function(e){return e.parentNode})),r=Object(i.uniq)(n).length;return e.tagName.toLowerCase()===o.h.toLowerCase()?r+1:r}t.a=r;var o=n(432),i=n(138);n.n(i)},679:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n.d(t,"UNKNOWN",(function(){return r})),n.d(t,"FILE_LIMIT",(function(){return o})),n.d(t,"TOTAL_LIMIT",(function(){return i})),n.d(t,"YADISK_ERROR",(function(){return a})),n.d(t,"VIRUS",(function(){return c})),n.d(t,"DISK_FULL",(function(){return s})),n.d(t,"STATUS_DISK_FULL",(function(){return u})),n.d(t,"DISK_TRAFFIC_LIMIT",(function(){return l})),n.d(t,"DISK_TECHNICAL_WORK",(function(){return p}));var r=0,o=1,i=2,a=6,c=106,s=85,u=507,l=311,p=312},680:function(e,t,n){"use strict";var r=n(138),o=(n.n(r),function(){return Object(r.uniqueId)("attach-")});t.a=function(e){return e.id||e.hid&&e.hid.replace(/\./g,"-")||o()}},681:function(e,t,n){"use strict";n.d(t,"d",(function(){return r})),n.d(t,"a",(function(){return o})),n.d(t,"i",(function(){return i})),n.d(t,"h",(function(){return a})),n.d(t,"f",(function(){return c})),n.d(t,"g",(function(){return s})),n.d(t,"e",(function(){return u})),n.d(t,"b",(function(){return l})),n.d(t,"c",(function(){return p}));var r="compose-have-opened",o="captcha-have-shown",i="SSItemsShow",a="SSItemClick",c="sending-has-been-triggered",s="sending-have-failed",u="delayed-sending-have-failed",l="changed-size-to-small",p="changed-size-to-large"},682:function(e,t,n){"use strict";var r=n(138),o=(n.n(r),n(348)),i=n.n(o),a=n(3545),c=n(369);t.a=i.a.shape({info:a.a.isRequired,status:i.a.oneOf(Object(r.values)(c.c)).isRequired,errorCode:i.a.oneOf(Object(r.values)(c.e)),previewSupported:i.a.bool.isRequired,progress:i.a.number,visual:i.a.object,source:i.a.oneOf(Object(r.values)(c.b))})},687:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.getLocString=t.UNIT_LOC_KEYS=t.getSizeAndUnit=void 0;var o=r(n(367)),i=function(e){var t=parseInt(String(e),10),n=null,r=null;return isNaN(t)?{value:n,unit:r}:(t<128?(n=t,r="bytes"):t<1048576?(n=t/1024,r="kilobytes"):t<1073741824?(n=t/1048576,r="megabytes"):(n=t/1073741824,r="gigabytes"),n=n<10?Math.round(10*n)/10:Math.round(n),n=n.toString().replace(".",","),{value:n,unit:r})};t.getSizeAndUnit=i,t.UNIT_LOC_KEYS={bytes:"compose-react/FileSize_bytes",kilobytes:"compose-react/FileSize_kilobytes",megabytes:"compose-react/FileSize_megabytes",gigabytes:"compose-react/FileSize_gigabytes"};var a=function(e){var n=e.unit,r=e.value;return r&&n?o.default(t.UNIT_LOC_KEYS[n],{value:r}):null};t.getLocString=a},688:function(e,t,n){"use strict";var r=n(3707);n.d(t,"a",(function(){return r.a}));var o=n(3741);n.d(t,"b",(function(){return o.a}));var i=(n(1834),n(3743));n.d(t,"c",(function(){return i.a}));var a=(n(455),n(794)),c=n.n(a);n.d(t,"d",(function(){return c.a}));var s=n(3744);n.d(t,"e",(function(){return s.a}));var u=n(1800);n.d(t,"f",(function(){return u.a}));n(1835),n(795)},762:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n.d(t,"NOSCRIPT",(function(){return r})),n.d(t,"NONE",(function(){return o})),n.d(t,"REACT",(function(){return i}));var r="noscript",o="none",i="react"},769:function(e,t,n){"use strict";function r(e){e&&e.parentNode&&e.parentNode.removeChild(e)}t.a=r},770:function(e,t,n){"use strict";function r(e){for(var t=e&&e.parentNode;t;){if(t.tagName.toUpperCase()===a.h.toUpperCase())return t;t=t.parentNode}return null}function o(e){var t=e.getAttribute(l);if(!t){t=1e4*Object(u.a)(e)+Object(c.a)(e).length,e.setAttribute(l,t)}return t}function i(e,t){if(!e)return null;var n=Array.prototype.slice.call(e.getElementsByTagName(a.h)).filter((function(t){var n=r(t);return!n||n===e})).map((function(e){return{quote:e,weight:o(e)}})).sort((function(e,t){return e.weight-t.weight})),i=null;return n.length&&(i=n[n.length-1].quote,Object(s.a)(i,t)),i}t.a=i;var a=n(432),c=n(499),s=n(609),u=n(667),l="data-weight"},785:function(e,t,n){"use strict";var r=n(1260);n.d(t,"a",(function(){return r.a}));var o=(n(786),n(899));n.d(t,"b",(function(){return o.a}));var i=n(900);n.d(t,"c",(function(){return i.a}))},786:function(e,t,n){"use strict";function r(e){return a(e)||i(e)||o()}function o(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function i(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function a(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){u(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function p(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function f(e,t,n){return t&&p(e.prototype,t),n&&p(e,n),e}n.d(t,"a",(function(){return y}));var d=n(139),y=(n.n(d),(function(){function e(){l(this,e)}return f(e,[{key:"getPageAfterSent",value:function(){return Daria.isReactiveCompose()&&Daria.IS_CORP?"prev":Daria.is3pane()?"prev":ns.Model.get("settings").getSetting("page_after_send")}},{key:"whereToGoAfterSend",value:function(){var e,t=ns.Model.get("folders");switch(this.getPageAfterSent()){case"done":e=ns.router.generateUrl("done");break;case"sent_list":e=ns.router.generateUrl("messages",{current_folder:t.getFidBySymbol(d.WellKnownFolderSymbol.SENT)});break;case"current_list":e=ns.page.history.getPreviousPageUrl({match:"messages"});break;case"prev":e=ns.page.history.getPreviousPageUrl({mismatch:"compose2"})}if(!e){e=ns.router.generateUrl("messages",{current_folder:t.getFidBySymbol(d.WellKnownFolderSymbol.INBOX)})}return e}},{key:"showMessageSentNotification",value:function(e){var t=e.fromQR,n=e.sentMid,r=e.wasSendCancelled,o=e.withUndo,i=e.isDelayed,a=e.sendTime;if(r)return!1;var c={};if(o){var s=Daria.SendMail.getUndoSendLogger(n);c.onClose=function(){s.logClose()},c.onCancel=function(){s.logCancel()}}if(i)return Daria.SendMail.showMessageSentDelayed(n,a,c),!0;var u=!1;if(t)u=o;else{u=!("done"===this.getPageAfterSent())||o}return!!u&&(Daria.SendMail.showMessageSent(n,c),!0)}},{key:"sendMetrika",value:function(){Jane.Metrika.counter&&Jane.Metrika.counter.reachGoal("SEND")}},{key:"leaveCompose",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.clearPageBlock,r=t.neverReturn;n&&ns.page.block.clear();var o=this.pageGoUrl||ns.page.history.getPreviousPageUrl({mismatch:"compose2"})||ns.page.HOME_HASH,i=ns.router(o);i.page===ns.R.REDIRECT&&(i=ns.router(i.redirect)),i.params=_.omit(i.params,"_cuid");var a=_.delay((function(){Jane.ErrorLog.send({event:"after_send_wait_10_sec"})}),1e4),c=_.delay((function(){Jane.ErrorLog.send({event:"after_send_wait_20_sec"}),ns.page.go(ns.page.HOME_HASH)}),2e4),s=ns.router.generateUrl(i.page,i.params);return ns.page.go(s,r?"replace":null).fail((function(t){return e.handleLeaveComposeFail(s,t)})).always((function(e){return window.clearTimeout(a),window.clearTimeout(c),e}))}},{key:"handleLeaveComposeFail",value:function(e,t){var n=this,r=s({},t,{event:"compose_leave_failed",loadingHash:e});return Jane.ErrorLog.send(r),this.handleTransitionFail(t,(function(e,t){return ns.page.go(t).fail(n.handleTransitionFail)}),[ns.page.HOME_HASH])}},{key:"handleTransitionFail",value:function(e,t,n){if(t=t||Vow.reject,n=Array.isArray(n)?n:[],"expired"!==(e&&e.error)){var o=t.apply(null,[e].concat(r(n)));return o instanceof Vow.Promise?o:Vow.reject(o)}return Vow.resolve(e)}}]),e})())},787:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n.d(t,"NEW",(function(){return r})),n.d(t,"UPLOADING",(function(){return o})),n.d(t,"COMPLETED",(function(){return i})),n.d(t,"FAILED",(function(){return a})),n.d(t,"VIRUS",(function(){return c})),n.d(t,"ABORTED",(function(){return s})),n.d(t,"RESTRICTED",(function(){return u}));var r=0,o=1,i=2,a=3,c=4,s=5,u=6},788:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n.d(t,"FILE",(function(){return r})),n.d(t,"YADISK",(function(){return o})),n.d(t,"FORWARDED_MAIL",(function(){return i}));var r="simple",o="narod",i="forwarded"},789:function(e,t,n){"use strict";t.a=function(e,t){var n=t.handlerName,r=t.isOk,o=t.errorCode;Daria.monitoring.workflow.attachToDisk({params:{size:e&&e.size,checkLimit:!0},handler:n,status:r?"success":"error",errorCode:o})}},790:function(e,t,n){"use strict";t.a=function(e,t){e.upload&&e.upload.addEventListener("progress",(function(e,n){e&&e.lengthComputable&&(n=e.loaded/e.total*100),n=parseInt(n,10),n=isNaN(n)?-1:n,t(n)}),!1)}},791:function(e,t,n){"use strict";function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e){if(e.mid){var t=s(e);e.previewHref=Daria.url.attachment(t,e.mid,{no_disposition:!0}),e.previewSrc=Daria.url.attachment(t,e.mid,{no_disposition:!0,thumb:!0})}}function c(e){e.narodPreview&&(e.previewSrc=e.narodPreview,e.previewHref=e.narodUrl||e.narodPreview)}function s(e){return e.mid&&e.from_template?o({},e,{mid:e.template_mid,hid:e.template_hid}):e}t.a=function(e){a(e),c(e)}},793:function(e,t,n){"use strict";var r=n(348);n.n(r);t.a=r.PropTypes.shape({email:r.PropTypes.string,name:r.PropTypes.string})},794:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=r(n(350)),i=r(n(137)),a=r(n(352)),c=n(140);n(3551);var s=function(e){var t=e.cls,n=e.fieldId,r=e.title,s=e.onTitleClick,u=e.onClickCapture,l=e.contentClass,p=e.contentRef,f=e.children,d=e.getRef,y=o.default("compose-LabelRow-Content",l);return i.default.createElement("div",{className:o.default(t,"compose-LabelRow"),onClickCapture:u,ref:d},i.default.createElement(c.Text,{className:"compose-LabelRow-Label",typography:"body-long-m",color:"secondary",onMouseDown:s,htmlFor:n,as:"label"},i.default.createElement(a.default,{loc:r})),i.default.createElement("div",{className:y,ref:p},f))};t.default=s},795:function(e,t,n){"use strict";function r(e){"@babel/helpers - typeof";return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function c(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),e}function s(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?u(e):t}function u(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function p(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function d(e,t,n,r){y||(y="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=r;else if(i>1){for(var a=new Array(i),c=0;c<i;c++)a[c]=arguments[c+3];t.children=a}if(t&&o)for(var s in o)void 0===t[s]&&(t[s]=o[s]);else t||(t=o||{});return{$$typeof:y,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}n.d(t,"a",(function(){return w}));var y,b=n(137),m=n.n(b),h=n(348),v=n.n(h),O=n(350),g=n.n(O),_=n(140),S=(n.n(_),n(367)),E=n(3553),P=(n.n(E),"ComposeYabble"),C={Block:P,Block_invalid:"".concat(P,"_invalid"),Block_editable:"".concat(P,"_editable"),Block_uneditable:"".concat(P,"_uneditable"),Block_external:"".concat(P,"_external"),Avatar:"".concat(P,"-Avatar"),Text:"".concat(P,"-Text"),RemoveIconWrapper:"".concat(P,"-RemoveIconWrapper")},w=(function(e){function t(){var e,n;i(this,t);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return n=s(this,(e=l(t)).call.apply(e,[this].concat(o))),n.onMouseDown=function(e){n.props.onMouseDown&&n.props.onMouseDown(e)},n.onClick=function(e){n.props.onClick&&n.props.onClick(e)},n.onRemove=function(e){e.preventDefault(),e.stopPropagation(),n.props.onRemove&&n.props.onRemove(e)},n}return p(t,e),c(t,[{key:"maybeRenderAvatar",value:function(e){if(!e)return null;var t=this.props.AvatarComponent;return t&&e.isValid()?d("div",{className:C.Avatar},void 0,d(t,{contact:e})):null}},{key:"maybeRenderRemoveIcon",value:function(){return this.props.isEditable?d("div",{className:C.RemoveIconWrapper,onClick:this.onRemove,role:"button","aria-label":Object(S.default)("compose-react/deleteLabel")},void 0,this.props.removeIcon):null}},{key:"render",value:function(){var e,t=this.props,n=t.nodeRef,r=t.isEditable,i=t.getContact,a=t.children,c=t.ContentComponent,s=t.className,u=i(),l=u?u.isValid():this.props.isValid,p=u&&u.isExternal(),f=g()(s,C.Block,(e={},o(e,C.Block_invalid,!l),o(e,C.Block_editable,r),o(e,C.Block_uneditable,!r),o(e,C.Block_external,p),e));return m.a.createElement("div",{ref:n,className:f,onMouseDown:this.onMouseDown,onClick:this.onClick,contentEditable:"false",suppressContentEditableWarning:!0},this.maybeRenderAvatar(u),d(_.Text,{as:"div",typography:"body-short-m",className:C.Text,spellCheck:"false",autoComplete:"off",autoCorrect:"off",autoCapitalize:"off"},void 0,d(c,{contact:u})),this.maybeRenderRemoveIcon(),a)}}]),t})(m.a.Component);w.propTypes={className:v.a.string,nodeRef:v.a.object,isEditable:v.a.bool,isValid:v.a.bool,onRemove:v.a.func,onClick:v.a.func,onMouseDown:v.a.func,AvatarComponent:v.a.elementType,ContentComponent:v.a.elementType.isRequired,removeIcon:v.a.element,getContact:v.a.func},w.defaultProps={getContact:function(){return null}}},799:function(e,t,n){"use strict";var r=n(348),o=n.n(r),i=n(372),a=n(376),c=n(365),s=n(380);t.a={cls:o.a.string,controllers:i.a.isRequired,data:a.a.isRequired,services:c.a.isRequired,visual:s.a.isRequired}},800:function(e,t,n){"use strict";var r=n(348),o=(n.n(r),n(530)),i=n(3667);t.a=r.PropTypes.shape({errors:o.a.arrayOf(i.a)})},801:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},r.apply(this,arguments)},o=this&&this.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var o=0,r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]]);return n},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Modal=void 0;var a=i(n(137)),c=i(n(350)),s=n(353),u=n(144);n(1313);var l=n(620),p={Block:"ComposeModal",Block_mobile:"ComposeModal_mobile",Block_tablet:"ComposeModal_tablet",Block_desktop:"ComposeModal_desktop",Block_fullscreen:"ComposeModal_fullscreen"};t.Modal=s.observer((function(e){var t,n=e.fullscreen,i=e.cls,s=e.className,f=o(e,["fullscreen","cls","className"]),d=l.useStores().services,y=c.default(i,s,p.Block,d.settings.isMobile?p.Block_mobile:p.Block_desktop,(t={},t[p.Block_fullscreen]=n,t[p.Block_tablet]=null===d||void 0===d?void 0:d.settings.isTablet,t));return a.default.createElement(u.Modal,r({className:y,theme:"normal"},f))})),t.default=t.Modal},886:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.INLINE_IMAGE_URL=t.INLINE_IMAGE_LOCAL=t.INLINE_IMAGE=t.CLEAR_FORMAT=t.BULLETED_LIST=t.NUMBERED_LIST=t.ALIGN_RIGHT=t.ALIGN_CENTER=t.ALIGN_LEFT=t.ALIGN=t.QUOTE=t.REMOVE_LINK=t.ADD_LINK=t.EMOJI=t.BACKGROUND_COLOR=t.TEXT_COLOR=t.FONT_SIZE=t.FONT=t.STRIKETHROUGH=t.UNDERLINE=t.ITALIC=t.BOLD=t.REDO=t.UNDO=void 0,t.UNDO="undo",t.REDO="redo",t.BOLD="bold",t.ITALIC="italic",t.UNDERLINE="underline",t.STRIKETHROUGH="strike",t.FONT="mailfont",t.FONT_SIZE="mailfontsize",t.TEXT_COLOR="mailtextcolor",t.BACKGROUND_COLOR="mailbgcolor",t.EMOJI="emoticons",t.ADD_LINK="link",t.REMOVE_LINK="unlink",t.QUOTE="blockquote",t.ALIGN="menualignment",t.ALIGN_LEFT="justifyleft",t.ALIGN_CENTER="justifycenter",t.ALIGN_RIGHT="justifyright",t.NUMBERED_LIST="numberedlist",t.BULLETED_LIST="bulletedlist",t.CLEAR_FORMAT="removeFormat",t.INLINE_IMAGE="inlineImage",t.INLINE_IMAGE_LOCAL="inlineImageLocal",t.INLINE_IMAGE_URL="inlineImageUrl"},887:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Tooltip=void 0;var r=n(154),o=n(389),i=n(151),a=n(87);t.Tooltip=a.hasFeature(a.Features.WEB_DARK_COMPOSE)?r.Tooltip:i.withStaticTheme(o.PS_LIGHT)(r.Tooltip)},899:function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e}n.d(t,"a",(function(){return c}));var a=n(139),c=(n.n(a),(function(){function e(){r(this,e)}return i(e,[{key:"updateDraftAfterAction",value:function(e,t){if(t){var n=ns.Model.get("message",{ids:t});if(!e){ns.Model.traverse("messages",(function(e){return e.remove(n)}));var r=n.getThreadMessage();r&&r.hasRealData()&&r.updateThreadCount(-1)}var o=function(e){return e.isValid()&&e.params.ids===t};ns.Model.invalidate("message",o),ns.Model.invalidate("message-body",o),this.updateFolders(a.DraftLikeFoldersShort)}}},{key:"updateFolders",value:function(e){var t=Array.isArray(e)?e:[e],n=ns.Model.get("folders");return t.forEach((function(e){var t=n.getFidBySymbol(e);Daria.messages.clearCacheByFID(t)})),ns.forcedRequest(["folders","labels"]).then((function(){ns.router.buildFoldersUrls()}))}},{key:"updateTemplateAfterAction",value:function(e){if(this.updateFolders(a.DraftTemplateLikeFoldersShort),e){var t=ns.Model.get("folders"),n=t.getFidBySymbol(a.WellKnownFolderSymbol.TEMPLATE);ns.Model.get("message",{ids:e}).setIfChanged(".fid",n);var r=function(t){return t.isValid()&&t.params.ids===e};ns.Model.invalidate("message",r),ns.Model.invalidate("message-body",r)}}},{key:"updateMessageFlagsAfterSend",value:function(e,t){var n=t.isForward,r=t.isReply,o=t.replyMessageId;if(e&&e.length){var i=function(t){return e.forEach((function(e){return t(ns.Model.get("message",{ids:e}))}))};n&&i((function(e){return e.markForwarded()})),r&&i((function(e){return e.markAnswered()})),ns.Model.invalidate("message-in-reply-to-ng",(function(e){return e.params.message_id===o}))}}},{key:"resetCheckedMessages",value:function(){if("message"!==ns.page.current.page){ns.Model.get("messages-checked").resetChecked(),ns.events.trigger("daria:vToolbarButton:restruct",{force:!0})}}}]),e})())},900:function(e,t,n){"use strict";function r(e){return Boolean(e.inreplyto)?{initial_to:e.to,initial_cc:e.cc}:{}}t.a=r},901:function(e,t,n){"use strict";t.a=function(e){return function(t){return e*(Math.sqrt(t)/(1+Math.sqrt(t)))}}},902:function(e,t,n){"use strict";function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e){return c(e)||s(e)||u(e)||{uploading:!0}}function c(e){var t=e.narodUrl,n=e.url;return t||n?{url:t||n}:null}function s(e){var t=e.mid,n=e.hid,r=e.bid;return t&&n?{mid:t,hid:n,bid:r}:null}function u(e){return e.from_template?{mid:e.template_mid,hid:e.template_hid}:null}function l(e,t){return t?{"preview-supported":!0,"preview-src":e.previewSrc||!1,"preview-href":e.previewHref||!1}:{}}function p(e,t){var n=e.narodUrl||e.url||t===f.COMPLETED&&Daria.url.attachment(e,e.mid,{no_disposition:!0});return n?{url:n}:{}}var f=n(787),d=n(679),y=n(788),b=n(138);n.n(b);t.a=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.status,r=t.previewSupported,i=e.id,c=e.name,s=e.folder,u=e.size,m=e.stid,h=e.message,v=e.type;if(v===y.FORWARDED_MAIL)return{id:i,name:c,icon:"eml",class:"mail"};var O=Daria.splitName(c),g={id:i,name:c,"name-uri-encoded":e["name-uri-encoded"],filename:O[0],fileext:O[1]?"."+O[1]:"",class:e.class,folder:s,"browser-supports":e["browser-supports"],length:u,status:n,errorCode:n===f.VIRUS?d.VIRUS:void 0,stid:m||void 0,icon:e.extension&&e.extension.icon||void 0,external_transformer:e.external_transformer,external_transformer_filetype:e.external_transformer?e.external_transformer_filetype:void 0,message:Boolean(h)||void 0,narod:v===y.YADISK||void 0},_=o({},Object(b.omit)(g,(function(e){return void 0===e})),{},a(e),{},l(e,r));return o({},_,{},p(_,n))}},903:function(e,t,n){"use strict";function r(e){return Object(o.escape)(e?e.name||e.fileName:i18n("%Без_темы"))}var o=n(138),i=(n.n(o),n(680)),a=n(369),c=n(791),s=n(1273);t.a=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};"mail"===e.class&&"eml"!==Daria.getExtension(Object(o.unescape)(e.name))&&(e.name+=".eml"),e.id=Object(i.a)(e),e.name=Object(o.unescape)(e.name||r(e.file)),e["name-uri-encoded"]=encodeURIComponent(e.name),e.extension=Daria.getExtensionInfo(e.name),e.class=e.class||e.extension.class;var t=Object(s.a)(e);return t&&Object(c.a)(e),{info:e,previewSupported:t,status:e.type?a.c.COMPLETED:a.c.NEW,progress:null}}},904:function(e,t){function n(e,t){for(var n=999,i=1,a=[];e&&n;)i>0?(e=o(e,a,t),i=-1):(e=r(e,a,t),i=1),n--;return a}function r(e,t,n){for(var r=!1,o=0;o<e.length;++o){var i=e[o];if(u(e,o)&&(r=!r),!r&&n[i]){var c=e.substring(0,o).trim();c&&t.push(c),e=a(e,0,o+1),o=-1}}return e&&(t.push(e.trim()),e=""),e}function o(e,t,n){for(var r=0;r<e.length;++r){if(">"===e.charAt(r)){var o=e.substring(0,r+1).trim();if(o&&l.test(o)){var c=[];o=i(o,t,n),c.length&&t.push.apply(t,c),t.push(o),e=a(e,0,r+1),r=-1}}}return e.trim()}function i(e,t,n){for(var r=!1,o=0;o<e.length;++o){var i=e[o];if(u(e,o)&&(r=!r),!r&&n[i]){var c=e.substring(0,o).trim();c&&!s(c,i)||(c&&t.push(c),e=a(e,0,o+1),o=-1)}}return e.trim()}function a(e,t,n){return e.substr(0,t)+(n>0?e.substr(n):"")}function c(e){return'"'===e[0]&&'"'===e[e.length-1]}function s(e,t){return(" "!==t||!c(e))&&Jane.FormValidation.checkEmail(e)}function u(e,t){return'"'===e[t]&&(0===t||"\\"!==e[t-1])}var l=/^(.*)<[^<>]*>$/,p={",":!0,";":!0," ":!0};e.exports=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:p;return function(t){return n(t,e)}},e.exports.SEPARATORS=p},905:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ATTACHMENTS_INITIALIZATION_FAILED=t.CHANGE_SIZE_FAILED=t.CHANGE_WORK_MODE_FAILED=t.TEMPLATES_FOLDER_CREATION_FAILED=t.CONTACT_LOAD_FAILED=void 0,t.CONTACT_LOAD_FAILED="compose.load-contact-failed",t.TEMPLATES_FOLDER_CREATION_FAILED="compose.templates-folder-creation-failed",t.CHANGE_WORK_MODE_FAILED="compose.change-work-mode-failed",t.CHANGE_SIZE_FAILED="compose.change-size-failed",t.ATTACHMENTS_INITIALIZATION_FAILED="compose.attachments-initialization-failed"},906:function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e}n.d(t,"a",(function(){return s}));var a=n(1274),c=n.n(a),s=(function(){function e(){r(this,e),this._emitter=c()()}return i(e,[{key:"on",value:function(e){var t=this;return this._emitter.on("event",e),function(){return t.off(e)}}},{key:"off",value:function(e){this._emitter.off("event",e)}},{key:"once",value:function(e){var t=this;return this._emitter.once("event",e),function(){return t.off(e)}}},{key:"_emit",value:function(e){this._emitter.emit("event",e)}}]),e})()},908:function(e,t,n){"use strict";function r(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.children.length-1,r="",o=t;o<=n;)r+=e.children[o++].outerHTML;return r}function o(e){try{return(new DOMParser).parseFromString(e,"text/html").body}catch(n){var t=document.createElement("div");return t.innerHTML=e,t}}n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return d})),n.d(t,"c",(function(){return y}));var i=n(770),a=n(769),c=n(666),s=function(e){var t=e.messageBody,n=e.signatureMatches,r=void 0===n?[]:n,o=document.createElement("div");return o.innerHTML=t,{signature:u(o,r),forward:p(o),quotes:f(o)}},u=function(e,t){var n=Object(c.b)(e,t);return n?l(e,n):""},l=function(e,t){for(var n=t.start,r=t.finish,o=document.createElement("div"),i=r-n+1,a=0;a<i;a++)o.appendChild(e.childNodes[n]);return o.innerHTML},p=function(e){var t=Object(c.a)(e);return t?l(e,t):""},f=function(e){var t=document.createElement("div"),n=Object(i.a)(e,t);if(n){var r=document.createElement("div"),o=t.previousSibling;return o&&r.appendChild(o),r.appendChild(n),r.innerHTML}return""},d=function(e){var t=document.createElement("div");t.innerHTML=e;var n=document.createElement("div");if(Object(i.a)(t,n)){var r=n.previousSibling;Object(a.a)(r),Object(a.a)(n)}return Daria.Html2Text.html2text(t.innerHTML).trim().length},y=function(e){var t=e.messageBody,n=e.signatureMatches,i=void 0===n?[]:n,a=o(t),s=Object(c.b)(a,i);return s?{beforeSignature:r(a,0,s.start-1),signature:r(a,s.start,s.finish),afterSignature:r(a,s.finish+1)}:{beforeSignature:a.innerHTML.trim(),signature:"",afterSignature:""}}},915:function(e,t,n){"use strict";var r="ComposeControlPanel";t.a={Block:r,Part:"".concat(r,"-Part"),Button:"".concat(r,"-Button"),ButtonNew:"".concat(r,"-Button_new"),FileInput:"".concat(r,"-FileInput"),AttachFileButton:"".concat(r,"-AttachFileButton"),CloseButton:"".concat(r,"-CloseButton"),DelayedSendingButton:"".concat(r,"-DelayedSendingButton"),LabelButton:"".concat(r,"-LabelButton"),MoreButton:"".concat(r,"-MoreButton"),NotificationsButton:"".concat(r,"-NotificationsButton"),SendButton:"".concat(r,"-SendButton"),TemplatesButton:"".concat(r,"-TemplatesButton"),TranslatorButton:"".concat(r,"-TranslatorButton")}},916:function(e,t,n){"use strict";function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t,n,r){a||(a="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=r;else if(i>1){for(var c=new Array(i),s=0;s<i;s++)c[s]=arguments[s+3];t.children=c}if(t&&o)for(var u in o)void 0===t[u]&&(t[u]=o[u]);else t||(t=o||{});return{$$typeof:a,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}var a,c=n(137),s=n.n(c),u=n(348),l=n.n(u),p=n(350),f=n.n(p),d=n(503),y=n(427),b=n(352),m=n(3623),h=(n.n(m),"ControlButtonMenuItem"),v={Block:h,withNotification:"".concat(h,"_notification"),Icon:"".concat(h,"-Icon"),Text:"".concat(h,"-Text")},O=function(e){var t=f()(e.cls,v.Block,o({},v.withNotification,e.hasNotification));return s.a.createElement("div",{ref:e.innerRef,onMouseEnter:e.onMouseEnter,onMouseLeave:e.onMouseLeave,onClick:e.onClick,className:t},i("span",{className:v.Icon},void 0,i(y.a,{id:e.icon})),i(b.default,{className:v.Text,loc:e.loc}))};t.a=O,O.propTypes=(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e})({},d.a,{icon:l.a.string,loc:l.a.string,hasNotification:l.a.bool})},917:function(e,t,n){"use strict";function r(e){"@babel/helpers - typeof";return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}function c(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?s(e):t}function s(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}n.d(t,"a",(function(){return C}));var f,d,y,b,m,h,v=n(137),O=n.n(v),g=n(351),_=n(353),S=n(688),E=n(380),P=(function(e,t,n,r){h||(h="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=r;else if(i>1){for(var a=new Array(i),c=0;c<i;c++)a[c]=arguments[c+3];t.children=a}if(t&&o)for(var s in o)void 0===t[s]&&(t[s]=o[s]);else t||(t=o||{});return{$$typeof:h,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}})(S.e,{}),C=(f=Object(_.inject)("visual"))(d=Object(_.observer)((m=b=(function(e){function t(){return o(this,t),c(this,u(t).apply(this,arguments))}return l(t,e),a(t,[{key:"render",value:function(){return this.isLocked&&P}},{key:"isLocked",get:function(){return this.props.visual.isLocked}}]),t})(O.a.Component),b.propTypes={visual:E.a.isRequired},y=m,(function(e,t,n,r,o){var i={};return Object.keys(r).forEach((function(e){i[e]=r[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce((function(n,r){return r(e,t,n)||n}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i})(y.prototype,"isLocked",[g.computed],Object.getOwnPropertyDescriptor(y.prototype,"isLocked"),y.prototype),d=y))||d)||d},920:function(e,t,n){"use strict";function r(e){return d(e.name||"").toLowerCase()||"general"}function o(e){return e&&e.icon&&"none"!==e.icon?e.icon:e&&e.meta&&e.meta.mediatype||"none"}function i(e){return e.type===f.d}function a(e,t){if(!t&&e.meta&&e.meta.sizes){var n=l.a.find(e.meta.sizes,(function(e){return"S"===e.name}));return n&&n.url}}function c(e,t){return Object(p.a)(e,t)}function s(e,t,n){return!e&&!Object(p.c)(t,n)}t.a=r,t.b=o,t.e=i,t.f=a,t.c=c,t.d=s;var u=n(138),l=n.n(u),p=n(918),f=n(500),d=function(e){return e.split(".").pop()||""}},921:function(e,t,n){"use strict";var r=n(3747);n.d(t,"a",(function(){return r.a}))},964:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PhoneStatus=void 0;!(function(e){e.ON="1",e.OFF="0"})(t.PhoneStatus||(t.PhoneStatus={}))}});